<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
<!-- Generated by rfcdiff 1.41: rfcdiff  --> 
<!-- <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional" > -->
<!-- System: Linux fomalhaut.local 3.13.0-38-generic #65-Ubuntu SMP Thu Oct 9 11:36:50 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux --> 
<!-- Using awk: /usr/bin/gawk: GNU Awk 4.0.1 --> 
<!-- Using diff: /usr/bin/diff: diff (GNU diffutils) 3.3 --> 
<!-- Using wdiff: /usr/bin/wdiff: wdiff (GNU wdiff) 1.2.1 --> 
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"> 
<head> 
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /> 
  <meta http-equiv="Content-Style-Type" content="text/css" /> 
  <title>Diff: karchive.cpp - karchive.cpp</title> 
  <style type="text/css"> 
    body    { font-size:16px; margin: 0.4ex; margin-right: auto; } 
    tr      { } 
    td      { white-space: pre; font-family: Consolas, "DejaVu Sans Mono", "Droid Sans Mono", Monaco, Monospace; vertical-align: top; font-size: 0.86em;} 
    th      { font-size: 0.86em; } 
    .small  { font-size: 0.6em; font-style: italic; font-family: Verdana, Helvetica, sans-serif; } 
    .left   { background-color: #EEE; } 
    .right  { background-color: #FFF; } 
    .diff   { background-color: #CCF; } 
    .lblock { background-color: #BFB; } 
    .rblock { background-color: #FF8; } 
    .insert { background-color: #8FF; } 
    .delete { background-color: #ACF; } 
    .void   { background-color: #FFB; } 
    .cont   { background-color: #EEE; } 
    .linebr { background-color: #AAA; } 
    .lineno { color: red; background-color: #FFF; font-size: 0.7em; text-align: right; padding: 0 2px; } 
    .elipsis{ background-color: #AAA; } 
    .left .cont { background-color: #DDD; } 
    .right .cont { background-color: #EEE; } 
    .lblock .cont { background-color: #9D9; } 
    .rblock .cont { background-color: #DD6; } 
    .insert .cont { background-color: #0DD; } 
    .delete .cont { background-color: #8AD; } 
    .stats, .stats td, .stats th { background-color: #EEE; padding: 2px 0; } 
  </style> 
</head> 
<body > 
  <table border="0" cellpadding="0" cellspacing="0"> 
  <tr bgcolor="orange"><th></th><th>&nbsp;karchive.cpp&nbsp;</th><th> </th><th>&nbsp;karchive.cpp&nbsp;</th><th></th></tr> 
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l1" /><small>skipping to change at</small><em> line 45</em></th><th> </th><th><a name="part-r1" /><small>skipping to change at</small><em> line 45</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#include &lt;time.h&gt;</td><td> </td><td class="right">#include &lt;time.h&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#include &lt;unistd.h&gt;</td><td> </td><td class="right">#include &lt;unistd.h&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#include &lt;errno.h&gt;</td><td> </td><td class="right">#include &lt;errno.h&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#include &lt;assert.h&gt;</td><td> </td><td class="right">#include &lt;assert.h&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#include &lt;sys/types.h&gt;</td><td> </td><td class="right">#include &lt;sys/types.h&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#include &lt;sys/stat.h&gt;</td><td> </td><td class="right">#include &lt;sys/stat.h&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#ifdef Q_OS_UNIX</td><td> </td><td class="right">#ifdef Q_OS_UNIX</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#include &lt;limits.h&gt;  // PATH_MAX</td><td> </td><td class="right">#include &lt;limits.h&gt;  // PATH_MAX</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#endif</td><td> </td><td class="right">#endif</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0001" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">#ifndef <span class="delete">WIN32</span></td><td> </td><td class="rblock">#ifndef <span class="insert">Q_OS_WIN</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#include &lt;grp.h&gt;</td><td> </td><td class="right">#include &lt;grp.h&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#include &lt;pwd.h&gt;</td><td> </td><td class="right">#include &lt;pwd.h&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#else</td><td> </td><td class="right">#else</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#include "kdewin32/grp.h"</td><td> </td><td class="right">#include "kdewin32/grp.h"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#include "kdewin32/pwd.h"</td><td> </td><td class="right">#include "kdewin32/pwd.h"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#include "kdewin32/unistd.h"</td><td> </td><td class="right">#include "kdewin32/unistd.h"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#endif</td><td> </td><td class="right">#endif</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">class KArchivePrivate</td><td> </td><td class="right">class KArchivePrivate</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">public:</td><td> </td><td class="right">public:</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0002" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    KArchivePrivate()</td><td> </td><td class="rblock">       KArchivePrivate()</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        : rootDir( 0 ),</td><td> </td><td class="rblock">               : rootDir( 0 ),</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//          saveFile( 0 ),</td><td> </td><td class="right">//          saveFile( 0 ),</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0003" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">          dev ( 0 ),</td><td> </td><td class="rblock">                 dev ( 0 ),</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">          fileName(),</td><td> </td><td class="rblock">                 fileName(),</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">          mode( QIODevice::NotOpen ),</td><td> </td><td class="rblock">                 mode( QIODevice::NotOpen ),</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">          deviceOwned( false )</td><td> </td><td class="rblock">                 deviceOwned( false )</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    {}</td><td> </td><td class="rblock">       {}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    ~KArchivePrivate()</td><td> </td><td class="rblock">       ~KArchivePrivate()</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    {</td><td> </td><td class="rblock">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//        delete saveFile;</td><td> </td><td class="right">//        delete saveFile;</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0004" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        delete rootDir;</td><td> </td><td class="rblock">               delete rootDir;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    }</td><td> </td><td class="rblock">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    void abortWriting();</td><td> </td><td class="rblock">       void abortWriting();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0005" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    KArchiveDirectory* rootDir;</td><td> </td><td class="rblock">    <span class="insert">   </span>KArchiveDirectory* rootDir;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//    KSaveFile* saveFile;</td><td> </td><td class="right">//    KSaveFile* saveFile;</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0006" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    QIODevice * dev;</td><td> </td><td class="rblock">       QIODevice * dev;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    QString fileName;</td><td> </td><td class="rblock">       QString fileName;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    QIODevice::OpenMode mode;</td><td> </td><td class="rblock">       QIODevice::OpenMode mode;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    bool deviceOwned; // if true, we (KArchive) own dev and must delete it</td><td> </td><td class="rblock">       bool deviceOwned; // if true, we (KArchive) own dev and must delete </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">it</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">};</td><td> </td><td class="right">};</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">////////////////////////////////////////////////////////////////////////</td><td> </td><td class="right">////////////////////////////////////////////////////////////////////////</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">/////////////////////////// KArchive ///////////////////////////////////</td><td> </td><td class="right">/////////////////////////// KArchive ///////////////////////////////////</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">////////////////////////////////////////////////////////////////////////</td><td> </td><td class="right">////////////////////////////////////////////////////////////////////////</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">KArchive::KArchive( const QString&amp; fileName )</td><td> </td><td class="right">KArchive::KArchive( const QString&amp; fileName )</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       : d(new KArchivePrivate)</td><td> </td><td class="right">       : d(new KArchivePrivate)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0007" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    Q_ASSERT( !fileName.isEmpty() );</td><td> </td><td class="rblock">       Q_ASSERT( !fileName.isEmpty() );</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    d-&gt;fileName = fileName;</td><td> </td><td class="rblock">       d-&gt;fileName = fileName;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    // This constructor leaves the device set to 0.</td><td> </td><td class="rblock">       // This constructor leaves the device set to 0.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    // This is for the use of KSaveFile, see open().</td><td> </td><td class="rblock">       // This is for the use of KSaveFile, see open().</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">KArchive::KArchive( QIODevice * dev )</td><td> </td><td class="right">KArchive::KArchive( QIODevice * dev )</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       : d(new KArchivePrivate)</td><td> </td><td class="right">       : d(new KArchivePrivate)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0008" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    d-&gt;dev = dev;</td><td> </td><td class="rblock">    <span class="insert">   </span>d-&gt;dev = dev;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">KArchive::~KArchive()</td><td> </td><td class="right">KArchive::~KArchive()</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0009" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    if ( isOpen() )</td><td> </td><td class="rblock">       if ( isOpen() )</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        close(); // WARNING: won't call the virtual method close in the <span class="delete">der</span></td><td> </td><td class="rblock">               close(); // WARNING: won't call the virtual method close in </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">ived</span> class!!!</td><td> </td><td class="rblock">the <span class="insert">derived</span> class!!!</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0010" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    delete d;</td><td> </td><td class="rblock">    <span class="insert">   </span>delete d;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">bool KArchive::open( QIODevice::OpenMode mode )</td><td> </td><td class="right">bool KArchive::open( QIODevice::OpenMode mode )</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0011" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    Q_ASSERT( mode != QIODevice::NotOpen );</td><td> </td><td class="rblock">    <span class="insert">   </span>Q_ASSERT( mode != QIODevice::NotOpen );</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0012" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    if ( isOpen() )</td><td> </td><td class="rblock">       if ( isOpen() )</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        close();</td><td> </td><td class="rblock">               close();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0013" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    if ( !d-&gt;fileName.isEmpty() )</td><td> </td><td class="rblock">       if ( !d-&gt;fileName.isEmpty() )</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    {</td><td> </td><td class="rblock">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        Q_ASSERT( !d-&gt;dev );</td><td> </td><td class="rblock">               Q_ASSERT( !d-&gt;dev );</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        if ( !createDevice( mode ) )</td><td> </td><td class="rblock">               if ( !createDevice( mode ) )</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">            return false;</td><td> </td><td class="rblock">                       return false;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    }</td><td> </td><td class="rblock">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0014" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    Q_ASSERT( d-&gt;dev );</td><td> </td><td class="rblock">    <span class="insert">   </span>Q_ASSERT( d-&gt;dev );</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0015" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    if ( !d-&gt;dev-&gt;isOpen() &amp;&amp; !d-&gt;dev-&gt;open( mode ) )</td><td> </td><td class="rblock">       if ( !d-&gt;dev-&gt;isOpen() &amp;&amp; !d-&gt;dev-&gt;open( mode ) )</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        return false;</td><td> </td><td class="rblock">               return false;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0016" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    d-&gt;mode = mode;</td><td> </td><td class="rblock">    <span class="insert">   </span>d-&gt;mode = mode;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0017" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    Q_ASSERT( !d-&gt;rootDir );</td><td> </td><td class="rblock">       Q_ASSERT( !d-&gt;rootDir );</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    d-&gt;rootDir = 0;</td><td> </td><td class="rblock">       d-&gt;rootDir = 0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0018" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    return openArchive( mode );</td><td> </td><td class="rblock">    <span class="insert">   </span>return openArchive( mode );</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">bool KArchive::createDevice( QIODevice::OpenMode mode )</td><td> </td><td class="right">bool KArchive::createDevice( QIODevice::OpenMode mode )</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0019" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    switch( mode ) {</td><td> </td><td class="rblock">       switch( mode ) {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    case QIODevice::WriteOnly:</td><td> </td><td class="rblock">       case QIODevice::WriteOnly:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//         if ( !d-&gt;fileName.isEmpty() ) {</td><td> </td><td class="right">//         if ( !d-&gt;fileName.isEmpty() ) {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//             // The use of KSaveFile can't be done in the ctor (no mode k
nown yet)</td><td> </td><td class="right">//             // The use of KSaveFile can't be done in the ctor (no mode k
nown yet)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//             //qDebug() &lt;&lt; "Writing to a file using KSaveFile";</td><td> </td><td class="right">//             //qDebug() &lt;&lt; "Writing to a file using KSaveFile";</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//             d-&gt;saveFile = new KSaveFile( d-&gt;fileName );</td><td> </td><td class="right">//             d-&gt;saveFile = new KSaveFile( d-&gt;fileName );</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//             if ( !d-&gt;saveFile-&gt;open() ) {</td><td> </td><td class="right">//             if ( !d-&gt;saveFile-&gt;open() ) {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//                 qWarning() &lt;&lt; "KSaveFile creation for " &lt;&lt; d-&gt;fileName &lt;
&lt; " failed, " &lt;&lt; d-&gt;saveFile-&gt;errorString();</td><td> </td><td class="right">//                 qWarning() &lt;&lt; "KSaveFile creation for " &lt;&lt; d-&gt;fileName &lt;
&lt; " failed, " &lt;&lt; d-&gt;saveFile-&gt;errorString();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//                 delete d-&gt;saveFile;</td><td> </td><td class="right">//                 delete d-&gt;saveFile;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//                 d-&gt;saveFile = 0;</td><td> </td><td class="right">//                 d-&gt;saveFile = 0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//                 return false;</td><td> </td><td class="right">//                 return false;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//             }</td><td> </td><td class="right">//             }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//             d-&gt;dev = d-&gt;saveFile;</td><td> </td><td class="right">//             d-&gt;dev = d-&gt;saveFile;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//             Q_ASSERT( d-&gt;dev );</td><td> </td><td class="right">//             Q_ASSERT( d-&gt;dev );</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//         }</td><td> </td><td class="right">//         }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               Q_ASSERT(0); // Unsupported for Stellarium</td><td> </td><td class="right">               Q_ASSERT(0); // Unsupported for Stellarium</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0020" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        break;</td><td> </td><td class="rblock">               break;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    case QIODevice::ReadOnly:</td><td> </td><td class="rblock">       case QIODevice::ReadOnly:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    case QIODevice::ReadWrite:</td><td> </td><td class="rblock">       case QIODevice::ReadWrite:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        // ReadWrite mode still uses QFile for now; we'd need to <span class="delete">copy</span> to <span class="delete">th</span></td><td> </td><td class="rblock">               // ReadWrite mode still uses QFile for now; we'd need to <span class="insert">cop</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">e</span> tempfile, in fact.</td><td> </td><td class="rblock"><span class="insert">y</span> to <span class="insert">the</span> tempfile, in fact.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        if ( !d-&gt;fileName.isEmpty() ) {</td><td> </td><td class="rblock">               if ( !d-&gt;fileName.isEmpty() ) {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">            d-&gt;dev = new QFile( d-&gt;fileName );</td><td> </td><td class="rblock">                       d-&gt;dev = new QFile( d-&gt;fileName );</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">            d-&gt;deviceOwned = true;</td><td> </td><td class="rblock">                       d-&gt;deviceOwned = true;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        }</td><td> </td><td class="rblock">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        break; // continued below</td><td> </td><td class="rblock">               break; // continued below</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    default:</td><td> </td><td class="rblock">       default:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        qWarning() &lt;&lt; "Unsupported mode " &lt;&lt; d-&gt;mode;</td><td> </td><td class="rblock">               qWarning() &lt;&lt; "Unsupported mode " &lt;&lt; d-&gt;mode;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        return false;</td><td> </td><td class="rblock">               return false;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    }</td><td> </td><td class="rblock">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    return true;</td><td> </td><td class="rblock">       return true;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">bool KArchive::close()</td><td> </td><td class="right">bool KArchive::close()</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0021" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    if ( !isOpen() )</td><td> </td><td class="rblock">       if ( !isOpen() )</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        return false; // already closed (return false or true? <span class="delete">arguable...)</span></td><td> </td><td class="rblock">               return false; // already closed (return false or true? <span class="insert">argua</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">ble...)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0022" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    // moved by holger to allow kzip to write the zip central dir</td><td> </td><td class="rblock">       // moved by holger to allow kzip to write the zip central dir</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    // to the file in closeArchive()</td><td> </td><td class="rblock">       // to the file in closeArchive()</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    // DF: added d-&gt;dev so that we skip closeArchive if saving aborted.</td><td> </td><td class="rblock">       // DF: added d-&gt;dev so that we skip closeArchive if saving aborted.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    bool closeSucceeded = true;</td><td> </td><td class="rblock">       bool closeSucceeded = true;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    if ( d-&gt;dev ) {</td><td> </td><td class="rblock">       if ( d-&gt;dev ) {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        closeSucceeded = closeArchive();</td><td> </td><td class="rblock">               closeSucceeded = closeArchive();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        if ( d-&gt;mode == QIODevice::WriteOnly &amp;&amp; !closeSucceeded )</td><td> </td><td class="rblock">               if ( d-&gt;mode == QIODevice::WriteOnly &amp;&amp; !closeSucceeded )</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">            d-&gt;abortWriting();</td><td> </td><td class="rblock">                       d-&gt;abortWriting();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    }</td><td> </td><td class="rblock">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                           </td><td> </td><td class="rblock">                                                                           </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    if ( d-&gt;dev )</td><td> </td><td class="rblock">       if ( d-&gt;dev )</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        d-&gt;dev-&gt;close();</td><td> </td><td class="rblock">               d-&gt;dev-&gt;close();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                           </td><td> </td><td class="rblock">                                                                           </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    if ( d-&gt;deviceOwned ) {</td><td> </td><td class="rblock">       if ( d-&gt;deviceOwned ) {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        delete d-&gt;dev; // we created it ourselves in open()</td><td> </td><td class="rblock">               delete d-&gt;dev; // we created it ourselves in open()</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    }</td><td> </td><td class="rblock">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Disabled for Stellarium</td><td> </td><td class="right">// Disabled for Stellarium</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//     if ( d-&gt;saveFile ) {</td><td> </td><td class="right">//     if ( d-&gt;saveFile ) {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//         closeSucceeded = d-&gt;saveFile-&gt;finalize();</td><td> </td><td class="right">//         closeSucceeded = d-&gt;saveFile-&gt;finalize();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//         delete d-&gt;saveFile;</td><td> </td><td class="right">//         delete d-&gt;saveFile;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//         d-&gt;saveFile = 0;</td><td> </td><td class="right">//         d-&gt;saveFile = 0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//     }</td><td> </td><td class="right">//     }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0023" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    delete d-&gt;rootDir;</td><td> </td><td class="rblock">       delete d-&gt;rootDir;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    d-&gt;rootDir = 0;</td><td> </td><td class="rblock">       d-&gt;rootDir = 0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    d-&gt;mode = QIODevice::NotOpen;</td><td> </td><td class="rblock">       d-&gt;mode = QIODevice::NotOpen;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    d-&gt;dev = 0;</td><td> </td><td class="rblock">       d-&gt;dev = 0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    return closeSucceeded;</td><td> </td><td class="rblock">       return closeSucceeded;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">const KArchiveDirectory* KArchive::directory() const</td><td> </td><td class="right">const KArchiveDirectory* KArchive::directory() const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0024" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    // rootDir isn't const so that parsing-on-demand is possible</td><td> </td><td class="rblock">       // rootDir isn't const so that parsing-on-demand is possible</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    return const_cast&lt;KArchive *&gt;(this)-&gt;rootDir();</td><td> </td><td class="rblock">       return const_cast&lt;KArchive *&gt;(this)-&gt;rootDir();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">bool KArchive::addLocalFile( const QString&amp; fileName, const QString&amp; destNa
me )</td><td> </td><td class="right">bool KArchive::addLocalFile( const QString&amp; fileName, const QString&amp; destNa
me )</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       Q_ASSERT(0);  // Disabled for Stellarium</td><td> </td><td class="right">       Q_ASSERT(0);  // Disabled for Stellarium</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return true;</td><td> </td><td class="right">       return true;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//     QFileInfo fileInfo( fileName );</td><td> </td><td class="right">//     QFileInfo fileInfo( fileName );</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//     if ( !fileInfo.isFile() &amp;&amp; !fileInfo.isSymLink() )</td><td> </td><td class="right">//     if ( !fileInfo.isFile() &amp;&amp; !fileInfo.isSymLink() )</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//     {</td><td> </td><td class="right">//     {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//         qWarning() &lt;&lt; fileName &lt;&lt; "doesn't exist or is not a regular fil
e.";</td><td> </td><td class="right">//         qWarning() &lt;&lt; fileName &lt;&lt; "doesn't exist or is not a regular fil
e.";</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l2" /><small>skipping to change at</small><em> line 292</em></th><th> </th><th><a name="part-r2" /><small>skipping to change at</small><em> line 292</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//     if ( !finishWriting( size ) )</td><td> </td><td class="right">//     if ( !finishWriting( size ) )</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//     {</td><td> </td><td class="right">//     {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//         qWarning() &lt;&lt; "finishWriting failed";</td><td> </td><td class="right">//         qWarning() &lt;&lt; "finishWriting failed";</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//         return false;</td><td> </td><td class="right">//         return false;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//     }</td><td> </td><td class="right">//     }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//     return true;</td><td> </td><td class="right">//     return true;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">bool KArchive::addLocalDirectory( const QString&amp; path, const QString&amp; destN
ame )</td><td> </td><td class="right">bool KArchive::addLocalDirectory( const QString&amp; path, const QString&amp; destN
ame )</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0025" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    QDir dir( path );</td><td> </td><td class="rblock">       QDir dir( path );</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    if ( !dir.exists() )</td><td> </td><td class="rblock">       if ( !dir.exists() )</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        return false;</td><td> </td><td class="rblock">               return false;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    dir.setFilter(dir.filter() | QDir::Hidden);</td><td> </td><td class="rblock">       dir.setFilter(dir.filter() | QDir::Hidden);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    const QStringList files = dir.entryList();</td><td> </td><td class="rblock">       const QStringList files = dir.entryList();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    for ( QStringList::ConstIterator it = files.begin(); it != <span class="delete">files.end();</span></td><td> </td><td class="rblock">       for ( QStringList::ConstIterator it = files.begin(); it != <span class="insert">files.end</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"> ++it )</td><td> </td><td class="rblock"><span class="insert">();</span> ++it )</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    {</td><td> </td><td class="rblock">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        if ( *it != "." &amp;&amp; *it != ".." )</td><td> </td><td class="rblock">               if ( *it != "." &amp;&amp; *it != ".." )</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        {</td><td> </td><td class="rblock">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">            QString fileName = path + '/' + *it;</td><td> </td><td class="rblock">                       QString fileName = path + '/' + *it;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//            qDebug() &lt;&lt; "storing " &lt;&lt; fileName;</td><td> </td><td class="right">//            qDebug() &lt;&lt; "storing " &lt;&lt; fileName;</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0026" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">            QString dest = destName.isEmpty() ? *it : (destName + '/' + <span class="delete">*it</span></td><td> </td><td class="rblock">                       QString dest = destName.isEmpty() ? *it : (destName </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">);</span></td><td> </td><td class="rblock">+ '/' + <span class="insert">*it);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">            QFileInfo fileInfo( fileName );</td><td> </td><td class="rblock">                       QFileInfo fileInfo( fileName );</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0027" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">            if ( fileInfo.isFile() || fileInfo.isSymLink() )</td><td> </td><td class="rblock">                       if ( fileInfo.isFile() || fileInfo.isSymLink() )</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                addLocalFile( fileName, dest );</td><td> </td><td class="rblock">                               addLocalFile( fileName, dest );</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">            else if ( fileInfo.isDir() )</td><td> </td><td class="rblock">                       else if ( fileInfo.isDir() )</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                addLocalDirectory( fileName, dest );</td><td> </td><td class="rblock">                               addLocalDirectory( fileName, dest );</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">            // We omit sockets</td><td> </td><td class="rblock">                       // We omit sockets</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        }</td><td> </td><td class="rblock">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    }</td><td> </td><td class="rblock">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    return true;</td><td> </td><td class="rblock">       return true;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">bool KArchive::writeFile( const QString&amp; name, const QString&amp; user,</td><td> </td><td class="right">bool KArchive::writeFile( const QString&amp; name, const QString&amp; user,</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0028" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                          const QString&amp; group, <span class="delete">const</span> char* data, qint64 <span class="delete">si</span></td><td> </td><td class="rblock">                                                 const QString&amp; group, <span class="insert">cons</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">ze,</span></td><td> </td><td class="rblock"><span class="insert">t</span> char* data, qint64 <span class="insert">size,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                          mode_t perm, time_t atime, time_t mtime, time_t <span class="delete">c</span></td><td> </td><td class="rblock">                                                 mode_t perm, time_t atime,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">time</span> )</td><td> </td><td class="rblock"> time_t mtime, time_t <span class="insert">ctime</span> )</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0029" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    if ( !prepareWriting( name, user, group, size, perm, atime, mtime, <span class="delete">ctim</span></td><td> </td><td class="rblock">       if ( !prepareWriting( name, user, group, size, perm, atime, mtime, <span class="insert">c</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">e</span> ) )</td><td> </td><td class="rblock"><span class="insert">time</span> ) )</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    {</td><td> </td><td class="rblock">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        qWarning() &lt;&lt; "prepareWriting failed";</td><td> </td><td class="rblock">               qWarning() &lt;&lt; "prepareWriting failed";</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        return false;</td><td> </td><td class="rblock">               return false;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    }</td><td> </td><td class="rblock">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                           </td><td> </td><td class="rblock">                                                                           </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    // Write data</td><td> </td><td class="rblock">       // Write data</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    // Note: if data is 0L, don't call write, it would terminate the <span class="delete">KFilte</span></td><td> </td><td class="rblock">       // Note: if data is 0L, don't call write, it would terminate the <span class="insert">KFi</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">rDev</span></td><td> </td><td class="rblock"><span class="insert">lterDev</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    if ( data &amp;&amp; size &amp;&amp; !writeData( data, size ) )</td><td> </td><td class="rblock">       if ( data &amp;&amp; size &amp;&amp; !writeData( data, size ) )</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    {</td><td> </td><td class="rblock">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        qWarning() &lt;&lt; "writeData failed";</td><td> </td><td class="rblock">               qWarning() &lt;&lt; "writeData failed";</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        return false;</td><td> </td><td class="rblock">               return false;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    }</td><td> </td><td class="rblock">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                           </td><td> </td><td class="rblock">                                                                           </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    if ( !finishWriting( size ) )</td><td> </td><td class="rblock">       if ( !finishWriting( size ) )</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    {</td><td> </td><td class="rblock">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        qWarning() &lt;&lt; "finishWriting failed";</td><td> </td><td class="rblock">               qWarning() &lt;&lt; "finishWriting failed";</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        return false;</td><td> </td><td class="rblock">               return false;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    }</td><td> </td><td class="rblock">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    return true;</td><td> </td><td class="rblock">       return true;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">bool KArchive::writeData( const char* data, qint64 size )</td><td> </td><td class="right">bool KArchive::writeData( const char* data, qint64 size )</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0030" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    bool ok = device()-&gt;write( data, size ) == size;</td><td> </td><td class="rblock">       bool ok = device()-&gt;write( data, size ) == size;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    if ( !ok )</td><td> </td><td class="rblock">       if ( !ok )</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        d-&gt;abortWriting();</td><td> </td><td class="rblock">               d-&gt;abortWriting();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    return ok;</td><td> </td><td class="rblock">       return ok;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// The writeDir -&gt; doWriteDir pattern allows to avoid propagating the defau
lt</td><td> </td><td class="right">// The writeDir -&gt; doWriteDir pattern allows to avoid propagating the defau
lt</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// values into all virtual methods of subclasses, and it allows more extens
ibility:</td><td> </td><td class="right">// values into all virtual methods of subclasses, and it allows more extens
ibility:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// if a new argument is needed, we can add a writeDir overload which stores
 the</td><td> </td><td class="right">// if a new argument is needed, we can add a writeDir overload which stores
 the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// additional argument in the d pointer, and doWriteDir reimplementations c
an fetch</td><td> </td><td class="right">// additional argument in the d pointer, and doWriteDir reimplementations c
an fetch</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// it from there.</td><td> </td><td class="right">// it from there.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">bool KArchive::writeDir( const QString&amp; name, const QString&amp; user, const QS
tring&amp; group,</td><td> </td><td class="right">bool KArchive::writeDir( const QString&amp; name, const QString&amp; user, const QS
tring&amp; group,</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0031" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                         mode_t perm, time_t atime,</td><td> </td><td class="rblock">                                                mode_t perm, time_t atime,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                         time_t mtime, time_t ctime )</td><td> </td><td class="rblock">                                                time_t mtime, time_t ctime </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0032" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    return doWriteDir( name, user, group, perm, atime, mtime, ctime );</td><td> </td><td class="rblock">    <span class="insert">   </span>return doWriteDir( name, user, group, perm, atime, mtime, ctime );</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">bool KArchive::writeSymLink(const QString &amp;name, const QString &amp;target,</td><td> </td><td class="right">bool KArchive::writeSymLink(const QString &amp;name, const QString &amp;target,</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0033" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                            const QString &amp;user, const QString &amp;group,</td><td> </td><td class="rblock">                                                       const QString &amp;user,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                            mode_t perm, time_t atime,</td><td> </td><td class="rblock"> const QString &amp;group,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                            time_t mtime, time_t ctime )</td><td> </td><td class="rblock">                                                       mode_t perm, time_t </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">atime,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                                                       time_t mtime, time_t</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"> ctime )</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0034" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    <span class="delete">return doWriteSymLink( name, target, user, group, perm, atime, mtime, c
</span>time );</td><td> </td><td class="rblock">    <span class="insert">   return doWriteSymLink( name, target, user, group, perm, atime, mtime
, c</span>time );</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">bool KArchive::prepareWriting( const QString&amp; name, const QString&amp; user,</td><td> </td><td class="right">bool KArchive::prepareWriting( const QString&amp; name, const QString&amp; user,</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0035" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                               const QString&amp; <span class="delete">group,</span> qint64 size,</td><td> </td><td class="rblock">                                                          const QString&amp; <span class="insert">gr</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                               mode_t perm, <span class="delete">time_t</span> atime,</td><td> </td><td class="rblock"><span class="insert">oup,</span> qint64 size,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                               time_t mtime, <span class="delete">time_t</span> ctime )</td><td> </td><td class="rblock">                                                          mode_t perm, <span class="insert">time</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">{</td><td> </td><td class="rblock"><span class="insert">_t</span> atime,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    bool ok = doPrepareWriting( name, user, group, size, perm, atime, <span class="delete">mtime</span></td><td> </td><td class="rblock">                                                          time_t mtime, <span class="insert">tim</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">,</span> ctime );</td><td> </td><td class="rblock"><span class="insert">e_t</span> ctime )</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    if ( !ok )</td><td> </td><td class="rblock">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        d-&gt;abortWriting();</td><td> </td><td class="rblock">       bool ok = doPrepareWriting( name, user, group, size, perm, atime, <span class="insert">mt</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    return ok;</td><td> </td><td class="rblock"><span class="insert">ime,</span> ctime );</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       if ( !ok )</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">               d-&gt;abortWriting();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       return ok;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">bool KArchive::finishWriting( qint64 size )</td><td> </td><td class="right">bool KArchive::finishWriting( qint64 size )</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0036" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    return doFinishWriting( size );</td><td> </td><td class="rblock">    <span class="insert">   </span>return doFinishWriting( size );</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">KArchiveDirectory * KArchive::rootDir()</td><td> </td><td class="right">KArchiveDirectory * KArchive::rootDir()</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0037" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    if ( !d-&gt;rootDir )</td><td> </td><td class="rblock">       if ( !d-&gt;rootDir )</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    {</td><td> </td><td class="rblock">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        //qDebug() &lt;&lt; "Making root dir ";</td><td> </td><td class="rblock">               //qDebug() &lt;&lt; "Making root dir ";</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        struct passwd* pw =  getpwuid( getuid() );</td><td> </td><td class="rblock">               struct passwd* pw =  getpwuid( getuid() );</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        struct group* grp = getgrgid( getgid() );</td><td> </td><td class="rblock">               struct group* grp = getgrgid( getgid() );</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        QString username = pw ? QFile::decodeName(pw-&gt;pw_name) : <span class="delete">QString::n</span></td><td> </td><td class="rblock">               QString username = pw ? QFile::decodeName(pw-&gt;pw_name) : <span class="insert">QSt</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">umber(</span> getuid() );</td><td> </td><td class="rblock"><span class="insert">ring::number(</span> getuid() );</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        QString groupname = grp ? QFile::decodeName(grp-&gt;gr_name) : <span class="delete">QString</span></td><td> </td><td class="rblock">               QString groupname = grp ? QFile::decodeName(grp-&gt;gr_name) : </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">::number(</span> getgid() );</td><td> </td><td class="rblock"><span class="insert">QString::number(</span> getgid() );</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                           </td><td> </td><td class="rblock">                                                                           </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        d-&gt;rootDir = new KArchiveDirectory( this, <span class="delete">QLatin1String("/"), (int)</span></td><td> </td><td class="rblock">               d-&gt;rootDir = new KArchiveDirectory( this, <span class="insert">QLatin1String("/")</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">(0777</span> + S_IFDIR), 0, username, groupname, QString() );</td><td> </td><td class="rblock"><span class="insert">, (int)(0777</span> + S_IFDIR), 0, username, groupname, QString() );</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    }</td><td> </td><td class="rblock">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    return d-&gt;rootDir;</td><td> </td><td class="rblock">       return d-&gt;rootDir;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">KArchiveDirectory * KArchive::findOrCreate( const QString &amp; path )</td><td> </td><td class="right">KArchiveDirectory * KArchive::findOrCreate( const QString &amp; path )</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0038" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    //qDebug() &lt;&lt; path;</td><td> </td><td class="rblock">       //qDebug() &lt;&lt; path;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    if ( path.isEmpty() || path == "/" || path == "." ) // root dir =&gt; <span class="delete">foun</span></td><td> </td><td class="rblock">       if ( path.isEmpty() || path == "/" || path == "." ) // root dir =&gt; <span class="insert">f</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">d</span></td><td> </td><td class="rblock"><span class="insert">ound</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    {</td><td> </td><td class="rblock">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        //qDebug() &lt;&lt; "returning rootdir";</td><td> </td><td class="rblock">               //qDebug() &lt;&lt; "returning rootdir";</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        return rootDir();</td><td> </td><td class="rblock">               return rootDir();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    }</td><td> </td><td class="rblock">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    // Important note : for tar files containing absolute paths</td><td> </td><td class="rblock">       // Important note : for tar files containing absolute paths</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    // (i.e. beginning with "/"), this means the leading "/" will</td><td> </td><td class="rblock">       // (i.e. beginning with "/"), this means the leading "/" will</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    // be removed (no KDirectory for it), which is exactly the way</td><td> </td><td class="rblock">       // be removed (no KDirectory for it), which is exactly the way</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    // the "tar" program works (though it displays a warning about it)</td><td> </td><td class="rblock">       // the "tar" program works (though it displays a warning about it)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    // See also KArchiveDirectory::entry().</td><td> </td><td class="rblock">       // See also KArchiveDirectory::entry().</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                           </td><td> </td><td class="rblock">                                                                           </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    // Already created ? =&gt; found</td><td> </td><td class="rblock">       // Already created ? =&gt; found</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    const KArchiveEntry* ent = rootDir()-&gt;entry( path );</td><td> </td><td class="rblock">       const KArchiveEntry* ent = rootDir()-&gt;entry( path );</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    if ( ent )</td><td> </td><td class="rblock">       if ( ent )</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    {</td><td> </td><td class="rblock">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        if ( ent-&gt;isDirectory() )</td><td> </td><td class="rblock">               if ( ent-&gt;isDirectory() )</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">            //qDebug() &lt;&lt; "found it";</td><td> </td><td class="rblock">                       //qDebug() &lt;&lt; "found it";</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">            return (KArchiveDirectory *) ent;</td><td> </td><td class="rblock">                       return (KArchiveDirectory *) ent;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        else</td><td> </td><td class="rblock">               else</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">            qWarning() &lt;&lt; "Found" &lt;&lt; path &lt;&lt; "but it's not a <span class="delete">directory";</span></td><td> </td><td class="rblock">                       qWarning() &lt;&lt; "Found" &lt;&lt; path &lt;&lt; "but it's not a <span class="insert">dir</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    }</td><td> </td><td class="rblock"><span class="insert">ectory";</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                           </td><td> </td><td class="rblock">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    // Otherwise go up and try again</td><td> </td><td class="rblock">                                                                           </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    int pos = path.lastIndexOf( '/' );</td><td> </td><td class="rblock">       // Otherwise go up and try again</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    KArchiveDirectory * parent;</td><td> </td><td class="rblock">       int pos = path.lastIndexOf( '/' );</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    QString dirname;</td><td> </td><td class="rblock">       KArchiveDirectory * parent;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    if ( pos == -1 ) // no more slash =&gt; create in root dir</td><td> </td><td class="rblock">       QString dirname;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    {</td><td> </td><td class="rblock">       if ( pos == -1 ) // no more slash =&gt; create in root dir</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        parent =  rootDir();</td><td> </td><td class="rblock">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        dirname = path;</td><td> </td><td class="rblock">               parent =  rootDir();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    }</td><td> </td><td class="rblock">               dirname = path;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    else</td><td> </td><td class="rblock">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    {</td><td> </td><td class="rblock">       else</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        QString left = path.left( pos );</td><td> </td><td class="rblock">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        dirname = path.mid( pos + 1 );</td><td> </td><td class="rblock">               QString left = path.left( pos );</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        parent = findOrCreate( left ); // recursive call... until we find <span class="delete">a</span></td><td> </td><td class="rblock">               dirname = path.mid( pos + 1 );</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">n</span> existing dir.</td><td> </td><td class="rblock">               parent = findOrCreate( left ); // recursive call... until we</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    }</td><td> </td><td class="rblock"> find <span class="insert">an</span> existing dir.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                           </td><td> </td><td class="rblock">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    //qDebug() &lt;&lt; "found parent " &lt;&lt; parent-&gt;name() &lt;&lt; " adding " &lt;&lt; <span class="delete">dirnam</span></td><td> </td><td class="rblock">                                                                           </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">e</span> &lt;&lt; " to ensure " &lt;&lt; path;</td><td> </td><td class="rblock">       //qDebug() &lt;&lt; "found parent " &lt;&lt; parent-&gt;name() &lt;&lt; " adding " &lt;&lt; <span class="insert">dir</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    // Found -&gt; add the missing piece</td><td> </td><td class="rblock"><span class="insert">name</span> &lt;&lt; " to ensure " &lt;&lt; path;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    KArchiveDirectory * e = new KArchiveDirectory( this, dirname, <span class="delete">d-&gt;rootDi</span></td><td> </td><td class="rblock">       // Found -&gt; add the missing piece</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">r-&gt;permissions(),</span></td><td> </td><td class="rblock">       KArchiveDirectory * e = new KArchiveDirectory( this, dirname, <span class="insert">d-&gt;roo</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                   d-&gt;rootDir-&gt;date(), <span class="delete">d-&gt;r</span></td><td> </td><td class="rblock"><span class="insert">tDir-&gt;permissions(),</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">ootDir-&gt;user(),</span></td><td> </td><td class="rblock">                                                                           </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                   d-&gt;rootDir-&gt;group(), <span class="delete">QSt</span></td><td> </td><td class="rblock">                       d-&gt;rootDir-&gt;date(), <span class="insert">d-&gt;rootDir-&gt;user(),</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">ring()</span> );</td><td> </td><td class="rblock">                                                                           </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    parent-&gt;addEntry( e );</td><td> </td><td class="rblock">                       d-&gt;rootDir-&gt;group(), <span class="insert">QString()</span> );</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    return e; // now a directory to &lt;path&gt; exists</td><td> </td><td class="rblock">       parent-&gt;addEntry( e );</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       return e; // now a directory to &lt;path&gt; exists</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void KArchive::setDevice( QIODevice * dev )</td><td> </td><td class="right">void KArchive::setDevice( QIODevice * dev )</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0039" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    if ( d-&gt;deviceOwned )</td><td> </td><td class="rblock">       if ( d-&gt;deviceOwned )</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        delete d-&gt;dev;</td><td> </td><td class="rblock">               delete d-&gt;dev;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    d-&gt;dev = dev;</td><td> </td><td class="rblock">       d-&gt;dev = dev;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    d-&gt;deviceOwned = false;</td><td> </td><td class="rblock">       d-&gt;deviceOwned = false;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void KArchive::setRootDir( KArchiveDirectory *rootDir )</td><td> </td><td class="right">void KArchive::setRootDir( KArchiveDirectory *rootDir )</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0040" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    Q_ASSERT( !d-&gt;rootDir ); // Call setRootDir only once during parsing <span class="delete">pl</span></td><td> </td><td class="rblock">       Q_ASSERT( !d-&gt;rootDir ); // Call setRootDir only once during parsing</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">ease</span> ;)</td><td> </td><td class="rblock"> <span class="insert">please</span> ;)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    d-&gt;rootDir = rootDir;</td><td> </td><td class="rblock">       d-&gt;rootDir = rootDir;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">QIODevice::OpenMode KArchive::mode() const</td><td> </td><td class="right">QIODevice::OpenMode KArchive::mode() const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0041" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    return d-&gt;mode;</td><td> </td><td class="rblock">    <span class="insert">   </span>return d-&gt;mode;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">QIODevice * KArchive::device() const</td><td> </td><td class="right">QIODevice * KArchive::device() const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0042" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    return d-&gt;dev;</td><td> </td><td class="rblock">    <span class="insert">   </span>return d-&gt;dev;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">bool KArchive::isOpen() const</td><td> </td><td class="right">bool KArchive::isOpen() const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0043" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    return d-&gt;mode != QIODevice::NotOpen;</td><td> </td><td class="rblock">    <span class="insert">   </span>return d-&gt;mode != QIODevice::NotOpen;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">QString KArchive::fileName() const</td><td> </td><td class="right">QString KArchive::fileName() const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0044" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    return d-&gt;fileName;</td><td> </td><td class="rblock">    <span class="insert">   </span>return d-&gt;fileName;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void KArchivePrivate::abortWriting()</td><td> </td><td class="right">void KArchivePrivate::abortWriting()</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Disabled for Stellarium</td><td> </td><td class="right">// Disabled for Stellarium</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//     if ( saveFile ) {</td><td> </td><td class="right">//     if ( saveFile ) {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//         saveFile-&gt;abort();</td><td> </td><td class="right">//         saveFile-&gt;abort();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//         delete saveFile;</td><td> </td><td class="right">//         delete saveFile;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//         saveFile = 0;</td><td> </td><td class="right">//         saveFile = 0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//         dev = 0;</td><td> </td><td class="right">//         dev = 0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//     }</td><td> </td><td class="right">//     }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">////////////////////////////////////////////////////////////////////////</td><td> </td><td class="right">////////////////////////////////////////////////////////////////////////</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">/////////////////////// KArchiveEntry //////////////////////////////////</td><td> </td><td class="right">/////////////////////// KArchiveEntry //////////////////////////////////</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">////////////////////////////////////////////////////////////////////////</td><td> </td><td class="right">////////////////////////////////////////////////////////////////////////</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">class KArchiveEntryPrivate</td><td> </td><td class="right">class KArchiveEntryPrivate</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">public:</td><td> </td><td class="right">public:</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0045" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    KArchiveEntryPrivate( KArchive* _archive, const QString&amp; _name, int <span class="delete">_ac</span></td><td> </td><td class="rblock">       KArchiveEntryPrivate( KArchive* _archive, const QString&amp; _name, int </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">cess,</span></td><td> </td><td class="rblock"><span class="insert">_access,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                          int _date, const QString&amp; _user, const QString&amp; <span class="delete">_</span></td><td> </td><td class="rblock">                                                 int _date, const QString&amp; </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">group,</span></td><td> </td><td class="rblock">_user, const QString&amp; <span class="insert">_group,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                          const QString&amp; _symlink) :</td><td> </td><td class="rblock">                                                 const QString&amp; _symlink) :</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        name(_name),</td><td> </td><td class="rblock">               name(_name),</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        date(_date),</td><td> </td><td class="rblock">               date(_date),</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        access(_access),</td><td> </td><td class="rblock">               access(_access),</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        user(_user),</td><td> </td><td class="rblock">               user(_user),</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        group(_group),</td><td> </td><td class="rblock">               group(_group),</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        symlink(_symlink),</td><td> </td><td class="rblock">               symlink(_symlink),</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        archive(_archive)</td><td> </td><td class="rblock">               archive(_archive)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    {}</td><td> </td><td class="rblock">       {}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    QString name;</td><td> </td><td class="rblock">       QString name;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    int date;</td><td> </td><td class="rblock">       int date;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    mode_t access;</td><td> </td><td class="rblock">       mode_t access;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    QString user;</td><td> </td><td class="rblock">       QString user;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    QString group;</td><td> </td><td class="rblock">       QString group;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    QString symlink;</td><td> </td><td class="rblock">       QString symlink;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    KArchive* archive;</td><td> </td><td class="rblock">       KArchive* archive;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">};</td><td> </td><td class="right">};</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">KArchiveEntry::KArchiveEntry( KArchive* t, const QString&amp; name, int access,
 int date,</td><td> </td><td class="right">KArchiveEntry::KArchiveEntry( KArchive* t, const QString&amp; name, int access,
 int date,</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0046" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                      const QString&amp; user, const <span class="delete">QString&amp;</span> group, const</td><td> </td><td class="rblock">                                         const QString&amp; user, const <span class="insert">QString</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                      QString&amp; symlink) :</td><td> </td><td class="rblock"><span class="insert">&amp;</span> group, const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    d(new KArchiveEntryPrivate(t,name,access,date,user,group,symlink))</td><td> </td><td class="rblock">                                         QString&amp; symlink) :</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       d(new KArchiveEntryPrivate(t,name,access,date,user,group,symlink))</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">KArchiveEntry::~KArchiveEntry()</td><td> </td><td class="right">KArchiveEntry::~KArchiveEntry()</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0047" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    delete d;</td><td> </td><td class="rblock">    <span class="insert">   </span>delete d;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">QDateTime KArchiveEntry::datetime() const</td><td> </td><td class="right">QDateTime KArchiveEntry::datetime() const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">  QDateTime datetimeobj;</td><td> </td><td class="right">  QDateTime datetimeobj;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">  datetimeobj.setTime_t( d-&gt;date );</td><td> </td><td class="right">  datetimeobj.setTime_t( d-&gt;date );</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">  return datetimeobj;</td><td> </td><td class="right">  return datetimeobj;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">int KArchiveEntry::date() const</td><td> </td><td class="right">int KArchiveEntry::date() const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0048" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    return d-&gt;date;</td><td> </td><td class="rblock">    <span class="insert">   </span>return d-&gt;date;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">QString KArchiveEntry::name() const</td><td> </td><td class="right">QString KArchiveEntry::name() const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0049" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    return d-&gt;name;</td><td> </td><td class="rblock">    <span class="insert">   </span>return d-&gt;name;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">mode_t KArchiveEntry::permissions() const</td><td> </td><td class="right">mode_t KArchiveEntry::permissions() const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0050" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    return d-&gt;access;</td><td> </td><td class="rblock">    <span class="insert">   </span>return d-&gt;access;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">QString KArchiveEntry::user() const</td><td> </td><td class="right">QString KArchiveEntry::user() const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0051" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    return d-&gt;user;</td><td> </td><td class="rblock">    <span class="insert">   </span>return d-&gt;user;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">QString KArchiveEntry::group() const</td><td> </td><td class="right">QString KArchiveEntry::group() const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0052" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    return d-&gt;group;</td><td> </td><td class="rblock">    <span class="insert">   </span>return d-&gt;group;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">QString KArchiveEntry::symLinkTarget() const</td><td> </td><td class="right">QString KArchiveEntry::symLinkTarget() const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0053" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    return d-&gt;symlink;</td><td> </td><td class="rblock">    <span class="insert">   </span>return d-&gt;symlink;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">bool KArchiveEntry::isFile() const</td><td> </td><td class="right">bool KArchiveEntry::isFile() const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0054" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    return false;</td><td> </td><td class="rblock">    <span class="insert">   </span>return false;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">bool KArchiveEntry::isDirectory() const</td><td> </td><td class="right">bool KArchiveEntry::isDirectory() const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0055" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    return false;</td><td> </td><td class="rblock">    <span class="insert">   </span>return false;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">KArchive* KArchiveEntry::archive() const</td><td> </td><td class="right">KArchive* KArchiveEntry::archive() const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0056" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    return d-&gt;archive;</td><td> </td><td class="rblock">    <span class="insert">   </span>return d-&gt;archive;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">////////////////////////////////////////////////////////////////////////</td><td> </td><td class="right">////////////////////////////////////////////////////////////////////////</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">/////////////////////// KArchiveFile ///////////////////////////////////</td><td> </td><td class="right">/////////////////////// KArchiveFile ///////////////////////////////////</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">////////////////////////////////////////////////////////////////////////</td><td> </td><td class="right">////////////////////////////////////////////////////////////////////////</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">class KArchiveFilePrivate</td><td> </td><td class="right">class KArchiveFilePrivate</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">public:</td><td> </td><td class="right">public:</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0057" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    KArchiveFilePrivate( qint64 _pos, qint64 _size ) :</td><td> </td><td class="rblock">       KArchiveFilePrivate( qint64 _pos, qint64 _size ) :</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        pos(_pos),</td><td> </td><td class="rblock">               pos(_pos),</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        size(_size)</td><td> </td><td class="rblock">               size(_size)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    {}</td><td> </td><td class="rblock">       {}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    qint64 pos;</td><td> </td><td class="rblock">       qint64 pos;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    qint64 size;</td><td> </td><td class="rblock">       qint64 size;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">};</td><td> </td><td class="right">};</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">KArchiveFile::KArchiveFile( KArchive* t, const QString&amp; name, int access, i
nt date,</td><td> </td><td class="right">KArchiveFile::KArchiveFile( KArchive* t, const QString&amp; name, int access, i
nt date,</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0058" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                            const QString&amp; user, const QString&amp; group,</td><td> </td><td class="rblock">                                                       const QString&amp; user,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                            const QString &amp; <span class="delete">symlink,</span></td><td> </td><td class="rblock"> const QString&amp; group,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                            qint64 pos, qint64 <span class="delete">size</span> )</td><td> </td><td class="rblock">                                                       const QString &amp; <span class="insert">syml</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">ink,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                                                       qint64 pos, qint64 <span class="insert">s</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">ize</span> )</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">  : KArchiveEntry( t, name, access, date, user, group, symlink ),</td><td> </td><td class="right">  : KArchiveEntry( t, name, access, date, user, group, symlink ),</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0059" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    d( new KArchiveFilePrivate(pos, size) )</td><td> </td><td class="rblock">    <span class="insert">   </span>d( new KArchiveFilePrivate(pos, size) )</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">KArchiveFile::~KArchiveFile()</td><td> </td><td class="right">KArchiveFile::~KArchiveFile()</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0060" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    delete d;</td><td> </td><td class="rblock">    <span class="insert">   </span>delete d;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">qint64 KArchiveFile::position() const</td><td> </td><td class="right">qint64 KArchiveFile::position() const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">  return d-&gt;pos;</td><td> </td><td class="right">  return d-&gt;pos;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">qint64 KArchiveFile::size() const</td><td> </td><td class="right">qint64 KArchiveFile::size() const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">  return d-&gt;size;</td><td> </td><td class="right">  return d-&gt;size;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void KArchiveFile::setSize( qint64 s )</td><td> </td><td class="right">void KArchiveFile::setSize( qint64 s )</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0061" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    d-&gt;size = s;</td><td> </td><td class="rblock">    <span class="insert">   </span>d-&gt;size = s;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">QByteArray KArchiveFile::data() const</td><td> </td><td class="right">QByteArray KArchiveFile::data() const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">  archive()-&gt;device()-&gt;seek( d-&gt;pos );</td><td> </td><td class="right">  archive()-&gt;device()-&gt;seek( d-&gt;pos );</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">  // Read content</td><td> </td><td class="right">  // Read content</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">  QByteArray arr;</td><td> </td><td class="right">  QByteArray arr;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">  if ( d-&gt;size )</td><td> </td><td class="right">  if ( d-&gt;size )</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">  {</td><td> </td><td class="right">  {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0062" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    assert( arr.data() );</td><td> </td><td class="rblock">       assert( arr.data() );</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    arr = archive()-&gt;device()-&gt;read( d-&gt;size );</td><td> </td><td class="rblock">       arr = archive()-&gt;device()-&gt;read( d-&gt;size );</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    Q_ASSERT( arr.size() == d-&gt;size );</td><td> </td><td class="rblock">       Q_ASSERT( arr.size() == d-&gt;size );</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">  }</td><td> </td><td class="right">  }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">  return arr;</td><td> </td><td class="right">  return arr;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">QIODevice * KArchiveFile::createDevice() const</td><td> </td><td class="right">QIODevice * KArchiveFile::createDevice() const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">  return new KLimitedIODevice( archive()-&gt;device(), d-&gt;pos, d-&gt;size );</td><td> </td><td class="right">  return new KLimitedIODevice( archive()-&gt;device(), d-&gt;pos, d-&gt;size );</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">bool KArchiveFile::isFile() const</td><td> </td><td class="right">bool KArchiveFile::isFile() const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0063" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    return true;</td><td> </td><td class="rblock">    <span class="insert">   </span>return true;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void KArchiveFile::copyTo(const QString&amp; dest) const</td><td> </td><td class="right">void KArchiveFile::copyTo(const QString&amp; dest) const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">  QFile f( dest + '/'  + name() );</td><td> </td><td class="right">  QFile f( dest + '/'  + name() );</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">  if ( f.open( QIODevice::ReadWrite | QIODevice::Truncate ) )</td><td> </td><td class="right">  if ( f.open( QIODevice::ReadWrite | QIODevice::Truncate ) )</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">  {</td><td> </td><td class="right">  {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0064" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      f.write( data() );</td><td> </td><td class="rblock">         f.write( data() );</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      f.close();</td><td> </td><td class="rblock">         f.close();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">  }</td><td> </td><td class="right">  }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">////////////////////////////////////////////////////////////////////////</td><td> </td><td class="right">////////////////////////////////////////////////////////////////////////</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//////////////////////// KArchiveDirectory ////////////////////////////////
/</td><td> </td><td class="right">//////////////////////// KArchiveDirectory ////////////////////////////////
/</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">////////////////////////////////////////////////////////////////////////</td><td> </td><td class="right">////////////////////////////////////////////////////////////////////////</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">class KArchiveDirectoryPrivate</td><td> </td><td class="right">class KArchiveDirectoryPrivate</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">public:</td><td> </td><td class="right">public:</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0065" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    ~KArchiveDirectoryPrivate()</td><td> </td><td class="rblock">       ~KArchiveDirectoryPrivate()</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    {</td><td> </td><td class="rblock">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        qDeleteAll(entries);</td><td> </td><td class="rblock">               qDeleteAll(entries);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    }</td><td> </td><td class="rblock">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    QHash&lt;QString, KArchiveEntry *&gt; entries;</td><td> </td><td class="rblock">       QHash&lt;QString, KArchiveEntry *&gt; entries;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">};</td><td> </td><td class="right">};</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">KArchiveDirectory::KArchiveDirectory( KArchive* t, const QString&amp; name, int
 access,</td><td> </td><td class="right">KArchiveDirectory::KArchiveDirectory( KArchive* t, const QString&amp; name, int
 access,</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0066" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                              int date,</td><td> </td><td class="rblock">                                                         int date,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                              const QString&amp; <span class="delete">user,</span> const QString&amp; group,</td><td> </td><td class="rblock">                                                         const QString&amp; <span class="insert">use</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                              const QString <span class="delete">&amp;symlink)</span></td><td> </td><td class="rblock"><span class="insert">r,</span> const QString&amp; group,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                                                         const QString <span class="insert">&amp;sym</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">link)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">  : KArchiveEntry( t, name, access, date, user, group, symlink ),</td><td> </td><td class="right">  : KArchiveEntry( t, name, access, date, user, group, symlink ),</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0067" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    d( new KArchiveDirectoryPrivate )</td><td> </td><td class="rblock">    <span class="insert">   </span>d( new KArchiveDirectoryPrivate )</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">KArchiveDirectory::~KArchiveDirectory()</td><td> </td><td class="right">KArchiveDirectory::~KArchiveDirectory()</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">  delete d;</td><td> </td><td class="right">  delete d;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">QStringList KArchiveDirectory::entries() const</td><td> </td><td class="right">QStringList KArchiveDirectory::entries() const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">  return d-&gt;entries.keys();</td><td> </td><td class="right">  return d-&gt;entries.keys();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">const KArchiveEntry* KArchiveDirectory::entry( const QString&amp; _name ) const</td><td> </td><td class="right">const KArchiveEntry* KArchiveDirectory::entry( const QString&amp; _name ) const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">  QString name = _name;</td><td> </td><td class="right">  QString name = _name;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">  int pos = name.indexOf( '/' );</td><td> </td><td class="right">  int pos = name.indexOf( '/' );</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">  if ( pos == 0 ) // ouch absolute path (see also KArchive::findOrCreate)</td><td> </td><td class="right">  if ( pos == 0 ) // ouch absolute path (see also KArchive::findOrCreate)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">  {</td><td> </td><td class="right">  {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0068" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    if (name.length()&gt;1)</td><td> </td><td class="rblock">       if (name.length()&gt;1)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    {</td><td> </td><td class="rblock">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      name = name.mid( 1 ); // remove leading slash</td><td> </td><td class="rblock">         name = name.mid( 1 ); // remove leading slash</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      pos = name.indexOf( '/' ); // look again</td><td> </td><td class="rblock">         pos = name.indexOf( '/' ); // look again</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    }</td><td> </td><td class="rblock">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    else // "/"</td><td> </td><td class="rblock">       else // "/"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      return this;</td><td> </td><td class="rblock">         return this;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">  }</td><td> </td><td class="right">  }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">  // trailing slash ? -&gt; remove</td><td> </td><td class="right">  // trailing slash ? -&gt; remove</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">  if ( pos != -1 &amp;&amp; pos == name.length()-1 )</td><td> </td><td class="right">  if ( pos != -1 &amp;&amp; pos == name.length()-1 )</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">  {</td><td> </td><td class="right">  {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0069" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    name = name.left( pos );</td><td> </td><td class="rblock">       name = name.left( pos );</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    pos = name.indexOf( '/' ); // look again</td><td> </td><td class="rblock">       pos = name.indexOf( '/' ); // look again</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">  }</td><td> </td><td class="right">  }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">  if ( pos != -1 )</td><td> </td><td class="right">  if ( pos != -1 )</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">  {</td><td> </td><td class="right">  {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0070" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    QString left = name.left( pos );</td><td> </td><td class="rblock">       QString left = name.left( pos );</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    QString right = name.mid( pos + 1 );</td><td> </td><td class="rblock">       QString right = name.mid( pos + 1 );</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0071" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    //qDebug() &lt;&lt; "left=" &lt;&lt; left &lt;&lt; "right=" &lt;&lt; right;</td><td> </td><td class="rblock">    <span class="insert">   </span>//qDebug() &lt;&lt; "left=" &lt;&lt; left &lt;&lt; "right=" &lt;&lt; right;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0072" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    const KArchiveEntry* e = d-&gt;entries.value( left );</td><td> </td><td class="rblock">       const KArchiveEntry* e = d-&gt;entries.value( left );</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    if ( !e || !e-&gt;isDirectory() )</td><td> </td><td class="rblock">       if ( !e || !e-&gt;isDirectory() )</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      return 0;</td><td> </td><td class="rblock">         return 0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    return static_cast&lt;const KArchiveDirectory*&gt;(e)-&gt;entry( right );</td><td> </td><td class="rblock">       return static_cast&lt;const KArchiveDirectory*&gt;(e)-&gt;entry( right );</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">  }</td><td> </td><td class="right">  }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">  return d-&gt;entries.value( name );</td><td> </td><td class="right">  return d-&gt;entries.value( name );</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void KArchiveDirectory::addEntry( KArchiveEntry* entry )</td><td> </td><td class="right">void KArchiveDirectory::addEntry( KArchiveEntry* entry )</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">  Q_ASSERT( !entry-&gt;name().isEmpty() );</td><td> </td><td class="right">  Q_ASSERT( !entry-&gt;name().isEmpty() );</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">  if( d-&gt;entries.value( entry-&gt;name() ) ) {</td><td> </td><td class="right">  if( d-&gt;entries.value( entry-&gt;name() ) ) {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0073" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      qWarning() &lt;&lt; "directory " &lt;&lt; name()</td><td> </td><td class="rblock">         qWarning() &lt;&lt; "directory " &lt;&lt; name()</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                  &lt;&lt; "has entry" &lt;&lt; entry-&gt;name() &lt;&lt; <span class="delete">"already";</span></td><td> </td><td class="rblock">                                 &lt;&lt; "has entry" &lt;&lt; entry-&gt;name() &lt;&lt; <span class="insert">"alread</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">y";</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">  }</td><td> </td><td class="right">  }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">  d-&gt;entries.insert( entry-&gt;name(), entry );</td><td> </td><td class="right">  d-&gt;entries.insert( entry-&gt;name(), entry );</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">bool KArchiveDirectory::isDirectory() const</td><td> </td><td class="right">bool KArchiveDirectory::isDirectory() const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0074" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    return true;</td><td> </td><td class="rblock">    <span class="insert">   </span>return true;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">static int sortByPosition( const KArchiveFile* file1, const KArchiveFile* f
ile2 ) {</td><td> </td><td class="right">static int sortByPosition( const KArchiveFile* file1, const KArchiveFile* f
ile2 ) {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0075" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    return file1-&gt;position() - file2-&gt;position();</td><td> </td><td class="rblock">    <span class="insert">   </span>return file1-&gt;position() - file2-&gt;position();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void KArchiveDirectory::copyTo(const QString&amp; dest, bool recursiveCopy ) co
nst</td><td> </td><td class="right">void KArchiveDirectory::copyTo(const QString&amp; dest, bool recursiveCopy ) co
nst</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">  QDir root;</td><td> </td><td class="right">  QDir root;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">  QList&lt;const KArchiveFile*&gt; fileList;</td><td> </td><td class="right">  QList&lt;const KArchiveFile*&gt; fileList;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">  QMap&lt;qint64, QString&gt; fileToDir;</td><td> </td><td class="right">  QMap&lt;qint64, QString&gt; fileToDir;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">  // placeholders for iterated items</td><td> </td><td class="right">  // placeholders for iterated items</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">  QStack&lt;const KArchiveDirectory *&gt; dirStack;</td><td> </td><td class="right">  QStack&lt;const KArchiveDirectory *&gt; dirStack;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">  QStack&lt;QString&gt; dirNameStack;</td><td> </td><td class="right">  QStack&lt;QString&gt; dirNameStack;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">  dirStack.push( this );     // init stack at current directory</td><td> </td><td class="right">  dirStack.push( this );     // init stack at current directory</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">  dirNameStack.push( dest ); // ... with given path</td><td> </td><td class="right">  dirNameStack.push( dest ); // ... with given path</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">  do {</td><td> </td><td class="right">  do {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0076" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    const KArchiveDirectory* curDir = dirStack.pop();</td><td> </td><td class="rblock">       const KArchiveDirectory* curDir = dirStack.pop();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    const QString curDirName = dirNameStack.pop();</td><td> </td><td class="rblock">       const QString curDirName = dirNameStack.pop();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    root.mkdir(curDirName);</td><td> </td><td class="rblock">       root.mkdir(curDirName);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                           </td><td> </td><td class="rblock">                                                                           </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    const QStringList dirEntries = curDir-&gt;entries();</td><td> </td><td class="rblock">       const QStringList dirEntries = curDir-&gt;entries();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    for ( QStringList::const_iterator it = dirEntries.begin(); it != <span class="delete">dirEnt</span></td><td> </td><td class="rblock">       for ( QStringList::const_iterator it = dirEntries.begin(); it != <span class="insert">dir</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">ries.end();</span> ++it ) {</td><td> </td><td class="rblock"><span class="insert">Entries.end();</span> ++it ) {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      const KArchiveEntry* curEntry = curDir-&gt;entry(*it);</td><td> </td><td class="rblock">         const KArchiveEntry* curEntry = curDir-&gt;entry(*it);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      if (!curEntry-&gt;symLinkTarget().isEmpty()) {</td><td> </td><td class="rblock">         if (!curEntry-&gt;symLinkTarget().isEmpty()) {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">          const QString linkName = curDirName+'/'+curEntry-&gt;name();</td><td> </td><td class="rblock">                 const QString linkName = curDirName+'/'+curEntry-&gt;name();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#ifdef Q_OS_UNIX</td><td> </td><td class="right">#ifdef Q_OS_UNIX</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0077" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">          if (!::symlink(curEntry-&gt;symLinkTarget().toLocal8Bit(), <span class="delete">linkName.</span></td><td> </td><td class="rblock">                 if (!::symlink(curEntry-&gt;symLinkTarget().toLocal8Bit(), <span class="insert">li</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">toLocal8Bit()))</span> {</td><td> </td><td class="rblock"><span class="insert">nkName.toLocal8Bit()))</span> {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              qDebug() &lt;&lt; "symlink(" &lt;&lt; <span class="delete">curEntry-&gt;symLinkTarget()</span> &lt;&lt; ',' &lt;&lt;</td><td> </td><td class="rblock">                         qDebug() &lt;&lt; "symlink(" &lt;&lt; <span class="insert">curEntry-&gt;symLinkTarget(</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"> linkName &lt;&lt; ") failed:" &lt;&lt; strerror(errno);</td><td> </td><td class="rblock"><span class="insert">)</span> &lt;&lt; ',' &lt;&lt; linkName &lt;&lt; ") failed:" &lt;&lt; strerror(errno);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">          }</td><td> </td><td class="rblock">                 }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#else</td><td> </td><td class="right">#else</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0078" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">          // TODO - how to create symlinks on other platforms?</td><td> </td><td class="rblock">          <span class="insert">       </span>// TODO - how to create symlinks on other platforms?</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#endif</td><td> </td><td class="right">#endif</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0079" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      } else {</td><td> </td><td class="rblock">         } else {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">          if ( curEntry-&gt;isFile() ) {</td><td> </td><td class="rblock">                 if ( curEntry-&gt;isFile() ) {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              const KArchiveFile* curFile = dynamic_cast&lt;const <span class="delete">KArchiveFile</span></td><td> </td><td class="rblock">                         const KArchiveFile* curFile = dynamic_cast&lt;const <span class="insert">K</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">*&gt;(</span> curEntry );</td><td> </td><td class="rblock"><span class="insert">ArchiveFile*&gt;(</span> curEntry );</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              if (curFile) {</td><td> </td><td class="rblock">                         if (curFile) {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                  fileList.append( curFile );</td><td> </td><td class="rblock">                                 fileList.append( curFile );</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                  fileToDir.insert( curFile-&gt;position(), <span class="delete">curDirName</span> );</td><td> </td><td class="rblock">                                 fileToDir.insert( curFile-&gt;position(), <span class="insert">cur</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              }</td><td> </td><td class="rblock"><span class="insert">DirName</span> );</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">          }</td><td> </td><td class="rblock">                         }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                           </td><td> </td><td class="rblock">                 }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">          if ( curEntry-&gt;isDirectory() &amp;&amp; recursiveCopy ) {</td><td> </td><td class="rblock">                                                                           </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              const KArchiveDirectory *ad = dynamic_cast&lt;const <span class="delete">KArchiveDire</span></td><td> </td><td class="rblock">                 if ( curEntry-&gt;isDirectory() &amp;&amp; recursiveCopy ) {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">ctory*&gt;(</span> curEntry );</td><td> </td><td class="rblock">                         const KArchiveDirectory *ad = dynamic_cast&lt;const <span class="insert">K</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              if (ad) {</td><td> </td><td class="rblock"><span class="insert">ArchiveDirectory*&gt;(</span> curEntry );</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                  dirStack.push( ad );</td><td> </td><td class="rblock">                         if (ad) {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                  dirNameStack.push( curDirName + '/' + <span class="delete">curEntry-&gt;name()</span> );</td><td> </td><td class="rblock">                                 dirStack.push( ad );</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              }</td><td> </td><td class="rblock">                                 dirNameStack.push( curDirName + '/' + <span class="insert">curE</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">          }</td><td> </td><td class="rblock"><span class="insert">ntry-&gt;name()</span> );</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      }</td><td> </td><td class="rblock">                         }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    }</td><td> </td><td class="rblock">                 }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">         }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">  } while (!dirStack.isEmpty());</td><td> </td><td class="right">  } while (!dirStack.isEmpty());</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">  qSort( fileList.begin(), fileList.end(), sortByPosition );  // sort on d-
&gt;pos, so we have a linear access</td><td> </td><td class="right">  qSort( fileList.begin(), fileList.end(), sortByPosition );  // sort on d-
&gt;pos, so we have a linear access</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">  for ( QList&lt;const KArchiveFile*&gt;::const_iterator it = fileList.constBegin
(), end = fileList.constEnd() ;</td><td> </td><td class="right">  for ( QList&lt;const KArchiveFile*&gt;::const_iterator it = fileList.constBegin
(), end = fileList.constEnd() ;</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0080" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        it != end ; ++it ) {</td><td> </td><td class="rblock">               it != end ; ++it ) {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      const KArchiveFile* f = *it;</td><td> </td><td class="rblock">         const KArchiveFile* f = *it;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      qint64 pos = f-&gt;position();</td><td> </td><td class="rblock">         qint64 pos = f-&gt;position();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      f-&gt;copyTo( fileToDir[pos] );</td><td> </td><td class="rblock">         f-&gt;copyTo( fileToDir[pos] );</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">  }</td><td> </td><td class="right">  }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void KArchive::virtual_hook( int, void* )</td><td> </td><td class="right">void KArchive::virtual_hook( int, void* )</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{ /*BASE::virtual_hook( id, data )*/; }</td><td> </td><td class="right">{ /*BASE::virtual_hook( id, data )*/; }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void KArchiveEntry::virtual_hook( int, void* )</td><td> </td><td class="right">void KArchiveEntry::virtual_hook( int, void* )</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{ /*BASE::virtual_hook( id, data );*/ }</td><td> </td><td class="right">{ /*BASE::virtual_hook( id, data );*/ }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void KArchiveFile::virtual_hook( int id, void* data )</td><td> </td><td class="right">void KArchiveFile::virtual_hook( int id, void* data )</td><td class="lineno" valign="top"></td></tr>

     <tr><td></td><td class="left"></td><td> </td><td class="right"></td><td></td></tr>
     <tr bgcolor="gray"><th colspan="5" align="center"><a name="end">&nbsp;End of changes. 80 change blocks.&nbsp;</a></th></tr>
     <tr class="stats"><td></td><th><i>351 lines changed or deleted</i></th><th><i> </i></th><th><i>370 lines changed or added</i></th><td></td></tr>
     <tr><td colspan="5" align="center" class="small"><br/>This html diff was produced by rfcdiff 1.41. The latest version is available from <a href="http://www.tools.ietf.org/tools/rfcdiff/" >http://tools.ietf.org/tools/rfcdiff/</a> </td></tr>
   </table>
   </body>
   </html>
