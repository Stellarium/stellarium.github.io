<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
<!-- Generated by rfcdiff 1.41: rfcdiff  --> 
<!-- <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional" > -->
<!-- System: Linux fomalhaut.home 4.4.0-93-generic #116-Ubuntu SMP Fri Aug 11 21:17:51 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux --> 
<!-- Using awk: /usr/bin/gawk: GNU Awk 4.1.3, API: 1.1 (GNU MPFR 3.1.4, GNU MP 6.1.0) --> 
<!-- Using diff: /usr/bin/diff: diff (GNU diffutils) 3.3 --> 
<!-- Using wdiff: /usr/bin/wdiff: wdiff (GNU wdiff) 1.2.2 --> 
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"> 
<head> 
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 
  <meta http-equiv="Content-Style-Type" content="text/css" /> 
  <title>Diff: SolarSystem.cpp - SolarSystem.cpp</title> 
  <style type="text/css"> 
    body    { font-size:16px; margin: 0.4ex; margin-right: auto; } 
    tr      { } 
    td      { white-space: pre; font-family: Consolas, "DejaVu Sans Mono", "Droid Sans Mono", Monaco, Monospace; vertical-align: top; font-size: 0.86em;} 
    th      { font-size: 0.86em; } 
    .small  { font-size: 0.6em; font-style: italic; font-family: Verdana, Helvetica, sans-serif; } 
    .left   { background-color: #EEE; } 
    .right  { background-color: #FFF; } 
    .diff   { background-color: #CCF; } 
    .lblock { background-color: #BFB; } 
    .rblock { background-color: #FF8; } 
    .insert { background-color: #8FF; } 
    .delete { background-color: #ACF; } 
    .void   { background-color: #FFB; } 
    .cont   { background-color: #EEE; } 
    .linebr { background-color: #AAA; } 
    .lineno { color: red; background-color: #FFF; font-size: 0.7em; text-align: right; padding: 0 2px; } 
    .elipsis{ background-color: #AAA; } 
    .left .cont { background-color: #DDD; } 
    .right .cont { background-color: #EEE; } 
    .lblock .cont { background-color: #9D9; } 
    .rblock .cont { background-color: #DD6; } 
    .insert .cont { background-color: #0DD; } 
    .delete .cont { background-color: #8AD; } 
    .stats, .stats td, .stats th { background-color: #EEE; padding: 2px 0; } 
  </style> 
</head> 
<body > 
  <table border="0" cellpadding="0" cellspacing="0"> 
  <tr bgcolor="orange"><th></th><th>&nbsp;SolarSystem.cpp&nbsp;</th><th> </th><th>&nbsp;SolarSystem.cpp&nbsp;</th><th></th></tr> 
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l1" /><small>skipping to change at</small><em> line 153</em></th><th> </th><th><a name="part-r1" /><small>skipping to change at</small><em> line 153</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Init and load the solar system data</td><td> </td><td class="right">// Init and load the solar system data</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void SolarSystem::init()</td><td> </td><td class="right">void SolarSystem::init()</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       Q_ASSERT(conf);</td><td> </td><td class="right">       Q_ASSERT(conf);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       Planet::init();</td><td> </td><td class="right">       Planet::init();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       loadPlanets();  // Load planets data</td><td> </td><td class="right">       loadPlanets();  // Load planets data</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // Compute position and matrix of sun and all the satellites (ie pla
nets)</td><td> </td><td class="right">       // Compute position and matrix of sun and all the satellites (ie pla
nets)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // for the first initialization Q_ASSERT that center is sun center (
only impacts on light speed correction)</td><td> </td><td class="right">       // for the first initialization Q_ASSERT that center is sun center (
only impacts on light speed correction)</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0001" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       computePositions(StelApp::getInstance().getCore()-&gt;getJDE());</td><td> </td><td class="rblock">       computePositions(StelApp::getInstance().getCore()-&gt;getJDE()<span class="insert">, getSun(
)</span>);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       setSelected("");        // Fix a bug on macosX! Thanks Fumio!</td><td> </td><td class="right">       setSelected("");        // Fix a bug on macosX! Thanks Fumio!</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       setFlagMoonScale(conf-&gt;value("viewing/flag_moon_scaled", conf-&gt;value
("viewing/flag_init_moon_scaled", "false").toBool()).toBool());  // name ch
ange</td><td> </td><td class="right">       setFlagMoonScale(conf-&gt;value("viewing/flag_moon_scaled", conf-&gt;value
("viewing/flag_init_moon_scaled", "false").toBool()).toBool());  // name ch
ange</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       setMinorBodyScale(conf-&gt;value("viewing/minorbodies_scale", 10.0).toF
loat());</td><td> </td><td class="right">       setMinorBodyScale(conf-&gt;value("viewing/minorbodies_scale", 10.0).toF
loat());</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       setFlagMinorBodyScale(conf-&gt;value("viewing/flag_minorbodies_scaled",
 false).toBool());</td><td> </td><td class="right">       setFlagMinorBodyScale(conf-&gt;value("viewing/flag_minorbodies_scaled",
 false).toBool());</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       setMoonScale(conf-&gt;value("viewing/moon_scale", 4.0).toFloat());</td><td> </td><td class="right">       setMoonScale(conf-&gt;value("viewing/moon_scale", 4.0).toFloat());</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       setFlagPlanets(conf-&gt;value("astro/flag_planets").toBool());</td><td> </td><td class="right">       setFlagPlanets(conf-&gt;value("astro/flag_planets").toBool());</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       setFlagHints(conf-&gt;value("astro/flag_planets_hints").toBool());</td><td> </td><td class="right">       setFlagHints(conf-&gt;value("astro/flag_planets_hints").toBool());</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       setFlagLabels(conf-&gt;value("astro/flag_planets_labels", true).toBool(
));</td><td> </td><td class="right">       setFlagLabels(conf-&gt;value("astro/flag_planets_labels", true).toBool(
));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       setLabelsAmount(conf-&gt;value("astro/labels_amount", 3.).toFloat());</td><td> </td><td class="right">       setLabelsAmount(conf-&gt;value("astro/labels_amount", 3.).toFloat());</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l2" /><small>skipping to change at</small><em> line 405</em></th><th> </th><th><a name="part-r2" /><small>skipping to change at</small><em> line 405</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void cometOrbitPosFunc(double jd,double xyz[3], void* userDataPtr)</td><td> </td><td class="right">void cometOrbitPosFunc(double jd,double xyz[3], void* userDataPtr)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       static_cast&lt;CometOrbit*&gt;(userDataPtr)-&gt;positionAtTimevInVSOP87Coordi
nates(jd, xyz);</td><td> </td><td class="right">       static_cast&lt;CometOrbit*&gt;(userDataPtr)-&gt;positionAtTimevInVSOP87Coordi
nates(jd, xyz);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Init and load the solar system data (2 files)</td><td> </td><td class="right">// Init and load the solar system data (2 files)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void SolarSystem::loadPlanets()</td><td> </td><td class="right">void SolarSystem::loadPlanets()</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       minorBodies.clear();</td><td> </td><td class="right">       minorBodies.clear();</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0002" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       systemMinorBodies.clear();</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       qDebug() &lt;&lt; "Loading Solar System data (1: planets and moons) ...";</td><td> </td><td class="right">       qDebug() &lt;&lt; "Loading Solar System data (1: planets and moons) ...";</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       QString solarSystemFile = StelFileMgr::findFile("data/ssystem_major.
ini");</td><td> </td><td class="right">       QString solarSystemFile = StelFileMgr::findFile("data/ssystem_major.
ini");</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (solarSystemFile.isEmpty())</td><td> </td><td class="right">       if (solarSystemFile.isEmpty())</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               qWarning() &lt;&lt; "ERROR while loading ssystem_major.ini (unable
 to find data/ssystem_major.ini): " &lt;&lt; endl;</td><td> </td><td class="right">               qWarning() &lt;&lt; "ERROR while loading ssystem_major.ini (unable
 to find data/ssystem_major.ini): " &lt;&lt; endl;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               return;</td><td> </td><td class="right">               return;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (!loadPlanets(solarSystemFile))</td><td> </td><td class="right">       if (!loadPlanets(solarSystemFile))</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l3" /><small>skipping to change at</small><em> line 478</em></th><th> </th><th><a name="part-r3" /><small>skipping to change at</small><em> line 479</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       shadowPlanetCount = 0;</td><td> </td><td class="right">       shadowPlanetCount = 0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       foreach (const PlanetP&amp; planet, systemPlanets)</td><td> </td><td class="right">       foreach (const PlanetP&amp; planet, systemPlanets)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               if(planet-&gt;parent != sun || !planet-&gt;satellites.isEmpty())</td><td> </td><td class="right">               if(planet-&gt;parent != sun || !planet-&gt;satellites.isEmpty())</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       shadowPlanetCount++;</td><td> </td><td class="right">                       shadowPlanetCount++;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0003" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">unsigned char SolarSystem::BvToColorIndex(float bV)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">{</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       double dBV = bV;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       dBV *= 1000.0;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       if (dBV &lt; -500)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               dBV = -500;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       else if (dBV &gt; 3499)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               dBV = 3499;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       return (unsigned int)floor(0.5+127.0*((500.0+dBV)/4000.0));</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">}</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                           </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">bool SolarSystem::loadPlanets(const QString&amp; filePath)</td><td> </td><td class="right">bool SolarSystem::loadPlanets(const QString&amp; filePath)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0004" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       StelSkyDrawer* skyDrawer = StelApp::getInstance().getCore()-&gt;getSkyD
rawer();</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       qDebug() &lt;&lt; "Loading from :"  &lt;&lt; filePath;</td><td> </td><td class="right">       qDebug() &lt;&lt; "Loading from :"  &lt;&lt; filePath;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       int readOk = 0;</td><td> </td><td class="right">       int readOk = 0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       QSettings pd(filePath, StelIniFormat);</td><td> </td><td class="right">       QSettings pd(filePath, StelIniFormat);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (pd.status() != QSettings::NoError)</td><td> </td><td class="right">       if (pd.status() != QSettings::NoError)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               qWarning() &lt;&lt; "ERROR while parsing" &lt;&lt; QDir::toNativeSeparat
ors(filePath);</td><td> </td><td class="right">               qWarning() &lt;&lt; "ERROR while parsing" &lt;&lt; QDir::toNativeSeparat
ors(filePath);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               return false;</td><td> </td><td class="right">               return false;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // QSettings does not allow us to say that the sections of the file</td><td> </td><td class="right">       // QSettings does not allow us to say that the sections of the file</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l4" /><small>skipping to change at</small><em> line 946</em></th><th> </th><th><a name="part-r4" /><small>skipping to change at</small><em> line 960</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               // by at least using this base class pointer and using setXX
X functions instead of mega-constructors</td><td> </td><td class="right">               // by at least using this base class pointer and using setXX
X functions instead of mega-constructors</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               // that have to pass most of it on to the Planet class</td><td> </td><td class="right">               // that have to pass most of it on to the Planet class</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               PlanetP p;</td><td> </td><td class="right">               PlanetP p;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               // New class objects, named "plutino", "cubewano", "dwarf pl
anet", "SDO", "OCO", has properties</td><td> </td><td class="right">               // New class objects, named "plutino", "cubewano", "dwarf pl
anet", "SDO", "OCO", has properties</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               // similar to asteroids and we should calculate their positi
ons like for asteroids. Dwarf planets</td><td> </td><td class="right">               // similar to asteroids and we should calculate their positi
ons like for asteroids. Dwarf planets</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               // have one exception: Pluto - we should use special functio
n for calculation of orbit of Pluto.</td><td> </td><td class="right">               // have one exception: Pluto - we should use special functio
n for calculation of orbit of Pluto.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               if ((type == "asteroid" || type == "dwarf planet" || type ==
 "cubewano" || type == "plutino" || type == "scattered disc object" || type
 == "Oort cloud object") &amp;&amp; !englishName.contains("Pluto"))</td><td> </td><td class="right">               if ((type == "asteroid" || type == "dwarf planet" || type ==
 "cubewano" || type == "plutino" || type == "scattered disc object" || type
 == "Oort cloud object") &amp;&amp; !englishName.contains("Pluto"))</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       minorBodies &lt;&lt; englishName;</td><td> </td><td class="right">                       minorBodies &lt;&lt; englishName;</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0005" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                           </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                       <span class="insert">Vec3f color = Vec3f(1.f, 1.f, 1.f);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       float bV = pd.value(secname+"/color_index_bv", 99.f)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">.toFloat();</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       if (bV&lt;99.f)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                               color = skyDrawer-&gt;indexToColor(BvToColorInd</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">ex(bV))*0.75f;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       else</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                               color = StelUtils::strToVec3f(pd.value(secna</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">me+"/color", "1.0,1.0,1.0").toString());</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                           </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       p = PlanetP(new MinorPlanet(englishName,</td><td> </td><td class="right">                       p = PlanetP(new MinorPlanet(englishName,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                                   pd.value(secname+"/radiu
s").toDouble()/AU,</td><td> </td><td class="right">                                                   pd.value(secname+"/radiu
s").toDouble()/AU,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                                   pd.value(secname+"/oblat
eness", 0.0).toDouble(),</td><td> </td><td class="right">                                                   pd.value(secname+"/oblat
eness", 0.0).toDouble(),</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0006" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                   <span class="delete">StelUtils::strToVec3f(pd
.value(secname+"/color", "1.0,1.0,1.0").toString())</span>, // halo color</td><td> </td><td class="rblock">                                                   <span class="insert">color</span>, // halo color</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                                   pd.value(secname+"/albed
o", 0.25f).toFloat(),</td><td> </td><td class="right">                                                   pd.value(secname+"/albed
o", 0.25f).toFloat(),</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                                   pd.value(secname+"/rough
ness",0.9f).toFloat(),</td><td> </td><td class="right">                                                   pd.value(secname+"/rough
ness",0.9f).toFloat(),</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                                   pd.value(secname+"/tex_m
ap", "nomap.png").toString(),</td><td> </td><td class="right">                                                   pd.value(secname+"/tex_m
ap", "nomap.png").toString(),</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                                   pd.value(secname+"/model
").toString(),</td><td> </td><td class="right">                                                   pd.value(secname+"/model
").toString(),</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                                   posfunc,</td><td> </td><td class="right">                                                   posfunc,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                                   orbitPtr,</td><td> </td><td class="right">                                                   orbitPtr,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                                   osculatingFunc,</td><td> </td><td class="right">                                                   osculatingFunc,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                                   closeOrbit,</td><td> </td><td class="right">                                                   closeOrbit,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                                   pd.value(secname+"/hidde
n", false).toBool(),</td><td> </td><td class="right">                                                   pd.value(secname+"/hidde
n", false).toBool(),</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                                   type));</td><td> </td><td class="right">                                                   type));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l5" /><small>skipping to change at</small><em> line 993</em></th><th> </th><th><a name="part-r5" /><small>skipping to change at</small><em> line 1015</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               {</td><td> </td><td class="right">                               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       mp-&gt;setAbsoluteMagnitudeAndSlope(mag
nitude, slope);</td><td> </td><td class="right">                                       mp-&gt;setAbsoluteMagnitudeAndSlope(mag
nitude, slope);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               }</td><td> </td><td class="right">                               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               else</td><td> </td><td class="right">                               else</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               {</td><td> </td><td class="right">                               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       mp-&gt;setAbsoluteMagnitudeAndSlope(mag
nitude, 0.15);</td><td> </td><td class="right">                                       mp-&gt;setAbsoluteMagnitudeAndSlope(mag
nitude, 0.15);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               }</td><td> </td><td class="right">                               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       }</td><td> </td><td class="right">                       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       mp-&gt;setSemiMajorAxis(pd.value(secname+"/orbit_SemiMa
jorAxis", 0).toDouble());</td><td> </td><td class="right">                       mp-&gt;setSemiMajorAxis(pd.value(secname+"/orbit_SemiMa
jorAxis", 0).toDouble());</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0007" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                       <span class="insert">mp-&gt;setColorIndexBV(bV);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       mp-&gt;setSpectralType(pd.value(secname+"/spec_t", "").</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">toString(), pd.value(secname+"/spec_b", "").toString());</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0008" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       systemMinorBodies.push_back(p);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               else if (type == "comet")</td><td> </td><td class="right">               else if (type == "comet")</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       minorBodies &lt;&lt; englishName;</td><td> </td><td class="right">                       minorBodies &lt;&lt; englishName;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       p = PlanetP(new Comet(englishName,</td><td> </td><td class="right">                       p = PlanetP(new Comet(englishName,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                             pd.value(secname+"/radius").to
Double()/AU,</td><td> </td><td class="right">                                             pd.value(secname+"/radius").to
Double()/AU,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                             pd.value(secname+"/oblateness"
, 0.0).toDouble(),</td><td> </td><td class="right">                                             pd.value(secname+"/oblateness"
, 0.0).toDouble(),</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                             StelUtils::strToVec3f(pd.value
(secname+"/color", "1.0,1.0,1.0").toString()), // halo color</td><td> </td><td class="right">                                             StelUtils::strToVec3f(pd.value
(secname+"/color", "1.0,1.0,1.0").toString()), // halo color</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                             pd.value(secname+"/albedo", 0.
25f).toFloat(),</td><td> </td><td class="right">                                             pd.value(secname+"/albedo", 0.
25f).toFloat(),</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                             pd.value(secname+"/roughness",
0.9f).toFloat(),</td><td> </td><td class="right">                                             pd.value(secname+"/roughness",
0.9f).toFloat(),</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l6" /><small>skipping to change at</small><em> line 1042</em></th><th> </th><th><a name="part-r6" /><small>skipping to change at</small><em> line 1067</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       mp-&gt;setAbsoluteMagnitudeAndSlope(mag
nitude, 4.0);</td><td> </td><td class="right">                                       mp-&gt;setAbsoluteMagnitudeAndSlope(mag
nitude, 4.0);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               }</td><td> </td><td class="right">                               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       }</td><td> </td><td class="right">                       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       const double eccentricity = pd.value(secname+"/orbit
_Eccentricity",0.0).toDouble();</td><td> </td><td class="right">                       const double eccentricity = pd.value(secname+"/orbit
_Eccentricity",0.0).toDouble();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       const double pericenterDistance = pd.value(secname+"
/orbit_PericenterDistance",-1e100).toDouble();</td><td> </td><td class="right">                       const double pericenterDistance = pd.value(secname+"
/orbit_PericenterDistance",-1e100).toDouble();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       if (eccentricity&lt;1 &amp;&amp; pericenterDistance&gt;0)</td><td> </td><td class="right">                       if (eccentricity&lt;1 &amp;&amp; pericenterDistance&gt;0)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       {</td><td> </td><td class="right">                       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               mp-&gt;setSemiMajorAxis(pericenterDistance / (1
.0-eccentricity));</td><td> </td><td class="right">                               mp-&gt;setSemiMajorAxis(pericenterDistance / (1
.0-eccentricity));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       }</td><td> </td><td class="right">                       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0009" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       systemMinorBodies.push_back(p);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               else</td><td> </td><td class="right">               else</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       // Set possible default name of the normal map for a
voiding yin-yang shaped moon</td><td> </td><td class="right">                       // Set possible default name of the normal map for a
voiding yin-yang shaped moon</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       // phase when normal map key not exists. Example: mo
on_normals.png</td><td> </td><td class="right">                       // phase when normal map key not exists. Example: mo
on_normals.png</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       // Details: https://bugs.launchpad.net/stellarium/+b
ug/1335609</td><td> </td><td class="right">                       // Details: https://bugs.launchpad.net/stellarium/+b
ug/1335609</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       QString normalMapName = "";</td><td> </td><td class="right">                       QString normalMapName = "";</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       if (!pd.value(secname+"/hidden", false).toBool()) //
 no normal maps for invisible objects!</td><td> </td><td class="right">                       if (!pd.value(secname+"/hidden", false).toBool()) //
 no normal maps for invisible objects!</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               normalMapName = englishName.toLower().append
("_normals.png");</td><td> </td><td class="right">                               normalMapName = englishName.toLower().append
("_normals.png");</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       p = PlanetP(new Planet(englishName,</td><td> </td><td class="right">                       p = PlanetP(new Planet(englishName,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l7" /><small>skipping to change at</small><em> line 1069</em></th><th> </th><th><a name="part-r7" /><small>skipping to change at</small><em> line 1095</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                              pd.value(secname+"/model").to
String(),</td><td> </td><td class="right">                                              pd.value(secname+"/model").to
String(),</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                              posfunc,</td><td> </td><td class="right">                                              posfunc,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                              orbitPtr,</td><td> </td><td class="right">                                              orbitPtr,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                              osculatingFunc,</td><td> </td><td class="right">                                              osculatingFunc,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                              closeOrbit,</td><td> </td><td class="right">                                              closeOrbit,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                              pd.value(secname+"/hidden", f
alse).toBool(),</td><td> </td><td class="right">                                              pd.value(secname+"/hidden", f
alse).toBool(),</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                              pd.value(secname+"/atmosphere
", false).toBool(),</td><td> </td><td class="right">                                              pd.value(secname+"/atmosphere
", false).toBool(),</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                              pd.value(secname+"/halo", tru
e).toBool(),          // GZ new default. Avoids clutter in ssystem.ini.</td><td> </td><td class="right">                                              pd.value(secname+"/halo", tru
e).toBool(),          // GZ new default. Avoids clutter in ssystem.ini.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                              type));</td><td> </td><td class="right">                                              type));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       p-&gt;absoluteMagnitude = pd.value(secname+"/absolute_m
agnitude", -99.).toDouble();</td><td> </td><td class="right">                       p-&gt;absoluteMagnitude = pd.value(secname+"/absolute_m
agnitude", -99.).toDouble();</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0010" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                           </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                       <span class="insert">// Moon designation (planet index + IAU moon number)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       QString moonDesignation = pd.value(secname+"/iau_moo</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">n_number", "").toString();</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       if (!moonDesignation.isEmpty())</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       {</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                               p-&gt;setIAUMoonNumber(moonDesignation);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               if (!parent.isNull())</td><td> </td><td class="right">               if (!parent.isNull())</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       parent-&gt;satellites.append(p);</td><td> </td><td class="right">                       parent-&gt;satellites.append(p);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       p-&gt;parent = parent;</td><td> </td><td class="right">                       p-&gt;parent = parent;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               if (secname=="earth") earth = p;</td><td> </td><td class="right">               if (secname=="earth") earth = p;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               if (secname=="sun") sun = p;</td><td> </td><td class="right">               if (secname=="sun") sun = p;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               if (secname=="moon") moon = p;</td><td> </td><td class="right">               if (secname=="moon") moon = p;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l8" /><small>skipping to change at</small><em> line 1151</em></th><th> </th><th><a name="part-r8" /><small>skipping to change at</small><em> line 1184</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               Comet::tailTexture = StelApp::getInstance().getTextureManage
r().createTextureThread(StelFileMgr::getInstallationDir()+"/textures/cometT
ail.png", StelTexture::StelTextureParams(true, GL_LINEAR, GL_CLAMP_TO_EDGE)
);</td><td> </td><td class="right">               Comet::tailTexture = StelApp::getInstance().getTextureManage
r().createTextureThread(StelFileMgr::getInstallationDir()+"/textures/cometT
ail.png", StelTexture::StelTextureParams(true, GL_LINEAR, GL_CLAMP_TO_EDGE)
);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (readOk&gt;0)</td><td> </td><td class="right">       if (readOk&gt;0)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               qDebug() &lt;&lt; "Loaded" &lt;&lt; readOk &lt;&lt; "Solar System bodies";</td><td> </td><td class="right">               qDebug() &lt;&lt; "Loaded" &lt;&lt; readOk &lt;&lt; "Solar System bodies";</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return true;</td><td> </td><td class="right">       return true;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Compute the position for every elements of the solar system.</td><td> </td><td class="right">// Compute the position for every elements of the solar system.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// The order is not important since the position is computed relatively to 
the mother body</td><td> </td><td class="right">// The order is not important since the position is computed relatively to 
the mother body</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0011" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">void SolarSystem::computePositions(double dateJDE, <span class="delete">const Vec3d&amp; observerPos
</span>)</td><td> </td><td class="rblock">void SolarSystem::computePositions(double dateJDE, <span class="insert">PlanetP observerPlanet</span>)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (flagLightTravelTime)</td><td> </td><td class="right">       if (flagLightTravelTime)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               foreach (PlanetP p, systemPlanets)</td><td> </td><td class="right">               foreach (PlanetP p, systemPlanets)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       p-&gt;computePositionWithoutOrbits(dateJDE);</td><td> </td><td class="right">                       p-&gt;computePositionWithoutOrbits(dateJDE);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0012" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               // BEGIN HACK: <span class="delete">0.16.0pre</span> for solar aberration/light time <span class="delete">cor</span></td><td> </td><td class="rblock">               // BEGIN HACK: <span class="insert">0.16.0post</span> for solar aberration/light time <span class="insert">co</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">rection: (This</span> fixes eclipse bug LP:#1275092)</td><td> </td><td class="rblock"><span class="insert">rrection</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               Vec3d <span class="delete">earthPosJDE=getEarth()-&gt;getHeliocentricEclipticPos();</span></td><td> </td><td class="rblock"><span class="insert">               // This</span> fixes eclipse bug LP:#1275092) <span class="insert">and outer planet rend</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               const double <span class="delete">earthDist=earthPosJDE.length();</span></td><td> </td><td class="rblock"><span class="insert">ering bug (LP:#1699648) introduced by the first fix in 0.16.0.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               getEarth()-&gt;computePosition(dateJDE-earthDist</span> * (AU / <span class="delete">(SPEED</span></td><td> </td><td class="rblock"><span class="insert">               // We compute a "light time corrected position" for the sun </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">_OF_LIGHT</span> * <span class="delete">86400)));</span></td><td> </td><td class="rblock"><span class="insert">and apply it only for rendering, not for other computations.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               Vec3d <span class="delete">earthPosJDEbefore=getEarth()-&gt;getHeliocentricEclipticP</span></td><td> </td><td class="rblock"><span class="insert">               // A complete solution should likely "just" implement aberra</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">os();</span></td><td> </td><td class="rblock"><span class="insert">tion for all objects.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               getSun()-&gt;setHeliocentricEclipticPos(earthPosJDE-earthPosJDE</span></td><td> </td><td class="rblock"><span class="insert">               const</span> Vec3d <span class="insert">obsPosJDE=observerPlanet-&gt;getHeliocentricEclipti</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">before);</span></td><td> </td><td class="rblock"><span class="insert">cPos();</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                           </td><td> </td><td class="rblock">               const double <span class="insert">obsDist=obsPosJDE.length();</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               // We must reset <span class="delete">Earth</span> for the next step!</td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               <span class="delete">getEarth()-&gt;computePosition(dateJDE);</span></td><td> </td><td class="rblock"><span class="insert">               observerPlanet-&gt;computePosition(dateJDE-obsDist</span> * (AU / <span class="insert">(SPE</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               // END HACK FOR SOLAR <span class="delete">LOGHT</span> TIME/ABERRATION</td><td> </td><td class="rblock"><span class="insert">ED_OF_LIGHT</span> * <span class="insert">86400.)));</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               const</span> Vec3d <span class="insert">obsPosJDEbefore=observerPlanet-&gt;getHeliocentricE</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">clipticPos();</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               lightTimeSunPosition=obsPosJDE-obsPosJDEbefore;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                           </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">               // We must reset <span class="insert">observerPlanet</span> for the next step!</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">               <span class="insert">observerPlanet-&gt;computePosition(dateJDE);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">               // END HACK FOR SOLAR <span class="insert">LIGHT</span> TIME/ABERRATION</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               foreach (PlanetP p, systemPlanets)</td><td> </td><td class="right">               foreach (PlanetP p, systemPlanets)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0013" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       const double light_speed_correction = (p-&gt;getHelioce
ntricEclipticPos()-obs<span class="delete">erverPos).length() * (AU / (SPEED_OF_LIGHT * 86400</span>));</td><td> </td><td class="rblock">                       const double light_speed_correction = (p-&gt;getHelioce
ntricEclipticPos()-obs<span class="insert">PosJDE).length() * (AU / (SPEED_OF_LIGHT * 86400.</span>));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       p-&gt;computePosition(dateJDE-light_speed_correction);</td><td> </td><td class="right">                       p-&gt;computePosition(dateJDE-light_speed_correction);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0014" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                           </td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               <span class="delete">// BEGIN HACK PART 2</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               getSun()-&gt;setHeliocentricEclipticPos(earthPosJDE-earthPosJDE</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">before);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               // END HACK PART 2</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                           </td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       else</td><td> </td><td class="right">       else</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               foreach (PlanetP p, systemPlanets)</td><td> </td><td class="right">               foreach (PlanetP p, systemPlanets)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       p-&gt;computePosition(dateJDE);</td><td> </td><td class="right">                       p-&gt;computePosition(dateJDE);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0015" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               lightTimeSunPosition.set(0.,0.,0.);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0016" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       computeTransMatrices(dateJDE, observerP<span class="delete">os</span>);</td><td> </td><td class="rblock">       computeTransMatrices(dateJDE, observerP<span class="insert">lanet-&gt;getHeliocentricEclipti
cPos()</span>);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Compute the transformation matrix for every elements of the solar system
.</td><td> </td><td class="right">// Compute the transformation matrix for every elements of the solar system
.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// The elements have to be ordered hierarchically, eg. it's important to co
mpute earth before moon.</td><td> </td><td class="right">// The elements have to be ordered hierarchically, eg. it's important to co
mpute earth before moon.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void SolarSystem::computeTransMatrices(double dateJDE, const Vec3d&amp; observe
rPos)</td><td> </td><td class="right">void SolarSystem::computeTransMatrices(double dateJDE, const Vec3d&amp; observe
rPos)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double dateJD=dateJDE - (StelApp::getInstance().getCore()-&gt;computeDe
ltaT(dateJDE))/86400.0;</td><td> </td><td class="right">       double dateJD=dateJDE - (StelApp::getInstance().getCore()-&gt;computeDe
ltaT(dateJDE))/86400.0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (flagLightTravelTime)</td><td> </td><td class="right">       if (flagLightTravelTime)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l9" /><small>skipping to change at</small><em> line 1327</em></th><th> </th><th><a name="part-r9" /><small>skipping to change at</small><em> line 1360</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">PlanetP SolarSystem::searchByEnglishName(QString planetEnglishName) const</td><td> </td><td class="right">PlanetP SolarSystem::searchByEnglishName(QString planetEnglishName) const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       foreach (const PlanetP&amp; p, systemPlanets)</td><td> </td><td class="right">       foreach (const PlanetP&amp; p, systemPlanets)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               if (p-&gt;getEnglishName() == planetEnglishName)</td><td> </td><td class="right">               if (p-&gt;getEnglishName() == planetEnglishName)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       return p;</td><td> </td><td class="right">                       return p;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return PlanetP();</td><td> </td><td class="right">       return PlanetP();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0017" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">PlanetP SolarSystem::searchMinorPlanetByEnglishName(QString planetEnglishNa</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">me) const</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">{</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       foreach (const PlanetP&amp; p, systemMinorBodies)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       {</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               if (p-&gt;getCommonEnglishName() == planetEnglishName)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       return p;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       return PlanetP();</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">}</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                           </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">StelObjectP SolarSystem::searchByNameI18n(const QString&amp; planetNameI18) con
st</td><td> </td><td class="right">StelObjectP SolarSystem::searchByNameI18n(const QString&amp; planetNameI18) con
st</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       foreach (const PlanetP&amp; p, systemPlanets)</td><td> </td><td class="right">       foreach (const PlanetP&amp; p, systemPlanets)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               if (p-&gt;getNameI18n() == planetNameI18)</td><td> </td><td class="right">               if (p-&gt;getNameI18n() == planetNameI18)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       return qSharedPointerCast&lt;StelObject&gt;(p);</td><td> </td><td class="right">                       return qSharedPointerCast&lt;StelObject&gt;(p);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return StelObjectP();</td><td> </td><td class="right">       return StelObjectP();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">StelObjectP SolarSystem::searchByName(const QString&amp; name) const</td><td> </td><td class="right">StelObjectP SolarSystem::searchByName(const QString&amp; name) const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       foreach (const PlanetP&amp; p, systemPlanets)</td><td> </td><td class="right">       foreach (const PlanetP&amp; p, systemPlanets)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0018" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               if (p-&gt;getEnglishName() == name)</td><td> </td><td class="rblock">               if (p-&gt;getEnglishName() == name<span class="insert"> || p-&gt;getCommonEnglishName()
 == name</span>)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       return qSharedPointerCast&lt;StelObject&gt;(p);</td><td> </td><td class="right">                       return qSharedPointerCast&lt;StelObject&gt;(p);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return StelObjectP();</td><td> </td><td class="right">       return StelObjectP();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">float SolarSystem::getPlanetVMagnitude(QString planetName, bool withExtinct
ion) const</td><td> </td><td class="right">float SolarSystem::getPlanetVMagnitude(QString planetName, bool withExtinct
ion) const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       PlanetP p = searchByEnglishName(planetName);</td><td> </td><td class="right">       PlanetP p = searchByEnglishName(planetName);</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0019" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       <span class="insert">if (p.isNull()) // Possible was asked the common name of minor plane</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">t?</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               p = searchMinorPlanetByEnglishName(planetName);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       float r = 0.f;</td><td> </td><td class="right">       float r = 0.f;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (withExtinction)</td><td> </td><td class="right">       if (withExtinction)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               r = p-&gt;getVMagnitudeWithExtinction(StelApp::getInstance().ge
tCore());</td><td> </td><td class="right">               r = p-&gt;getVMagnitudeWithExtinction(StelApp::getInstance().ge
tCore());</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       else</td><td> </td><td class="right">       else</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               r = p-&gt;getVMagnitude(StelApp::getInstance().getCore());</td><td> </td><td class="right">               r = p-&gt;getVMagnitude(StelApp::getInstance().getCore());</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return r;</td><td> </td><td class="right">       return r;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">QString SolarSystem::getPlanetType(QString planetName) const</td><td> </td><td class="right">QString SolarSystem::getPlanetType(QString planetName) const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       PlanetP p = searchByEnglishName(planetName);</td><td> </td><td class="right">       PlanetP p = searchByEnglishName(planetName);</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0020" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       <span class="insert">if (p.isNull()) // Possible was asked the common name of minor plane</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">t?</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               p = searchMinorPlanetByEnglishName(planetName);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return p-&gt;getPlanetTypeString();</td><td> </td><td class="right">       return p-&gt;getPlanetTypeString();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">double SolarSystem::getDistanceToPlanet(QString planetName) const</td><td> </td><td class="right">double SolarSystem::getDistanceToPlanet(QString planetName) const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       PlanetP p = searchByEnglishName(planetName);</td><td> </td><td class="right">       PlanetP p = searchByEnglishName(planetName);</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0021" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       <span class="insert">if (p.isNull()) // Possible was asked the common name of minor plane</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">t?</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               p = searchMinorPlanetByEnglishName(planetName);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double r = 0.f;</td><td> </td><td class="right">       double r = 0.f;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       r = p-&gt;getDistance();</td><td> </td><td class="right">       r = p-&gt;getDistance();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return r;</td><td> </td><td class="right">       return r;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">double SolarSystem::getElongationForPlanet(QString planetName) const</td><td> </td><td class="right">double SolarSystem::getElongationForPlanet(QString planetName) const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       PlanetP p = searchByEnglishName(planetName);</td><td> </td><td class="right">       PlanetP p = searchByEnglishName(planetName);</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0022" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       <span class="insert">if (p.isNull()) // Possible was asked the common name of minor plane</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">t?</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               p = searchMinorPlanetByEnglishName(planetName);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double r = 0.f;</td><td> </td><td class="right">       double r = 0.f;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       r = p-&gt;getElongation(StelApp::getInstance().getCore()-&gt;getObserverHe
liocentricEclipticPos());</td><td> </td><td class="right">       r = p-&gt;getElongation(StelApp::getInstance().getCore()-&gt;getObserverHe
liocentricEclipticPos());</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return r;</td><td> </td><td class="right">       return r;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">double SolarSystem::getPhaseAngleForPlanet(QString planetName) const</td><td> </td><td class="right">double SolarSystem::getPhaseAngleForPlanet(QString planetName) const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       PlanetP p = searchByEnglishName(planetName);</td><td> </td><td class="right">       PlanetP p = searchByEnglishName(planetName);</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0023" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       <span class="insert">if (p.isNull()) // Possible was asked the common name of minor plane</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">t?</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               p = searchMinorPlanetByEnglishName(planetName);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double r = 0.f;</td><td> </td><td class="right">       double r = 0.f;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       r = p-&gt;getPhaseAngle(StelApp::getInstance().getCore()-&gt;getObserverHe
liocentricEclipticPos());</td><td> </td><td class="right">       r = p-&gt;getPhaseAngle(StelApp::getInstance().getCore()-&gt;getObserverHe
liocentricEclipticPos());</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return r;</td><td> </td><td class="right">       return r;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">float SolarSystem::getPhaseForPlanet(QString planetName) const</td><td> </td><td class="right">float SolarSystem::getPhaseForPlanet(QString planetName) const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       PlanetP p = searchByEnglishName(planetName);</td><td> </td><td class="right">       PlanetP p = searchByEnglishName(planetName);</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0024" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       <span class="insert">if (p.isNull()) // Possible was asked the common name of minor plane</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">t?</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               p = searchMinorPlanetByEnglishName(planetName);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       float r = 0.f;</td><td> </td><td class="right">       float r = 0.f;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       r = p-&gt;getPhase(StelApp::getInstance().getCore()-&gt;getObserverHelioce
ntricEclipticPos());</td><td> </td><td class="right">       r = p-&gt;getPhase(StelApp::getInstance().getCore()-&gt;getObserverHelioce
ntricEclipticPos());</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return r;</td><td> </td><td class="right">       return r;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">QStringList SolarSystem::getObjectsList(QString objType) const</td><td> </td><td class="right">QStringList SolarSystem::getObjectsList(QString objType) const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       QStringList r;</td><td> </td><td class="right">       QStringList r;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (objType.toLower()=="all")</td><td> </td><td class="right">       if (objType.toLower()=="all")</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l10" /><small>skipping to change at</small><em> line 2076</em></th><th> </th><th><a name="part-r10" /><small>skipping to change at</small><em> line 2131</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if(b!=flagMinorBodyScale)</td><td> </td><td class="right">       if(b!=flagMinorBodyScale)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               flagMinorBodyScale = b;</td><td> </td><td class="right">               flagMinorBodyScale = b;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               double newScale = b ? minorBodyScale : 1.0;</td><td> </td><td class="right">               double newScale = b ? minorBodyScale : 1.0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               //update the bodies with the new scale</td><td> </td><td class="right">               //update the bodies with the new scale</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               foreach(PlanetP p, systemPlanets)</td><td> </td><td class="right">               foreach(PlanetP p, systemPlanets)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       if(p == moon) continue;</td><td> </td><td class="right">                       if(p == moon) continue;</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0025" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       if (p-&gt;getPlanetType()!=Planet::isPlanet</td><td> </td><td class="rblock">                       if (p-&gt;getPlanetType()!=Planet::isPlanet &amp;&amp; <span class="insert">p-&gt;getPl</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                       &amp;&amp; <span class="delete">p-&gt;getPlanetType()!=Planet::isSta</span></td><td> </td><td class="rblock"><span class="insert">anetType()!=Planet::isStar)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">r</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                                       )</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               p-&gt;setSphereScale(newScale);</td><td> </td><td class="right">                               p-&gt;setSphereScale(newScale);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               emit flagMinorBodyScaleChanged(b);</td><td> </td><td class="right">               emit flagMinorBodyScaleChanged(b);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Set/Get minor body display scaling factor. This will be queried by all P
lanet objects except for the Moon.</td><td> </td><td class="right">// Set/Get minor body display scaling factor. This will be queried by all P
lanet objects except for the Moon.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void SolarSystem::setMinorBodyScale(double f)</td><td> </td><td class="right">void SolarSystem::setMinorBodyScale(double f)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if(minorBodyScale != f)</td><td> </td><td class="right">       if(minorBodyScale != f)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               minorBodyScale = f;</td><td> </td><td class="right">               minorBodyScale = f;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               if(flagMinorBodyScale) //update the bodies with the new scal
e</td><td> </td><td class="right">               if(flagMinorBodyScale) //update the bodies with the new scal
e</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       foreach(PlanetP p, systemPlanets)</td><td> </td><td class="right">                       foreach(PlanetP p, systemPlanets)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       {</td><td> </td><td class="right">                       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               if(p == moon) continue;</td><td> </td><td class="right">                               if(p == moon) continue;</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0026" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                               if (p-&gt;getPlanetType()!=Planet::isPlanet</td><td> </td><td class="rblock">                               if (p-&gt;getPlanetType()!=Planet::isPlanet &amp;&amp; </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                               &amp;&amp; <span class="delete">p-&gt;getPlanetType()!=Plane</span></td><td> </td><td class="rblock"><span class="insert">p-&gt;getPlanetType()!=Planet::isStar)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">t::isStar</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                                               )</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       p-&gt;setSphereScale(minorBodyScale);</td><td> </td><td class="right">                                       p-&gt;setSphereScale(minorBodyScale);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       }</td><td> </td><td class="right">                       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               emit minorBodyScaleChanged(f);</td><td> </td><td class="right">               emit minorBodyScaleChanged(f);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Set selected planets by englishName</td><td> </td><td class="right">// Set selected planets by englishName</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void SolarSystem::setSelected(const QString&amp; englishName)</td><td> </td><td class="right">void SolarSystem::setSelected(const QString&amp; englishName)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       setSelected(searchByEnglishName(englishName));</td><td> </td><td class="right">       setSelected(searchByEnglishName(englishName));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Get the list of all the planet english names</td><td> </td><td class="right">// Get the list of all the planet english names</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">QStringList SolarSystem::getAllPlanetEnglishNames() const</td><td> </td><td class="right">QStringList SolarSystem::getAllPlanetEnglishNames() const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       QStringList res;</td><td> </td><td class="right">       QStringList res;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       foreach (const PlanetP&amp; p, systemPlanets)</td><td> </td><td class="right">       foreach (const PlanetP&amp; p, systemPlanets)</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0027" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               res.append(p-&gt;<span class="delete">englishName</span>);</td><td> </td><td class="rblock">               res.append(p-&gt;<span class="insert">getEnglishName()</span>);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return res;</td><td> </td><td class="right">       return res;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">QStringList SolarSystem::getAllPlanetLocalizedNames() const</td><td> </td><td class="right">QStringList SolarSystem::getAllPlanetLocalizedNames() const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       QStringList res;</td><td> </td><td class="right">       QStringList res;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       foreach (const PlanetP&amp; p, systemPlanets)</td><td> </td><td class="right">       foreach (const PlanetP&amp; p, systemPlanets)</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0028" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               <span class="delete">res.append(p-&gt;nameI18);</span></td><td> </td><td class="rblock">               <span class="insert">res.append(p-&gt;getNameI18n());</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       return res;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">}</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">QStringList SolarSystem::getAllMinorPlanetCommonEnglishNames() const</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">{</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       QStringList res;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       foreach (const PlanetP&amp; p, systemMinorBodies)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               res.append(p-&gt;getCommonEnglishName());</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return res;</td><td> </td><td class="right">       return res;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// GZ TODO: This could be modified to only delete&amp;reload the minor objects.
 For now, we really load both parts again like in the 0.10?-0.15 series.</td><td> </td><td class="right">// GZ TODO: This could be modified to only delete&amp;reload the minor objects.
 For now, we really load both parts again like in the 0.10?-0.15 series.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void SolarSystem::reloadPlanets()</td><td> </td><td class="right">void SolarSystem::reloadPlanets()</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // Save flag states</td><td> </td><td class="right">       // Save flag states</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       bool flagScaleMoon = getFlagMoonScale();</td><td> </td><td class="right">       bool flagScaleMoon = getFlagMoonScale();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       float moonScale = getMoonScale();</td><td> </td><td class="right">       float moonScale = getMoonScale();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       bool flagScaleMinorBodies=getFlagMinorBodyScale();</td><td> </td><td class="right">       bool flagScaleMinorBodies=getFlagMinorBodyScale();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l11" /><small>skipping to change at</small><em> line 2184</em></th><th> </th><th><a name="part-r11" /><small>skipping to change at</small><em> line 2243</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       delete allTrails;</td><td> </td><td class="right">       delete allTrails;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       allTrails = Q_NULLPTR;</td><td> </td><td class="right">       allTrails = Q_NULLPTR;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       foreach (PlanetP p, systemPlanets)</td><td> </td><td class="right">       foreach (PlanetP p, systemPlanets)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               p-&gt;satellites.clear();</td><td> </td><td class="right">               p-&gt;satellites.clear();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               p.clear();</td><td> </td><td class="right">               p.clear();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       systemPlanets.clear();</td><td> </td><td class="right">       systemPlanets.clear();</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0029" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       systemMinorBodies.clear();</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // Memory leak? What's the proper way of cleaning shared pointers?</td><td> </td><td class="right">       // Memory leak? What's the proper way of cleaning shared pointers?</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // Also delete Comet textures (loaded in loadPlanets()</td><td> </td><td class="right">       // Also delete Comet textures (loaded in loadPlanets()</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       Comet::tailTexture.clear();</td><td> </td><td class="right">       Comet::tailTexture.clear();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       Comet::comaTexture.clear();</td><td> </td><td class="right">       Comet::comaTexture.clear();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // Re-load the ssystem_major.ini and ssystem_minor.ini file</td><td> </td><td class="right">       // Re-load the ssystem_major.ini and ssystem_minor.ini file</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       loadPlanets();</td><td> </td><td class="right">       loadPlanets();</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0030" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       computePositions(core-&gt;getJDE());</td><td> </td><td class="rblock">       computePositions(core-&gt;getJDE()<span class="insert">, getSun()</span>);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       setSelected("");</td><td> </td><td class="right">       setSelected("");</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       recreateTrails();</td><td> </td><td class="right">       recreateTrails();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // Restore observer location</td><td> </td><td class="right">       // Restore observer location</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       core-&gt;moveObserverTo(loc, 0., 0.);</td><td> </td><td class="right">       core-&gt;moveObserverTo(loc, 0., 0.);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // Restore flag states</td><td> </td><td class="right">       // Restore flag states</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       setFlagMoonScale(flagScaleMoon);</td><td> </td><td class="right">       setFlagMoonScale(flagScaleMoon);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       setMoonScale(moonScale);</td><td> </td><td class="right">       setMoonScale(moonScale);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       setFlagMinorBodyScale(flagScaleMinorBodies);</td><td> </td><td class="right">       setFlagMinorBodyScale(flagScaleMinorBodies);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l12" /><small>skipping to change at</small><em> line 2323</em></th><th> </th><th><a name="part-r12" /><small>skipping to change at</small><em> line 2383</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       break;</td><td> </td><td class="right">                       break;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               case Planet::ocsMajorPlanets:</td><td> </td><td class="right">               case Planet::ocsMajorPlanets:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       r = "major_planets";</td><td> </td><td class="right">                       r = "major_planets";</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       break;</td><td> </td><td class="right">                       break;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return r;</td><td> </td><td class="right">       return r;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">double SolarSystem::getEclipseFactor(const StelCore* core) const</td><td> </td><td class="right">double SolarSystem::getEclipseFactor(const StelCore* core) const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0031" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       Vec3d Lp = sun-&gt;getEclipticPos();</td><td> </td><td class="rblock">       Vec3d Lp = <span class="insert">getLightTimeSunPosition();  //</span>sun-&gt;getEclipticPos();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       Vec3d P3 = core-&gt;getObserverHeliocentricEclipticPos();</td><td> </td><td class="right">       Vec3d P3 = core-&gt;getObserverHeliocentricEclipticPos();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       const double RS = sun-&gt;getRadius();</td><td> </td><td class="right">       const double RS = sun-&gt;getRadius();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double final_illumination = 1.0;</td><td> </td><td class="right">       double final_illumination = 1.0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       foreach (const PlanetP&amp; planet, systemPlanets)</td><td> </td><td class="right">       foreach (const PlanetP&amp; planet, systemPlanets)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               if(planet == sun || planet == core-&gt;getCurrentPlanet())</td><td> </td><td class="right">               if(planet == sun || planet == core-&gt;getCurrentPlanet())</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       continue;</td><td> </td><td class="right">                       continue;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               Mat4d trans;</td><td> </td><td class="right">               Mat4d trans;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               planet-&gt;computeModelMatrix(trans);</td><td> </td><td class="right">               planet-&gt;computeModelMatrix(trans);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0032" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               const Vec3d C = trans * Vec3d(0<span class="delete">, 0, 0</span>);</td><td> </td><td class="rblock">               const Vec3d C = trans * Vec3d(0<span class="insert">., 0., 0.</span>);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               const double radius = planet-&gt;getRadius();</td><td> </td><td class="right">               const double radius = planet-&gt;getRadius();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               Vec3d v1 = Lp - P3;</td><td> </td><td class="right">               Vec3d v1 = Lp - P3;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               Vec3d v2 = C - P3;</td><td> </td><td class="right">               Vec3d v2 = C - P3;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               const double L = v1.length();</td><td> </td><td class="right">               const double L = v1.length();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               const double l = v2.length();</td><td> </td><td class="right">               const double l = v2.length();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               v1 = v1 / L;</td><td> </td><td class="right">               v1 = v1 / L;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               v2 = v2 / l;</td><td> </td><td class="right">               v2 = v2 / l;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               const double R = RS / L;</td><td> </td><td class="right">               const double R = RS / L;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               const double r = radius / l;</td><td> </td><td class="right">               const double r = radius / l;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               const double d = ( v1 - v2 ).length();</td><td> </td><td class="right">               const double d = ( v1 - v2 ).length();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               if(planet-&gt;englishName == "Moon")</td><td> </td><td class="right">               if(planet-&gt;englishName == "Moon")</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0033" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       v1 = planet-&gt;getHeliocentricEclipticPos();</td><td> </td><td class="rblock">                       v1 = planet-&gt;getHeliocentricEclipticPos();<span class="insert"> // ??? Th
is assignment is dead code!</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               double illumination;</td><td> </td><td class="right">               double illumination;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0034" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               <span class="delete">// distance too far</span></td><td> </td><td class="rblock">               if(d &gt;= R + r) <span class="insert">// distance too far</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               if(d &gt;= R + r)</td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       illumination = 1.0;</td><td> </td><td class="right">                       illumination = 1.0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0035" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               // umbra</td><td> </td><td class="rblock">               <span class="insert">else if(d &lt;= r - R)</span> // umbra</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               <span class="delete">else if(r &gt;= R + d)</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       illumination = 0.0;</td><td> </td><td class="right">                       illumination = 0.0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0036" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               // penumbra completely inside</td><td> </td><td class="rblock">               <span class="insert">else if(d &lt;= R - r)</span> // penumbra completely inside</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               <span class="delete">else if(d + r &lt;= R)</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       illumination = 1.0 - r * r / (R * R);</td><td> </td><td class="right">                       illumination = 1.0 - r * r / (R * R);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0037" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               // penumbra partially inside</td><td> </td><td class="rblock">               <span class="insert">else</span> // penumbra partially inside</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               <span class="delete">else</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       const double x = (R * R + d * d - r * r) / (2.0 * d)
;</td><td> </td><td class="right">                       const double x = (R * R + d * d - r * r) / (2.0 * d)
;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       const double alpha = std::acos(x / R);</td><td> </td><td class="right">                       const double alpha = std::acos(x / R);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       const double beta = std::acos((d - x) / r);</td><td> </td><td class="right">                       const double beta = std::acos((d - x) / r);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       const double AR = R * R * (alpha - 0.5 * std::sin(2.
0 * alpha));</td><td> </td><td class="right">                       const double AR = R * R * (alpha - 0.5 * std::sin(2.
0 * alpha));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       const double Ar = r * r * (beta - 0.5 * std::sin(2.0
 * beta));</td><td> </td><td class="right">                       const double Ar = r * r * (beta - 0.5 * std::sin(2.0
 * beta));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       const double AS = R * R * 2.0 * std::asin(1.0);</td><td> </td><td class="right">                       const double AS = R * R * 2.0 * std::asin(1.0);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       illumination = 1.0 - (AR + Ar) / AS;</td><td> </td><td class="right">                       illumination = 1.0 - (AR + Ar) / AS;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               if(illumination &lt; final_illumination)</td><td> </td><td class="right">               if(illumination &lt; final_illumination)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       final_illumination = illumination;</td><td> </td><td class="right">                       final_illumination = illumination;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return final_illumination;</td><td> </td><td class="right">       return final_illumination;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0038" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">bool SolarSystem::removePlanet(QString name)</td><td> </td><td class="rblock">bool SolarSystem::remove<span class="insert">Minor</span>Planet(QString name)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0039" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       PlanetP candidate = searchByEnglishName(name);</td><td> </td><td class="rblock">       PlanetP candidate = search<span class="insert">MinorPlanet</span>ByEnglishName(name);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (!candidate)</td><td> </td><td class="right">       if (!candidate)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               qWarning() &lt;&lt; "Cannot remove planet " &lt;&lt; name &lt;&lt; ": Not foun
d.";</td><td> </td><td class="right">               qWarning() &lt;&lt; "Cannot remove planet " &lt;&lt; name &lt;&lt; ": Not foun
d.";</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               return false;</td><td> </td><td class="right">               return false;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0040" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">// TODO: In case we want major bodies or Pluto to be deleted, think </span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">about proper handling of moons!</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       //candidate-&gt;satellites.clear();</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       if (candidate-&gt;pType &lt; Planet::isAsteroid)</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       {</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               qWarning() &lt;&lt; "REMOVING MAJOR OBJECT:" &lt;&lt; name;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               qWarning() &lt;&lt; "              This is likely not what you wan</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">t, but will be accepted.";</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               Q_ASSERT(0);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       }</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       Orbit* orbPtr=(Orbit*) candidate-&gt;orbitPtr;</td><td> </td><td class="right">       Orbit* orbPtr=(Orbit*) candidate-&gt;orbitPtr;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (orbPtr)</td><td> </td><td class="right">       if (orbPtr)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               orbits.removeOne(orbPtr);</td><td> </td><td class="right">               orbits.removeOne(orbPtr);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       systemPlanets.removeOne(candidate);</td><td> </td><td class="right">       systemPlanets.removeOne(candidate);</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0041" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       systemMinorBodies.removeOne(candidate);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       candidate.clear();</td><td> </td><td class="right">       candidate.clear();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return true;</td><td> </td><td class="right">       return true;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>

     <tr><td></td><td class="left"></td><td> </td><td class="right"></td><td></td></tr>
     <tr bgcolor="gray"><th colspan="5" align="center"><a name="end">&nbsp;End of changes. 41 change blocks.&nbsp;</a></th></tr>
     <tr class="stats"><td></td><th><i>60 lines changed or deleted</i></th><th><i> </i></th><th><i>121 lines changed or added</i></th><td></td></tr>
     <tr><td colspan="5" align="center" class="small"><br/>This html diff was produced by rfcdiff 1.41. The latest version is available from <a href="http://www.tools.ietf.org/tools/rfcdiff/" >http://tools.ietf.org/tools/rfcdiff/</a> </td></tr>
   </table>
   </body>
   </html>
