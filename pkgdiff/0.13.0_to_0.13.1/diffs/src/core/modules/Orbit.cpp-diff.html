<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
<!-- Generated by rfcdiff 1.41: rfcdiff  --> 
<!-- <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional" > -->
<!-- System: Linux fomalhaut.local 3.13.0-38-generic #65-Ubuntu SMP Thu Oct 9 11:36:50 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux --> 
<!-- Using awk: /usr/bin/gawk: GNU Awk 4.0.1 --> 
<!-- Using diff: /usr/bin/diff: diff (GNU diffutils) 3.3 --> 
<!-- Using wdiff: /usr/bin/wdiff: wdiff (GNU wdiff) 1.2.1 --> 
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"> 
<head> 
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 
  <meta http-equiv="Content-Style-Type" content="text/css" /> 
  <title>Diff: Orbit.cpp - Orbit.cpp</title> 
  <style type="text/css"> 
    body    { font-size:16px; margin: 0.4ex; margin-right: auto; } 
    tr      { } 
    td      { white-space: pre; font-family: Consolas, "DejaVu Sans Mono", "Droid Sans Mono", Monaco, Monospace; vertical-align: top; font-size: 0.86em;} 
    th      { font-size: 0.86em; } 
    .small  { font-size: 0.6em; font-style: italic; font-family: Verdana, Helvetica, sans-serif; } 
    .left   { background-color: #EEE; } 
    .right  { background-color: #FFF; } 
    .diff   { background-color: #CCF; } 
    .lblock { background-color: #BFB; } 
    .rblock { background-color: #FF8; } 
    .insert { background-color: #8FF; } 
    .delete { background-color: #ACF; } 
    .void   { background-color: #FFB; } 
    .cont   { background-color: #EEE; } 
    .linebr { background-color: #AAA; } 
    .lineno { color: red; background-color: #FFF; font-size: 0.7em; text-align: right; padding: 0 2px; } 
    .elipsis{ background-color: #AAA; } 
    .left .cont { background-color: #DDD; } 
    .right .cont { background-color: #EEE; } 
    .lblock .cont { background-color: #9D9; } 
    .rblock .cont { background-color: #DD6; } 
    .insert .cont { background-color: #0DD; } 
    .delete .cont { background-color: #8AD; } 
    .stats, .stats td, .stats th { background-color: #EEE; padding: 2px 0; } 
  </style> 
</head> 
<body > 
  <table border="0" cellpadding="0" cellspacing="0"> 
  <tr bgcolor="orange"><th></th><th>&nbsp;Orbit.cpp&nbsp;</th><th> </th><th>&nbsp;Orbit.cpp&nbsp;</th><th></th></tr> 
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l1" /><small>skipping to change at</small><em> line 157</em></th><th> </th><th><a name="part-r1" /><small>skipping to change at</small><em> line 157</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//! @param ry: y component of position vector, AU</td><td> </td><td class="right">//! @param ry: y component of position vector, AU</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//! @param rz: z component of position vector, AU</td><td> </td><td class="right">//! @param rz: z component of position vector, AU</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//! @param withVelVector also compute velocity vector (required for comet t
ails)</td><td> </td><td class="right">//! @param withVelVector also compute velocity vector (required for comet t
ails)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//! @param e excentricity (required if withVelVector=true)</td><td> </td><td class="right">//! @param e excentricity (required if withVelVector=true)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//! @param q perihel distance, AU (required if withVelVector=true)</td><td> </td><td class="right">//! @param q perihel distance, AU (required if withVelVector=true)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//! @param rdotx: x component of velocity vector, AU/d</td><td> </td><td class="right">//! @param rdotx: x component of velocity vector, AU/d</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//! @param rdoty: y component of velocity vector, AU/d</td><td> </td><td class="right">//! @param rdoty: y component of velocity vector, AU/d</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//! @param rdotz: z component of velocity vector, AU/d</td><td> </td><td class="right">//! @param rdotz: z component of velocity vector, AU/d</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void Init3D(const double i, const double Omega, const double w, const doubl
e rCosNu, const double rSinNu,</td><td> </td><td class="right">void Init3D(const double i, const double Omega, const double w, const doubl
e rCosNu, const double rSinNu,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            double &amp;rx,double &amp;ry,double &amp;rz, double &amp;rdotx, double &amp;rdoty,
 double &amp;rdotz, const bool withVelVector=false, const double e=0.0, const d
ouble q=0.0) {</td><td> </td><td class="right">            double &amp;rx,double &amp;ry,double &amp;rz, double &amp;rdotx, double &amp;rdoty,
 double &amp;rdotz, const bool withVelVector=false, const double e=0.0, const d
ouble q=0.0) {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0001" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">//        qDebug() &lt;&lt; "Init3D";</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">  const double cw = cos(w);</td><td> </td><td class="right">  const double cw = cos(w);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">  const double sw = sin(w);</td><td> </td><td class="right">  const double sw = sin(w);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">  const double cOm = cos(Omega);</td><td> </td><td class="right">  const double cOm = cos(Omega);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">  const double sOm = sin(Omega);</td><td> </td><td class="right">  const double sOm = sin(Omega);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">  const double ci = cos(i);</td><td> </td><td class="right">  const double ci = cos(i);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">  const double si = sin(i);</td><td> </td><td class="right">  const double si = sin(i);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">  const double Px=-sw*sOm*ci+cw*cOm; // Heafner, 5.3.1 Px</td><td> </td><td class="right">  const double Px=-sw*sOm*ci+cw*cOm; // Heafner, 5.3.1 Px</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">  const double Qx=-cw*sOm*ci-sw*cOm; // Heafner, 5.3.4 Qx</td><td> </td><td class="right">  const double Qx=-cw*sOm*ci-sw*cOm; // Heafner, 5.3.4 Qx</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">  const double Py= sw*cOm*ci+cw*sOm; // Heafner, 5.3.2 Py</td><td> </td><td class="right">  const double Py= sw*cOm*ci+cw*sOm; // Heafner, 5.3.2 Py</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">  const double Qy= cw*cOm*ci-sw*sOm; // Heafner, 5.3.5 Qy</td><td> </td><td class="right">  const double Qy= cw*cOm*ci-sw*sOm; // Heafner, 5.3.5 Qy</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l2" /><small>skipping to change at</small><em> line 193</em></th><th> </th><th><a name="part-r2" /><small>skipping to change at</small><em> line 192</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">CometOrbit::CometOrbit(double pericenterDistance,</td><td> </td><td class="right">CometOrbit::CometOrbit(double pericenterDistance,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       double eccentricity,</td><td> </td><td class="right">                       double eccentricity,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       double inclination,</td><td> </td><td class="right">                       double inclination,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       double ascendingNode,</td><td> </td><td class="right">                       double ascendingNode,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       double argOfPerhelion,</td><td> </td><td class="right">                       double argOfPerhelion,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       double timeAtPerihelion,</td><td> </td><td class="right">                       double timeAtPerihelion,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       double orbitGoodDays,</td><td> </td><td class="right">                       double orbitGoodDays,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       double meanMotion,              // GZ: for parabolic
s, this is W/dt in Heafner's lettering</td><td> </td><td class="right">                       double meanMotion,              // GZ: for parabolic
s, this is W/dt in Heafner's lettering</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0002" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       double parentRotObliquity,      <span class="delete">// GZ: I don't see a</span></td><td> </td><td class="rblock">                      double parentRotObliquity,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">ny use for this, should be 0 for comets.</span></td><td> </td><td class="rblock">                      double parentRotAscendingnode,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       double parentRotAscendingnode,  <span class="delete">// GZ: I don't see a</span></td><td> </td><td class="rblock">                      double parentRotJ2000Longitude)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">ny use for this, should be 0 for comets.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       double parentRotJ2000Longitude) <span class="delete">// GZ: I don't see a</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">ny use for this, should be 0 for comets.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                      //)</td><td> </td><td class="right">                      //)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            :q(pericenterDistance),e(eccentricity),i(inclination),</td><td> </td><td class="right">            :q(pericenterDistance),e(eccentricity),i(inclination),</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            Om(ascendingNode),w(argOfPerhelion),t0(timeAtPerihelion),</td><td> </td><td class="right">            Om(ascendingNode),w(argOfPerhelion),t0(timeAtPerihelion),</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">           n(meanMotion), updateTails(true), orbitGood(orbitGoodDays) {</td><td> </td><td class="right">           n(meanMotion), updateTails(true), orbitGood(orbitGoodDays) {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0003" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">//        qDebug() &lt;&lt; "CometOrbit::()";</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">  rdot.set(0.0, 0.0, 0.0);</td><td> </td><td class="right">  rdot.set(0.0, 0.0, 0.0);</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0004" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">  const double c_obl = cos(parentRotObliquity);         <span class="delete">// 1?</span></td><td> </td><td class="rblock">  const double c_obl = cos(parentRotObliquity);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">  const double s_obl = sin(parentRotObliquity);         <span class="delete">// 0?</span></td><td> </td><td class="rblock">  const double s_obl = sin(parentRotObliquity);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">  const double c_nod = cos(parentRotAscendingnode);     <span class="delete">// 1?</span></td><td> </td><td class="rblock">  const double c_nod = cos(parentRotAscendingnode);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">  const double s_nod = sin(parentRotAscendingnode);     <span class="delete">// 0?</span></td><td> </td><td class="rblock">  const double s_nod = sin(parentRotAscendingnode);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">  const double cj = cos(parentRotJ2000Longitude);       <span class="delete">// 1?</span></td><td> </td><td class="rblock">  const double cj = cos(parentRotJ2000Longitude);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">  const double sj = sin(parentRotJ2000Longitude);       <span class="delete">// 0?</span></td><td> </td><td class="rblock">  const double sj = sin(parentRotJ2000Longitude);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">  // GZ: Test my assumptions before breaking anything...</span></td><td> </td><td class="rblock">                                                                           </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">//  Q_ASSERT(c_obl==1.0);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">//  Q_ASSERT(c_nod==1.0);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">//  Q_ASSERT(cj   ==1.0);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">//  Q_ASSERT(s_obl==0.0);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">//  Q_ASSERT(s_nod==0.0);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">//  Q_ASSERT(sj   ==0.0);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">  // GZ NO, this is necessary!</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//  rotateToVsop87[0] =  c_nod;</td><td> </td><td class="right">//  rotateToVsop87[0] =  c_nod;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//  rotateToVsop87[1] = -s_nod * c_obl;</td><td> </td><td class="right">//  rotateToVsop87[1] = -s_nod * c_obl;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//  rotateToVsop87[2] =  s_nod * s_obl;</td><td> </td><td class="right">//  rotateToVsop87[2] =  s_nod * s_obl;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//  rotateToVsop87[3] =  s_nod;</td><td> </td><td class="right">//  rotateToVsop87[3] =  s_nod;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//  rotateToVsop87[4] =  c_nod * c_obl;</td><td> </td><td class="right">//  rotateToVsop87[4] =  c_nod * c_obl;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//  rotateToVsop87[5] = -c_nod * s_obl;</td><td> </td><td class="right">//  rotateToVsop87[5] = -c_nod * s_obl;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//  rotateToVsop87[6] =  0.0;</td><td> </td><td class="right">//  rotateToVsop87[6] =  0.0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//  rotateToVsop87[7] =          s_obl;</td><td> </td><td class="right">//  rotateToVsop87[7] =          s_obl;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//  rotateToVsop87[8] =          c_obl;</td><td> </td><td class="right">//  rotateToVsop87[8] =          c_obl;</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0005" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">  rotateToVsop87[0] =  c_nod*cj-s_nod*c_obl*sj; <span class="delete">// 1 in case of comet orbit</span></td><td> </td><td class="rblock">  rotateToVsop87[0] =  c_nod*cj-s_nod*c_obl*sj;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">ing the sun, these names are misleading, however they do the right thing.</span></td><td> </td><td class="rblock">  rotateToVsop87[1] = -c_nod*sj-s_nod*c_obl*cj;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">  rotateToVsop87[1] = -c_nod*sj-s_nod*c_obl*cj; <span class="delete">// 0 OK, this is NOT an ide</span></td><td> </td><td class="rblock">  rotateToVsop87[2] =           s_nod*s_obl;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">ntity matrix...</span></td><td> </td><td class="rblock">  rotateToVsop87[3] =  s_nod*cj+c_nod*c_obl*sj;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">  rotateToVsop87[2] =           s_nod*s_obl;    <span class="delete">// 0</span></td><td> </td><td class="rblock">  rotateToVsop87[4] = -s_nod*sj+c_nod*c_obl*cj;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">  rotateToVsop87[3] =  s_nod*cj+c_nod*c_obl*sj; <span class="delete">// 0</span></td><td> </td><td class="rblock">  rotateToVsop87[5] =          -c_nod*s_obl;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">  rotateToVsop87[4] = -s_nod*sj+c_nod*c_obl*cj; <span class="delete">// 1</span></td><td> </td><td class="rblock">  rotateToVsop87[6] =                 s_obl*sj;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">  rotateToVsop87[5] =          -c_nod*s_obl;    <span class="delete">// 0</span></td><td> </td><td class="rblock">  rotateToVsop87[7] =                 s_obl*cj;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">  rotateToVsop87[6] =                 s_obl*sj; <span class="delete">// 0</span></td><td> </td><td class="rblock">  rotateToVsop87[8] =                 c_obl;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">  rotateToVsop87[7] =                 s_obl*cj; <span class="delete">// 0</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">  rotateToVsop87[8] =                 c_obl;    <span class="delete">// 1</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//  qDebug() &lt;&lt; "CometOrbit::()...done";</td><td> </td><td class="right">//  qDebug() &lt;&lt; "CometOrbit::()...done";</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void CometOrbit::positionAtTimevInVSOP87Coordinates(double JD, double *v, b
ool updateVelocityVector)  {</td><td> </td><td class="right">void CometOrbit::positionAtTimevInVSOP87Coordinates(double JD, double *v, b
ool updateVelocityVector)  {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">  JD -= t0;</td><td> </td><td class="right">  JD -= t0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">  double rCosNu,rSinNu;</td><td> </td><td class="right">  double rCosNu,rSinNu;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">  // temporary solve freezes for near-parabolic comets - using (e &lt; 0.9999)
 for elliptical orbits</td><td> </td><td class="right">  // temporary solve freezes for near-parabolic comets - using (e &lt; 0.9999)
 for elliptical orbits</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">  // TODO: improve calculations orbits for near-parabolic comets --AW</td><td> </td><td class="right">  // TODO: improve calculations orbits for near-parabolic comets --AW</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//  if (e &lt; 0.9999) InitEll(q,n,e,JD,a1,a2);</td><td> </td><td class="right">//  if (e &lt; 0.9999) InitEll(q,n,e,JD,a1,a2);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">  if (e &lt; 1.0) InitEll(q,n,e,JD,rCosNu,rSinNu); // GZ: After solving with L
aguerre-Conway, I dare to go for 1.0.</td><td> </td><td class="right">  if (e &lt; 1.0) InitEll(q,n,e,JD,rCosNu,rSinNu); // GZ: After solving with L
aguerre-Conway, I dare to go for 1.0.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">  else if (e &gt; 1.0) {</td><td> </td><td class="right">  else if (e &gt; 1.0) {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//      qDebug() &lt;&lt; "Hyperbolic orbit for ecc=" &lt;&lt; e &lt;&lt; ", i=" &lt;&lt; i &lt;&lt; ", w
=" &lt;&lt; w &lt;&lt; ", Mean Motion n=" &lt;&lt; n;</td><td> </td><td class="right">//      qDebug() &lt;&lt; "Hyperbolic orbit for ecc=" &lt;&lt; e &lt;&lt; ", i=" &lt;&lt; i &lt;&lt; ", w
=" &lt;&lt; w &lt;&lt; ", Mean Motion n=" &lt;&lt; n;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      InitHyp(q,n,e,JD,rCosNu,rSinNu);</td><td> </td><td class="right">      InitHyp(q,n,e,JD,rCosNu,rSinNu);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">  }</td><td> </td><td class="right">  }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">  else InitPar(q,n,JD,rCosNu,rSinNu);</td><td> </td><td class="right">  else InitPar(q,n,JD,rCosNu,rSinNu);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">  double p0,p1,p2, s0, s1, s2;</td><td> </td><td class="right">  double p0,p1,p2, s0, s1, s2;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">  Init3D(i,Om,w,rCosNu,rSinNu,p0,p1,p2, s0, s1, s2, updateVelocityVector, e
, q);</td><td> </td><td class="right">  Init3D(i,Om,w,rCosNu,rSinNu,p0,p1,p2, s0, s1, s2, updateVelocityVector, e
, q);</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0006" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">  // GZ: The next 3 lines are meaningless for a comet orbiting the sun. Or 
not?</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">  v[0] = rotateToVsop87[0]*p0 + rotateToVsop87[1]*p1 + rotateToVsop87[2]*p2
;</td><td> </td><td class="right">  v[0] = rotateToVsop87[0]*p0 + rotateToVsop87[1]*p1 + rotateToVsop87[2]*p2
;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">  v[1] = rotateToVsop87[3]*p0 + rotateToVsop87[4]*p1 + rotateToVsop87[5]*p2
;</td><td> </td><td class="right">  v[1] = rotateToVsop87[3]*p0 + rotateToVsop87[4]*p1 + rotateToVsop87[5]*p2
;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">  v[2] = rotateToVsop87[6]*p0 + rotateToVsop87[7]*p1 + rotateToVsop87[8]*p2
;</td><td> </td><td class="right">  v[2] = rotateToVsop87[6]*p0 + rotateToVsop87[7]*p1 + rotateToVsop87[8]*p2
;</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0007" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">  <span class="delete">//GZ replace with:</span></td><td> </td><td class="rblock">                                                                           </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">  //v[0]=p0;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">  //v[1]=p1;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">  //v[2]=p2;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">  if (updateVelocityVector) {</td><td> </td><td class="right">  if (updateVelocityVector) {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0008" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      rdot.set(s0, s1, s2);<span class="delete"> // TODO: ROTATE?</span></td><td> </td><td class="rblock">      rdot.set(s0, s1, s2);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      updateTails=true;</td><td> </td><td class="right">      updateTails=true;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">  }</td><td> </td><td class="right">  }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">EllipticalOrbit::EllipticalOrbit(double pericenterDistance,</td><td> </td><td class="right">EllipticalOrbit::EllipticalOrbit(double pericenterDistance,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                 double eccentricity,</td><td> </td><td class="right">                                 double eccentricity,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                 double inclination,</td><td> </td><td class="right">                                 double inclination,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                 double ascendingNode,</td><td> </td><td class="right">                                 double ascendingNode,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                 double argOfPeriapsis,</td><td> </td><td class="right">                                 double argOfPeriapsis,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                 double meanAnomalyAtEpoch,</td><td> </td><td class="right">                                 double meanAnomalyAtEpoch,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l3" /><small>skipping to change at</small><em> line 311</em></th><th> </th><th><a name="part-r3" /><small>skipping to change at</small><em> line 298</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">  rotateToVsop87[7] =                 s_obl*cj;</td><td> </td><td class="right">  rotateToVsop87[7] =                 s_obl*cj;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">  rotateToVsop87[8] =                 c_obl;</td><td> </td><td class="right">  rotateToVsop87[8] =                 c_obl;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Standard iteration for solving Kepler's Equation</td><td> </td><td class="right">// Standard iteration for solving Kepler's Equation</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">struct SolveKeplerFunc1 : public unary_function&lt;double, double&gt;</td><td> </td><td class="right">struct SolveKeplerFunc1 : public unary_function&lt;double, double&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">    double ecc;</td><td> </td><td class="right">    double ecc;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">    double M;</td><td> </td><td class="right">    double M;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0009" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    SolveKeplerFunc1(double _ecc, double _M) : ecc(_ecc), M(_M) {}<span class="delete">;</span></td><td> </td><td class="rblock">    SolveKeplerFunc1(double _ecc, double _M) : ecc(_ecc), M(_M) {}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">    double operator()(double x) const</td><td> </td><td class="right">    double operator()(double x) const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">    {</td><td> </td><td class="right">    {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">        return M + ecc * sin(x);</td><td> </td><td class="right">        return M + ecc * sin(x);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">    }</td><td> </td><td class="right">    }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">};</td><td> </td><td class="right">};</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Faster converging iteration for Kepler's Equation; more efficient</td><td> </td><td class="right">// Faster converging iteration for Kepler's Equation; more efficient</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// than above for orbits with eccentricities greater than 0.3.  This</td><td> </td><td class="right">// than above for orbits with eccentricities greater than 0.3.  This</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// is from Jean Meeus's _Astronomical Algorithms_ (2nd ed), p. 199</td><td> </td><td class="right">// is from Jean Meeus's _Astronomical Algorithms_ (2nd ed), p. 199</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">struct SolveKeplerFunc2 : public unary_function&lt;double, double&gt;</td><td> </td><td class="right">struct SolveKeplerFunc2 : public unary_function&lt;double, double&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">    double ecc;</td><td> </td><td class="right">    double ecc;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">    double M;</td><td> </td><td class="right">    double M;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0010" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    SolveKeplerFunc2(double _ecc, double _M) : ecc(_ecc), M(_M) {}<span class="delete">;</span></td><td> </td><td class="rblock">    SolveKeplerFunc2(double _ecc, double _M) : ecc(_ecc), M(_M) {}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">    double operator()(double x) const</td><td> </td><td class="right">    double operator()(double x) const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">    {</td><td> </td><td class="right">    {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">        return x + (M + ecc * sin(x) - x) / (1 - ecc * cos(x));</td><td> </td><td class="right">        return x + (M + ecc * sin(x) - x) / (1 - ecc * cos(x));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">    }</td><td> </td><td class="right">    }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">};</td><td> </td><td class="right">};</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">double sign(double x)</td><td> </td><td class="right">double sign(double x)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">    if (x &lt; 0.)</td><td> </td><td class="right">    if (x &lt; 0.)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l4" /><small>skipping to change at</small><em> line 350</em></th><th> </th><th><a name="part-r4" /><small>skipping to change at</small><em> line 337</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">        return 1.;</td><td> </td><td class="right">        return 1.;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">    else</td><td> </td><td class="right">    else</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">        return 0.;</td><td> </td><td class="right">        return 0.;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">struct SolveKeplerLaguerreConway : public unary_function&lt;double, double&gt;</td><td> </td><td class="right">struct SolveKeplerLaguerreConway : public unary_function&lt;double, double&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">    double ecc;</td><td> </td><td class="right">    double ecc;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">    double M;</td><td> </td><td class="right">    double M;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0011" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    SolveKeplerLaguerreConway(double _ecc, double _M) : ecc(_ecc), M(_M) {}<span class="delete">
;</span></td><td> </td><td class="rblock">    SolveKeplerLaguerreConway(double _ecc, double _M) : ecc(_ecc), M(_M) {}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">    // cf Heafner, Fundamental Ephemeris Computations p.73</td><td> </td><td class="right">    // cf Heafner, Fundamental Ephemeris Computations p.73</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">    // GZ: note&amp;add Heafner's initial guess for E!</td><td> </td><td class="right">    // GZ: note&amp;add Heafner's initial guess for E!</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">    double operator()(double E) const</td><td> </td><td class="right">    double operator()(double E) const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">    {</td><td> </td><td class="right">    {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">        double s = ecc * sin(E);</td><td> </td><td class="right">        double s = ecc * sin(E);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">        double c = ecc * cos(E);</td><td> </td><td class="right">        double c = ecc * cos(E);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">        double f = E - s - M;</td><td> </td><td class="right">        double f = E - s - M;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">        double f1 = 1 - c;</td><td> </td><td class="right">        double f1 = 1 - c;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">        double f2 = s;</td><td> </td><td class="right">        double f2 = s;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">        E += -5 * f / (f1 + sign(f1) * sqrt(abs(16 * f1 * f1 - 20 * f * f2)
));</td><td> </td><td class="right">        E += -5 * f / (f1 + sign(f1) * sqrt(abs(16 * f1 * f1 - 20 * f * f2)
));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">        return E;</td><td> </td><td class="right">        return E;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">    }</td><td> </td><td class="right">    }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">};</td><td> </td><td class="right">};</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">struct SolveKeplerLaguerreConwayHyp : public unary_function&lt;double, double&gt;</td><td> </td><td class="right">struct SolveKeplerLaguerreConwayHyp : public unary_function&lt;double, double&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">    double ecc;</td><td> </td><td class="right">    double ecc;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">    double M;</td><td> </td><td class="right">    double M;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0012" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    SolveKeplerLaguerreConwayHyp(double _ecc, double _M) : ecc(_ecc), M(_M)
 {}<span class="delete">;</span></td><td> </td><td class="rblock">    SolveKeplerLaguerreConwayHyp(double _ecc, double _M) : ecc(_ecc), M(_M)
 {}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">    // cf Heafner, Fundamental Ephemeris Computations p.73</td><td> </td><td class="right">    // cf Heafner, Fundamental Ephemeris Computations p.73</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">    double operator()(double x) const</td><td> </td><td class="right">    double operator()(double x) const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">    {</td><td> </td><td class="right">    {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">        double s = ecc * sinh(x);</td><td> </td><td class="right">        double s = ecc * sinh(x);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">        double c = ecc * cosh(x);</td><td> </td><td class="right">        double c = ecc * cosh(x);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">        double f = s - x - M;</td><td> </td><td class="right">        double f = s - x - M;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">        double f1 = c - 1;</td><td> </td><td class="right">        double f1 = c - 1;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">        double f2 = s;</td><td> </td><td class="right">        double f2 = s;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">        x += -5 * f / (f1 + sign(f1) * sqrt(abs(16 * f1 * f1 - 20 * f * f2)
));</td><td> </td><td class="right">        x += -5 * f / (f1 + sign(f1) * sqrt(abs(16 * f1 * f1 - 20 * f * f2)
));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l5" /><small>skipping to change at</small><em> line 415</em></th><th> </th><th><a name="part-r5" /><small>skipping to change at</small><em> line 402</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">        Solution sol = solveIteration_fixed(SolveKeplerFunc2(eccentricity, 
M), M, 6);</td><td> </td><td class="right">        Solution sol = solveIteration_fixed(SolveKeplerFunc2(eccentricity, 
M), M, 6);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">        // Debugging</td><td> </td><td class="right">        // Debugging</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">        // qDebug("ecc: %f, error: %f mas\n",</td><td> </td><td class="right">        // qDebug("ecc: %f, error: %f mas\n",</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">        //        eccentricity, radToDeg(sol.second) * 3600000);</td><td> </td><td class="right">        //        eccentricity, radToDeg(sol.second) * 3600000);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">        return sol.first;</td><td> </td><td class="right">        return sol.first;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">    }</td><td> </td><td class="right">    }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">    else if (eccentricity &lt; 1.0)</td><td> </td><td class="right">    else if (eccentricity &lt; 1.0)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">    {</td><td> </td><td class="right">    {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">        // Extremely stable Laguerre-Conway method for solving Kepler's</td><td> </td><td class="right">        // Extremely stable Laguerre-Conway method for solving Kepler's</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">        // equation.  Only use this for high-eccentricity orbits, as it</td><td> </td><td class="right">        // equation.  Only use this for high-eccentricity orbits, as it</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0013" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete"> // requires more calcu</span>ation.</td><td> </td><td class="rblock">       <span class="insert">// requires more calcul</span>ation.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">        double E = M + 0.85 * eccentricity * sign(sin(M));</td><td> </td><td class="right">        double E = M + 0.85 * eccentricity * sign(sin(M));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">        Solution sol = solveIteration_fixed(SolveKeplerLaguerreConway(eccen
tricity, M), E, 8);</td><td> </td><td class="right">        Solution sol = solveIteration_fixed(SolveKeplerLaguerreConway(eccen
tricity, M), E, 8);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">        return sol.first;</td><td> </td><td class="right">        return sol.first;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">    }</td><td> </td><td class="right">    }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">    else if (eccentricity == 1.0)</td><td> </td><td class="right">    else if (eccentricity == 1.0)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">    {</td><td> </td><td class="right">    {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">        // parabolic orbit; very common for comets</td><td> </td><td class="right">        // parabolic orbit; very common for comets</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">        // TODO: handle this.</td><td> </td><td class="right">        // TODO: handle this.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">        // Problem: E does not make sense here. True anomaly quantities (rS
inNu, rCosNu) computed directly.</td><td> </td><td class="right">        // Problem: E does not make sense here. True anomaly quantities (rS
inNu, rCosNu) computed directly.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">        // Anyhow, Comets use CometOrbit class.</td><td> </td><td class="right">        // Anyhow, Comets use CometOrbit class.</td><td class="lineno" valign="top"></td></tr>

     <tr><td></td><td class="left"></td><td> </td><td class="right"></td><td></td></tr>
     <tr bgcolor="gray"><th colspan="5" align="center"><a name="end">&nbsp;End of changes. 13 change blocks.&nbsp;</a></th></tr>
     <tr class="stats"><td></td><th><i>44 lines changed or deleted</i></th><th><i> </i></th><th><i>26 lines changed or added</i></th><td></td></tr>
     <tr><td colspan="5" align="center" class="small"><br/>This html diff was produced by rfcdiff 1.41. The latest version is available from <a href="http://www.tools.ietf.org/tools/rfcdiff/" >http://tools.ietf.org/tools/rfcdiff/</a> </td></tr>
   </table>
   </body>
   </html>
