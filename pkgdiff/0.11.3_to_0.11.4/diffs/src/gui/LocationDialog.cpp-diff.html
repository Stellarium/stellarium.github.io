<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
<!-- Generated by rfcdiff 1.41: rfcdiff  --> 
<!-- <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional" > -->
<!-- System: Linux fomalhaut.local 3.13.0-38-generic #65-Ubuntu SMP Thu Oct 9 11:36:50 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux --> 
<!-- Using awk: /usr/bin/gawk: GNU Awk 4.0.1 --> 
<!-- Using diff: /usr/bin/diff: diff (GNU diffutils) 3.3 --> 
<!-- Using wdiff: /usr/bin/wdiff: wdiff (GNU wdiff) 1.2.1 --> 
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"> 
<head> 
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /> 
  <meta http-equiv="Content-Style-Type" content="text/css" /> 
  <title>Diff: LocationDialog.cpp - LocationDialog.cpp</title> 
  <style type="text/css"> 
    body    { font-size:16px; margin: 0.4ex; margin-right: auto; } 
    tr      { } 
    td      { white-space: pre; font-family: Consolas, "DejaVu Sans Mono", "Droid Sans Mono", Monaco, Monospace; vertical-align: top; font-size: 0.86em;} 
    th      { font-size: 0.86em; } 
    .small  { font-size: 0.6em; font-style: italic; font-family: Verdana, Helvetica, sans-serif; } 
    .left   { background-color: #EEE; } 
    .right  { background-color: #FFF; } 
    .diff   { background-color: #CCF; } 
    .lblock { background-color: #BFB; } 
    .rblock { background-color: #FF8; } 
    .insert { background-color: #8FF; } 
    .delete { background-color: #ACF; } 
    .void   { background-color: #FFB; } 
    .cont   { background-color: #EEE; } 
    .linebr { background-color: #AAA; } 
    .lineno { color: red; background-color: #FFF; font-size: 0.7em; text-align: right; padding: 0 2px; } 
    .elipsis{ background-color: #AAA; } 
    .left .cont { background-color: #DDD; } 
    .right .cont { background-color: #EEE; } 
    .lblock .cont { background-color: #9D9; } 
    .rblock .cont { background-color: #DD6; } 
    .insert .cont { background-color: #0DD; } 
    .delete .cont { background-color: #8AD; } 
    .stats, .stats td, .stats th { background-color: #EEE; padding: 2px 0; } 
  </style> 
</head> 
<body > 
  <table border="0" cellpadding="0" cellspacing="0"> 
  <tr bgcolor="orange"><th></th><th>&nbsp;LocationDialog.cpp&nbsp;</th><th> </th><th>&nbsp;LocationDialog.cpp&nbsp;</th><th></th></tr> 
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l1" /><small>skipping to change at</small><em> line 23</em></th><th> </th><th><a name="part-r1" /><small>skipping to change at</small><em> line 23</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</td><td> </td><td class="right"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"> * GNU General Public License for more details.</td><td> </td><td class="right"> * GNU General Public License for more details.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"> *</td><td> </td><td class="right"> *</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"> * You should have received a copy of the GNU General Public License</td><td> </td><td class="right"> * You should have received a copy of the GNU General Public License</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"> * along with this program; if not, write to the Free Software</td><td> </td><td class="right"> * along with this program; if not, write to the Free Software</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"> * Foundation, Inc., 51 Franklin Street, Suite 500, Boston, MA  02110-1335,
 USA.</td><td> </td><td class="right"> * Foundation, Inc., 51 Franklin Street, Suite 500, Boston, MA  02110-1335,
 USA.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">*/</td><td> </td><td class="right">*/</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#include "Dialog.hpp"</td><td> </td><td class="right">#include "Dialog.hpp"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#include "LocationDialog.hpp"</td><td> </td><td class="right">#include "LocationDialog.hpp"</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0001" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">#include "LandscapeMgr.hpp"</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#include "StelLocationMgr.hpp"</td><td> </td><td class="right">#include "StelLocationMgr.hpp"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#include "ui_locationDialogGui.h"</td><td> </td><td class="right">#include "ui_locationDialogGui.h"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#include "StelApp.hpp"</td><td> </td><td class="right">#include "StelApp.hpp"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#include "StelCore.hpp"</td><td> </td><td class="right">#include "StelCore.hpp"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#include "StelModuleMgr.hpp"</td><td> </td><td class="right">#include "StelModuleMgr.hpp"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#include "SolarSystem.hpp"</td><td> </td><td class="right">#include "SolarSystem.hpp"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#include "Planet.hpp"</td><td> </td><td class="right">#include "Planet.hpp"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#include "StelFileMgr.hpp"</td><td> </td><td class="right">#include "StelFileMgr.hpp"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#include "StelLocaleMgr.hpp"</td><td> </td><td class="right">#include "StelLocaleMgr.hpp"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l2" /><small>skipping to change at</small><em> line 94</em></th><th> </th><th><a name="part-r2" /><small>skipping to change at</small><em> line 95</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       QSortFilterProxyModel *proxyModel = new QSortFilterProxyModel(this);</td><td> </td><td class="right">       QSortFilterProxyModel *proxyModel = new QSortFilterProxyModel(this);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       proxyModel-&gt;setSourceModel((QAbstractItemModel*)StelApp::getInstance
().getLocationMgr().getModelAll());</td><td> </td><td class="right">       proxyModel-&gt;setSourceModel((QAbstractItemModel*)StelApp::getInstance
().getLocationMgr().getModelAll());</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       proxyModel-&gt;sort(0, Qt::AscendingOrder);</td><td> </td><td class="right">       proxyModel-&gt;sort(0, Qt::AscendingOrder);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       proxyModel-&gt;setFilterCaseSensitivity(Qt::CaseInsensitive);</td><td> </td><td class="right">       proxyModel-&gt;setFilterCaseSensitivity(Qt::CaseInsensitive);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       ui-&gt;citiesListView-&gt;setModel(proxyModel);</td><td> </td><td class="right">       ui-&gt;citiesListView-&gt;setModel(proxyModel);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       populatePlanetList();</td><td> </td><td class="right">       populatePlanetList();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       populateCountryList();</td><td> </td><td class="right">       populateCountryList();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       connect(ui-&gt;citySearchLineEdit, SIGNAL(textChanged(const QString&amp;)),
 proxyModel, SLOT(setFilterWildcard(const QString&amp;)));</td><td> </td><td class="right">       connect(ui-&gt;citySearchLineEdit, SIGNAL(textChanged(const QString&amp;)),
 proxyModel, SLOT(setFilterWildcard(const QString&amp;)));</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0002" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       connect(ui-&gt;citiesListView, SIGNAL(clicked(const QModelIndex&amp;)), <span class="delete">thi</span></td><td> </td><td class="rblock">       connect(ui-&gt;citiesListView, SIGNAL(clicked(const QModelIndex&amp;)),</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">s, SLOT(listItemActivated(const</span> QModelIndex&amp;)));</td><td> </td><td class="rblock">               <span class="insert">this, SLOT(setPositionFromList(const</span> QModelIndex&amp;)));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // Connect all the QT signals</td><td> </td><td class="right">       // Connect all the QT signals</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       connect(ui-&gt;closeStelWindow, SIGNAL(clicked()), this, SLOT(close()))
;</td><td> </td><td class="right">       connect(ui-&gt;closeStelWindow, SIGNAL(clicked()), this, SLOT(close()))
;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       connect(ui-&gt;mapLabel, SIGNAL(positionChanged(double, double)), this,
 SLOT(setPositionFromMap(double, double)));</td><td> </td><td class="right">       connect(ui-&gt;mapLabel, SIGNAL(positionChanged(double, double)), this,
 SLOT(setPositionFromMap(double, double)));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       connect(ui-&gt;addLocationToListPushButton, SIGNAL(clicked()), this, SL
OT(addCurrentLocationToList()));</td><td> </td><td class="right">       connect(ui-&gt;addLocationToListPushButton, SIGNAL(clicked()), this, SL
OT(addCurrentLocationToList()));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       connect(ui-&gt;deleteLocationFromListPushButton, SIGNAL(clicked()), thi
s, SLOT(deleteCurrentLocationFromList()));</td><td> </td><td class="right">       connect(ui-&gt;deleteLocationFromListPushButton, SIGNAL(clicked()), thi
s, SLOT(deleteCurrentLocationFromList()));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0003" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">setFieldsFromLocation(StelApp::getInstance().getCore()-&gt;getCurrentLo</span></td><td> </td><td class="rblock">       <span class="insert">StelCore* core = StelApp::getInstance().getCore();</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">cation());</span></td><td> </td><td class="rblock"><span class="insert">       const StelLocation&amp; currentLocation = core-&gt;getCurrentLocation();</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       setFieldsFromLocation(currentLocation);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0004" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       const bool b = <span class="delete">StelApp::getInstance().getCore()-&gt;getCurrentLocation(</span></td><td> </td><td class="rblock">       const bool b = <span class="insert">(currentLocation.getID() == core-&gt;getDefaultLocationI</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">).getID()</span></td><td> </td><td class="rblock"><span class="insert">D());</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                       ==StelApp::getInstance().getCore()-&gt;getDefaultLocati</span></td><td> </td><td class="rblock"><span class="insert">       updateDefaultLocationControls(b);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">onID();</span></td><td> </td><td class="rblock">       connect(ui-&gt;useAsDefaultLocationCheckBox, SIGNAL(clicked()), this, S</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       ui-&gt;useAsDefaultLocationCheckBox-&gt;setChecked(b);</span></td><td> </td><td class="rblock"><span class="insert">LOT(setDefaultLocation()));</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       ui-&gt;useAsDefaultLocationCheckBox-&gt;setEnabled(!b);</span></td><td> </td><td class="rblock"><span class="insert">       connect(ui-&gt;pushButtonReturnToDefault, SIGNAL(clicked()),</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       connect(ui-&gt;useAsDefaultLocationCheckBox, SIGNAL(clicked()), this, S</td><td> </td><td class="rblock"><span class="insert">               core, SLOT(returnToDefaultLocation()));</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">LOT(useAsDefaultClicked()));</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       connectEditSignals();</td><td> </td><td class="right">       connectEditSignals();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0005" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">QTimer* refreshTimer = new QTimer(this);</span></td><td> </td><td class="rblock">       <span class="insert">connect(core, SIGNAL(locationChanged(StelLocation)),</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       connect(refreshTimer, SIGNAL(timeout()),</span> this, <span class="delete">SLOT(updateFromProgra</span></td><td> </td><td class="rblock">               this, <span class="insert">SLOT(updateFromProgram(StelLocation)));</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">m()));</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       refreshTimer-&gt;start(200);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       ui-&gt;citySearchLineEdit-&gt;setFocus();</td><td> </td><td class="right">       ui-&gt;citySearchLineEdit-&gt;setFocus();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Update the widget to make sure it is synchrone if the location is change
d programmatically</td><td> </td><td class="right">// Update the widget to make sure it is synchrone if the location is change
d programmatically</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0006" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">void LocationDialog::updateFromProgram()</td><td> </td><td class="rblock">void LocationDialog::updateFromProgram(<span class="insert">const StelLocation&amp; currentLocation</span>)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (!dialog-&gt;isVisible())</td><td> </td><td class="right">       if (!dialog-&gt;isVisible())</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               return;</td><td> </td><td class="right">               return;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0007" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">// Check that the use as default check box needs to be updated</span></td><td> </td><td class="rblock">       <span class="insert">StelCore* stelCore</span> = <span class="insert">StelApp::getInstance().getCore();</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       const bool b</span> = <span class="delete">StelApp::getInstance().getCore()-&gt;getCurrentLocation(</span></td><td> </td><td class="rblock"><span class="insert">       //const StelLocation&amp; currentLocation = stelCore-&gt;getCurrentLocation</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">).getID() == StelApp::getInstance().getCore()-&gt;getDefaultLocationID();</span></td><td> </td><td class="rblock"><span class="insert">();</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       if (b!=ui-&gt;useAsDefaultLocationCheckBox-&gt;isChecked())</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       {</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               ui-&gt;useAsDefaultLocationCheckBox-&gt;setChecked(b);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               ui-&gt;useAsDefaultLocationCheckBox-&gt;setEnabled(!b);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       }</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0008" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       // <span class="delete">removing this check and return... we might have</span> the <span class="delete">location chan</span></td><td> </td><td class="rblock">       // <span class="insert">Hack to avoid</span> the <span class="insert">coord spinbox receiving</span> the <span class="insert">focus and triggerin</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">ged</span></td><td> </td><td class="rblock"><span class="insert">g</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       // by a script or plugin, and as such we should update the map whene</span></td><td> </td><td class="rblock">       // <span class="insert">"new location" editing mode.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">ver</span> the</td><td> </td><td class="rblock"><span class="insert">       ui-&gt;citySearchLineEdit-&gt;setFocus();</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       // <span class="delete">location window is visible.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       if (isEditingNew==true)</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               return;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0009" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       const QString&amp; key1 = <span class="delete">StelApp::getInstance().getCore()-&gt;getCurrentLo</span></td><td> </td><td class="rblock">       <span class="insert">isEditingNew = false;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">cation().getID();</span></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       // Check that the use as default check box needs to be updated</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       // Move to setFieldsFromLocation()? --BM?</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       const bool b = currentLocation.getID() == stelCore-&gt;getDefaultLocati</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">onID();</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       updateDefaultLocationControls(b);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                           </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       const QString&amp; key1 = <span class="insert">currentLocation.getID();</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       const QString&amp; key2 = locationFromFields().getID();</td><td> </td><td class="right">       const QString&amp; key2 = locationFromFields().getID();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (key1!=key2)</td><td> </td><td class="right">       if (key1!=key2)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0010" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               setFieldsFromLocation(<span class="delete">StelApp::getInstance().getCore()-&gt;getC
urrentLocation()</span>);</td><td> </td><td class="rblock">               setFieldsFromLocation(<span class="insert">currentLocation</span>);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void LocationDialog::disconnectEditSignals()</td><td> </td><td class="right">void LocationDialog::disconnectEditSignals()</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0011" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       disconnect(ui-&gt;longitudeSpinBox, SIGNAL(valueChanged()), this, SLOT(</td><td> </td><td class="rblock">       disconnect(ui-&gt;longitudeSpinBox, SIGNAL(valueChanged()), this, SLOT(</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">spinBoxChanged()));</span></td><td> </td><td class="rblock"><span class="insert">setPositionFromCoords()));</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       disconnect(ui-&gt;latitudeSpinBox, SIGNAL(valueChanged()), this, SLOT(s</td><td> </td><td class="rblock">       disconnect(ui-&gt;latitudeSpinBox, SIGNAL(valueChanged()), this, SLOT(s</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">pinBoxChanged()));</span></td><td> </td><td class="rblock"><span class="insert">etPositionFromCoords()));</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       disconnect(ui-&gt;altitudeSpinBox, SIGNAL(valueChanged(int)), this, SLO</td><td> </td><td class="rblock">       disconnect(ui-&gt;altitudeSpinBox, SIGNAL(valueChanged(int)), this, SLO</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">T(spinBoxChanged(int)));</span></td><td> </td><td class="rblock"><span class="insert">T(setPositionFromCoords(int)));</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       disconnect(ui-&gt;planetNameComboBox, SIGNAL(currentIndexChanged(const </td><td> </td><td class="rblock">       disconnect(ui-&gt;planetNameComboBox, SIGNAL(currentIndexChanged(const </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">QString&amp;)), this, <span class="delete">SLOT(comboBoxChanged(const</span> QString&amp;)));</td><td> </td><td class="rblock">QString&amp;)), this, <span class="insert">SLOT(moveToAnotherPlanet(const</span> QString&amp;)));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       disconnect(ui-&gt;countryNameComboBox, SIGNAL(currentIndexChanged(const</td><td> </td><td class="rblock">       disconnect(ui-&gt;countryNameComboBox, SIGNAL(currentIndexChanged(const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"> QString&amp;)), this, <span class="delete">SLOT(comboBoxChanged(const QString&amp;)));</span></td><td> </td><td class="rblock"> QString&amp;)), this, <span class="insert">SLOT(reportEdit()));</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       disconnect(ui-&gt;countryNameComboBox,</span> SIGNAL(activated(const <span class="delete">QString&amp;)</span></td><td> </td><td class="rblock"><span class="insert">       // Why an edit should be reported even if the country is not changed</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">),</span> this, SLOT(comboBoxChanged(const QString&amp;)));</td><td> </td><td class="rblock"><span class="insert">? --BM</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       disconnect(ui-&gt;cityNameLineEdit, SIGNAL(textEdited(const QString&amp;)),</td><td> </td><td class="rblock"><span class="insert">       //disconnect(ui-&gt;countryNameComboBox,</span> SIGNAL(activated(const <span class="insert">QString</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"> this, <span class="delete">SLOT(locationNameChanged(const QString&amp;)));</span></td><td> </td><td class="rblock"><span class="insert">&amp;)),</span> this, SLOT(comboBoxChanged(const QString&amp;)));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       disconnect(ui-&gt;cityNameLineEdit, SIGNAL(textEdited(const QString&amp;)),</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                  this, <span class="insert">SLOT(reportEdit()));</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void LocationDialog::connectEditSignals()</td><td> </td><td class="right">void LocationDialog::connectEditSignals()</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0012" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       connect(ui-&gt;longitudeSpinBox, SIGNAL(valueChanged()), this, <span class="delete">SLOT(spi</span></td><td> </td><td class="rblock">       connect(ui-&gt;longitudeSpinBox, SIGNAL(valueChanged()), this, <span class="insert">SLOT(set</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">nBoxChanged()));</span></td><td> </td><td class="rblock"><span class="insert">PositionFromCoords()));</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       connect(ui-&gt;latitudeSpinBox, SIGNAL(valueChanged()), this, <span class="delete">SLOT(spin</span></td><td> </td><td class="rblock">       connect(ui-&gt;latitudeSpinBox, SIGNAL(valueChanged()), this, <span class="insert">SLOT(setP</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">BoxChanged()));</span></td><td> </td><td class="rblock"><span class="insert">ositionFromCoords()));</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       connect(ui-&gt;altitudeSpinBox, SIGNAL(valueChanged(int)), this, SLOT(s</td><td> </td><td class="rblock">       connect(ui-&gt;altitudeSpinBox, SIGNAL(valueChanged(int)), this, SLOT(s</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">pinBoxChanged(int)));</span></td><td> </td><td class="rblock"><span class="insert">etPositionFromCoords(int)));</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       connect(ui-&gt;planetNameComboBox, SIGNAL(currentIndexChanged(const QSt</td><td> </td><td class="rblock">       connect(ui-&gt;planetNameComboBox, SIGNAL(currentIndexChanged(const QSt</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">ring&amp;)), this, <span class="delete">SLOT(comboBoxChanged(const</span> QString&amp;)));</td><td> </td><td class="rblock">ring&amp;)), this, <span class="insert">SLOT(moveToAnotherPlanet(const</span> QString&amp;)));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       connect(ui-&gt;countryNameComboBox, SIGNAL(currentIndexChanged(const QS</td><td> </td><td class="rblock">       connect(ui-&gt;countryNameComboBox, SIGNAL(currentIndexChanged(const QS</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">tring&amp;)), this, <span class="delete">SLOT(comboBoxChanged(const QString&amp;)));</span></td><td> </td><td class="rblock">tring&amp;)), this, <span class="insert">SLOT(reportEdit()));</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       connect(ui-&gt;countryNameComboBox,</span> SIGNAL(activated(const <span class="delete">QString&amp;)),</span> </td><td> </td><td class="rblock"><span class="insert">       // Why an edit should be reported even if the country is not changed</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">this, SLOT(comboBoxChanged(const QString&amp;)));</td><td> </td><td class="rblock"><span class="insert">? --BM</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       connect(ui-&gt;cityNameLineEdit, SIGNAL(textEdited(const QString&amp;)), <span class="delete">th</span></td><td> </td><td class="rblock"><span class="insert">       //connect(ui-&gt;countryNameComboBox,</span> SIGNAL(activated(const <span class="insert">QString&amp;))</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">is, SLOT(locationNameChanged(const QString&amp;)));</span></td><td> </td><td class="rblock"><span class="insert">,</span> this, SLOT(comboBoxChanged(const QString&amp;)));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       connect(ui-&gt;cityNameLineEdit, SIGNAL(textEdited(const QString&amp;)),</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">               <span class="insert">this, SLOT(reportEdit()));</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void LocationDialog::setFieldsFromLocation(const StelLocation&amp; loc)</td><td> </td><td class="right">void LocationDialog::setFieldsFromLocation(const StelLocation&amp; loc)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // Deactivate edit signals</td><td> </td><td class="right">       // Deactivate edit signals</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       disconnectEditSignals();</td><td> </td><td class="right">       disconnectEditSignals();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       ui-&gt;cityNameLineEdit-&gt;setText(loc.name);</td><td> </td><td class="right">       ui-&gt;cityNameLineEdit-&gt;setText(loc.name);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       int idx = ui-&gt;countryNameComboBox-&gt;findData(loc.country, Qt::UserRol
e, Qt::MatchCaseSensitive);</td><td> </td><td class="right">       int idx = ui-&gt;countryNameComboBox-&gt;findData(loc.country, Qt::UserRol
e, Qt::MatchCaseSensitive);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (idx==-1)</td><td> </td><td class="right">       if (idx==-1)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l3" /><small>skipping to change at</small><em> line 202</em></th><th> </th><th><a name="part-r3" /><small>skipping to change at</small><em> line 209</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               idx = ui-&gt;planetNameComboBox-&gt;findData(QVariant("Earth"), Qt
::UserRole, Qt::MatchCaseSensitive);</td><td> </td><td class="right">               idx = ui-&gt;planetNameComboBox-&gt;findData(QVariant("Earth"), Qt
::UserRole, Qt::MatchCaseSensitive);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       ui-&gt;planetNameComboBox-&gt;setCurrentIndex(idx);</td><td> </td><td class="right">       ui-&gt;planetNameComboBox-&gt;setCurrentIndex(idx);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       setMapForLocation(loc);</td><td> </td><td class="right">       setMapForLocation(loc);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // Set pointer position</td><td> </td><td class="right">       // Set pointer position</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       ui-&gt;mapLabel-&gt;setCursorPos(loc.longitude, loc.latitude);</td><td> </td><td class="right">       ui-&gt;mapLabel-&gt;setCursorPos(loc.longitude, loc.latitude);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       ui-&gt;deleteLocationFromListPushButton-&gt;setEnabled(StelApp::getInstanc
e().getLocationMgr().canDeleteUserLocation(loc.getID()));</td><td> </td><td class="right">       ui-&gt;deleteLocationFromListPushButton-&gt;setEnabled(StelApp::getInstanc
e().getLocationMgr().canDeleteUserLocation(loc.getID()));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0013" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       <span class="insert">SolarSystem* ssm = GETSTELMODULE(SolarSystem);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       PlanetP p = ssm-&gt;searchByEnglishName(loc.planetName);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       LandscapeMgr* ls = GETSTELMODULE(LandscapeMgr);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       ls-&gt;setFlagAtmosphere(p-&gt;hasAtmosphere());</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       ls-&gt;setFlagFog(p-&gt;hasAtmosphere());</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                           </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // Reactivate edit signals</td><td> </td><td class="right">       // Reactivate edit signals</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       connectEditSignals();</td><td> </td><td class="right">       connectEditSignals();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Update the map for the given location.</td><td> </td><td class="right">// Update the map for the given location.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void LocationDialog::setMapForLocation(const StelLocation&amp; loc)</td><td> </td><td class="right">void LocationDialog::setMapForLocation(const StelLocation&amp; loc)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // Avoids usless processing</td><td> </td><td class="right">       // Avoids usless processing</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (lastPlanet==loc.planetName &amp;&amp; lastVisionMode==StelApp::getInstan
ce().getVisionModeNight())</td><td> </td><td class="right">       if (lastPlanet==loc.planetName &amp;&amp; lastVisionMode==StelApp::getInstan
ce().getVisionModeNight())</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               return;</td><td> </td><td class="right">               return;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l4" /><small>skipping to change at</small><em> line 330</em></th><th> </th><th><a name="part-r4" /><small>skipping to change at</small><em> line 343</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       loc.altitude = ui-&gt;altitudeSpinBox-&gt;value();</td><td> </td><td class="right">       loc.altitude = ui-&gt;altitudeSpinBox-&gt;value();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       index = ui-&gt;countryNameComboBox-&gt;currentIndex();</td><td> </td><td class="right">       index = ui-&gt;countryNameComboBox-&gt;currentIndex();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (index &lt; 0)</td><td> </td><td class="right">       if (index &lt; 0)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               loc.country = QString();//As returned by QComboBox::currentT
ext()</td><td> </td><td class="right">               loc.country = QString();//As returned by QComboBox::currentT
ext()</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       else</td><td> </td><td class="right">       else</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               loc.country = ui-&gt;countryNameComboBox-&gt;itemData(index).toStr
ing();</td><td> </td><td class="right">               loc.country = ui-&gt;countryNameComboBox-&gt;itemData(index).toStr
ing();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return loc;</td><td> </td><td class="right">       return loc;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0014" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">void LocationDialog::<span class="delete">listItemActivated</span>(const QModelIndex&amp; index)</td><td> </td><td class="rblock">void LocationDialog::<span class="insert">setPositionFromList</span>(const QModelIndex&amp; index)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       isEditingNew=false;</td><td> </td><td class="right">       isEditingNew=false;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       ui-&gt;addLocationToListPushButton-&gt;setEnabled(false);</td><td> </td><td class="right">       ui-&gt;addLocationToListPushButton-&gt;setEnabled(false);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       StelLocation loc = StelApp::getInstance().getLocationMgr().locationF
orSmallString(index.data().toString());</td><td> </td><td class="right">       StelLocation loc = StelApp::getInstance().getLocationMgr().locationF
orSmallString(index.data().toString());</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       setFieldsFromLocation(loc);</td><td> </td><td class="right">       setFieldsFromLocation(loc);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       StelApp::getInstance().getCore()-&gt;moveObserverTo(loc, 0.);</td><td> </td><td class="right">       StelApp::getInstance().getCore()-&gt;moveObserverTo(loc, 0.);</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0015" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                           </td><td> </td><td class="rblock">       <span class="insert">// This calls indirectly updateFromProgram()</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">const bool b = loc.getID()==StelApp::getInstance().getCore()-&gt;getDef</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">aultLocationID();</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       ui-&gt;useAsDefaultLocationCheckBox-&gt;setChecked(b);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       ui-&gt;useAsDefaultLocationCheckBox-&gt;setEnabled(!b);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void LocationDialog::setPositionFromMap(double longitude, double latitude)</td><td> </td><td class="right">void LocationDialog::setPositionFromMap(double longitude, double latitude)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       reportEdit();</td><td> </td><td class="right">       reportEdit();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       StelLocation loc = locationFromFields();</td><td> </td><td class="right">       StelLocation loc = locationFromFields();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       loc.latitude = latitude;</td><td> </td><td class="right">       loc.latitude = latitude;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       loc.longitude = longitude;</td><td> </td><td class="right">       loc.longitude = longitude;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       setFieldsFromLocation(loc);</td><td> </td><td class="right">       setFieldsFromLocation(loc);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       StelApp::getInstance().getCore()-&gt;moveObserverTo(loc, 0.);</td><td> </td><td class="right">       StelApp::getInstance().getCore()-&gt;moveObserverTo(loc, 0.);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Called when the planet name is changed by hand</td><td> </td><td class="right">// Called when the planet name is changed by hand</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0016" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">void LocationDialog::<span class="delete">comboBoxChanged</span>(const QString&amp;)</td><td> </td><td class="rblock">void LocationDialog::<span class="insert">moveToAnotherPlanet</span>(const QString&amp;)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       reportEdit();</td><td> </td><td class="right">       reportEdit();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       StelLocation loc = locationFromFields();</td><td> </td><td class="right">       StelLocation loc = locationFromFields();</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0017" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       if <span class="delete">(loc.planetName!=StelApp::getInstance().getCore()-&gt;getCurrentLoca</span></td><td> </td><td class="rblock">       <span class="insert">StelCore* stelCore = StelApp::getInstance().getCore();</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">tion().planetName)</span></td><td> </td><td class="rblock">       if <span class="insert">(loc.planetName != stelCore-&gt;getCurrentLocation().planetName)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               setFieldsFromLocation(loc);</td><td> </td><td class="right">               setFieldsFromLocation(loc);</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0018" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">StelApp::getInstance().getCore()</span>-&gt;moveObserverTo(loc, 0.);</td><td> </td><td class="rblock">       <span class="insert">stelCore</span>-&gt;moveObserverTo(loc, 0.);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0019" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">void LocationDialog::s<span class="delete">pinBoxChanged</span>(int )</td><td> </td><td class="rblock">void LocationDialog::s<span class="insert">etPositionFromCoords</span>(int )</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       reportEdit();</td><td> </td><td class="right">       reportEdit();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       StelLocation loc = locationFromFields();</td><td> </td><td class="right">       StelLocation loc = locationFromFields();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       StelApp::getInstance().getCore()-&gt;moveObserverTo(loc, 0.);</td><td> </td><td class="right">       StelApp::getInstance().getCore()-&gt;moveObserverTo(loc, 0.);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       //Update the position of the map pointer</td><td> </td><td class="right">       //Update the position of the map pointer</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       ui-&gt;mapLabel-&gt;setCursorPos(loc.longitude, loc.latitude);</td><td> </td><td class="right">       ui-&gt;mapLabel-&gt;setCursorPos(loc.longitude, loc.latitude);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0020" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">// Called when the location name is manually changed</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">void LocationDialog::locationNameChanged(const QString&amp;)</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">{</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       reportEdit();</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">}</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                           </td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void LocationDialog::reportEdit()</td><td> </td><td class="right">void LocationDialog::reportEdit()</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (isEditingNew==false)</td><td> </td><td class="right">       if (isEditingNew==false)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               // The user starts editing manually a field, this creates au
tomatically a new location</td><td> </td><td class="right">               // The user starts editing manually a field, this creates au
tomatically a new location</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               // and allows to save it to the user locations list</td><td> </td><td class="right">               // and allows to save it to the user locations list</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               isEditingNew=true;</td><td> </td><td class="right">               isEditingNew=true;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       StelLocation loc = locationFromFields();</td><td> </td><td class="right">       StelLocation loc = locationFromFields();</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0021" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       if <span class="delete">(!StelApp::getInstance().getLocationMgr().canSaveUserLocation(loc</span></td><td> </td><td class="rblock">       <span class="insert">StelLocationMgr&amp; locationMgr = StelApp::getInstance().getLocationMgr</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">))</span></td><td> </td><td class="rblock"><span class="insert">();</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       bool canSave = locationMgr.canSaveUserLocation(loc);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       if <span class="insert">(!canSave)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               if (ui-&gt;cityNameLineEdit-&gt;hasFocus())</td><td> </td><td class="right">               if (ui-&gt;cityNameLineEdit-&gt;hasFocus())</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       // The user is editing the location name: don't chan
ge it!</td><td> </td><td class="right">                       // The user is editing the location name: don't chan
ge it!</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       ui-&gt;addLocationToListPushButton-&gt;setEnabled(false);</td><td> </td><td class="right">                       ui-&gt;addLocationToListPushButton-&gt;setEnabled(false);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       ui-&gt;deleteLocationFromListPushButton-&gt;setEnabled(fal
se);</td><td> </td><td class="right">                       ui-&gt;deleteLocationFromListPushButton-&gt;setEnabled(fal
se);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       return;</td><td> </td><td class="right">                       return;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               else</td><td> </td><td class="right">               else</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       ui-&gt;cityNameLineEdit-&gt;setText(q_("New Location"));</td><td> </td><td class="right">                       ui-&gt;cityNameLineEdit-&gt;setText(q_("New Location"));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       ui-&gt;cityNameLineEdit-&gt;selectAll();</td><td> </td><td class="right">                       ui-&gt;cityNameLineEdit-&gt;selectAll();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       loc = locationFromFields();</td><td> </td><td class="right">                       loc = locationFromFields();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0022" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       ui-&gt;addLocationToListPushButton-&gt;setEnabled(isEditingNew &amp;&amp; <span class="delete">StelApp:</span></td><td> </td><td class="rblock">       ui-&gt;addLocationToListPushButton-&gt;setEnabled(isEditingNew &amp;&amp; <span class="insert">canSave)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">:getInstance().getLocationMgr().canSaveUserLocation(loc));</span></td><td> </td><td class="rblock"><span class="insert">;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       ui-&gt;deleteLocationFromListPushButton-&gt;setEnabled(StelApp::getInstanc</span></td><td> </td><td class="rblock"><span class="insert">       ui-&gt;deleteLocationFromListPushButton-&gt;setEnabled(locationMgr.canDele</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">e().getLocationMgr().canDeleteUserLocation(loc.getID()));</span></td><td> </td><td class="rblock"><span class="insert">teUserLocation(loc.getID()));</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Called when the user clic on the save button</td><td> </td><td class="right">// Called when the user clic on the save button</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void LocationDialog::addCurrentLocationToList()</td><td> </td><td class="right">void LocationDialog::addCurrentLocationToList()</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       const StelLocation&amp; loc = locationFromFields();</td><td> </td><td class="right">       const StelLocation&amp; loc = locationFromFields();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       ui-&gt;citySearchLineEdit-&gt;clear();</td><td> </td><td class="right">       ui-&gt;citySearchLineEdit-&gt;clear();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       StelApp::getInstance().getLocationMgr().saveUserLocation(loc);</td><td> </td><td class="right">       StelApp::getInstance().getLocationMgr().saveUserLocation(loc);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       isEditingNew=false;</td><td> </td><td class="right">       isEditingNew=false;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       ui-&gt;addLocationToListPushButton-&gt;setEnabled(false);</td><td> </td><td class="right">       ui-&gt;addLocationToListPushButton-&gt;setEnabled(false);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       const QAbstractItemModel* model = ui-&gt;citiesListView-&gt;model();</td><td> </td><td class="right">       const QAbstractItemModel* model = ui-&gt;citiesListView-&gt;model();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       const QString id = loc.getID();</td><td> </td><td class="right">       const QString id = loc.getID();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       for (int i=0;i&lt;model-&gt;rowCount();++i)</td><td> </td><td class="right">       for (int i=0;i&lt;model-&gt;rowCount();++i)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               if (model-&gt;index(i,0).data()==id)</td><td> </td><td class="right">               if (model-&gt;index(i,0).data()==id)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       ui-&gt;citiesListView-&gt;scrollTo(model-&gt;index(i,0));</td><td> </td><td class="right">                       ui-&gt;citiesListView-&gt;scrollTo(model-&gt;index(i,0));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       ui-&gt;citiesListView-&gt;selectionModel()-&gt;select(model-&gt;
index(i,0), QItemSelectionModel::ClearAndSelect|QItemSelectionModel::Rows);</td><td> </td><td class="right">                       ui-&gt;citiesListView-&gt;selectionModel()-&gt;select(model-&gt;
index(i,0), QItemSelectionModel::ClearAndSelect|QItemSelectionModel::Rows);</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0023" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       <span class="delete">listItemActivated</span>(model-&gt;index(i,0));</td><td> </td><td class="rblock">                       <span class="insert">setPositionFromList</span>(model-&gt;index(i,0));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       disconnectEditSignals();</td><td> </td><td class="right">                       disconnectEditSignals();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       ui-&gt;citySearchLineEdit-&gt;setFocus();</td><td> </td><td class="right">                       ui-&gt;citySearchLineEdit-&gt;setFocus();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       connectEditSignals();</td><td> </td><td class="right">                       connectEditSignals();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       break;</td><td> </td><td class="right">                       break;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Called when the user wants to use the current location as default</td><td> </td><td class="right">// Called when the user wants to use the current location as default</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0024" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">void LocationDialog::<span class="delete">useAsDefaultClicked</span>()</td><td> </td><td class="rblock">void LocationDialog::<span class="insert">setDefaultLocation</span>()</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       StelCore* core = StelApp::getInstance().getCore();</td><td> </td><td class="right">       StelCore* core = StelApp::getInstance().getCore();</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0025" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">QString newDefaultLocationId = core-&gt;getCurrentLocation().getID();</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       core-&gt;setDefaultLocationID(newDefaultLocationId);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                           </td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       QString currentLocationId = core-&gt;getCurrentLocation().getID();</td><td> </td><td class="right">       QString currentLocationId = core-&gt;getCurrentLocation().getID();</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0026" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">const</span> bool <span class="delete">show</span> = (currentLocationId == <span class="delete">core-&gt;getDefaultLocationID()</span></td><td> </td><td class="rblock">       <span class="insert">core-&gt;setDefaultLocationID(currentLocationId);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">);</span></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       // Why this code even exists? After the previous code, this should a</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">lways</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       // be true, except if setting the default location somehow fails. --</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">BM</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       bool <span class="insert">isDefault</span> = (currentLocationId == <span class="insert">core-&gt;getDefaultLocationID())</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       disconnectEditSignals();</td><td> </td><td class="right">       disconnectEditSignals();</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0027" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">ui-&gt;useAsDefaultLocationCheckBox-&gt;setChecked(show);</span></td><td> </td><td class="rblock">       <span class="insert">updateDefaultLocationControls(isDefault);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       ui-&gt;useAsDefaultLocationCheckBox-&gt;setEnabled(!show);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       //The focus need to be switched to another control, otherwise</td><td> </td><td class="right">       //The focus need to be switched to another control, otherwise</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       //ui-&gt;latitudeSpinBox receives it and emits a valueChanged() signal 
when</td><td> </td><td class="right">       //ui-&gt;latitudeSpinBox receives it and emits a valueChanged() signal 
when</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       //the window is closed.</td><td> </td><td class="right">       //the window is closed.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       ui-&gt;citySearchLineEdit-&gt;setFocus();</td><td> </td><td class="right">       ui-&gt;citySearchLineEdit-&gt;setFocus();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       connectEditSignals();</td><td> </td><td class="right">       connectEditSignals();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0028" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">// Called when the user clic on the delete button</td><td> </td><td class="rblock">// Called when the user clic<span class="insert">ks</span> on the delete button</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void LocationDialog::deleteCurrentLocationFromList()</td><td> </td><td class="right">void LocationDialog::deleteCurrentLocationFromList()</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       const StelLocation&amp; loc = locationFromFields();</td><td> </td><td class="right">       const StelLocation&amp; loc = locationFromFields();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       StelApp::getInstance().getLocationMgr().deleteUserLocation(loc.getID
());</td><td> </td><td class="right">       StelApp::getInstance().getLocationMgr().deleteUserLocation(loc.getID
());</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0029" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                           </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">void LocationDialog::updateDefaultLocationControls(bool currentIsDefault)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">{</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       ui-&gt;useAsDefaultLocationCheckBox-&gt;setChecked(currentIsDefault);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       ui-&gt;useAsDefaultLocationCheckBox-&gt;setEnabled(!currentIsDefault);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       ui-&gt;pushButtonReturnToDefault-&gt;setEnabled(!currentIsDefault);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">}</span></td><td class="lineno" valign="top"></td></tr>

     <tr><td></td><td class="left"></td><td> </td><td class="right"></td><td></td></tr>
     <tr bgcolor="gray"><th colspan="5" align="center"><a name="end">&nbsp;End of changes. 29 change blocks.&nbsp;</a></th></tr>
     <tr class="stats"><td></td><th><i>96 lines changed or deleted</i></th><th><i> </i></th><th><i>98 lines changed or added</i></th><td></td></tr>
     <tr><td colspan="5" align="center" class="small"><br/>This html diff was produced by rfcdiff 1.41. The latest version is available from <a href="http://www.tools.ietf.org/tools/rfcdiff/" >http://tools.ietf.org/tools/rfcdiff/</a> </td></tr>
   </table>
   </body>
   </html>
