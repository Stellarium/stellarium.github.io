<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
<!-- Generated by rfcdiff 1.41: rfcdiff  --> 
<!-- <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional" > -->
<!-- System: Linux fomalhaut.local 3.13.0-38-generic #65-Ubuntu SMP Thu Oct 9 11:36:50 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux --> 
<!-- Using awk: /usr/bin/gawk: GNU Awk 4.0.1 --> 
<!-- Using diff: /usr/bin/diff: diff (GNU diffutils) 3.3 --> 
<!-- Using wdiff: /usr/bin/wdiff: wdiff (GNU wdiff) 1.2.1 --> 
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"> 
<head> 
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 
  <meta http-equiv="Content-Style-Type" content="text/css" /> 
  <title>Diff: Observability.cpp - Observability.cpp</title> 
  <style type="text/css"> 
    body    { font-size:16px; margin: 0.4ex; margin-right: auto; } 
    tr      { } 
    td      { white-space: pre; font-family: Consolas, "DejaVu Sans Mono", "Droid Sans Mono", Monaco, Monospace; vertical-align: top; font-size: 0.86em;} 
    th      { font-size: 0.86em; } 
    .small  { font-size: 0.6em; font-style: italic; font-family: Verdana, Helvetica, sans-serif; } 
    .left   { background-color: #EEE; } 
    .right  { background-color: #FFF; } 
    .diff   { background-color: #CCF; } 
    .lblock { background-color: #BFB; } 
    .rblock { background-color: #FF8; } 
    .insert { background-color: #8FF; } 
    .delete { background-color: #ACF; } 
    .void   { background-color: #FFB; } 
    .cont   { background-color: #EEE; } 
    .linebr { background-color: #AAA; } 
    .lineno { color: red; background-color: #FFF; font-size: 0.7em; text-align: right; padding: 0 2px; } 
    .elipsis{ background-color: #AAA; } 
    .left .cont { background-color: #DDD; } 
    .right .cont { background-color: #EEE; } 
    .lblock .cont { background-color: #9D9; } 
    .rblock .cont { background-color: #DD6; } 
    .insert .cont { background-color: #0DD; } 
    .delete .cont { background-color: #8AD; } 
    .stats, .stats td, .stats th { background-color: #EEE; padding: 2px 0; } 
  </style> 
</head> 
<body > 
  <table border="0" cellpadding="0" cellspacing="0"> 
  <tr bgcolor="orange"><th></th><th>&nbsp;Observability.cpp&nbsp;</th><th> </th><th>&nbsp;Observability.cpp&nbsp;</th><th></th></tr> 
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l1" /><small>skipping to change at</small><em> line 19</em></th><th> </th><th><a name="part-r1" /><small>skipping to change at</small><em> line 19</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"> * This program is distributed in the hope that it will be useful,</td><td> </td><td class="right"> * This program is distributed in the hope that it will be useful,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</td><td> </td><td class="right"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</td><td> </td><td class="right"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"> * GNU General Public License for more details.</td><td> </td><td class="right"> * GNU General Public License for more details.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"> *</td><td> </td><td class="right"> *</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"> * You should have received a copy of the GNU General Public License</td><td> </td><td class="right"> * You should have received a copy of the GNU General Public License</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"> * along with this program; if not, write to the Free Software</td><td> </td><td class="right"> * along with this program; if not, write to the Free Software</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"> * Foundation, Inc., 51 Franklin Street, Suite 500, Boston, MA  02110-1335,
 USA.</td><td> </td><td class="right"> * Foundation, Inc., 51 Franklin Street, Suite 500, Boston, MA  02110-1335,
 USA.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"> */</td><td> </td><td class="right"> */</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0001" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">#include &lt;QSettings&gt;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">#include &lt;QPixmap&gt;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">#include &lt;QTimer&gt;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">#include &lt;QString&gt;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#include &lt;QDebug&gt;</td><td> </td><td class="right">#include &lt;QDebug&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0002" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">#include &lt;QAction&gt;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">#include &lt;QKeyEvent&gt;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">#include &lt;QtNetwork&gt;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#include &lt;QKeyEvent&gt;</td><td> </td><td class="right">#include &lt;QKeyEvent&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#include &lt;QMouseEvent&gt;</td><td> </td><td class="right">#include &lt;QMouseEvent&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0003" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">#include &lt;QPixmap&gt;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">#include &lt;QSettings&gt;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">#include &lt;QString&gt;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">#include &lt;QTimer&gt;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0004" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">#include <span class="delete">"renderer/StelRenderer.hpp"</span></td><td> </td><td class="rblock"><span class="insert">//#include &lt;QtNetwork&gt; // Why do we need a full part of the framwork again?</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">#include <span class="delete">"StelIniParser.hpp"</span></td><td> </td><td class="rblock">                                                                           </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">#include <span class="delete">"StelProjector.hpp"</span></td><td> </td><td class="rblock">#include <span class="insert">"Observability.hpp"</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">#include <span class="insert">"ObservabilityDialog.hpp"</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                           </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">#include <span class="insert">"Planet.hpp"</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">#include "SolarSystem.hpp"</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#include "StarMgr.hpp"</td><td> </td><td class="right">#include "StarMgr.hpp"</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0005" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">#include <span class="delete">"StelObject.hpp"</span></td><td> </td><td class="rblock">#include <span class="insert">"StelActionMgr.hpp"</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">#include "StelObserver.hpp"</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">#include "StelUtils.hpp"</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#include "StelApp.hpp"</td><td> </td><td class="right">#include "StelApp.hpp"</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0006" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">#include <span class="delete">"StelObjectMgr.hpp"</span></td><td> </td><td class="rblock">#include <span class="insert">"StelCore.hpp"</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">#include <span class="delete">"StelLocaleMgr.hpp"</span></td><td> </td><td class="rblock">#include <span class="insert">"StelFader.hpp"</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">#include <span class="delete">"StelModuleMgr.hpp"</span></td><td> </td><td class="rblock">#include <span class="insert">"StelFileMgr.hpp"</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#include "StelGui.hpp"</td><td> </td><td class="right">#include "StelGui.hpp"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#include "StelGuiItems.hpp"</td><td> </td><td class="right">#include "StelGuiItems.hpp"</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0007" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">#include "StelIniParser.hpp"</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">#include "StelLocaleMgr.hpp"</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">#include "StelModuleMgr.hpp"</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#include "StelMovementMgr.hpp"</td><td> </td><td class="right">#include "StelMovementMgr.hpp"</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0008" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">#include <span class="delete">"StelFileMgr.hpp"</span></td><td> </td><td class="rblock">#include <span class="insert">"StelObject.hpp"</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">#include <span class="delete">"StelCore.hpp"</span></td><td> </td><td class="rblock">#include <span class="insert">"StelObjectMgr.hpp"</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">#include <span class="delete">"ZoneArray.hpp"</span></td><td> </td><td class="rblock">#include <span class="insert">"StelObserver.hpp"</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">#include "StelProjector.hpp"</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#include "StelSkyDrawer.hpp"</td><td> </td><td class="right">#include "StelSkyDrawer.hpp"</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0009" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">#include <span class="delete">"Observability.hpp"</span></td><td> </td><td class="rblock">#include <span class="insert">"StelUtils.hpp"</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">#include <span class="delete">"ObservabilityDialog.hpp"</span></td><td> </td><td class="rblock">#include <span class="insert">"StelPainter.hpp"</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                           </td><td> </td><td class="rblock">#include <span class="insert">"ZoneArray.hpp"</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">#include <span class="delete">"SolarSystem.hpp"</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">#include "Planet.hpp"</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">#include "StelFader.hpp"</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">StelModule* ObservabilityStelPluginInterface::getStelModule() const</td><td> </td><td class="right">StelModule* ObservabilityStelPluginInterface::getStelModule() const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0010" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete"> </span>return new Observability();</td><td> </td><td class="rblock">       return new Observability();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">StelPluginInfo ObservabilityStelPluginInterface::getPluginInfo() const</td><td> </td><td class="right">StelPluginInfo ObservabilityStelPluginInterface::getPluginInfo() const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       Q_INIT_RESOURCE(Observability);</td><td> </td><td class="right">       Q_INIT_RESOURCE(Observability);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0011" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete"> </span>StelPluginInfo info;</td><td> </td><td class="rblock">       StelPluginInfo info;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       info.id = "Observability";</td><td> </td><td class="right">       info.id = "Observability";</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0012" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete"> info.displayedName = N_("Observability a</span>nalysis");</td><td> </td><td class="rblock">       <span class="insert">info.displayedName = N_("Observability A</span>nalysis");</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       info.authors = "Ivan Marti-Vidal (Onsala Space Observatory)"; // non
-translatable field</td><td> </td><td class="right">       info.authors = "Ivan Marti-Vidal (Onsala Space Observatory)"; // non
-translatable field</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       info.contact = "i.martividal@gmail.com";</td><td> </td><td class="right">       info.contact = "i.martividal@gmail.com";</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0013" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        info.description = <span class="delete">N_("Reports</span> an analysis of <span class="delete">source observability</span> </td><td> </td><td class="rblock">       info.description = <span class="insert">N_("Displays</span> an analysis of <span class="insert">a selected object's o</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">(rise, set, and transit <span class="delete">times),</span> as well <span class="delete">as the epochs of year when the sour</span></td><td> </td><td class="rblock"><span class="insert">bservability</span> (rise, set, and transit <span class="insert">times) for the current date,</span> as well a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">ce is best observed. It assumes that</span> a <span class="delete">source</span> is observable if it is above </td><td> </td><td class="rblock"><span class="insert">s when it</span> is observable <span class="insert">through the year. An object is assumed to be observ</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">the horizon during a fraction of the night. <span class="delete">The plugin also gives the day f</span></td><td> </td><td class="rblock"><span class="insert">able</span> if it is above the horizon during a fraction of the night. <span class="insert">Also includ</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">or</span> largest separation from the Sun and <span class="delete">the days of Acronychal</span> and <span class="delete">Cosmical </span></td><td> </td><td class="rblock"><span class="insert">ed are the dates of the</span> largest separation from the Sun and <span class="insert">acronychal</span> and </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">rise/set.&lt;br&gt;&lt;br&gt; An explanation of the quantities shown by this script is </span></td><td> </td><td class="rblock"><span class="insert">cosmical rising and setting. (Explanations are provided</span> in the 'About' tab </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">given</span> in the 'About' tab of the configuration <span class="delete">window");</span></td><td> </td><td class="rblock">of the <span class="insert">plugin's</span> configuration <span class="insert">window.)");</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        return info;</td><td> </td><td class="rblock"><span class="insert">       info.version = OBSERVABILITY_PLUGIN_VERSION;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       return info;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0014" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">Q_EXPORT_PLUGIN2(Observability, ObservabilityStelPluginInterface)</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                           </td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">Observability::Observability()</td><td> </td><td class="right">Observability::Observability()</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0015" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       : <span class="delete">flagShowObservability(false), OnIcon(NULL), OffIcon(NULL), GlowIco</span></td><td> </td><td class="rblock">       : <span class="insert">Jan1stJD(0.)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">n(NULL),toolbarButton(NULL)</span></td><td> </td><td class="rblock"><span class="insert">       , GMTShift(0.)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       , twilightAltRad(0.)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       , twilightAltDeg(0.)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       , horizonAltitude(0.)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       , horizonAltDeg(0.)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       , selRA(0.)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       , selDec(0.)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       , alti(0.)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       , horizH(0.)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       , culmAlt(0.)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       , MoonRise(0.)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       , MoonSet(0.)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       , MoonCulm(0.)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       , lastJDMoon(0.)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       , ObserverLoc(0.)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       , myPlanet(NULL)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       , nDays(0)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       , dmyFormat(false)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       , hasRisen(false)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       , configChanged(false)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       , souChanged(false)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       , lastType(0)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       , show_AcroCos(false)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       , show_Good_Nights(false)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       , show_Best_Night(false)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       , show_Today(false)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       , show_FullMoon(false)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       , flagShowReport(false)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       , fontSize(14)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       , button(NULL)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       setObjectName("Observability");</td><td> </td><td class="right">       setObjectName("Observability");</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       configDialog = new ObservabilityDialog();</td><td> </td><td class="right">       configDialog = new ObservabilityDialog();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0016" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       // TODO: Migrate to static const? --BM</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // Some useful constants:</td><td> </td><td class="right">       // Some useful constants:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       Rad2Deg = 180./3.1415927; // Convert degrees into radians</td><td> </td><td class="right">       Rad2Deg = 180./3.1415927; // Convert degrees into radians</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       Rad2Hr = 12./3.1415927;  // Convert hours into radians</td><td> </td><td class="right">       Rad2Hr = 12./3.1415927;  // Convert hours into radians</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       UA = 1.4958e+8;         // Astronomical Unit in Km.</td><td> </td><td class="right">       UA = 1.4958e+8;         // Astronomical Unit in Km.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       TFrac = 0.9972677595628414;  // Convert sidereal time into Solar tim
e</td><td> </td><td class="right">       TFrac = 0.9972677595628414;  // Convert sidereal time into Solar tim
e</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       JDsec = 1./86400.;      // A second in days.</td><td> </td><td class="right">       JDsec = 1./86400.;      // A second in days.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       halfpi = 1.57079632675; // pi/2</td><td> </td><td class="right">       halfpi = 1.57079632675; // pi/2</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       MoonT = 29.530588; // Moon synodic period (used as first estimate of
 Full Moon).</td><td> </td><td class="right">       MoonT = 29.530588; // Moon synodic period (used as first estimate of
 Full Moon).</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       RefFullMoon = 2451564.696; // Reference Julian date of a Full Moon.</td><td> </td><td class="right">       RefFullMoon = 2451564.696; // Reference Julian date of a Full Moon.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       MoonPerilune = 0.0024236308; // Smallest Earth-Moon distance (in AU)
.</td><td> </td><td class="right">       MoonPerilune = 0.0024236308; // Smallest Earth-Moon distance (in AU)
.</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0017" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                                                                           </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       nextFullMoon = 0.0;</td><td> </td><td class="right">       nextFullMoon = 0.0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       prevFullMoon = 0.0;</td><td> </td><td class="right">       prevFullMoon = 0.0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0018" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">RefracHoriz = 0.0;   // Geometric altitude at refraction-corrected h
orizon.</span></td><td> </td><td class="rblock">       <span class="insert">refractedHorizonAlt = 0.0;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       selName = "";</td><td> </td><td class="right">       selName = "";</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0019" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">////////////////////////////</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">// Read configuration:</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       QSettings* conf = StelApp::getInstance().getSettings();</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       // Setup defaults if not present</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       conf-&gt;beginGroup("Observability");</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       if (!conf-&gt;contains("font_size"))</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               conf-&gt;setValue("font_size", 15);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       if (!conf-&gt;contains("font_color"))</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               conf-&gt;setValue("font_color", "0,0.5,1");</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       if (!conf-&gt;contains("show_AcroCos"))</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               conf-&gt;setValue("show_AcroCos", true);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       if (!conf-&gt;contains("show_Good_Nights"))</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               conf-&gt;setValue("show_Good_Nights", true);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       if (!conf-&gt;contains("show_Best_Night"))</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               conf-&gt;setValue("show_Best_Night", true);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       if (!conf-&gt;contains("show_Today"))</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               conf-&gt;setValue("show_Today", true);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       if (!conf-&gt;contains("Sun_Altitude"))</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               conf-&gt;setValue("Sun_Altitude", 12);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       if (!conf-&gt;contains("Horizon_Altitude"))</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               conf-&gt;setValue("Horizon_Altitude", 0);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       if (!conf-&gt;contains("show_FullMoon"))</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               conf-&gt;setValue("show_FullMoon", true);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">//     if (!conf-&gt;contains("show_Crescent"))</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">//             conf-&gt;setValue("show_Crescent", true);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">//     if (!conf-&gt;contains("show_SuperMoon"))</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">//             conf-&gt;setValue("show_SuperMoon", true);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       // Load settings from main config file</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       fontSize = conf-&gt;value("font_size",15).toInt();</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       iAltitude = conf-&gt;value("Sun_Altitude",12).toInt();</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       iHorizAltitude = conf-&gt;value("Horizon_Altitude",0).toInt();</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       AstroTwiAlti = -((double) iAltitude)/Rad2Deg ;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       HorizAlti = ((double) iHorizAltitude)/Rad2Deg ;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       font.setPixelSize(fontSize);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       QString fontColorStr = conf-&gt;value("font_color", "0,0.5,1").toString</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">();</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       fontColor = StelUtils::strToVec3f(fontColorStr);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       show_AcroCos = conf-&gt;value("show_AcroCos", true).toBool();</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       show_Good_Nights = conf-&gt;value("show_Good_Nights", true).toBool();</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       show_Best_Night = conf-&gt;value("show_Best_Night", true).toBool();</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       show_Today = conf-&gt;value("show_Today", true).toBool();</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       show_FullMoon = conf-&gt;value("show_FullMoon", true).toBool();</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">//     show_Crescent = conf-&gt;value("show_Crescent", true).toBool();</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">//     show_SuperMoon = conf-&gt;value("show_SuperMoon", true).toBool();</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       conf-&gt;endGroup();</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">/////////////////////////////////</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       // Apply format for date from main settings</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       if (conf-&gt;value("localization/date_display_format", "system_default"</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">).toString() == "ddmmyyyy")</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               setDateFormat(true);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       else</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               setDateFormat(false);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                           </td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // Dummy initial values for parameters and data vectors:</td><td> </td><td class="right">       // Dummy initial values for parameters and data vectors:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       mylat = 1000.; mylon = 1000.;</td><td> </td><td class="right">       mylat = 1000.; mylon = 1000.;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       myJD = 0.0;</td><td> </td><td class="right">       myJD = 0.0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0020" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       cur<span class="delete">r</span>Year = 0;</td><td> </td><td class="rblock">       curYear = 0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       isStar = true;</td><td> </td><td class="right">       isStar = true;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       isMoon = false;</td><td> </td><td class="right">       isMoon = false;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       isSun = false;</td><td> </td><td class="right">       isSun = false;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       isScreen = true;</td><td> </td><td class="right">       isScreen = true;</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0021" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">raised=false;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       ObserverLoc[0]=0.0;ObserverLoc[1]=0.0;ObserverLoc[2]=0.0;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0022" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">//Get pointer to the Earth:</td><td> </td><td class="rblock"><span class="insert">       </span>//Get pointer to the Earth:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       PlanetP Earth = GETSTELMODULE(SolarSystem)-&gt;getEarth();</td><td> </td><td class="right">       PlanetP Earth = GETSTELMODULE(SolarSystem)-&gt;getEarth();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       myEarth = Earth.data();</td><td> </td><td class="right">       myEarth = Earth.data();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0023" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">// Get pointer to the Moon/Sun:</td><td> </td><td class="rblock"><span class="insert">       </span>// Get pointer to the Moon/Sun:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       PlanetP Moon = GETSTELMODULE(SolarSystem)-&gt;getMoon();</td><td> </td><td class="right">       PlanetP Moon = GETSTELMODULE(SolarSystem)-&gt;getMoon();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       myMoon = Moon.data();</td><td> </td><td class="right">       myMoon = Moon.data();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0024" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       // I think this can be done in a more simple way...--BM</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       for (int i=0;i&lt;366;i++) {</td><td> </td><td class="right">       for (int i=0;i&lt;366;i++) {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0025" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               <span class="delete">SunRA[i]</span> = 0.0; <span class="delete">SunDec[i]</span> = 0.0;</td><td> </td><td class="rblock">               <span class="insert">sunRA[i]</span> = 0.0; <span class="insert">sunDec[i]</span> = 0.0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               <span class="delete">ObjectRA[i]</span> = 0.0; <span class="delete">ObjectDec[i]=0.0;</span></td><td> </td><td class="rblock">               <span class="insert">objectRA[i]</span> = 0.0; <span class="insert">objectDec[i]=0.0;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               SunSidT[0][i]=0.0; SunSidT[1][i]=0.0;</span></td><td> </td><td class="rblock"><span class="insert">               sunSidT[0][i]=0.0; sunSidT[1][i]=0.0;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               ObjectSidT[0][i]=0.0; ObjectSidT[1][i]=0.0;</span></td><td> </td><td class="rblock"><span class="insert">               objectSidT[0][i]=0.0; objectSidT[1][i]=0.0;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               ObjectH0[i]</span> = 0.0;</td><td> </td><td class="rblock"><span class="insert">               objectH0[i]</span> = 0.0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               yearJD[i] = 0.0;</td><td> </td><td class="right">               yearJD[i] = 0.0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       };</td><td> </td><td class="right">       };</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">Observability::~Observability()</td><td> </td><td class="right">Observability::~Observability()</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0026" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       if <span class="delete">(GlowIcon!=NULL)</span></td><td> </td><td class="rblock">       <span class="insert">// Shouldn't this be in the deinit()? --BM</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               delete GlowIcon;</span></td><td> </td><td class="rblock">       if <span class="insert">(configDialog != NULL)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       if (OnIcon!=NULL)</span></td><td> </td><td class="rblock">               delete configDialog;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               delete OnIcon;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       if (OffIcon!=NULL)</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               delete OffIcon;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       delete configDialog;</td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void Observability::updateMessageText()</td><td> </td><td class="right">void Observability::updateMessageText()</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // Set names of the months:</td><td> </td><td class="right">       // Set names of the months:</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0027" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">QString mons[12]={qc_("Jan",</span> "short month <span class="delete">name"),</span> qc_("Feb", "short </td><td> </td><td class="rblock">       <span class="insert">monthNames.clear();</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">month <span class="delete">name"),</span> qc_("Mar", "short month <span class="delete">name"),</span> qc_("Apr", "short month <span class="delete">name"</span></td><td> </td><td class="rblock"><span class="insert">       monthNames &lt;&lt; qc_("Jan",</span> "short month <span class="insert">name")</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">),</span> qc_("May", "short month <span class="delete">name"),</span> qc_("Jun", "short month <span class="delete">name"), qc_("Jul</span></td><td> </td><td class="rblock"><span class="insert">                  &lt;&lt;</span> qc_("Feb", "short month <span class="insert">name")</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">",</span> "short month <span class="delete">name"),</span> qc_("Aug", "short month <span class="delete">name"),</span> qc_("Sep", "short <span class="delete">m</span></td><td> </td><td class="rblock"><span class="insert">                  &lt;&lt;</span> qc_("Mar", "short month <span class="insert">name")</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">onth name"),</span> qc_("Oct", "short month <span class="delete">name"),</span> qc_("Nov", "short month name")</td><td> </td><td class="rblock"><span class="insert">                  &lt;&lt;</span> qc_("Apr", "short month <span class="insert">name")</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">,</span> qc_("Dec", "short month <span class="delete">name")};</span></td><td> </td><td class="rblock"><span class="insert">                  &lt;&lt;</span> qc_("May", "short month <span class="insert">name")</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"><span class="insert">                  &lt;&lt;</span> qc_("Jun", "short month <span class="insert">name")</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       for (int i=0;i&lt;12;i++) {</span></td><td> </td><td class="rblock"><span class="insert">                  &lt;&lt; qc_("Jul",</span> "short month <span class="insert">name")</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               months[i]=mons[i];</span></td><td> </td><td class="rblock"><span class="insert">                  &lt;&lt;</span> qc_("Aug", "short month <span class="insert">name")</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       };</span></td><td> </td><td class="rblock"><span class="insert">                  &lt;&lt;</span> qc_("Sep", "short <span class="insert">month name")</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                  &lt;&lt;</span> qc_("Oct", "short month <span class="insert">name")</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                  &lt;&lt;</span> qc_("Nov", "short month name")</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                  <span class="insert">&lt;&lt;</span> qc_("Dec", "short month <span class="insert">name");</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0028" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       // TRANSLATORS: Short for "hours".</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       msgH            = q_("h");</td><td> </td><td class="right">       msgH            = q_("h");</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0029" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       // TRANSLATORS: Short for "minutes".</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       msgM            = q_("m");</td><td> </td><td class="right">       msgM            = q_("m");</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0030" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       // TRANSLATORS: Short for "seconds".</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       msgS            = q_("s");</td><td> </td><td class="right">       msgS            = q_("s");</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       msgSetsAt       = q_("Sets at %1 (in %2)");</td><td> </td><td class="right">       msgSetsAt       = q_("Sets at %1 (in %2)");</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       msgRoseAt       = q_("Rose at %1 (%2 ago)");</td><td> </td><td class="right">       msgRoseAt       = q_("Rose at %1 (%2 ago)");</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       msgSetAt        = q_("Set at %1 (%2 ago)");</td><td> </td><td class="right">       msgSetAt        = q_("Set at %1 (%2 ago)");</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       msgRisesAt      = q_("Rises at %1 (in %2)");</td><td> </td><td class="right">       msgRisesAt      = q_("Rises at %1 (in %2)");</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       msgCircumpolar  = q_("Circumpolar.");</td><td> </td><td class="right">       msgCircumpolar  = q_("Circumpolar.");</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       msgNoRise       = q_("No rise.");</td><td> </td><td class="right">       msgNoRise       = q_("No rise.");</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       msgCulminatesAt = q_("Culminates at %1 (in %2) at %3 deg.");</td><td> </td><td class="right">       msgCulminatesAt = q_("Culminates at %1 (in %2) at %3 deg.");</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       msgCulminatedAt = q_("Culminated at %1 (%2 ago) at %3 deg.");</td><td> </td><td class="right">       msgCulminatedAt = q_("Culminated at %1 (%2 ago) at %3 deg.");</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       msgSrcNotObs    = q_("Source is not observable.");</td><td> </td><td class="right">       msgSrcNotObs    = q_("Source is not observable.");</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0031" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       msgNoACRise     = q_("No <span class="delete">Acronychal</span> nor <span class="delete">Cosmical</span> rise/set.");</td><td> </td><td class="rblock">       msgNoACRise     = q_("No <span class="insert">acronychal</span> nor <span class="insert">cosmical</span> rise/set.");</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       msgGreatElong   = q_("Greatest elongation: <span class="delete">");</span></td><td> </td><td class="rblock">       msgGreatElong   = q_("Greatest elongation: <span class="insert">%1 (at %2 deg.)");</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       msgLargSSep     = q_("Largest Sun separation: <span class="delete">");</span></td><td> </td><td class="rblock">       msgLargSSep     = q_("Largest Sun separation: %1 <span class="insert">(at %2</span> deg.)");</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       msgAtDeg        = q_(" (at</span> %1 deg.)");</td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       msgNone         = q_("None");</td><td> </td><td class="right">       msgNone         = q_("None");</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0032" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       msgAcroRise     = q_("Acronychal <span class="delete">rise/set");</span></td><td> </td><td class="rblock">       <span class="insert">// TRANSLATORS: The space at the end is significant - another senten</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       msgNoAcroRise   = q_("No <span class="delete">Acronychal rise/set.");</span></td><td> </td><td class="rblock"><span class="insert">ce may follow.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       msgCosmRise     = q_("Cosmical <span class="delete">rise/set");</span></td><td> </td><td class="rblock">       msgAcroRise     = q_("Acronychal <span class="insert">rise/set: %1/%2. ");</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       msgNoCosmRise   = q_("No <span class="delete">Cosmical</span> rise/set.");</td><td> </td><td class="rblock"><span class="insert">       // TRANSLATORS: The space at the end is significant - another senten</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">ce may follow.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       msgNoAcroRise   = q_("No <span class="insert">acronychal rise/set. ");</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       msgCosmRise     = q_("Cosmical <span class="insert">rise/set: %1/%2.");</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       msgNoCosmRise   = q_("No <span class="insert">cosmical</span> rise/set.");</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       msgWholeYear    = q_("Observable during the whole year.");</td><td> </td><td class="right">       msgWholeYear    = q_("Observable during the whole year.");</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       msgNotObs       = q_("Not observable at dark night.");</td><td> </td><td class="right">       msgNotObs       = q_("Not observable at dark night.");</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0033" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       msgAboveHoriz   = q_("Nights above horizon: ");</td><td> </td><td class="rblock">       msgAboveHoriz   = q_("Nights above horizon: <span class="insert">%1</span>");</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       msgToday        = q_("TODAY:");</td><td> </td><td class="right">       msgToday        = q_("TODAY:");</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       msgThisYear     = q_("THIS YEAR:");</td><td> </td><td class="right">       msgThisYear     = q_("THIS YEAR:");</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0034" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       // TRANSLATORS: The space at the end is significant - another senten
ce may follow.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       msgPrevFullMoon = q_("Previous Full Moon: %1 %2 at %3:%4. ");</td><td> </td><td class="right">       msgPrevFullMoon = q_("Previous Full Moon: %1 %2 at %3:%4. ");</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       msgNextFullMoon = q_("Next Full Moon: %1 %2 at %3:%4. ");</td><td> </td><td class="right">       msgNextFullMoon = q_("Next Full Moon: %1 %2 at %3:%4. ");</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">double Observability::getCallOrder(StelModuleActionName actionName) const</td><td> </td><td class="right">double Observability::getCallOrder(StelModuleActionName actionName) const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0035" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       if (actionName==StelModule::ActionDraw)</td><td> </td><td class="rblock">       if (actionName==StelModule::ActionDraw)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               return StelApp::getInstance().getModuleMgr().getModule("Land</td><td> </td><td class="rblock">               return StelApp::getInstance().getModuleMgr().getModule("Land</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">scapeMgr")-&gt;getCallOrder(actionName)+10.;</td><td> </td><td class="rblock">scapeMgr")-&gt;getCallOrder(actionName)+10.;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       return 0;</td><td> </td><td class="rblock">       return 0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void Observability::init()</td><td> </td><td class="right">void Observability::init()</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0036" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">qDebug() &lt;&lt; "init called for Observability"</span>;</td><td> </td><td class="rblock">       <span class="insert">loadConfiguration()</span>;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0037" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">try</span></td><td> </td><td class="rblock">       <span class="insert">StelAction* actionShow = addAction("actionShow_Observability",</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       {</span></td><td> </td><td class="rblock"><span class="insert">                                          N_("Observability"),</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               StelGui* gui = <span class="delete">dynamic_cast&lt;StelGui*&gt;(StelApp::getInstance()</span></td><td> </td><td class="rblock"><span class="insert">                                          N_("Observability"),</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">.getGui());</span></td><td> </td><td class="rblock"><span class="insert">                                          "flagShowReport");</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               GlowIcon = new QPixmap(":/graphicGui/glow32x32.png");</span></td><td> </td><td class="rblock"><span class="insert">       // actionShow-&gt;setChecked(flagShowReport); //Unnecessary?</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               OnIcon = new QPixmap(":/observability/bt_observab_on.png");</span></td><td> </td><td class="rblock"><span class="insert">       addAction("actionShow_Observability_ConfigDialog",</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               OffIcon = new QPixmap(":/observability/bt_observab_off.png")</span></td><td> </td><td class="rblock"><span class="insert">                 N_("Observability"),</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">;</span></td><td> </td><td class="rblock"><span class="insert">                 N_("Observability configuration window"),</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"><span class="insert">                 configDialog, "visible");</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               gui-&gt;getGuiAction("actionShow_Observability")-&gt;setChecked(fl</span></td><td> </td><td class="rblock">                                                                           </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">agShowObservability);</span></td><td> </td><td class="rblock">       StelGui* gui = <span class="insert">dynamic_cast&lt;StelGui*&gt;(StelApp::getInstance().getGui(</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               toolbarButton</span> = new StelButton(NULL, <span class="delete">*OnIcon, *OffIcon, *Glo</span></td><td> </td><td class="rblock"><span class="insert">));</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">wIcon, gui-&gt;getGuiAction("actionShow_Observability"));</span></td><td> </td><td class="rblock"><span class="insert">       if (gui!=NULL)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               gui-&gt;getButtonBar()-&gt;addButton(toolbarButton, "065-pluginsGr</span></td><td> </td><td class="rblock"><span class="insert">       {</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">oup");</span></td><td> </td><td class="rblock"><span class="insert">               button</span> = new StelButton(NULL,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               connect(gui-&gt;getGuiAction("actionShow_Observability"), SIGNA</span></td><td> </td><td class="rblock">                                       <span class="insert">QPixmap(":/observability/bt_observab</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">L(toggled(bool)), this, SLOT(enableObservability(bool)));</span></td><td> </td><td class="rblock"><span class="insert">_on.png"),</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               connect(gui-&gt;getGuiAction("actionShow_Observability_ConfigDi</span></td><td> </td><td class="rblock"><span class="insert">                                       QPixmap(":/observability/bt_observab</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">alog"), SIGNAL(toggled(bool)), configDialog, SLOT(setVisible(bool)));</span></td><td> </td><td class="rblock"><span class="insert">_off.png"),</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               connect(configDialog, SIGNAL(visibleChanged(bool)), gui-&gt;get</span></td><td> </td><td class="rblock"><span class="insert">                                       QPixmap(":/graphicGui/glow32x32.png"</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">GuiAction("actionShow_Observability_ConfigDialog"), SLOT(setChecked(bool)))</span></td><td> </td><td class="rblock"><span class="insert">),</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">;</span></td><td> </td><td class="rblock"><span class="insert">                                       actionShow);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               gui-&gt;getButtonBar()-&gt;addButton(button, "065-pluginsGroup");</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0038" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">catch (std::exception &amp;e)</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       {</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               qWarning() &lt;&lt; "WARNING: unable create toolbar button for Obs</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">ervability plugin (or load gonfig GUI). " &lt;&lt; e.what();</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       };</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0039" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       updateMessageText();</td><td> </td><td class="rblock">       updateMessageText();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       connect(&amp;StelApp::getInstance(), SIGNAL(languageChanged()), this, <span class="delete">SL</span></td><td> </td><td class="rblock">       connect(&amp;StelApp::getInstance(), SIGNAL(languageChanged()),</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">OT(updateMessageText()));</span></td><td> </td><td class="rblock">               this, <span class="insert">SLOT(updateMessageText()));</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">/////////////////////////////////////////////</td><td> </td><td class="right">/////////////////////////////////////////////</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// MAIN CODE:</td><td> </td><td class="right">// MAIN CODE:</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0040" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">void Observability::draw(StelCore* core<span class="delete">, StelRenderer* renderer</span>)</td><td> </td><td class="rblock">void Observability::draw(StelCore* core)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0041" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                           </td><td> </td><td class="rblock">       if <span class="insert">(!flagShowReport)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       if <span class="delete">(!flagShowObservability)</span> return; // Button is off.</td><td> </td><td class="rblock">               return; // Button is off.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">/////////////////////////////////////////////////////////////////</td><td> </td><td class="right">/////////////////////////////////////////////////////////////////</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// PRELIMINARS:</td><td> </td><td class="right">// PRELIMINARS:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       bool locChanged, yearChanged;</td><td> </td><td class="right">       bool locChanged, yearChanged;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       StelObjectP selectedObject;</td><td> </td><td class="right">       StelObjectP selectedObject;</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0042" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">Planet* currPlanet;</span></td><td> </td><td class="rblock">       PlanetP <span class="insert">ssObject, parentPlanet;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       PlanetP <span class="delete">Object, parent;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Only execute plugin if we are on Earth.</td><td> </td><td class="right">// Only execute plugin if we are on Earth.</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0043" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       if (core-&gt;getCurrentLocation().planetName != "Earth") <span class="delete">{return;};</span></td><td> </td><td class="rblock">       if (core-&gt;getCurrentLocation().planetName != "Earth")</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">               <span class="insert">return;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Set the painter:</td><td> </td><td class="right">// Set the painter:</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0044" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">StelProjectorP projector = core-&gt;getProjection2d();</span></td><td> </td><td class="rblock">       <span class="insert">StelPainter painter(core-&gt;getProjection2d());</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       renderer-&gt;setGlobalColor(fontColor[0],fontColor[1],fontColor[2],1);</span></td><td> </td><td class="rblock"><span class="insert">       painter.setColor(fontColor[0],fontColor[1],fontColor[2],1);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       font.setPixelSize(fontSize);</td><td> </td><td class="right">       font.setPixelSize(fontSize);</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0045" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">renderer-&gt;</span>setFont(font);</td><td> </td><td class="rblock">       <span class="insert">painter.</span>setFont(font);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Get current date, location, and check if there is something selected.</td><td> </td><td class="right">// Get current date, location, and check if there is something selected.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double currlat = (core-&gt;getCurrentLocation().latitude)/Rad2Deg;</td><td> </td><td class="right">       double currlat = (core-&gt;getCurrentLocation().latitude)/Rad2Deg;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double currlon = (core-&gt;getCurrentLocation().longitude)/Rad2Deg;</td><td> </td><td class="right">       double currlon = (core-&gt;getCurrentLocation().longitude)/Rad2Deg;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double currheight = (6371.+(core-&gt;getCurrentLocation().altitude)/100
0.)/UA;</td><td> </td><td class="right">       double currheight = (6371.+(core-&gt;getCurrentLocation().altitude)/100
0.)/UA;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double currJD = core-&gt;getJDay();</td><td> </td><td class="right">       double currJD = core-&gt;getJDay();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double currJDint;</td><td> </td><td class="right">       double currJDint;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//     GMTShift = StelUtils::getGMTShiftFromQT(currJD)/24.0;</td><td> </td><td class="right">//     GMTShift = StelUtils::getGMTShiftFromQT(currJD)/24.0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       GMTShift = StelApp::getInstance().getLocaleMgr().getGMTShift(currJD)
/24.0;</td><td> </td><td class="right">       GMTShift = StelApp::getInstance().getLocaleMgr().getGMTShift(currJD)
/24.0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//     qDebug() &lt;&lt; QString("%1%2 ").arg(GMTShift);</td><td> </td><td class="right">//     qDebug() &lt;&lt; QString("%1%2 ").arg(GMTShift);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double currLocalT = 24.*modf(currJD + GMTShift,&amp;currJDint);</td><td> </td><td class="right">       double currLocalT = 24.*modf(currJD + GMTShift,&amp;currJDint);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       int auxm, auxd, auxy;</td><td> </td><td class="right">       int auxm, auxd, auxy;</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0046" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       StelUtils::getDateFromJulianDay(currJD,<span class="delete">&amp;auxy,&amp;auxm,</span>&amp;auxd);</td><td> </td><td class="rblock">       StelUtils::getDateFromJulianDay(currJD,<span class="insert"> &amp;auxy, &amp;auxm, </span>&amp;auxd);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       bool isSource = StelApp::getInstance().getStelObjectMgr().getWasSele
cted();</td><td> </td><td class="right">       bool isSource = StelApp::getInstance().getStelObjectMgr().getWasSele
cted();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       bool show_Year = show_Best_Night || show_Good_Nights || show_AcroCos
;</td><td> </td><td class="right">       bool show_Year = show_Best_Night || show_Good_Nights || show_AcroCos
;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//////////////////////////////////////////////////////////////////</td><td> </td><td class="right">//////////////////////////////////////////////////////////////////</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//////////////////////////////////////////////////////////////////</td><td> </td><td class="right">//////////////////////////////////////////////////////////////////</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// NOW WE CHECK THE CHANGED PARAMETERS W.R.T. THE PREVIOUS FRAME:</td><td> </td><td class="right">// NOW WE CHECK THE CHANGED PARAMETERS W.R.T. THE PREVIOUS FRAME:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Update JD.</td><td> </td><td class="right">// Update JD.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       myJD = currJD;</td><td> </td><td class="right">       myJD = currJD;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0047" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">// If <span class="delete">we have changed</span> the <span class="delete">year,</span> we must recompute the Sun's position for <span class="delete">ea</span></td><td> </td><td class="rblock">// If the <span class="insert">year changed,</span> we must recompute the Sun's position for <span class="insert">each</span> new <span class="insert">d</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">ch</span> new <span class="delete">day:</span></td><td> </td><td class="rblock"><span class="insert">ay:</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       if (auxy != <span class="delete">currYear)</span> {</td><td> </td><td class="rblock">       if (auxy != <span class="insert">curYear)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               yearChanged = true;</td><td> </td><td class="right">               yearChanged = true;</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0048" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               <span class="delete">currYear</span> = auxy;</td><td> </td><td class="rblock">               <span class="insert">curYear</span> = auxy;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               <span class="delete">SunRADec(core);}</span></td><td> </td><td class="rblock">               <span class="insert">updateSunData(core);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       else {</td><td> </td><td class="rblock"><span class="insert">       }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       else</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               yearChanged = false;</td><td> </td><td class="right">               yearChanged = false;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       };</td><td> </td><td class="right">       };</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Have we changed the latitude or longitude?</td><td> </td><td class="right">// Have we changed the latitude or longitude?</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0049" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       if (currlat == mylat &amp;&amp; currlon == mylon) {</td><td> </td><td class="rblock">       if (currlat == mylat &amp;&amp; currlon == mylon)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               locChanged = <span class="delete">false;}</span></td><td> </td><td class="rblock">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       else {</td><td> </td><td class="rblock">               locChanged = <span class="insert">false;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       else</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               locChanged = true;</td><td> </td><td class="right">               locChanged = true;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               mylat = currlat; mylon = currlon;</td><td> </td><td class="right">               mylat = currlat; mylon = currlon;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               double temp1 = currheight*std::cos(currlat);</td><td> </td><td class="right">               double temp1 = currheight*std::cos(currlat);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               ObserverLoc[0] = temp1*std::cos(currlon);</td><td> </td><td class="right">               ObserverLoc[0] = temp1*std::cos(currlon);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               ObserverLoc[1] = temp1*std::sin(currlon);</td><td> </td><td class="right">               ObserverLoc[1] = temp1*std::sin(currlon);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               ObserverLoc[2] = currheight*std::sin(currlat);</td><td> </td><td class="right">               ObserverLoc[2] = currheight*std::sin(currlat);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       };</td><td> </td><td class="right">       };</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Add refraction, if necessary:</td><td> </td><td class="right">// Add refraction, if necessary:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       Vec3d TempRefr;</td><td> </td><td class="right">       Vec3d TempRefr;</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0050" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       TempRefr[0] = std::cos(<span class="delete">HorizAlti</span>);</td><td> </td><td class="rblock">       TempRefr[0] = std::cos(<span class="insert">horizonAltitude</span>);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       TempRefr[1] = 0.0;</td><td> </td><td class="right">       TempRefr[1] = 0.0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0051" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       TempRefr[2] = std::sin(<span class="delete">HorizAlti</span>);</td><td> </td><td class="rblock">       TempRefr[2] = std::sin(<span class="insert">horizonAltitude</span>);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       Vec3d CorrRefr = core-&gt;altAzToEquinoxEqu(TempRefr,StelCore::Refracti
onAuto);</td><td> </td><td class="right">       Vec3d CorrRefr = core-&gt;altAzToEquinoxEqu(TempRefr,StelCore::Refracti
onAuto);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       TempRefr = core-&gt;equinoxEquToAltAz(CorrRefr,StelCore::RefractionOff)
;</td><td> </td><td class="right">       TempRefr = core-&gt;equinoxEquToAltAz(CorrRefr,StelCore::RefractionOff)
;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double RefracAlt = std::asin(TempRefr[2]);</td><td> </td><td class="right">       double RefracAlt = std::asin(TempRefr[2]);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0052" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">if (std::abs(RefracHoriz-RefracAlt)&gt;2.91e-4)</span>  // <span class="delete">Diference</span> larger <span class="delete">th</span></td><td> </td><td class="rblock">       // <span class="insert">If the diference is</span> larger <span class="insert">than</span> 1 <span class="insert">arcminute...</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">an</span> 1 <span class="delete">arcminute.</span></td><td> </td><td class="rblock"><span class="insert">       if (std::abs(refractedHorizonAlt-RefracAlt)&gt;2.91e-4)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       {   <span class="delete">// Configuration</span> for refraction changed <span class="delete">notably:</span></td><td> </td><td class="rblock">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               RefracHoriz</span> = RefracAlt;</td><td> </td><td class="rblock">               <span class="insert">//... configuration</span> for refraction changed <span class="insert">notably.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               refractedHorizonAlt</span> = RefracAlt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               configChanged = true;</td><td> </td><td class="right">               configChanged = true;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               souChanged = true;</td><td> </td><td class="right">               souChanged = true;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       };</td><td> </td><td class="right">       };</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// If we have changed latitude (or year), we update the vector of Sun's hou
r</td><td> </td><td class="right">// If we have changed latitude (or year), we update the vector of Sun's hou
r</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// angles at twilight, and re-compute Sun/Moon ephemeris (if selected):</td><td> </td><td class="right">// angles at twilight, and re-compute Sun/Moon ephemeris (if selected):</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (locChanged || yearChanged || configChanged)</td><td> </td><td class="right">       if (locChanged || yearChanged || configChanged)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0053" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               <span class="delete">SunHTwi</span>();</td><td> </td><td class="rblock">               <span class="insert">updateSunH</span>();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               lastJDMoon = 0.0;</td><td> </td><td class="right">               lastJDMoon = 0.0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       };</td><td> </td><td class="right">       };</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//////////////////////////////////////////////////////////////////</td><td> </td><td class="right">//////////////////////////////////////////////////////////////////</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//////////////////////////////////////////////////////////////////</td><td> </td><td class="right">//////////////////////////////////////////////////////////////////</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// NOW WE DEAL WITH THE SOURCE (OR SCREEN-CENTER) POSITION:</td><td> </td><td class="right">// NOW WE DEAL WITH THE SOURCE (OR SCREEN-CENTER) POSITION:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0054" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       if (isScreen) <span class="delete">souChanged=true;</span> // Always re-compute everything for <span class="delete">t</span></td><td> </td><td class="rblock">       if (isScreen) // Always re-compute everything for <span class="insert">the</span> screen center.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">he</span> screen center.</td><td> </td><td class="rblock">               <span class="insert">souChanged = true;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0055" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       if (isSource) <span class="delete">{</span> // There is something selected!</td><td> </td><td class="rblock">       if (isSource) // There is something selected!</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       <span class="insert">{</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Get the selected source and its name:</td><td> </td><td class="right">// Get the selected source and its name:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               selectedObject = StelApp::getInstance().getStelObjectMgr().g
etSelectedObject()[0];</td><td> </td><td class="right">               selectedObject = StelApp::getInstance().getStelObjectMgr().g
etSelectedObject()[0];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Don't do anything for satellites:</td><td> </td><td class="right">// Don't do anything for satellites:</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0056" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               <span class="delete">if(selectedObject-&gt;getType()==</span> "Satellite") return;</td><td> </td><td class="rblock">               <span class="insert">if(selectedObject-&gt;getType() ==</span> "Satellite")</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                           </td><td> </td><td class="rblock">                       return;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               <span class="delete">QString tempName = selectedObject-&gt;getEnglishName();</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0057" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">// Check if the source is Sun or Moon (i.e., it changes quite a bit during </span></td><td> </td><td class="rblock">               <span class="insert">QString name = selectedObject-&gt;getEnglishName();</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">one day):</span></td><td> </td><td class="rblock">               isMoon = ("Moon" == <span class="insert">name);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               isMoon = ("Moon" == <span class="delete">tempName)?true:false;</span></td><td> </td><td class="rblock">               isSun = ("Sun" == <span class="insert">name);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               isSun = ("Sun" == <span class="delete">tempName)?true:false;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// If Moon is not selected (or was unselected), force re-compute of Full Mo
on next time it is selected:</td><td> </td><td class="right">// If Moon is not selected (or was unselected), force re-compute of Full Mo
on next time it is selected:</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0058" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               if (!isMoon) <span class="delete">{prevFullMoon=0.0; nextFullMoon=0.0;};</span></td><td> </td><td class="rblock">               if (!isMoon)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">               <span class="insert">{</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       prevFullMoon = 0.0;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       nextFullMoon = 0.0;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               };</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//Update position:</td><td> </td><td class="right">//Update position:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               EquPos = selectedObject-&gt;getEquinoxEquatorialPos(core);</td><td> </td><td class="right">               EquPos = selectedObject-&gt;getEquinoxEquatorialPos(core);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               EquPos.normalize();</td><td> </td><td class="right">               EquPos.normalize();</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0059" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               LocPos = core-&gt;equinoxEquToAltAz(EquPos,<span class="delete">StelCore::Refraction
</span>Off);</td><td> </td><td class="rblock">               LocPos = core-&gt;equinoxEquToAltAz(EquPos,<span class="insert"> StelCore::Refractio
n</span>Off);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Check if the user has changed the source (or if the source is Sun/Moon).</td><td> </td><td class="right">// Check if the user has changed the source (or if the source is Sun/Moon).</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0060" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               if (<span class="delete">tempN</span>ame == selName)</td><td> </td><td class="rblock">               if (<span class="insert">n</span>ame == selName)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0061" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       souChanged = <span class="delete">false;}</span></td><td> </td><td class="rblock">                       souChanged = <span class="insert">false;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               else</td><td> </td><td class="right">               else</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               { // Check also if the (new) source belongs to the Solar Sys
tem:</td><td> </td><td class="right">               { // Check also if the (new) source belongs to the Solar Sys
tem:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       souChanged = true;</td><td> </td><td class="right">                       souChanged = true;</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0062" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       selName = <span class="delete">tempN</span>ame;</td><td> </td><td class="rblock">                       selName = <span class="insert">n</span>ame;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0063" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       <span class="delete">currPlanet</span> = <span class="delete">dynamic_cast&lt;Planet*&gt;(selectedObject.da</span></td><td> </td><td class="rblock">                       <span class="insert">Planet* planet</span> = <span class="insert">dynamic_cast&lt;Planet*&gt;(selectedObjec</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">ta());</span></td><td> </td><td class="rblock"><span class="insert">t.data());</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       isStar = <span class="delete">(currPlanet)?false:true;</span></td><td> </td><td class="rblock">                       isStar = <span class="insert">(planet == NULL);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       if (!isStar &amp;&amp; !isMoon &amp;&amp; !isSun)  // Object in the 
Solar System, but is not Sun nor Moon.</td><td> </td><td class="right">                       if (!isStar &amp;&amp; !isMoon &amp;&amp; !isSun)  // Object in the 
Solar System, but is not Sun nor Moon.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       {</td><td> </td><td class="right">                       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               int gene = -1;</td><td> </td><td class="right">                               int gene = -1;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       // If object is a planet's moon, we get its parent p
lanet:</td><td> </td><td class="right">                       // If object is a planet's moon, we get its parent p
lanet:</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0064" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                               <span class="delete">Object</span> = <span class="delete">GETSTELMODULE(SolarSystem)-&gt;searchB</span></td><td> </td><td class="rblock">                               <span class="insert">ssObject</span> = <span class="insert">GETSTELMODULE(SolarSystem)-&gt;searc</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">yEnglishName(selName);</span></td><td> </td><td class="rblock"><span class="insert">hByEnglishName(selName);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                               // TODO: Isn't it easier just to use the pla</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">net object we just cast? --BM</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0065" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                               <span class="delete">parent</span> = <span class="delete">Object-&gt;getParent();</span></td><td> </td><td class="rblock">                               <span class="insert">parentPlanet</span> = <span class="insert">ssObject-&gt;getParent();</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                           </td><td> </td><td class="rblock">                               if <span class="insert">(parentPlanet)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                               if <span class="delete">(parent)</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               {</td><td> </td><td class="right">                               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0066" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                       while <span class="delete">(parent)</span> {</td><td> </td><td class="rblock">                                       while <span class="insert">(parentPlanet)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                       gene += 1;</td><td> </td><td class="rblock">                                       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                       <span class="delete">parent</span> = <span class="delete">parent-&gt;getParent();}</span></td><td> </td><td class="rblock">                                               gene += 1;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                                       };</span></td><td> </td><td class="rblock">                                               <span class="insert">parentPlanet</span> = <span class="insert">parentPlanet-</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                       for (int g=0; <span class="delete">g&lt;gene;g++)</span> {</td><td> </td><td class="rblock"><span class="insert">&gt;getParent();</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                       <span class="delete">Object</span> = <span class="delete">Object-&gt;getParent();</span></td><td> </td><td class="rblock"><span class="insert">                                       }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                               };</span></td><td> </td><td class="rblock"><span class="insert">                               }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                               for (int g=0; <span class="insert">g&lt;gene; g++)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                                       <span class="insert">ssObject</span> = <span class="insert">ssObject-&gt;getParent();</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                               }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       // Now get a pointer to the planet's instance:</td><td> </td><td class="right">                       // Now get a pointer to the planet's instance:</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0067" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                               myPlanet = <span class="delete">Object.data();</span></td><td> </td><td class="rblock">                               myPlanet = <span class="insert">ssObject.data();</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                       };</span></td><td> </td><td class="rblock"><span class="insert">                       }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"><span class="insert">               }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               };</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0068" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       else <span class="delete">{</span> // There is no source selected!</td><td> </td><td class="rblock">       else // There is no source selected!</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                           </td><td> </td><td class="rblock">       <span class="insert">{</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">// If no source is selected, get the position vector of the screen <span class="delete">center:</span></td><td> </td><td class="rblock">       // If no source is selected, get the position vector of the screen <span class="insert">c</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               selName</span> = <span class="delete">""; isStar=true;</span> isMoon = false; isSun = false; <span class="delete">is</span></td><td> </td><td class="rblock"><span class="insert">enter:</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">Screen=true;</span></td><td> </td><td class="rblock"><span class="insert">               selName.clear();</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               isStar</span> = <span class="insert">true;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">               isMoon = false;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">               isSun = false;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">               <span class="insert">isScreen = true;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               Vec3d currentPos = GETSTELMODULE(StelMovementMgr)-&gt;getViewDi
rectionJ2000();</td><td> </td><td class="right">               Vec3d currentPos = GETSTELMODULE(StelMovementMgr)-&gt;getViewDi
rectionJ2000();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               currentPos.normalize();</td><td> </td><td class="right">               currentPos.normalize();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               EquPos = core-&gt;j2000ToEquinoxEqu(currentPos);</td><td> </td><td class="right">               EquPos = core-&gt;j2000ToEquinoxEqu(currentPos);</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0069" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               LocPos = core-&gt;j2000ToAltAz(currentPos,<span class="delete">StelCore::RefractionO
</span>ff);</td><td> </td><td class="rblock">               LocPos = core-&gt;j2000ToAltAz(currentPos,<span class="insert"> StelCore::Refraction
O</span>ff);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Convert EquPos to RA/Dec:</td><td> </td><td class="right">// Convert EquPos to RA/Dec:</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0070" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       toRADec(EquPos,<span class="delete">selRA,</span>selDec);</td><td> </td><td class="rblock">       toRADec(EquPos,<span class="insert"> selRA, </span>selDec);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Compute source's altitude (in radians):</td><td> </td><td class="right">// Compute source's altitude (in radians):</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       alti = std::asin(LocPos[2]);</td><td> </td><td class="right">       alti = std::asin(LocPos[2]);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Force re-computation of ephemeris if the location changes or the user ch
anges the configuration:</td><td> </td><td class="right">// Force re-computation of ephemeris if the location changes or the user ch
anges the configuration:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (locChanged || configChanged)</td><td> </td><td class="right">       if (locChanged || configChanged)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               souChanged=true;</td><td> </td><td class="right">               souChanged=true;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               configChanged=false;</td><td> </td><td class="right">               configChanged=false;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       };</td><td> </td><td class="right">       };</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">/////////////////////////////////////////////////////////////////</td><td> </td><td class="right">/////////////////////////////////////////////////////////////////</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">/////////////////////////////////////////////////////////////////</td><td> </td><td class="right">/////////////////////////////////////////////////////////////////</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// NOW WE COMPUTE RISE/SET/TRANSIT TIMES FOR THE CURRENT DAY:</td><td> </td><td class="right">// NOW WE COMPUTE RISE/SET/TRANSIT TIMES FOR THE CURRENT DAY:</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0071" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       double currH = <span class="delete">HourAngle(mylat,alti,selDec);</span></td><td> </td><td class="rblock">       double currH = <span class="insert">calculateHourAngle(mylat,alti,selDec);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       horizH = <span class="delete">HourAngle(mylat,RefracHoriz,selDec);</span></td><td> </td><td class="rblock">       horizH = <span class="insert">calculateHourAngle(mylat,refractedHorizonAlt,selDec);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       QString RS1, RS2, Cul; // strings with Rise/Set/Culmination times</td><td> </td><td class="right">       QString RS1, RS2, Cul; // strings with Rise/Set/Culmination times</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0072" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       double <span class="delete">Rise, Set; // Actual Rise/Set times (in</span> GMT).</td><td> </td><td class="rblock">       double <span class="insert">risingTime = 0, settingTime = 0; // Actual Rise/Set times (in
</span> GMT).</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       int d1,m1,s1,d2,m2,s2,dc,mc,sc; // Integers for the time spans in hh
:mm:ss.</td><td> </td><td class="right">       int d1,m1,s1,d2,m2,s2,dc,mc,sc; // Integers for the time spans in hh
:mm:ss.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       bool solvedMoon = false; // Check if solutions were found for Sun, M
oon, or planet.</td><td> </td><td class="right">       bool solvedMoon = false; // Check if solutions were found for Sun, M
oon, or planet.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       bool transit = false; // Is the source above the horizon? Did it cul
minate?</td><td> </td><td class="right">       bool transit = false; // Is the source above the horizon? Did it cul
minate?</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       int ephHour, ephMinute, ephSecond;  // Local time for selected ephem
eris</td><td> </td><td class="right">       int ephHour, ephMinute, ephSecond;  // Local time for selected ephem
eris</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0073" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       if (show_Today) {  // <span class="delete">We show</span> ephemeris <span class="delete">for today (i.e., rise,</span> set, </td><td> </td><td class="rblock">       if (show_Today)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">and transit <span class="delete">times).</span></td><td> </td><td class="rblock">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                           </td><td> </td><td class="rblock">               // <span class="insert">Today's</span> ephemeris <span class="insert">(rise,</span> set, and transit <span class="insert">times)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               if (!isStar)</td><td> </td><td class="right">               if (!isStar)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0074" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       int <span class="delete">Kind</span> = <span class="delete">(isSun)?1:0;  // Set "Kind" according to </span></td><td> </td><td class="rblock">                       int <span class="insert">type</span> = <span class="insert">(isSun) ? 1:0;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">the selected object.</span></td><td> </td><td class="rblock"><span class="insert">                       type</span> += <span class="insert">(isMoon) ? 2:0;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                       Kind</span> += <span class="delete">(isMoon)?2:0; Kind</span> += (!isSun &amp;&amp; <span class="delete">!isMoon)?3:</span></td><td> </td><td class="rblock"><span class="insert">                       type</span> += (!isSun &amp;&amp; <span class="insert">!isMoon) ? 3:0;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">0;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0075" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       <span class="delete">solvedMoon = SolarSystemSolve(core, Kind);</span>  // <span class="delete">False</span></td><td> </td><td class="rblock">                       // <span class="insert">Returns false</span> if <span class="insert">the calculation fails...</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"> if <span class="delete">fails; True otherwise.</span></td><td> </td><td class="rblock"><span class="insert">                       solvedMoon = calculateSolarSystemEvents(core, type);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       currH = std::abs(24.*(MoonCulm-myJD)/TFrac);</td><td> </td><td class="right">                       currH = std::abs(24.*(MoonCulm-myJD)/TFrac);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       transit = MoonCulm-myJD&lt;0.0;</td><td> </td><td class="right">                       transit = MoonCulm-myJD&lt;0.0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0076" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       if (solvedMoon) {  // If failed, Set and Rise will <span class="delete">b</span></td><td> </td><td class="rblock">                       if (solvedMoon)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">e dummy.</span></td><td> </td><td class="rblock">                       {  // If failed, Set and Rise will be <span class="insert">dummy.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                               Set = std::abs(24.*(MoonSet-myJD)/TFrac);</span></td><td> </td><td class="rblock"><span class="insert">                               settingTime</span> = <span class="insert">std::abs(24.*(MoonSet-myJD)/TF</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                               Rise = std::abs(24.*(MoonRise-myJD)/TFrac);</span></td><td> </td><td class="rblock"><span class="insert">rac);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                       };</span></td><td> </td><td class="rblock"><span class="insert">                               risingTime</span> = <span class="insert">std::abs(24.*(MoonRise-myJD)/TF</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               } else if (horizH&gt;0.0) { // The source is not circumpolar an</span></td><td> </td><td class="rblock"><span class="insert">rac);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">d can</span> be <span class="delete">seen from this latitude.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                       if ( LocPos[1]&gt;0.0 ) {  // The source is at the east</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">ern side...</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                               if ( currH&gt;horizH ) {  // ... and below the </span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">horizon.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                                       Set = 24.-currH-horizH;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                                       Rise = currH-horizH;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                                       raised = false;}</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                               else { // ... and above the horizon.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                                       Rise = horizH-currH;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                                       Set</span> = <span class="delete">2.*horizH-Rise;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                                       raised</span> = <span class="delete">true;};</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       }</td><td> </td><td class="right">                       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0077" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       else { // The source is <span class="delete">at the western side...</span></td><td> </td><td class="rblock">               <span class="insert">}</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                               if ( currH&gt;horizH ) { // ... and below the h</span></td><td> </td><td class="rblock">               else <span class="insert">if (horizH&gt;0.0)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">orizon.</span></td><td> </td><td class="rblock">               { // The source is <span class="insert">not circumpolar</span> and <span class="insert">can be seen from this</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                                       Set = currH-horizH;</span></td><td> </td><td class="rblock"><span class="insert"> latitude.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                                       Rise = 24.-currH-horizH;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                                       raised = false;}</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                               else { // ...</span> and <span class="delete">above the horizon.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                                       Rise = horizH+currH;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                                       Set = horizH-currH;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                                       raised = true;};</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                       };</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0078" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               <span class="delete">};</span></td><td> </td><td class="rblock">                       <span class="insert">if ( LocPos[1]&gt;0.0 ) // The source is at the eastern</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"> side...</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       {</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                               if ( currH&gt;horizH ) // ... and below the hor</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">izon.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                               {</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                                       settingTime = 24.-currH-horizH;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                                       risingTime = currH-horizH;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                                       hasRisen = false;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                               }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                               else  // ... and above the horizon.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                               {</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                                       risingTime = horizH-currH;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                                       settingTime = 2.*horizH-risingTime;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                                       hasRisen = true;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                               }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       else // The source is at the western side...</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       {</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                               if ( currH&gt;horizH ) // ... and below the hor</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">izon.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                               {</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                                       settingTime = currH-horizH;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                                       risingTime = 24.-currH-horizH;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                                       hasRisen = false;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                               }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                               else // ... and above the horizon.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                               {</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                                       risingTime = horizH+currH;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                                       settingTime = horizH-currH;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                                       hasRisen = true;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                               }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               if ((solvedMoon &amp;&amp; MoonRise&gt;0.0) || (!isSun &amp;&amp; !isMoon &amp;&amp; ho
rizH&gt;0.0))</td><td> </td><td class="right">               if ((solvedMoon &amp;&amp; MoonRise&gt;0.0) || (!isSun &amp;&amp; !isMoon &amp;&amp; ho
rizH&gt;0.0))</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0079" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       <span class="delete">double2hms(TFrac*Set,d1,m1,s1);</span></td><td> </td><td class="rblock">                       <span class="insert">double2hms(TFrac*settingTime, d1, m1, s1);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                       double2hms(TFrac*Rise,d2,m2,s2);</span></td><td> </td><td class="rblock"><span class="insert">                       double2hms(TFrac*risingTime, d2, m2, s2);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0080" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">//             Strings with time spans for <span class="delete">rise/set/transit:</span></td><td> </td><td class="rblock">                       //              Strings with time spans for <span class="insert">rise/set</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       RS1 = (d1==0)?"":QString("%1%2 ").arg(d1).arg(msgH);</td><td> </td><td class="rblock"><span class="insert">/transit:</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"> RS1 += (m1==0)?"":QString("%1%2 <span class="delete">").arg(m1).arg(msgM);</span> RS1 += <span class="delete">QString("%1%2</span></td><td> </td><td class="rblock">                       RS1 = (d1==0)?"":QString("%1%2 ").arg(d1).arg(msgH);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">").arg(s1).arg(msgS);</span></td><td> </td><td class="rblock">                       RS1 += (m1==0)?"":QString("%1%2 <span class="insert">").arg(m1).arg(msgM)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       RS2 = (d2==0)?"":QString("%1%2 ").arg(d2).arg(msgH);</td><td> </td><td class="rblock"><span class="insert">;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"> RS2 += (m2==0)?"":QString("%1%2 <span class="delete">").arg(m2).arg(msgM);</span> RS2 += <span class="delete">QString("%1%2</span></td><td> </td><td class="rblock">                       RS1 += <span class="insert">QString("%1%2").arg(s1).arg(msgS);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">").arg(s2).arg(msgS);</span></td><td> </td><td class="rblock">                       RS2 = (d2==0)?"":QString("%1%2 ").arg(d2).arg(msgH);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       if <span class="delete">(raised)</span></td><td> </td><td class="rblock">                       RS2 += (m2==0)?"":QString("%1%2 <span class="insert">").arg(m2).arg(msgM)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                       RS2 += <span class="insert">QString("%1%2").arg(s2).arg(msgS);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                       if <span class="insert">(hasRisen)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       {</td><td> </td><td class="right">                       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0081" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                <span class="delete">double2hms(toUnsignedRA(currLocalT+TFrac*Se</span></td><td> </td><td class="rblock">                               <span class="insert">double2hms(toUnsignedRA(currLocalT+TFrac*set</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">t+12.),ephHour,ephMinute,ephSecond);</span></td><td> </td><td class="rblock"><span class="insert">tingTime+12.),</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                               SetTime = QString("%1:%2").arg(ephHour).arg(</td><td> </td><td class="rblock"><span class="insert">                                          ephHour, ephMinute, ephSecond);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">ephMinute,2,10,QLatin1Char('0'));</span> // Local time for set.</td><td> </td><td class="rblock">                               SetTime = QString("%1:%2").arg(ephHour).arg(</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">ephMinute,2,10,QChar('0'));</span> // Local time for set.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0082" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                <span class="delete">double2hms(toUnsignedRA(currLocalT-TFrac*Ri</span></td><td> </td><td class="rblock">                               <span class="insert">double2hms(toUnsignedRA(currLocalT-TFrac*ris</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">se+12.),ephHour,ephMinute,ephSecond); //</span> Local time for rise.</td><td> </td><td class="rblock"><span class="insert">ingTime+12.),</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                                          ephHour, ephMinute, ephSecond); /</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">/</span> Local time for rise.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               RiseTime = QString("%1:%2").arg(ephHour).arg
(ephMinute,2,10,QLatin1Char('0'));</td><td> </td><td class="right">                               RiseTime = QString("%1:%2").arg(ephHour).arg
(ephMinute,2,10,QLatin1Char('0'));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               //RS1 = q_("Sets at %1 (in %2)").arg(SetTime
).arg(RS1);</td><td> </td><td class="right">                               //RS1 = q_("Sets at %1 (in %2)").arg(SetTime
).arg(RS1);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               //RS2 = q_("Rose at %1 (%2 ago)").arg(RiseTi
me).arg(RS2);</td><td> </td><td class="right">                               //RS2 = q_("Rose at %1 (%2 ago)").arg(RiseTi
me).arg(RS2);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               RS1 = msgSetsAt.arg(SetTime).arg(RS1);</td><td> </td><td class="right">                               RS1 = msgSetsAt.arg(SetTime).arg(RS1);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               RS2 = msgRoseAt.arg(RiseTime).arg(RS2);</td><td> </td><td class="right">                               RS2 = msgRoseAt.arg(RiseTime).arg(RS2);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       }</td><td> </td><td class="right">                       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       else</td><td> </td><td class="right">                       else</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       {</td><td> </td><td class="right">                       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0083" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                <span class="delete">double2hms(toUnsignedRA(currLocalT-TFrac*Se</span></td><td> </td><td class="rblock">                               <span class="insert">double2hms(toUnsignedRA(currLocalT-TFrac*set</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">t+12.),ephHour,ephMinute,ephSecond);</span></td><td> </td><td class="rblock"><span class="insert">tingTime+12.),</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                                          ephHour, ephMinute, ephSecond);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               SetTime = QString("%1:%2").arg(ephHour).arg(
ephMinute,2,10,QLatin1Char('0'));</td><td> </td><td class="right">                               SetTime = QString("%1:%2").arg(ephHour).arg(
ephMinute,2,10,QLatin1Char('0'));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0084" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                <span class="delete">double2hms(toUnsignedRA(currLocalT+TFrac*Ri</span></td><td> </td><td class="rblock">                               <span class="insert">double2hms(toUnsignedRA(currLocalT+TFrac*ris</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">se+12.),ephHour,ephMinute,ephSecond);</span></td><td> </td><td class="rblock"><span class="insert">ingTime+12.),</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                                          ephHour, ephMinute, ephSecond);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               RiseTime = QString("%1:%2").arg(ephHour).arg
(ephMinute,2,10,QLatin1Char('0'));</td><td> </td><td class="right">                               RiseTime = QString("%1:%2").arg(ephHour).arg
(ephMinute,2,10,QLatin1Char('0'));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               //RS1 = q_("Set at %1 (%2 ago)").arg(SetTime
).arg(RS1);</td><td> </td><td class="right">                               //RS1 = q_("Set at %1 (%2 ago)").arg(SetTime
).arg(RS1);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               //RS2 = q_("Rises at %1 (in %2)").arg(RiseTi
me).arg(RS2);</td><td> </td><td class="right">                               //RS2 = q_("Rises at %1 (in %2)").arg(RiseTi
me).arg(RS2);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               RS1 = msgSetAt.arg(SetTime).arg(RS1);</td><td> </td><td class="right">                               RS1 = msgSetAt.arg(SetTime).arg(RS1);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               RS2 = msgRisesAt.arg(RiseTime).arg(RS2);</td><td> </td><td class="right">                               RS2 = msgRisesAt.arg(RiseTime).arg(RS2);</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0085" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       }<span class="delete">;</span></td><td> </td><td class="rblock">                       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0086" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               else <span class="delete">{</span> // The source is either circumpolar or never rises:</td><td> </td><td class="rblock">               else // The source is either circumpolar or never rises:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       <span class="delete">(alti&gt;RefracHoriz)?</span> RS1 = msgCircumpolar: <span class="delete">RS1</span> = <span class="delete">msgN</span></td><td> </td><td class="rblock">               <span class="insert">{</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">oRise;</span></td><td> </td><td class="rblock"><span class="insert">                       (alti&gt;refractedHorizonAlt)?</span> RS1 = msgCircumpolar: <span class="insert">RS</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">1</span> = <span class="insert">msgNoRise;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       RS2 = "";</td><td> </td><td class="right">                       RS2 = "";</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               };</td><td> </td><td class="right">               };</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0087" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">//</span>     Culmination:</td><td> </td><td class="rblock"><span class="insert">               // </span>     Culmination:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0088" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       if (isStar)</td><td> </td><td class="rblock">               if (isStar)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">{</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               culmAlt = std::abs(mylat-selDec); // 90.-altitude at transit</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               transit = LocPos[1]&lt;0.0;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       };</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       if (culmAlt&lt;halfpi-RefracHoriz) { // Source can be observed.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               double altiAtCulmi = Rad2Deg*(halfpi-culmAlt-RefracHoriz);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               double2hms(TFrac*currH,dc,mc,sc);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">//             String with the time span for culmination:</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               Cul = (dc==0)?"":QString("%1%2 ").arg(dc).arg(msgH); Cul += </span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">(mc==0)?"":QString("%1%2 ").arg(mc).arg(msgM); Cul += QString("%1%2").arg(s</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">c).arg(msgS);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               if (transit==false) {</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                        double2hms(toUnsignedRA(currLocalT+TFrac*currH+12.)</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">,ephHour,ephMinute,ephSecond); // Local time at transit.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                       CulmTime = QString("%1:%2").arg(ephHour).arg(ephMinu</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">te,2,10,QLatin1Char('0'));</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                       //Cul = q_("Culminates at %1 (in %2) at %3 deg.").ar</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">g(CulmTime).arg(Cul).arg(altiAtCulmi,0,'f',1);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                       Cul = msgCulminatesAt.arg(CulmTime).arg(Cul).arg(alt</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">iAtCulmi,0,'f',1);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               }</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               else</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0089" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                        <span class="delete">double2hms(toUnsignedRA(currLocalT-TFrac*currH+12.)</span></td><td> </td><td class="rblock">                       <span class="insert">culmAlt</span> = <span class="insert">std::abs(mylat-selDec); // 90.-altitude</span> at</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">,ephHour,ephMinute,ephSecond);</span></td><td> </td><td class="rblock"> <span class="insert">transit.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                       CulmTime</span> = <span class="delete">QString("%1:%2").arg(ephHour).arg(ephMinu</span></td><td> </td><td class="rblock"><span class="insert">                       transit</span> = <span class="insert">LocPos[1]&lt;0.0;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">te,2,10,QLatin1Char('0'));</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                       //Cul = q_("Culminated at %1 (%2 ago)</span> at <span class="delete">%3 deg.").a</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">rg(CulmTime).arg(Cul).arg(altiAtCulmi,0,'f',1);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                       Cul</span> = <span class="delete">msgCulminatedAt.arg(CulmTime).arg(Cul).arg(alt</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">iAtCulmi,0,'f',1);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               };</td><td> </td><td class="right">               };</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0090" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       };</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0091" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">};</span> // This comes from show_Today==True</td><td> </td><td class="rblock">               <span class="insert">if (culmAlt &lt; (halfpi - refractedHorizonAlt)) // Source can </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">be observed.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               {</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       double altiAtCulmi = Rad2Deg*(halfpi-culmAlt-refract</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">edHorizonAlt);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       double2hms(TFrac*currH,dc,mc,sc);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       //String with the time span for culmination:</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       Cul = (dc==0)?"":QString("%1%2 ").arg(dc).arg(msgH);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       Cul += (mc==0)?"":QString("%1%2 ").arg(mc).arg(msgM)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       Cul += QString("%1%2").arg(sc).arg(msgS);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       if (!transit)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       {</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                               double2hms(toUnsignedRA(currLocalT + TFrac*c</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">urrH + 12.),</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                                          ephHour, ephMinute, ephSecond); /</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">/ Local time at transit.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                               CulmTime = QString("%1:%2").arg(ephHour).arg</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">(ephMinute,2,10,QLatin1Char('0'));</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                               //Cul = q_("Culminates at %1 (in %2) at %3 d</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">eg.").arg(CulmTime).arg(Cul).arg(altiAtCulmi,0,'f',1);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                               Cul = msgCulminatesAt.arg(CulmTime).arg(Cul)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">.arg(altiAtCulmi,0,'f',1);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       else</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       {</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                               double2hms(toUnsignedRA(currLocalT - TFrac*c</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">urrH + 12.),</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                                          ephHour, ephMinute, ephSecond);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                               CulmTime = QString("%1:%2").arg(ephHour).arg</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">(ephMinute,2,10,QLatin1Char('0'));</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                               //Cul = q_("Culminated at %1 (%2 ago) at %3 </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">deg.").arg(CulmTime).arg(Cul).arg(altiAtCulmi,0,'f',1);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                               Cul = msgCulminatedAt.arg(CulmTime).arg(Cul)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">.arg(altiAtCulmi,0,'f',1);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       }</span> // This comes from show_Today==True</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">////////////////////////////////////////////////////////////</td><td> </td><td class="right">////////////////////////////////////////////////////////////</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">////////////////////////////////////////////////////////////</td><td> </td><td class="right">////////////////////////////////////////////////////////////</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// NOW WE ANALYZE THE SOURCE OBSERVABILITY FOR THE WHOLE YEAR:</td><td> </td><td class="right">// NOW WE ANALYZE THE SOURCE OBSERVABILITY FOR THE WHOLE YEAR:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Compute yearly ephemeris (only if necessary, and not for Sun nor Moon):</td><td> </td><td class="right">// Compute yearly ephemeris (only if necessary, and not for Sun nor Moon):</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (isSun)</td><td> </td><td class="right">       if (isSun)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0092" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               <span class="delete">bestNight=""; ObsRange = "";</span></td><td> </td><td class="rblock">               <span class="insert">lineBestNight.clear();</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               lineObservableRange.clear();</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0093" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       else if (!isMoon &amp;&amp; show_Year) {</td><td> </td><td class="rblock">       else if (!isMoon &amp;&amp; show_Year)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                           </td><td> </td><td class="rblock">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               <span class="delete">if (isStar==false &amp;&amp; (souChanged || yearChanged)) { // Objec</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">t moves.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                       PlanetRADec(core);} // Re-compute ephemeris.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0094" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               else { // Object is fixed on the sky.</td><td> </td><td class="rblock">               <span class="insert">if (!isStar &amp;&amp; (souChanged || yearChanged)) // Object moves.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       double auxH = <span class="delete">HourAngle(mylat,RefracHoriz,selDec);</span></td><td> </td><td class="rblock"><span class="insert">                       updatePlanetData(core); // Re-compute ephemeris.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">               else</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">               { // Object is fixed on the sky.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                       double auxH = <span class="insert">calculateHourAngle(mylat,refractedHori</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">zonAlt,selDec);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       double auxSidT1 = toUnsignedRA(selRA - auxH);</td><td> </td><td class="right">                       double auxSidT1 = toUnsignedRA(selRA - auxH);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       double auxSidT2 = toUnsignedRA(selRA + auxH);</td><td> </td><td class="right">                       double auxSidT2 = toUnsignedRA(selRA + auxH);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       for (int i=0;i&lt;nDays;i++) {</td><td> </td><td class="right">                       for (int i=0;i&lt;nDays;i++) {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0095" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                               <span class="delete">ObjectH0[i]</span> = auxH;</td><td> </td><td class="rblock">                               <span class="insert">objectH0[i]</span> = auxH;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                               <span class="delete">ObjectRA[i]</span> = selRA;</td><td> </td><td class="rblock">                               <span class="insert">objectRA[i]</span> = selRA;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                               <span class="delete">ObjectDec[i]</span> = selDec;</td><td> </td><td class="rblock">                               <span class="insert">objectDec[i]</span> = selDec;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                               <span class="delete">ObjectSidT[0][i]</span> = auxSidT1;</td><td> </td><td class="rblock">                               <span class="insert">objectSidT[0][i]</span> = auxSidT1;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                               <span class="delete">ObjectSidT[1][i]</span> = auxSidT2;</td><td> </td><td class="rblock">                               <span class="insert">objectSidT[1][i]</span> = auxSidT2;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       };</td><td> </td><td class="right">                       };</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               };</td><td> </td><td class="right">               };</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Determine source observability (only if something changed):</td><td> </td><td class="right">// Determine source observability (only if something changed):</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0096" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               if ((souChanged || locChanged || yearChanged)) {</td><td> </td><td class="rblock">               if ((souChanged || locChanged || yearChanged))</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       <span class="delete">bestNight=""; ObsRange = "";</span></td><td> </td><td class="rblock">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                       <span class="insert">lineBestNight.clear();</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       lineObservableRange.clear();</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0097" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       <span class="delete">if (culmAlt&gt;=halfpi-RefracHoriz) {</span> // <span class="delete">Source</span> cannot </td><td> </td><td class="rblock">                       // <span class="insert">Check if the target</span> cannot be seen.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">be seen.</td><td> </td><td class="rblock">                       <span class="insert">if (culmAlt &gt;= (halfpi - refractedHorizonAlt))</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       {</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               //ObsRange = q_("Source is not observable.")
;</td><td> </td><td class="right">                               //ObsRange = q_("Source is not observable.")
;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               //AcroCos = q_("No Acronychal nor Cosmical r
ise/set.");</td><td> </td><td class="right">                               //AcroCos = q_("No Acronychal nor Cosmical r
ise/set.");</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0098" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                               <span class="delete">ObsRange</span> = msgSrcNotObs;</td><td> </td><td class="rblock">                               <span class="insert">lineObservableRange</span> = msgSrcNotObs;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                               <span class="delete">AcroCos</span> = msgNoACRise;</td><td> </td><td class="rblock">                               <span class="insert">lineAcroCos</span> = msgNoACRise;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       }</td><td> </td><td class="right">                       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0099" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       else { // Source can be seen.</td><td> </td><td class="rblock">                       else</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                       { // Source can be seen.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">///////////////////////////</td><td> </td><td class="right">///////////////////////////</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// - Part 1. Determine the best observing night (i.e., opposition to the Su
n):</td><td> </td><td class="right">// - Part 1. Determine the best observing night (i.e., opposition to the Su
n):</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0100" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                               if (show_Best_Night) {</td><td> </td><td class="rblock">                               if (show_Best_Night)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       int selday = 0;</td><td> </td><td class="right">                                       int selday = 0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       double deltaPhs = -1.0; // Initial d
ummy value</td><td> </td><td class="right">                                       double deltaPhs = -1.0; // Initial d
ummy value</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       double tempPhs;</td><td> </td><td class="right">                                       double tempPhs;</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0101" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                       for (int <span class="delete">i=0;i&lt;nDays;i++) {</span> // Maxim</td><td> </td><td class="rblock">                                       for (int <span class="insert">i=0; i&lt;nDays; i++)</span> // Maxim</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">ize the Sun-object separation.</td><td> </td><td class="rblock">ize the Sun-object separation.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                               tempPhs = <span class="delete">Lambda(ObjectRA[i]</span></td><td> </td><td class="rblock">                                       <span class="insert">{</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">,ObjectDec[i],SunRA[i],SunDec[i]);</span></td><td> </td><td class="rblock">                                               tempPhs = <span class="insert">Lambda(objectRA[i]</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                               if <span class="delete">(tempPhs&gt;deltaPhs) {selda</span></td><td> </td><td class="rblock"><span class="insert">, objectDec[i],</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">y=i;deltaPhs=tempPhs;};</span></td><td> </td><td class="rblock"><span class="insert">                                                                sunRA[i], s</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                                       };</span></td><td> </td><td class="rblock"><span class="insert">unDec[i]);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                                               if <span class="insert">(tempPhs &gt; deltaPhs)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                                               {</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                                                       selday = i;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                                                       deltaPhs = tempPhs;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                                               }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                                       }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       if (selName=="Mercury" || selName=="
Venus")</td><td> </td><td class="right">                                       if (selName=="Mercury" || selName=="
Venus")</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       {</td><td> </td><td class="right">                                       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0102" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                               <span class="delete">//bestNight</span> = <span class="delete">q_("Greatest e</span></td><td> </td><td class="rblock">                                               <span class="insert">lineBestNight</span> = <span class="insert">msgGreatElon</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">longation: ");</span></td><td> </td><td class="rblock"><span class="insert">g;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                                               bestNight = msgGreatElong;</span></td><td> </td><td class="rblock">                                       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                       } else</td><td> </td><td class="rblock">                                       else</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       {</td><td> </td><td class="right">                                       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0103" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                               <span class="delete">//bestNight = q_("Largest Su</span></td><td> </td><td class="rblock">                                               <span class="insert">lineBestNight</span> = msgLargSSep;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">n separation: ");</span></td><td> </td><td class="rblock">                                       <span class="insert">}</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                                               bestNight</span> = msgLargSSep;</td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                       <span class="delete">};</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0104" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                       <span class="delete">//bestNight</span> = <span class="delete">bestNight + CalenDate(</span></td><td> </td><td class="rblock">                                       <span class="insert">lineBestNight</span> = <span class="insert">lineBestNight</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">selday) + q_(" (at %1 deg.)").arg(deltaPhs*Rad2Deg,0,'f',1);</span></td><td> </td><td class="rblock"><span class="insert">                                                       .arg(formatAsDate(se</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                                       bestNight = bestNight + CalenDate(se</span></td><td> </td><td class="rblock"><span class="insert">lday))</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">lday) + msgAtDeg.arg(deltaPhs*Rad2Deg,0,'f',1);</span></td><td> </td><td class="rblock"><span class="insert">                                                       .arg(deltaPhs*Rad2De</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                               };</span></td><td> </td><td class="rblock"><span class="insert">g, 0, 'f', 1);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                               }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">///////////////////////////////</td><td> </td><td class="right">///////////////////////////////</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// - Part 2. Determine Acronychal and Cosmical rise and set:</td><td> </td><td class="right">// - Part 2. Determine Acronychal and Cosmical rise and set:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0105" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                               if (show_AcroCos) {</td><td> </td><td class="rblock">                               if (show_AcroCos)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                       int <span class="delete">selRise, selSet, selRise2, selSe</span></td><td> </td><td class="rblock">                               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">t2; // days of year for Acronical and Cosmical rise/set.</span></td><td> </td><td class="rblock">                                       int <span class="insert">acroRise, acroSet, cosRise, cosS</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                       int <span class="delete">Acro</span> = <span class="delete">CheckAcro(selRise,selSet,</span></td><td> </td><td class="rblock"><span class="insert">et;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">selRise2,selSet2);</span></td><td> </td><td class="rblock">                                       int <span class="insert">result</span> = <span class="insert">calculateAcroCos(acroRi</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                       QString <span class="delete">AcroRiseStr, AcroSetStr;</span></td><td> </td><td class="rblock"><span class="insert">se, acroSet,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                       QString <span class="delete">CosmRiseStr, CosmSetStr;</span></td><td> </td><td class="rblock"><span class="insert">                                                                     cosRis</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"><span class="insert">e, cosSet);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                                       AcroRiseStr = (selRise&gt;0)?CalenDate(</span></td><td> </td><td class="rblock">                                       QString <span class="insert">acroRiseStr, acroSetStr;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">selRise):msgNone;</span></td><td> </td><td class="rblock">                                       QString <span class="insert">cosRiseStr, cosSetStr;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                                       AcroSetStr = (selSet&gt;0)?CalenDate(se</span></td><td> </td><td class="rblock"><span class="insert">                                       // TODO: Possible error? Day 0 is 1 </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">lSet):msgNone;</span></td><td> </td><td class="rblock"><span class="insert">Jan.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"><span class="insert">                                       acroRiseStr = (acroRise&gt;0)?formatAsD</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                                       CosmRiseStr = (selRise2&gt;0)?CalenDate</span></td><td> </td><td class="rblock"><span class="insert">ate(acroRise):msgNone;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">(selRise2):msgNone;</span></td><td> </td><td class="rblock"><span class="insert">                                       acroSetStr = (acroSet&gt;0)?formatAsDat</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                                       CosmSetStr = (selSet2&gt;0)?CalenDate(s</span></td><td> </td><td class="rblock"><span class="insert">e(acroSet):msgNone;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">elSet2):msgNone;</span></td><td> </td><td class="rblock"><span class="insert">                                       cosRiseStr = (cosRise&gt;0)?formatAsDat</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"><span class="insert">e(cosRise):msgNone;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                                       //AcroCos = (Acro==3 || Acro==1)?QSt</span></td><td> </td><td class="rblock"><span class="insert">                                       cosSetStr = (cosSet&gt;0)?formatAsDate(</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">ring("%1: %2/%3.").arg(q_("Acronychal rise/set")).arg(AcroRiseStr).arg(Acro</span></td><td> </td><td class="rblock"><span class="insert">cosSet):msgNone;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">SetStr):q_("No Acronychal rise/set.");</span></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                                       //AcroCos += (Acro==3</span> || <span class="delete">Acro==2)?QS</span></td><td> </td><td class="rblock"><span class="insert">                                       if (result==3</span> || <span class="insert">result==1)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">tring(" %1: %2/%3.").arg(q_("Cosmical rise/set")).arg(CosmRiseStr).arg(Cosm</span></td><td> </td><td class="rblock"><span class="insert">                                               lineAcroCos</span> =  <span class="insert">msgAcroRise</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">SetStr):QString(" %1").arg(q_("No Cosmical rise/set."));</span></td><td> </td><td class="rblock"><span class="insert">                                                              .arg(acroRise</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                                       AcroCos</span> = <span class="delete">(Acro==3 || Acro==1)?QStri</span></td><td> </td><td class="rblock"><span class="insert">Str)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">ng("%1: %2/%3.").arg(msgAcroRise).arg(AcroRiseStr).arg(AcroSetStr):msgNoAcr</span></td><td> </td><td class="rblock"><span class="insert">                                                              .arg(acroSetS</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">oRise;</span></td><td> </td><td class="rblock"><span class="insert">tr);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                                       AcroCos += (Acro==3 || Acro==2)?QStr</span></td><td> </td><td class="rblock"><span class="insert">                                       else</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">ing(" %1: %2/%3.").arg(msgCosmRise).arg(CosmRiseStr).arg(CosmSetStr):QStrin</span></td><td> </td><td class="rblock"><span class="insert">                                               lineAcroCos =  msgNoAcroRise</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">g(" %1").arg(msgNoCosmRise);</span></td><td> </td><td class="rblock"><span class="insert">;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0106" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                               <span class="delete">};</span></td><td> </td><td class="rblock">                                       <span class="insert">if (result==3 || result==2)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                                               lineAcroCos += msgCosmRise</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                                                              .arg(cosRiseS</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">tr)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                                                              .arg(cosSetSt</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">r);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                                       else</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                                               lineAcroCos += msgNoCosmRise</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                               }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">////////////////////////////</td><td> </td><td class="right">////////////////////////////</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// - Part 3. Determine range of good nights</td><td> </td><td class="right">// - Part 3. Determine range of good nights</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// (i.e., above horizon before/after twilight):</td><td> </td><td class="right">// (i.e., above horizon before/after twilight):</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0107" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                               if (show_Good_Nights) {</td><td> </td><td class="rblock">                               if (show_Good_Nights)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       int selday = 0;</td><td> </td><td class="right">                                       int selday = 0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       int selday2 = 0;</td><td> </td><td class="right">                                       int selday2 = 0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       bool bestBegun = false; // Are we in
side a good time range?</td><td> </td><td class="right">                                       bool bestBegun = false; // Are we in
side a good time range?</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       bool atLeastOne = false;</td><td> </td><td class="right">                                       bool atLeastOne = false;</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0108" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                       QString <span class="delete">dateRange = "";</span></td><td> </td><td class="rblock">                                       QString <span class="insert">dateRange;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                       bool <span class="delete">PoleNight,</span> twiGood;</td><td> </td><td class="rblock">                                       bool <span class="insert">poleNight,</span> twiGood;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                           </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                                       <span class="insert">for (int i=0; i&lt;nDays; i++)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                                       {</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0109" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                       <span class="delete">for (int i=0;i&lt;nDays;i++) {</span></td><td> </td><td class="rblock">                                               <span class="insert">poleNight = sunSidT[0][i]&lt;0.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">0 &amp;&amp; std::abs(sunDec[i]-mylat)&gt;=halfpi; // Is it night during 24h?</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                                               twiGood = (poleNight &amp;&amp; std:</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">:abs(objectDec[i]-mylat)&lt;halfpi)?true:CheckRise(i);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0110" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                               <span class="delete">PoleNight = SunSidT[0][i]&lt;0.</span></td><td> </td><td class="rblock">                                               if (twiGood &amp;&amp; bestBegun == </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">0 &amp;&amp; std::abs(SunDec[i]-mylat)&gt;=halfpi; // Is it night during 24h?</span></td><td> </td><td class="rblock">false)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                                               twiGood = (PoleNight &amp;&amp; std:</span></td><td> </td><td class="rblock">                                               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">:abs(ObjectDec[i]-mylat)&lt;halfpi)?true:CheckRise(i);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                               if (twiGood &amp;&amp; bestBegun == </td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">false) {</td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                                       selday = i;</td><td> </td><td class="right">                                                       selday = i;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                                       bestBegun = true;</td><td> </td><td class="right">                                                       bestBegun = true;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                                       atLeastOne = true;</td><td> </td><td class="right">                                                       atLeastOne = true;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                               };</td><td> </td><td class="right">                                               };</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0111" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                               if (!twiGood &amp;&amp; bestBegun ==</td><td> </td><td class="rblock">                                               if (!twiGood &amp;&amp; bestBegun ==</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"> true) {</td><td> </td><td class="rblock"> true)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                                               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                                       selday2 = i;</td><td> </td><td class="right">                                                       selday2 = i;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                                       bestBegun = false;</td><td> </td><td class="right">                                                       bestBegun = false;</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0112" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                       if (selday2 &gt; selday</td><td> </td><td class="rblock">                                                       if (selday2 &gt; selday</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">) {</td><td> </td><td class="rblock">)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                               if <span class="delete">(dateRang</span></td><td> </td><td class="rblock">                                                       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">e!="") { dateRange</span> += ", <span class="delete">";};</span></td><td> </td><td class="rblock">                                                               <span class="insert">// FIXME: Th</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                               dateRange +=</td><td> </td><td class="rblock"><span class="insert">is kind of concatenation is bad for i18n.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"> <span class="delete">QString("%1").arg(RangeCalenDates(selday,</span> selday2));</td><td> </td><td class="rblock">                                                               if <span class="insert">(!dateRan</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">ge.isEmpty())</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                                                                       date</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">Range</span> += ", <span class="insert">";</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                                                               dateRange +=</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"> <span class="insert">QString("%1").arg(formatAsDateRange(selday,</span> selday2));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                                       };</td><td> </td><td class="right">                                                       };</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                               };</td><td> </td><td class="right">                                               };</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       };</td><td> </td><td class="right">                                       };</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0113" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                       <span class="delete">if (bestBegun) {</span> // <span class="delete">There</span> were good </td><td> </td><td class="rblock">                                       // <span class="insert">Check if there</span> were good dates <span class="insert">ti</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">dates <span class="delete">till</span> the end of the year.</td><td> </td><td class="rblock"><span class="insert">ll</span> the end of the year.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                if <span class="delete">(dateRange!="")</span> { <span class="delete">dateRa</span></td><td> </td><td class="rblock">                                       if <span class="insert">(bestBegun)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">nge</span> += ", <span class="delete">";};</span></td><td> </td><td class="rblock">                                       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                               dateRange += <span class="delete">RangeCalenDates</span></td><td> </td><td class="rblock">                                               <span class="insert">// FIXME: This kind of conca</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">(selday,</span> 0);</td><td> </td><td class="rblock"><span class="insert">tenation is bad for i18n.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                                                if (!dateRange.isEmpty())</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                                                        dateRange</span> += ", <span class="insert">";</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                                               dateRange += <span class="insert">formatAsDateRan</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">ge(selday,</span> 0);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       };</td><td> </td><td class="right">                                       };</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0114" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                       if (dateRange<span class="delete"> == ""</span>)</td><td> </td><td class="rblock">                                       if (dateRange<span class="insert">.isEmpty()</span>)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       {</td><td> </td><td class="right">                                       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                               if (atLeastOne)</td><td> </td><td class="right">                                               if (atLeastOne)</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0115" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                               {<span class="delete"> // The whole year is good.</span></td><td> </td><td class="rblock">                                               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                                       //ObsRange = q_("Obs
ervable during the whole year.");</td><td> </td><td class="right">                                                       //ObsRange = q_("Obs
ervable during the whole year.");</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0116" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                       <span class="delete">ObsRange = msgWholeY
</span>ear;</td><td> </td><td class="rblock">                                                       <span class="insert">lineObservableRange 
= msgWholeY</span>ear;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                               }</td><td> </td><td class="right">                                               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                               else</td><td> </td><td class="right">                                               else</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                               {</td><td> </td><td class="right">                                               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                                       //ObsRange = q_("Not
 observable at dark night.");</td><td> </td><td class="right">                                                       //ObsRange = q_("Not
 observable at dark night.");</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0117" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                       <span class="delete">ObsRange = msgNotObs
</span>;</td><td> </td><td class="rblock">                                                       <span class="insert">lineObservableRange 
= msgNotObs</span>;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                               };</td><td> </td><td class="right">                                               };</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       }</td><td> </td><td class="right">                                       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       else</td><td> </td><td class="right">                                       else</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       {</td><td> </td><td class="right">                                       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0118" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                               <span class="delete">//ObsRange = QString("%1 %2"</span></td><td> </td><td class="rblock">                                               <span class="insert">// Nights when the target is</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">).arg(q_("Nights</span> above <span class="delete">horizon: ")).arg(dateRange);</span></td><td> </td><td class="rblock"> above <span class="insert">the horizon</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                                               ObsRange</span> = <span class="delete">QString("%1 %2").</span></td><td> </td><td class="rblock"><span class="insert">                                               lineObservableRange</span> = <span class="insert">msgAbo</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">arg(msgAboveHoriz).arg(dateRange);</span></td><td> </td><td class="rblock"><span class="insert">veHoriz.arg(dateRange);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       };</td><td> </td><td class="right">                                       };</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               }; // Comes from show_Good_Nights==True"</td><td> </td><td class="right">                               }; // Comes from show_Good_Nights==True"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       }; // Comes from the "else" of "culmAlt&gt;=..."</td><td> </td><td class="right">                       }; // Comes from the "else" of "culmAlt&gt;=..."</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               };// Comes from  "souChanged || ..."</td><td> </td><td class="right">               };// Comes from  "souChanged || ..."</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }; // Comes from the "else" with "!isMoon"</td><td> </td><td class="right">       }; // Comes from the "else" with "!isMoon"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Print all results:</td><td> </td><td class="right">// Print all results:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0119" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       int <span class="delete">spacing</span> = (int) (1.3* ( (double) fontSize));  // between <span class="delete">lines</span></td><td> </td><td class="rblock">       int <span class="insert">lineSpacing</span> = (int) (1.3* ( (double) fontSize));  // between <span class="insert">lin</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       int <span class="delete">spacing2</span> = 6*fontSize;  // between daily and yearly results</td><td> </td><td class="rblock"><span class="insert">es</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       int <span class="insert">groupSpacing</span> = 6*fontSize;  // between daily and yearly results</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       int yLine = 8*fontSize+110;</td><td> </td><td class="right">       int yLine = 8*fontSize+110;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       int xLine = 80;</td><td> </td><td class="right">       int xLine = 80;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (show_Today)</td><td> </td><td class="right">       if (show_Today)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               //renderer-&gt;drawText(TextParams(xLine, yLine,q_("TODAY:")));</td><td> </td><td class="right">               //renderer-&gt;drawText(TextParams(xLine, yLine,q_("TODAY:")));</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0120" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               <span class="delete">renderer-&gt;drawText(TextParams(xLine, yLine,msgToday));</span></td><td> </td><td class="rblock">               <span class="insert">painter.drawText(xLine, yLine, msgToday);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               renderer-&gt;drawText(TextParams(xLine+fontSize, yLine-spacing,</span></td><td> </td><td class="rblock"><span class="insert">               painter.drawText(xLine + fontSize, yLine - lineSpacing, RS2)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"> RS2));</span></td><td> </td><td class="rblock"><span class="insert">;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               renderer-&gt;drawText(TextParams(xLine+fontSize, yLine-spacing*</span></td><td> </td><td class="rblock"><span class="insert">               painter.drawText(xLine + fontSize, yLine - lineSpacing*2, RS</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">2, RS1));</span></td><td> </td><td class="rblock"><span class="insert">1);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               renderer-&gt;drawText(TextParams(xLine+fontSize, yLine-spacing*</span></td><td> </td><td class="rblock"><span class="insert">               painter.drawText(xLine + fontSize, yLine - lineSpacing*3, Cu</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">3, Cul));</span></td><td> </td><td class="rblock"><span class="insert">l);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               yLine -= <span class="delete">spacing2;</span></td><td> </td><td class="rblock">               yLine -= <span class="insert">groupSpacing;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       };</span></td><td> </td><td class="rblock"><span class="insert">       }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if ((isMoon &amp;&amp; show_FullMoon) || (!isSun &amp;&amp; !isMoon &amp;&amp; show_Year))</td><td> </td><td class="right">       if ((isMoon &amp;&amp; show_FullMoon) || (!isSun &amp;&amp; !isMoon &amp;&amp; show_Year))</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0121" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               <span class="delete">//renderer-&gt;drawText(TextParams(xLine,yLine,q_("THIS YEAR:")</span></td><td> </td><td class="rblock">               <span class="insert">painter.drawText(xLine, yLine, msgThisYear);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">));</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               renderer-&gt;drawText(TextParams(xLine,yLine,msgThisYear));</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               if (show_Best_Night || show_FullMoon)</td><td> </td><td class="right">               if (show_Best_Night || show_FullMoon)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0122" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       yLine -= <span class="delete">spacing;</span></td><td> </td><td class="rblock">                       yLine -= <span class="insert">lineSpacing;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                       renderer-&gt;drawText(TextParams(xLine+fontSize,</span> yLine,</td><td> </td><td class="rblock"><span class="insert">                       painter.drawText(xLine + fontSize,</span> yLine, <span class="insert">lineBestNi</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"> <span class="delete">bestNight));</span></td><td> </td><td class="rblock"><span class="insert">ght);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               };</span></td><td> </td><td class="rblock"><span class="insert">               }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               if (show_Good_Nights)</td><td> </td><td class="right">               if (show_Good_Nights)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0123" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       yLine -= <span class="delete">spacing;</span></td><td> </td><td class="rblock">                       yLine -= <span class="insert">lineSpacing;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                       renderer-&gt;drawText(TextParams(xLine+fontSize,</span> yLine,</td><td> </td><td class="rblock"><span class="insert">                       painter.drawText(xLine + fontSize,</span> yLine, <span class="insert">lineObserv</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"> <span class="delete">ObsRange));</span></td><td> </td><td class="rblock"><span class="insert">ableRange);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               };</span></td><td> </td><td class="rblock"><span class="insert">               }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               if (show_AcroCos)</td><td> </td><td class="right">               if (show_AcroCos)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0124" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       yLine -= <span class="delete">spacing;</span></td><td> </td><td class="rblock">                       yLine -= <span class="insert">lineSpacing;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                       renderer-&gt;drawText(TextParams(xLine+fontSize,</span> yLine,</td><td> </td><td class="rblock"><span class="insert">                       painter.drawText(xLine + fontSize,</span> yLine, <span class="insert">lineAcroCo</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"> <span class="delete">AcroCos));</span></td><td> </td><td class="rblock"><span class="insert">s);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               };</span></td><td> </td><td class="rblock"><span class="insert">               }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"><span class="insert">       }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       };</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                           </td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// END OF MAIN CODE</td><td> </td><td class="right">// END OF MAIN CODE</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">///////////////////////////////////////////////////////</td><td> </td><td class="right">///////////////////////////////////////////////////////</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//////////////////////////////</td><td> </td><td class="right">//////////////////////////////</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// AUXILIARY FUNCTIONS</td><td> </td><td class="right">// AUXILIARY FUNCTIONS</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">////////////////////////////////////</td><td> </td><td class="right">////////////////////////////////////</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Returns the hour angle for a given altitude:</td><td> </td><td class="right">// Returns the hour angle for a given altitude:</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0125" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">double <span class="delete">Observability::HourAngle(double lat,</span> double <span class="delete">h,</span> double <span class="delete">Dec)</span></td><td> </td><td class="rblock">double <span class="insert">Observability::calculateHourAngle(double latitude,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                                         double <span class="insert">elevation,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                                         double <span class="insert">declination)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0126" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       double <span class="delete">Denom</span> = <span class="delete">std::cos(lat)*std::cos(Dec);</span></td><td> </td><td class="rblock">       double <span class="insert">denom</span> = <span class="insert">std::cos(latitude)*std::cos(declination);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       double <span class="delete">Numer</span> = <span class="delete">(std::sin(h)-std::sin(lat)*std::sin(Dec));</span></td><td> </td><td class="rblock">       double <span class="insert">numer</span> = <span class="insert">(std::sin(elevation)-std::sin(latitude)*std::sin(decl</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">ination));</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0127" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       if ( <span class="delete">std::abs(Numer)&gt;std::abs(Denom)</span> )</td><td> </td><td class="rblock">       if ( <span class="insert">std::abs(numer) &gt; std::abs(denom)</span> )</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               <span class="delete">{return -0.5/86400.;}</span> // Source doesn't reach that altitude.</td><td> </td><td class="rblock">       <span class="insert">{</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               return -0.5/86400.;</span> // Source doesn't reach that altitude.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       <span class="insert">}</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       else</td><td> </td><td class="right">       else</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0128" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">{return Rad2Hr*std::acos(Numer/Denom);}</span></td><td> </td><td class="rblock">       <span class="insert">{</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                           </td><td> </td><td class="rblock"><span class="insert">               return Rad2Hr * std::acos(numer/denom);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">////////////////////////////////////</td><td> </td><td class="right">////////////////////////////////////</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">////////////////////////////////////</td><td> </td><td class="right">////////////////////////////////////</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Returns the angular separation between two points on the Sky:</td><td> </td><td class="right">// Returns the angular separation between two points on the Sky:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// RA is given in hours and Dec in radians.</td><td> </td><td class="right">// RA is given in hours and Dec in radians.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">double Observability::Lambda(double RA1, double Dec1, double RA2, double De
c2)</td><td> </td><td class="right">double Observability::Lambda(double RA1, double Dec1, double RA2, double De
c2)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return std::acos(std::sin(Dec1)*std::sin(Dec2)+std::cos(Dec1)*std::c
os(Dec2)*std::cos((RA1-RA2)/Rad2Hr));</td><td> </td><td class="right">       return std::acos(std::sin(Dec1)*std::sin(Dec2)+std::cos(Dec1)*std::c
os(Dec2)*std::cos((RA1-RA2)/Rad2Hr));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">////////////////////////////////////</td><td> </td><td class="right">////////////////////////////////////</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">////////////////////////////////////</td><td> </td><td class="right">////////////////////////////////////</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Returns the hour angle for a given a Sid. Time:</td><td> </td><td class="right">// Returns the hour angle for a given a Sid. Time:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">double Observability::HourAngle2(double RA, double ST)</td><td> </td><td class="right">double Observability::HourAngle2(double RA, double ST)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0129" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       double <span class="delete">Htemp</span> = toUnsignedRA(RA-ST/15.);</td><td> </td><td class="rblock">       double <span class="insert">result</span> = toUnsignedRA(RA-ST/15.);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">Htemp</span> -= <span class="delete">(Htemp&gt;12.)?24.0:0.0;</span></td><td> </td><td class="rblock">       <span class="insert">result</span> -= <span class="insert">(result &gt; 12.) ? 24.0 : 0.0;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       return <span class="delete">Htemp;</span></td><td> </td><td class="rblock">       return <span class="insert">result;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">////////////////////////////////////</td><td> </td><td class="right">////////////////////////////////////</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">////////////////////////////////////</td><td> </td><td class="right">////////////////////////////////////</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Converts a float time/angle span (in hours/degrees) in the (integer) for
mat hh/dd,mm,ss:</td><td> </td><td class="right">// Converts a float time/angle span (in hours/degrees) in the (integer) for
mat hh/dd,mm,ss:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void Observability::double2hms(double hfloat, int &amp;h1, int &amp;h2, int &amp;h3)</td><td> </td><td class="right">void Observability::double2hms(double hfloat, int &amp;h1, int &amp;h2, int &amp;h3)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double f1,f2,f3;</td><td> </td><td class="right">       double f1,f2,f3;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       hfloat = std::abs(hfloat);</td><td> </td><td class="right">       hfloat = std::abs(hfloat);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l2" /><small>skipping to change at</small><em> line 842</em></th><th> </th><th><a name="part-r2" /><small>skipping to change at</small><em> line 903</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double tempRA,tempmod;</td><td> </td><td class="right">       double tempRA,tempmod;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       //FIXME: tempmod is unused variable; need fix</td><td> </td><td class="right">       //FIXME: tempmod is unused variable; need fix</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (RA&lt;0.0) {tempmod = std::modf(-RA/24.,&amp;tempRA); RA += 24.*(tempRA
+1.0)+0.0*tempmod;};</td><td> </td><td class="right">       if (RA&lt;0.0) {tempmod = std::modf(-RA/24.,&amp;tempRA); RA += 24.*(tempRA
+1.0)+0.0*tempmod;};</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double auxRA = 24.*std::modf(RA/24.,&amp;tempRA);</td><td> </td><td class="right">       double auxRA = 24.*std::modf(RA/24.,&amp;tempRA);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       auxRA += (auxRA&lt;0.0)?24.0:((auxRA&gt;24.0)?-24.0:0.0);</td><td> </td><td class="right">       auxRA += (auxRA&lt;0.0)?24.0:((auxRA&gt;24.0)?-24.0:0.0);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return auxRA;</td><td> </td><td class="right">       return auxRA;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">////////////////////////////////////</td><td> </td><td class="right">////////////////////////////////////</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0130" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">///////////////////////////////////////////////</span></td><td> </td><td class="rblock">QString <span class="insert">Observability::formatAsDate(int dayNumber)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">// Returns the day and month of year (to put it in format '25 Apr')</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">QString <span class="delete">Observability::CalenDate(int selday)</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0131" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       int <span class="delete">day,month,year;</span></td><td> </td><td class="rblock">       int <span class="insert">day, month, year;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       StelUtils::getDateFromJulianDay(yearJD[selday],&amp;year,&amp;month,&amp;day);</span></td><td> </td><td class="rblock"><span class="insert">       StelUtils::getDateFromJulianDay(yearJD[dayNumber], &amp;year, &amp;month, &amp;d</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">ay);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0132" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       QString <span class="delete">r;</span></td><td> </td><td class="rblock">       QString <span class="insert">formatString</span> = <span class="insert">(getDateFormat()) ? "%1 %2" : "%2 %1";</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       if (getDateFormat())</span></td><td> </td><td class="rblock"><span class="insert">       QString result</span> = <span class="insert">formatString.arg(day).arg(monthNames[month-1]);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               r</span> = <span class="delete">QString("%1 %2").arg(day).arg(months[month-1]);</span></td><td> </td><td class="rblock">       return <span class="insert">result;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       else</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               r</span> = <span class="delete">QString("%1 %2").arg(months[month-1]).arg(day);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                           </td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       return <span class="delete">r;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0133" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">//////////////////////////////////////////////</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">///////////////////////////////////////////////</td><td> </td><td class="right">///////////////////////////////////////////////</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Returns the day and month of year (to put it in format '25 Apr')</td><td> </td><td class="right">// Returns the day and month of year (to put it in format '25 Apr')</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0134" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">QString Observability::<span class="delete">RangeCalenDates(int fDoY, int sDoY</span>)</td><td> </td><td class="rblock">QString Observability::<span class="insert">formatAsDateRange(int startDay, int endDay</span>)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0135" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       int <span class="delete">day1,month1,year1,day2,month2,year2</span>;</td><td> </td><td class="rblock">       int <span class="insert">sDay, sMonth, sYear, eDay, eMonth, eYear</span>;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       QString range;</td><td> </td><td class="right">       QString range;</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0136" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">StelUtils::getDateFromJulianDay(yearJD[fDoY],&amp;year1,&amp;month1,&amp;day1);</span></td><td> </td><td class="rblock">       <span class="insert">StelUtils::getDateFromJulianDay(yearJD[startDay], &amp;sYear, &amp;sMonth, &amp;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       StelUtils::getDateFromJulianDay(yearJD[sDoY],&amp;year2,&amp;month2,&amp;day2);</span></td><td> </td><td class="rblock"><span class="insert">sDay);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       if <span class="delete">(sDoY==0)</span></td><td> </td><td class="rblock"><span class="insert">       StelUtils::getDateFromJulianDay(yearJD[endDay], &amp;eYear, &amp;eMonth, &amp;eD</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">ay);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       if <span class="insert">(endDay == 0)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0137" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               <span class="delete">day2</span> = 31;</td><td> </td><td class="rblock">               <span class="insert">eDay</span> = 31;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               <span class="delete">month2</span> = 12;</td><td> </td><td class="rblock">               <span class="insert">eMonth</span> = 12;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0138" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       if (<span class="delete">fDoY==</span>0)</td><td> </td><td class="rblock">       if (<span class="insert">startDay == </span>0)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0139" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               <span class="delete">day1</span> = 1;</td><td> </td><td class="rblock">               <span class="insert">sDay</span> = 1;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               <span class="delete">month1</span> = 1;</td><td> </td><td class="rblock">               <span class="insert">sMonth</span> = 1;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0140" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       if <span class="delete">(month1==month2)</span></td><td> </td><td class="rblock">                                                                           </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       <span class="insert">// If it's the same month, display "X-Y Month" or "Month X-Y"</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       if <span class="insert">(sMonth == eMonth)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0141" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               <span class="delete">if (getDateFormat())</span></td><td> </td><td class="rblock">               <span class="insert">QString formatString</span> = <span class="insert">(getDateFormat()) ? "%1</span> - %2 <span class="insert">%3" : "%</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                       range</span> = <span class="delete">QString("%1</span> - %2 <span class="delete">%3").arg(day1).arg(day2).ar</span></td><td> </td><td class="rblock"><span class="insert">3</span> %1 - <span class="insert">%2";</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">g(months[month1-1]);</span></td><td> </td><td class="rblock"><span class="insert">               range = formatString.arg(sDay).arg(eDay).arg(monthNames[sMon</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               else</span></td><td> </td><td class="rblock"><span class="insert">th-1]);;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                       range = QString("%3</span> %1 - <span class="delete">%2").arg(day1).arg(day2).ar</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">g(months[month1-1]);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       else</td><td> </td><td class="right">       else</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0142" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               <span class="delete">if (getDateFormat())</span></td><td> </td><td class="rblock">               <span class="insert">QString formatString</span> = <span class="insert">(getDateFormat()) ? "%1</span> %2 - %3 <span class="insert">%4"</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                       range</span> = <span class="delete">QString("%1</span> %2 - %3 <span class="delete">%4").arg(day1).arg(month</span></td><td> </td><td class="rblock"><span class="insert">                                                        : "%2 %1 - %4 %3";</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">s[month1-1]).arg(day2).arg(months[month2-1]);</span></td><td> </td><td class="rblock">               range = <span class="insert">formatString.arg(sDay)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               else</span></td><td> </td><td class="rblock"><span class="insert">                                   .arg(monthNames[sMonth-1])</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       range = <span class="delete">QString("%1 %2 - %3 %4").arg(months[month1-1</span></td><td> </td><td class="rblock"><span class="insert">                                   .arg(eDay)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">]).arg(day1).arg(months[month2-1]).arg(day2);</span></td><td> </td><td class="rblock"><span class="insert">                                   .arg(monthNames[eMonth-1]);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return range;</td><td> </td><td class="right">       return range;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//////////////////////////////////////////////</td><td> </td><td class="right">//////////////////////////////////////////////</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0143" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">//////////////////////////////////////////////////</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">// Returns the RA and Dec of the selected planet</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">//for each day of the current year:</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">void Observability::PlanetRADec(StelCore *core)</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">{</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       double TempH;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                           </td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Compute planet's position for each day of the current year:</td><td> </td><td class="right">// Compute planet's position for each day of the current year:</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0144" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                           </td><td> </td><td class="rblock"><span class="insert">void Observability::updatePlanetData(StelCore *core)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       for (int <span class="delete">i=0;i&lt;nDays;i++)</span> {</td><td> </td><td class="rblock"><span class="insert">{</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               <span class="delete">getPlanetCoords(core,yearJD[i],ObjectRA[i],ObjectDec[i],fals</span></td><td> </td><td class="rblock"><span class="insert">       double tempH;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">e);</span></td><td> </td><td class="rblock">       for (int <span class="insert">i=0; i&lt;nDays; i++)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               TempH</span> = <span class="delete">HourAngle(mylat,RefracHoriz,ObjectDec[i]);</span></td><td> </td><td class="rblock">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               ObjectH0[i]</span> = <span class="delete">TempH;</span></td><td> </td><td class="rblock">               <span class="insert">getPlanetCoords(core, yearJD[i], objectRA[i], objectDec[i], </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               ObjectSidT[0][i]</span> = <span class="delete">toUnsignedRA(ObjectRA[i]-TempH);</span></td><td> </td><td class="rblock"><span class="insert">false);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               ObjectSidT[1][i]</span> = <span class="delete">toUnsignedRA(ObjectRA[i]+TempH);</span></td><td> </td><td class="rblock"><span class="insert">               tempH</span> = <span class="insert">calculateHourAngle(mylat, refractedHorizonAlt, objec</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">tDec[i]);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               objectH0[i]</span> = <span class="insert">tempH;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               objectSidT[0][i]</span> = <span class="insert">toUnsignedRA(objectRA[i]-tempH);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               objectSidT[1][i]</span> = <span class="insert">toUnsignedRA(objectRA[i]+tempH);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Return the planet to its current time:</td><td> </td><td class="right">// Return the planet to its current time:</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0145" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">getPlanetCoords(core,myJD,ObjectRA[0],ObjectDec[0],true);</span></td><td> </td><td class="rblock">       <span class="insert">getPlanetCoords(core, myJD, objectRA[0], objectDec[0], true);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                           </td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">/////////////////////////////////////////////////</td><td> </td><td class="right">/////////////////////////////////////////////////</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Computes the Sun's RA and Dec (and the JD) for</td><td> </td><td class="right">// Computes the Sun's RA and Dec (and the JD) for</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// each day of the current year.</td><td> </td><td class="right">// each day of the current year.</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0146" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">void Observability::<span class="delete">SunRADec</span>(StelCore* core)</td><td> </td><td class="rblock">void Observability::<span class="insert">updateSunData</span>(StelCore* core)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0147" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       int <span class="delete">day,month,year,year2;</span></td><td> </td><td class="rblock">       int <span class="insert">day, month, year, sameYear;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                           </td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Get current date:</td><td> </td><td class="right">// Get current date:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       StelUtils::getDateFromJulianDay(myJD,&amp;year,&amp;month,&amp;day);</td><td> </td><td class="right">       StelUtils::getDateFromJulianDay(myJD,&amp;year,&amp;month,&amp;day);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Get JD for the Jan 1 of current year:</td><td> </td><td class="right">// Get JD for the Jan 1 of current year:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       StelUtils::getJDFromDate(&amp;Jan1stJD,year,1,1,0,0,0);</td><td> </td><td class="right">       StelUtils::getJDFromDate(&amp;Jan1stJD,year,1,1,0,0,0);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Check if we are on a leap year:</td><td> </td><td class="right">// Check if we are on a leap year:</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0148" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">StelUtils::getDateFromJulianDay(Jan1stJD+365.,&amp;year2,&amp;month,&amp;day);</span></td><td> </td><td class="rblock">       <span class="insert">StelUtils::getDateFromJulianDay(Jan1stJD+365., &amp;sameYear, &amp;month, &amp;d</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       nDays = <span class="delete">(year==year2)?366:365;</span></td><td> </td><td class="rblock"><span class="insert">ay);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       nDays = <span class="insert">(year==sameYear)?366:365;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Compute Earth's position throughout the year:</td><td> </td><td class="right">// Compute Earth's position throughout the year:</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0149" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       for (int <span class="delete">i=0;i&lt;nDays;i++)</span> {</td><td> </td><td class="rblock">       <span class="insert">Vec3d pos, sunPos;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               yearJD[i] = <span class="delete">Jan1stJD+(double)i;</span></td><td> </td><td class="rblock">       for (int <span class="insert">i=0; i&lt;nDays; i++)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">               yearJD[i] = <span class="insert">Jan1stJD + (double)i;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               myEarth-&gt;computePosition(yearJD[i]);</td><td> </td><td class="right">               myEarth-&gt;computePosition(yearJD[i]);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               myEarth-&gt;computeTransMatrix(yearJD[i]);</td><td> </td><td class="right">               myEarth-&gt;computeTransMatrix(yearJD[i]);</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0150" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               <span class="delete">Pos1</span> = myEarth-&gt;getHeliocentricEclipticPos();</td><td> </td><td class="rblock">               <span class="insert">pos</span> = myEarth-&gt;getHeliocentricEclipticPos();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               <span class="delete">Pos2</span> = <span class="delete">core-&gt;j2000ToEquinoxEqu((core-&gt;matVsop87ToJ2000)*(-Po</span></td><td> </td><td class="rblock">               <span class="insert">sunPos</span> = <span class="insert">core-&gt;j2000ToEquinoxEqu((core-&gt;matVsop87ToJ2000)*(-</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">s1));</span></td><td> </td><td class="rblock"><span class="insert">pos));</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               EarthPos[i] = <span class="delete">-Pos1;</span></td><td> </td><td class="rblock">               EarthPos[i] = <span class="insert">-pos;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               toRADec(Pos2,SunRA[i],SunDec[i]);</span></td><td> </td><td class="rblock"><span class="insert">               toRADec(sunPos,sunRA[i],sunDec[i]);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       };</td><td> </td><td class="right">       };</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//Return the Earth to its current time:</td><td> </td><td class="right">//Return the Earth to its current time:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       myEarth-&gt;computePosition(myJD);</td><td> </td><td class="right">       myEarth-&gt;computePosition(myJD);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       myEarth-&gt;computeTransMatrix(myJD);</td><td> </td><td class="right">       myEarth-&gt;computeTransMatrix(myJD);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">///////////////////////////////////////////////////</td><td> </td><td class="right">///////////////////////////////////////////////////</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">////////////////////////////////////////////</td><td> </td><td class="right">////////////////////////////////////////////</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Computes Sun's Sidereal Times at twilight and culmination:</td><td> </td><td class="right">// Computes Sun's Sidereal Times at twilight and culmination:</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0151" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">void Observability::<span class="delete">SunHTwi</span>()</td><td> </td><td class="rblock">void Observability::<span class="insert">updateSunH</span>()</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0152" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       double <span class="delete">TempH, T</span>empH00;</td><td> </td><td class="rblock">       double <span class="insert">tempH, t</span>empH00;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0153" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       for (int i=0; i&lt;nDays; i++) {</td><td> </td><td class="rblock">       for (int i=0; i&lt;nDays; i++)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               <span class="delete">TempH</span> = <span class="delete">HourAngle(mylat,AstroTwiAlti,SunDec[i]);</span></td><td> </td><td class="rblock">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               TempH00 = HourAngle(mylat,RefracHoriz,SunDec[i]);</span></td><td> </td><td class="rblock">               <span class="insert">tempH</span> = <span class="insert">calculateHourAngle(mylat, twilightAltRad, sunDec[i])</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               if <span class="delete">(TempH&gt;0.0)</span> {</td><td> </td><td class="rblock"><span class="insert">;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       <span class="delete">SunSidT[0][i]</span> = <span class="delete">toUnsignedRA(SunRA[i]-TempH*(1.00278</span></td><td> </td><td class="rblock"><span class="insert">               tempH00 = calculateHourAngle(mylat, refractedHorizonAlt, sun</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">));</td><td> </td><td class="rblock"><span class="insert">Dec[i]);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       <span class="delete">SunSidT[1][i]</span> = <span class="delete">toUnsignedRA(SunRA[i]+TempH*(1.00278</span></td><td> </td><td class="rblock">               if <span class="insert">(tempH &gt; 0.0)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">));}</span></td><td> </td><td class="rblock">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               else {</td><td> </td><td class="rblock">                       <span class="insert">sunSidT[0][i]</span> = <span class="insert">toUnsignedRA(sunRA[i]-tempH*(1.00278</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       <span class="delete">SunSidT[0][i]</span> = -1000.0;</td><td> </td><td class="rblock">));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       <span class="delete">SunSidT[1][i] = -1000.0;};</span></td><td> </td><td class="rblock">                       <span class="insert">sunSidT[1][i]</span> = <span class="insert">toUnsignedRA(sunRA[i]+tempH*(1.00278</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               if (TempH00&gt;0.0) {</span></td><td> </td><td class="rblock"><span class="insert">));</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                       SunSidT[2][i] = toUnsignedRA(SunRA[i]+TempH00);</span></td><td> </td><td class="rblock"><span class="insert">               }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                       SunSidT[3][i] = toUnsignedRA(SunRA[i]-TempH00);}</span></td><td> </td><td class="rblock">               else</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               else {</span></td><td> </td><td class="rblock">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                       SunSidT[2][i]</span> = -1000.0;</td><td> </td><td class="rblock">                       <span class="insert">sunSidT[0][i]</span> = -1000.0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       <span class="delete">SunSidT[3][i] = -1000.0;};</span></td><td> </td><td class="rblock">                       <span class="insert">sunSidT[1][i]</span> = -1000.0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">               <span class="insert">}</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0154" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">};</span></td><td> </td><td class="rblock">               <span class="insert">if (tempH00&gt;0.0)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               {</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       sunSidT[2][i] = toUnsignedRA(sunRA[i]+tempH00);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       sunSidT[3][i] = toUnsignedRA(sunRA[i]-tempH00);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               else</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               {</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       sunSidT[2][i] = -1000.0;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       sunSidT[3][i] = -1000.0;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">////////////////////////////////////////////</td><td> </td><td class="right">////////////////////////////////////////////</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">///////////////////////////////////////////</td><td> </td><td class="right">///////////////////////////////////////////</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Checks if a source can be observed with the Sun below the twilight altit
ude.</td><td> </td><td class="right">// Checks if a source can be observed with the Sun below the twilight altit
ude.</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0155" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">bool Observability::CheckRise(int <span class="delete">i</span>)</td><td> </td><td class="rblock">bool Observability::CheckRise(int <span class="insert">day</span>)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0156" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       // If Sun can't reach twilight elevation, <span class="delete">return false:</span></td><td> </td><td class="rblock">       // If Sun can't reach twilight elevation, <span class="insert">the target is not visible.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       if <span class="delete">(SunSidT[0][i]&lt;0.0</span> || <span class="delete">SunSidT[1][i]&lt;0.0) {</span> return <span class="delete">false;};</span></td><td> </td><td class="rblock">       if <span class="insert">(sunSidT[0][day]&lt;0.0</span> || <span class="insert">sunSidT[1][day]&lt;0.0)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">               return <span class="insert">false;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // Iterate over the whole year:</td><td> </td><td class="right">       // Iterate over the whole year:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       int nBin = 1000;</td><td> </td><td class="right">       int nBin = 1000;</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0157" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       double auxSid1 = <span class="delete">SunSidT[0][i];</span></td><td> </td><td class="rblock">       double auxSid1 = <span class="insert">sunSidT[0][day];</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       auxSid1 += <span class="delete">(SunSidT[0][i]</span> &lt; <span class="delete">SunSidT[1][i])?24.0:0.0;</span></td><td> </td><td class="rblock">       auxSid1 += <span class="insert">(sunSidT[0][day]</span> &lt; <span class="insert">sunSidT[1][day]) ? 24.0 : 0.0;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       double deltaT = <span class="delete">(auxSid1-SunSidT[1][i])/((double)nBin);</span></td><td> </td><td class="rblock">       double deltaT = <span class="insert">(auxSid1-sunSidT[1][day]) / ((double)nBin);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                           </td><td> </td><td class="rblock">                                                                           </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       double <span class="delete">Hour;</span></td><td> </td><td class="rblock">       double <span class="insert">hour;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       for (int <span class="delete">j=0;j&lt;nBin;j++)</span> {</td><td> </td><td class="rblock">       for (int <span class="insert">j=0; j&lt;nBin; j++)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               <span class="delete">Hour</span> = <span class="delete">toUnsignedRA(SunSidT[1][i]+deltaT*(double)j</span> - <span class="delete">ObjectR</span></td><td> </td><td class="rblock">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">A[i]);</span></td><td> </td><td class="rblock">               <span class="insert">hour</span> = <span class="insert">toUnsignedRA(sunSidT[1][day]+deltaT*(double)j</span> - <span class="insert">objec</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               Hour</span> -= <span class="delete">(Hour&gt;12.)?24.0:0.0;</span></td><td> </td><td class="rblock"><span class="insert">tRA[day]);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               if <span class="delete">(std::abs(Hour)&lt;ObjectH0[i]</span> || <span class="delete">(ObjectH0[i]</span> &lt; 0.0 &amp;&amp; <span class="delete">alti</span></td><td> </td><td class="rblock"><span class="insert">               hour</span> -= <span class="insert">(hour&gt;12.) ? 24.0 : 0.0;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">&gt;0.0)) {return true;};</span></td><td> </td><td class="rblock">               if <span class="insert">(std::abs(hour)&lt;objectH0[day]</span> || <span class="insert">(objectH0[day]</span> &lt; 0.0 &amp;&amp; </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       };</span></td><td> </td><td class="rblock"><span class="insert">alti&gt;0.0))</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       return true;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return false;</td><td> </td><td class="right">       return false;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">///////////////////////////////////////////</td><td> </td><td class="right">///////////////////////////////////////////</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">///////////////////////////////////////////</td><td> </td><td class="right">///////////////////////////////////////////</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Finds the dates of Acronichal (Rise, Set) and Cosmical (Rise2, Set2) dat
es.</td><td> </td><td class="right">// Finds the dates of Acronichal (Rise, Set) and Cosmical (Rise2, Set2) dat
es.</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0158" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">// Returns 0 if no dates found, 1 if Acro exists, 2 if Cosm exists, and 3 i</span></td><td> </td><td class="rblock">int <span class="insert">Observability::calculateAcroCos(int &amp;acroRise,</span> int <span class="insert">&amp;acroSet,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">f both are found.</span></td><td> </td><td class="rblock">                                    int <span class="insert">&amp;cosRise,</span> int <span class="insert">&amp;cosSet)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">int <span class="delete">Observability::CheckAcro(int &amp;Rise,</span> int <span class="delete">&amp;Set,</span> int <span class="delete">&amp;Rise2,</span> int <span class="delete">&amp;Set2)</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0159" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       <span class="insert">acroRise = -1;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       acroSet = -1;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       cosRise = -1;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       cosSet = -1;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       double bestDiffAcroRise = 12.0;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       double bestDiffAcroSet = 12.0;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       double bestDiffCosRise = 12.0;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       double bestDiffCosSet = 12.0;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0160" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">Rise = -1;</span></td><td> </td><td class="rblock">       double <span class="insert">hourDiffAcroRise, hourDiffAcroSet, hourDiffCosRise, hourCosDi</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       Set = -1;</span></td><td> </td><td class="rblock"><span class="insert">ffSet;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       Rise2 = -1;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       Set2 = -1;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                           </td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       double <span class="delete">BestDiffRise = 12.0;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       double BestDiffSet = 12.0;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       double BestDiffRise2 = 12.0;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       double BestDiffSet2 = 12.0;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       double HourDiffRise, HourDiffSet, HourDiffRise2, HourDiffSet2;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       bool success = false;</td><td> </td><td class="right">       bool success = false;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0161" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       for (int i=0;<span class="delete">i&lt;366;</span>i++)</td><td> </td><td class="rblock">       for (int i=0;<span class="insert"> i&lt;366; </span>i++)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0162" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               if <span class="delete">(ObjectH0[i]&gt;0.0</span> &amp;&amp; <span class="delete">SunSidT[2][i]&gt;0.0</span> &amp;&amp; <span class="delete">SunSidT[3][i]&gt;0.</span></td><td> </td><td class="rblock">               if <span class="insert">(objectH0[i]&gt;0.0</span> &amp;&amp; <span class="insert">sunSidT[2][i]&gt;0.0</span> &amp;&amp; <span class="insert">sunSidT[3][i]&gt;0.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">0) {</td><td> </td><td class="rblock">0)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       success = true;</td><td> </td><td class="right">                       success = true;</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0163" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       <span class="delete">HourDiffRise</span> = <span class="delete">toUnsignedRA(ObjectRA[i]</span> - <span class="delete">ObjectH0[i</span></td><td> </td><td class="rblock">                       <span class="insert">hourDiffAcroRise</span> = <span class="insert">toUnsignedRA(objectRA[i]</span> - <span class="insert">object</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">]);</span></td><td> </td><td class="rblock"><span class="insert">H0[i]);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                       HourDiffRise2</span> = <span class="delete">HourDiffRise-SunSidT[3][i];</span></td><td> </td><td class="rblock"><span class="insert">                       hourDiffCosRise</span> = <span class="insert">hourDiffAcroRise-sunSidT[3][i];</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                       HourDiffRise</span> -= <span class="delete">SunSidT[2][i];</span></td><td> </td><td class="rblock"><span class="insert">                       hourDiffAcroRise</span> -= <span class="insert">sunSidT[2][i];</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                       HourDiffSet</span> = <span class="delete">toUnsignedRA(ObjectRA[i]</span> + <span class="delete">ObjectH0[i]</span></td><td> </td><td class="rblock"><span class="insert">                       hourDiffAcroSet</span> = <span class="insert">toUnsignedRA(objectRA[i]</span> + <span class="insert">objectH</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">);</span></td><td> </td><td class="rblock"><span class="insert">0[i]);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                       HourDiffSet2</span> = <span class="delete">HourDiffSet</span> - <span class="delete">SunSidT[2][i];</span></td><td> </td><td class="rblock"><span class="insert">                       hourCosDiffSet</span> = <span class="insert">hourDiffAcroSet</span> - <span class="insert">sunSidT[2][i];</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                       HourDiffSet</span> -= <span class="delete">SunSidT[3][i];</span></td><td> </td><td class="rblock"><span class="insert">                       hourDiffAcroSet</span> -= <span class="insert">sunSidT[3][i];</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0164" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               // Acronychal <span class="delete">Rise/Set:</span></td><td> </td><td class="rblock">                       // Acronychal <span class="insert">rise/set:</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       if <span class="delete">(std::abs(HourDiffRise)&lt;BestDiffRise)</span></td><td> </td><td class="rblock">                       if <span class="insert">(std::abs(hourDiffAcroRise) &lt; bestDiffAcroRise)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       {</td><td> </td><td class="right">                       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0165" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                               <span class="delete">BestDiffRise</span> = <span class="delete">std::abs(HourDiffRise);</span></td><td> </td><td class="rblock">                               <span class="insert">bestDiffAcroRise</span> = <span class="insert">std::abs(hourDiffAcroRise</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                               Rise</span> = i;</td><td> </td><td class="rblock"><span class="insert">);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                               acroRise</span> = i;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       };</td><td> </td><td class="right">                       };</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0166" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       if (std::abs(<span class="delete">HourDiffSet)&lt;BestDiff</span>Set)</td><td> </td><td class="rblock">                       if (std::abs(<span class="insert">hourDiffAcroSet) &lt; bestDiffAcro</span>Set)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       {</td><td> </td><td class="right">                       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0167" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                               <span class="delete">BestDiffSet</span> = <span class="delete">std::abs(HourDiffSet);</span></td><td> </td><td class="rblock">                               <span class="insert">bestDiffAcroSet</span> = <span class="insert">std::abs(hourDiffAcroSet);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                               Set</span> = i;</td><td> </td><td class="rblock"><span class="insert">                               acroSet</span> = i;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       };</td><td> </td><td class="right">                       };</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0168" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               // Cosmical Rise/Set:</td><td> </td><td class="rblock">                       // Cosmical Rise/Set:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       if <span class="delete">(std::abs(HourDiffRise2)&lt;BestDiffRise2)</span></td><td> </td><td class="rblock">                       if <span class="insert">(std::abs(hourDiffCosRise) &lt; bestDiffCosRise)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       {</td><td> </td><td class="right">                       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0169" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                               <span class="delete">BestDiffRise2</span> = <span class="delete">std::abs(HourDiffRise2);</span></td><td> </td><td class="rblock">                               <span class="insert">bestDiffCosRise</span> = <span class="insert">std::abs(hourDiffCosRise);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                               Rise2</span> = i;</td><td> </td><td class="rblock"><span class="insert">                               cosRise</span> = i;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       };</td><td> </td><td class="right">                       };</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0170" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       if (std::abs(<span class="delete">HourDiffSet2)&lt;BestDiffSet2</span>)</td><td> </td><td class="rblock">                       if (std::abs(<span class="insert">hourCosDiffSet) &lt; bestDiffCosSet</span>)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       {</td><td> </td><td class="right">                       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0171" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                               <span class="delete">BestDiffSet2</span> = <span class="delete">std::abs(HourDiffSet2);</span></td><td> </td><td class="rblock">                               <span class="insert">bestDiffCosSet</span> = <span class="insert">std::abs(hourCosDiffSet);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                               Set2</span> = i;</td><td> </td><td class="rblock"><span class="insert">                               cosSet</span> = i;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       };</td><td> </td><td class="right">                       };</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0172" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                                                                           </span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               };</td><td> </td><td class="right">               };</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       };</td><td> </td><td class="right">       };</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0173" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">Rise</span> *= <span class="delete">(BestDiffRise</span> &gt; 0.083)?-1:1; // Check that <span class="delete">difference</span> is <span class="delete">low</span></td><td> </td><td class="rblock">       <span class="insert">acroRise</span> *= <span class="insert">(bestDiffAcroRise</span> &gt; 0.083)?-1:1; // Check that <span class="insert">differenc</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">er</span> than 5 minutes.</td><td> </td><td class="rblock"><span class="insert">e</span> is <span class="insert">lower</span> than 5 minutes.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">Set</span> *= <span class="delete">(BestDiffSet</span> &gt; 0.083)?-1:1; // Check that difference is lower</td><td> </td><td class="rblock">       <span class="insert">acroSet</span> *= <span class="insert">(bestDiffAcroSet</span> &gt; 0.083)?-1:1; // Check that difference </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"> than 5 minutes.</td><td> </td><td class="rblock">is lower than 5 minutes.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">Rise2</span> *= <span class="delete">(BestDiffRise2</span> &gt; 0.083)?-1:1; // Check that difference is <span class="delete">l</span></td><td> </td><td class="rblock">       <span class="insert">cosRise</span> *= <span class="insert">(bestDiffCosRise</span> &gt; 0.083)?-1:1; // Check that difference </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">ower</span> than 5 minutes.</td><td> </td><td class="rblock">is <span class="insert">lower</span> than 5 minutes.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">Set2</span> *= <span class="delete">(BestDiffSet2</span> &gt; 0.083)?-1:1; // Check that difference is <span class="delete">low</span></td><td> </td><td class="rblock">       <span class="insert">cosSet</span> *= <span class="insert">(bestDiffCosSet</span> &gt; 0.083)?-1:1; // Check that difference is</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">er</span> than 5 minutes.</td><td> </td><td class="rblock"> <span class="insert">lower</span> than 5 minutes.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       int <span class="delete">Result</span> = <span class="delete">(Rise&gt;0</span> || <span class="delete">Set&gt;0)?1:0;</span></td><td> </td><td class="rblock">       int <span class="insert">result</span> = <span class="insert">(acroRise&gt;0</span> || <span class="insert">acroSet&gt;0) ? 1 : 0;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       Result</span> += <span class="delete">(Rise2&gt;0</span> || <span class="delete">Set2&gt;0)?2:0;</span></td><td> </td><td class="rblock"><span class="insert">       result</span> += <span class="insert">(cosRise&gt;0</span> || <span class="insert">cosSet&gt;0) ? 2 : 0;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       return <span class="delete">(success)?Result:0;</span></td><td> </td><td class="rblock">       return <span class="insert">(success) ? result : 0;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">///////////////////////////////////////////</td><td> </td><td class="right">///////////////////////////////////////////</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">////////////////////////////////////////////</td><td> </td><td class="right">////////////////////////////////////////////</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Convert an Equatorial Vec3d into RA and Dec:</td><td> </td><td class="right">// Convert an Equatorial Vec3d into RA and Dec:</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0174" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">void Observability::toRADec(Vec3d <span class="delete">TempLoc, double &amp;RA, double &amp;D</span>ec)</td><td> </td><td class="rblock">void Observability::toRADec(Vec3d <span class="insert">vec3d, double&amp; ra, double &amp;d</span>ec)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0175" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">TempLoc.normalize();</span></td><td> </td><td class="rblock">       <span class="insert">vec3d.normalize();</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       Dec</span> = <span class="delete">std::asin(TempLoc[2]);</span> // in radians</td><td> </td><td class="rblock"><span class="insert">       dec</span> = <span class="insert">std::asin(vec3d[2]);</span> // in radians</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">RA</span> = <span class="delete">toUnsignedRA(std::atan2(TempLoc[1],TempLoc[0])*Rad2Hr);</span> // in <span class="delete">h</span></td><td> </td><td class="rblock">       <span class="insert">ra</span> = <span class="insert">toUnsignedRA(std::atan2(vec3d[1],vec3d[0])*Rad2Hr);</span> // in <span class="insert">hours</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">ours.</span></td><td> </td><td class="rblock"><span class="insert">.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">////////////////////////////////////////////</td><td> </td><td class="right">////////////////////////////////////////////</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">///////////////////////////</td><td> </td><td class="right">///////////////////////////</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Just return the sign of a double</td><td> </td><td class="right">// Just return the sign of a double</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">double Observability::sign(double d)</td><td> </td><td class="right">double Observability::sign(double d)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return (d&lt;0.0)?-1.0:1.0;</td><td> </td><td class="right">       return (d&lt;0.0)?-1.0:1.0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//////////////////////////</td><td> </td><td class="right">//////////////////////////</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//////////////////////////</td><td> </td><td class="right">//////////////////////////</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Get the coordinates of Sun or Moon for a given JD:</td><td> </td><td class="right">// Get the coordinates of Sun or Moon for a given JD:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// getBack controls whether Earth and Moon must be returned to their origin
al positions after computation.</td><td> </td><td class="right">// getBack controls whether Earth and Moon must be returned to their origin
al positions after computation.</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0176" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">void Observability::getSunMoonCoords(StelCore *core, double <span class="delete">JD,</span> double <span class="delete">&amp;RAS</span></td><td> </td><td class="rblock">void Observability::getSunMoonCoords(StelCore *core, double <span class="insert">jd,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">un,</span> double <span class="delete">&amp;DecSun,</span> double <span class="delete">&amp;RAMoon,</span> double <span class="delete">&amp;DecMoon,</span> double <span class="delete">&amp;EclLon,</span> bool <span class="delete">g</span></td><td> </td><td class="rblock">                                     double <span class="insert">&amp;raSun,</span> double <span class="insert">&amp;decSun,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">etBack)</span> //, Vec3d &amp;AltAzVector)</td><td> </td><td class="rblock">                                     double <span class="insert">&amp;raMoon,</span> double <span class="insert">&amp;decMoon,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                                     double <span class="insert">&amp;eclLon,</span> bool <span class="insert">getBack)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                                     //, Vec3d &amp;AltAzVector)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (getBack) // Return the Moon and Earth to their current position:</td><td> </td><td class="right">       if (getBack) // Return the Moon and Earth to their current position:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0177" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               <span class="delete">myEarth-&gt;computePosition(JD);</span></td><td> </td><td class="rblock">               <span class="insert">myEarth-&gt;computePosition(jd);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               myEarth-&gt;computeTransMatrix(JD);</span></td><td> </td><td class="rblock"><span class="insert">               myEarth-&gt;computeTransMatrix(jd);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               myMoon-&gt;computePosition(JD);</span></td><td> </td><td class="rblock"><span class="insert">               myMoon-&gt;computePosition(jd);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               myMoon-&gt;computeTransMatrix(JD);</span></td><td> </td><td class="rblock"><span class="insert">               myMoon-&gt;computeTransMatrix(jd);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0178" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       else</td><td> </td><td class="rblock">       else // Compute coordinates:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">{</span>       // Compute coordinates:</td><td> </td><td class="rblock">       <span class="insert">{</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               <span class="delete">myEarth-&gt;computePosition(JD);</span></td><td> </td><td class="rblock"><span class="insert">               myEarth-&gt;computePosition(jd);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               myEarth-&gt;computeTransMatrix(JD);</span></td><td> </td><td class="rblock"><span class="insert">               myEarth-&gt;computeTransMatrix(jd);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               Pos0</span> = myEarth-&gt;getHeliocentricEclipticPos();</td><td> </td><td class="rblock"><span class="insert">               Vec3d earthPos</span> = myEarth-&gt;getHeliocentricEclipticPos();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               double <span class="delete">currSidT;</span></td><td> </td><td class="rblock">               double <span class="insert">curSidT;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Sun coordinates:</td><td> </td><td class="right">// Sun coordinates:</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0179" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               <span class="delete">Pos2</span> = <span class="delete">core-&gt;j2000ToEquinoxEqu((core-&gt;matVsop87ToJ2000)*(-Po</span></td><td> </td><td class="rblock">               <span class="insert">Vec3d sunPos</span> = <span class="insert">core-&gt;j2000ToEquinoxEqu((core-&gt;matVsop87ToJ20</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">s0));</span></td><td> </td><td class="rblock"><span class="insert">00)*(-earthPos));</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               toRADec(Pos2,RASun,DecSun);</span></td><td> </td><td class="rblock"><span class="insert">               toRADec(sunPos, raSun, decSun);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Moon coordinates:</td><td> </td><td class="right">// Moon coordinates:</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0180" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               <span class="delete">currSidT</span> = <span class="delete">myEarth-&gt;getSiderealTime(JD)/Rad2Deg;</span></td><td> </td><td class="rblock">               <span class="insert">curSidT</span> = <span class="insert">myEarth-&gt;getSiderealTime(jd)/Rad2Deg;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               RotObserver = <span class="delete">(Mat4d::zrotation(currSidT))*ObserverLoc;</span></td><td> </td><td class="rblock">               RotObserver = <span class="insert">(Mat4d::zrotation(curSidT))*ObserverLoc;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               LocTrans = <span class="delete">(core-&gt;matVsop87ToJ2000)*(Mat4d::translation(-Pos</span></td><td> </td><td class="rblock">               LocTrans = <span class="insert">(core-&gt;matVsop87ToJ2000)*(Mat4d::translation(-ear</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">0));</span></td><td> </td><td class="rblock"><span class="insert">thPos));</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               myMoon-&gt;computePosition(JD);</span></td><td> </td><td class="rblock"><span class="insert">               myMoon-&gt;computePosition(jd);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               myMoon-&gt;computeTransMatrix(JD);</span></td><td> </td><td class="rblock"><span class="insert">               myMoon-&gt;computeTransMatrix(jd);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               Pos1</span> = myMoon-&gt;getHeliocentricEclipticPos();</td><td> </td><td class="rblock"><span class="insert">               Vec3d moonPos</span> = myMoon-&gt;getHeliocentricEclipticPos();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               <span class="delete">Pos2</span> = <span class="delete">(core-&gt;j2000ToEquinoxEqu(LocTrans*Pos1))-RotObserver;</span></td><td> </td><td class="rblock">               <span class="insert">sunPos</span> = <span class="insert">(core-&gt;j2000ToEquinoxEqu(LocTrans*moonPos))-RotObse</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">rver;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0181" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               <span class="delete"> EclLon = Pos1[0]*Pos0[1] - Pos1[1]*Pos0</span>[0];</td><td> </td><td class="rblock">               <span class="insert">eclLon = moonPos[0]*earthPos[1] - moonPos[1]*earthPos</span>[0];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0182" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               toRADec(<span class="delete">Pos2,RAMoon,D</span>ecMoon);</td><td> </td><td class="rblock">               toRADec(<span class="insert">sunPos,raMoon,d</span>ecMoon);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       };</td><td> </td><td class="right">       };</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//////////////////////////////////////////////</td><td> </td><td class="right">//////////////////////////////////////////////</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//////////////////////////</td><td> </td><td class="right">//////////////////////////</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Get the Observer-to-Moon distance JD:</td><td> </td><td class="right">// Get the Observer-to-Moon distance JD:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// getBack controls whether Earth and Moon must be returned to their origin
al positions after computation.</td><td> </td><td class="right">// getBack controls whether Earth and Moon must be returned to their origin
al positions after computation.</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0183" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">void Observability::getMoonDistance(StelCore *core, double <span class="delete">JD, double &amp;D</span>ist
ance, bool getBack)</td><td> </td><td class="rblock">void Observability::getMoonDistance(StelCore *core, double <span class="insert">jd, double &amp;d</span>ist
ance, bool getBack)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (getBack) // Return the Moon and Earth to their current position:</td><td> </td><td class="right">       if (getBack) // Return the Moon and Earth to their current position:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0184" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               <span class="delete">myEarth-&gt;computePosition(JD);</span></td><td> </td><td class="rblock">               <span class="insert">myEarth-&gt;computePosition(jd);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               myEarth-&gt;computeTransMatrix(JD);</span></td><td> </td><td class="rblock"><span class="insert">               myEarth-&gt;computeTransMatrix(jd);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               myMoon-&gt;computePosition(JD);</span></td><td> </td><td class="rblock"><span class="insert">               myMoon-&gt;computePosition(jd);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               myMoon-&gt;computeTransMatrix(JD);</span></td><td> </td><td class="rblock"><span class="insert">               myMoon-&gt;computeTransMatrix(jd);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       else</td><td> </td><td class="right">       else</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {       // Compute coordinates:</td><td> </td><td class="right">       {       // Compute coordinates:</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0185" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               <span class="delete">myEarth-&gt;computePosition(JD);</span></td><td> </td><td class="rblock">               <span class="insert">myEarth-&gt;computePosition(jd);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               myEarth-&gt;computeTransMatrix(JD);</span></td><td> </td><td class="rblock"><span class="insert">               myEarth-&gt;computeTransMatrix(jd);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               Pos0</span> = myEarth-&gt;getHeliocentricEclipticPos();</td><td> </td><td class="rblock"><span class="insert">               Vec3d earthPos</span> = myEarth-&gt;getHeliocentricEclipticPos();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">//             double <span class="delete">currSidT;</span></td><td> </td><td class="rblock">//             double <span class="insert">curSidT;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Sun coordinates:</td><td> </td><td class="right">// Sun coordinates:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//             Pos2 = core-&gt;j2000ToEquinoxEqu((core-&gt;matVsop87ToJ2000)*(-Po
s0));</td><td> </td><td class="right">//             Pos2 = core-&gt;j2000ToEquinoxEqu((core-&gt;matVsop87ToJ2000)*(-Po
s0));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//             toRADec(Pos2,RASun,DecSun);</td><td> </td><td class="right">//             toRADec(Pos2,RASun,DecSun);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Moon coordinates:</td><td> </td><td class="right">// Moon coordinates:</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0186" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">//             <span class="delete">currSidT</span> = myEarth-&gt;getSiderealTime(JD)/Rad2Deg;</td><td> </td><td class="rblock">//             <span class="insert">curSidT</span> = myEarth-&gt;getSiderealTime(JD)/Rad2Deg;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">//             RotObserver = <span class="delete">(Mat4d::zrotation(currSidT))*ObserverLoc;</span></td><td> </td><td class="rblock">//             RotObserver = <span class="insert">(Mat4d::zrotation(curSidT))*ObserverLoc;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               LocTrans = <span class="delete">(core-&gt;matVsop87ToJ2000)*(Mat4d::translation(-Pos</span></td><td> </td><td class="rblock">               LocTrans = <span class="insert">(core-&gt;matVsop87ToJ2000)*(Mat4d::translation(-ear</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">0));</span></td><td> </td><td class="rblock"><span class="insert">thPos));</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               myMoon-&gt;computePosition(JD);</span></td><td> </td><td class="rblock"><span class="insert">               myMoon-&gt;computePosition(jd);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               myMoon-&gt;computeTransMatrix(JD);</span></td><td> </td><td class="rblock"><span class="insert">               myMoon-&gt;computeTransMatrix(jd);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               Pos1 = myMoon-&gt;getHeliocentricEclipticPos();</td><td> </td><td class="right">               Pos1 = myMoon-&gt;getHeliocentricEclipticPos();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               Pos2 = (core-&gt;j2000ToEquinoxEqu(LocTrans*Pos1)); //-RotObser
ver;</td><td> </td><td class="right">               Pos2 = (core-&gt;j2000ToEquinoxEqu(LocTrans*Pos1)); //-RotObser
ver;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0187" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               <span class="delete">D</span>istance = std::sqrt(Pos2*Pos2);</td><td> </td><td class="rblock">               <span class="insert">d</span>istance = std::sqrt(Pos2*Pos2);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//             toRADec(Pos2,RAMoon,DecMoon);</td><td> </td><td class="right">//             toRADec(Pos2,RAMoon,DecMoon);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       };</td><td> </td><td class="right">       };</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//////////////////////////////////////////////</td><td> </td><td class="right">//////////////////////////////////////////////</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//////////////////////////////////////////////</td><td> </td><td class="right">//////////////////////////////////////////////</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Get the Coords of a planet:</td><td> </td><td class="right">// Get the Coords of a planet:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void Observability::getPlanetCoords(StelCore *core, double JD, double &amp;RA, 
double &amp;Dec, bool getBack)</td><td> </td><td class="right">void Observability::getPlanetCoords(StelCore *core, double JD, double &amp;RA, 
double &amp;Dec, bool getBack)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l3" /><small>skipping to change at</small><em> line 1199</em></th><th> </th><th><a name="part-r3" /><small>skipping to change at</small><em> line 1266</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               Pos2 = myEarth-&gt;getHeliocentricEclipticPos();</td><td> </td><td class="right">               Pos2 = myEarth-&gt;getHeliocentricEclipticPos();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               LocTrans = (core-&gt;matVsop87ToJ2000)*(Mat4d::translation(-Pos
2));</td><td> </td><td class="right">               LocTrans = (core-&gt;matVsop87ToJ2000)*(Mat4d::translation(-Pos
2));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               Pos2 = core-&gt;j2000ToEquinoxEqu(LocTrans*Pos1);</td><td> </td><td class="right">               Pos2 = core-&gt;j2000ToEquinoxEqu(LocTrans*Pos1);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               toRADec(Pos2,RA,Dec);</td><td> </td><td class="right">               toRADec(Pos2,RA,Dec);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       };</td><td> </td><td class="right">       };</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//////////////////////////////////////////////</td><td> </td><td class="right">//////////////////////////////////////////////</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//////////////////////////////////////////////</td><td> </td><td class="right">//////////////////////////////////////////////</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0188" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">// Solves Moon's, Sun's, or Planet's ephemeris by bissection. <span class="delete">Returns JD:</span></td><td> </td><td class="rblock">// Solves Moon's, Sun's, or Planet's ephemeris by bissection.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">bool <span class="delete">Observability::SolarSystemSolve(StelCore*</span> core, int <span class="delete">Kind)</span></td><td> </td><td class="rblock">bool <span class="insert">Observability::calculateSolarSystemEvents(StelCore*</span> core, int <span class="insert">bodyType</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0189" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">int Niter</span> = 100;</td><td> </td><td class="rblock">       <span class="insert">const int NUM_ITER</span> = 100;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       int i;</td><td> </td><td class="right">       int i;</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0190" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       double <span class="delete">Hhoriz, RA, Dec, RAS, DecS, TempH, jd1,</span> tempEphH, <span class="delete">currSidT, E</span></td><td> </td><td class="rblock">       double <span class="insert">hHoriz, ra, dec, raSun, decSun, tempH, tempJd,</span> tempEphH, <span class="insert">curS</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">clLon;</span></td><td> </td><td class="rblock"><span class="insert">idT, eclLon;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       Vec3d</span> Observer;</td><td> </td><td class="rblock"><span class="insert">       //Vec3d</span> Observer;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0191" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">Hhoriz</span> = <span class="delete">HourAngle(mylat,RefracHoriz,selDec);</span></td><td> </td><td class="rblock">       <span class="insert">hHoriz</span> = <span class="insert">calculateHourAngle(mylat, refractedHorizonAlt, selDec);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       bool raises = <span class="delete">Hhoriz</span> &gt; 0.0;</td><td> </td><td class="rblock">       bool raises = <span class="insert">hHoriz</span> &gt; 0.0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Only recompute ephemeris from second to second (at least)</td><td> </td><td class="right">// Only recompute ephemeris from second to second (at least)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// or if the source has changed (i.e., Sun &lt;-&gt; Moon). This saves resources:</td><td> </td><td class="right">// or if the source has changed (i.e., Sun &lt;-&gt; Moon). This saves resources:</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0192" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       if (std::abs(myJD-lastJDMoon)&gt;JDsec || <span class="delete">LastObject!=Kind || souChange
</span>d)</td><td> </td><td class="rblock">       if (std::abs(myJD-lastJDMoon)&gt;JDsec || <span class="insert">lastType!=bodyType || souChan
ge</span>d)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//             qDebug() &lt;&lt; q_("%1  %2   %3   %4").arg(Kind).arg(LastObject)
.arg(myJD,0,'f',5).arg(lastJDMoon,0,'f',5);</td><td> </td><td class="right">//             qDebug() &lt;&lt; q_("%1  %2   %3   %4").arg(Kind).arg(LastObject)
.arg(myJD,0,'f',5).arg(lastJDMoon,0,'f',5);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0193" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               <span class="delete">LastObject = Kind</span>;</td><td> </td><td class="rblock">               <span class="insert">lastType = bodyType</span>;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               myEarth-&gt;computePosition(myJD);</td><td> </td><td class="right">               myEarth-&gt;computePosition(myJD);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               myEarth-&gt;computeTransMatrix(myJD);</td><td> </td><td class="right">               myEarth-&gt;computeTransMatrix(myJD);</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0194" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               <span class="delete">Pos0</span> = myEarth-&gt;getHeliocentricEclipticPos();</td><td> </td><td class="rblock">               <span class="insert">Vec3d earthPos</span> = myEarth-&gt;getHeliocentricEclipticPos();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0195" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               if <span class="delete">(Kind==1)</span></td><td> </td><td class="rblock">               if <span class="insert">(bodyType == 1)</span> // Sun <span class="insert">position</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               {</span>   // Sun <span class="delete">position:</span></td><td> </td><td class="rblock"><span class="insert">               {</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       Pos2 = core-&gt;j2000ToEquinoxEqu((core-&gt;matVsop87ToJ20</td><td> </td><td class="rblock">                       Pos2 = core-&gt;j2000ToEquinoxEqu((core-&gt;matVsop87ToJ20</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">00)*(-Pos0));</span></td><td> </td><td class="rblock"><span class="insert">00)*(-earthPos));</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               } else if <span class="delete">(Kind==2)</span></td><td> </td><td class="rblock">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               {</span>   // Moon <span class="delete">position:</span></td><td> </td><td class="rblock">               else if <span class="insert">(bodyType==2)</span> // Moon <span class="insert">position</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                       currSidT</span> = myEarth-&gt;getSiderealTime(myJD)/Rad2Deg;</td><td> </td><td class="rblock"><span class="insert">               {</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       RotObserver = <span class="delete">(Mat4d::zrotation(currSidT))*ObserverL</span></td><td> </td><td class="rblock"><span class="insert">                       curSidT</span> = myEarth-&gt;getSiderealTime(myJD)/Rad2Deg;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">oc;</span></td><td> </td><td class="rblock">                       RotObserver = <span class="insert">(Mat4d::zrotation(curSidT))*ObserverLo</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       LocTrans = (core-&gt;matVsop87ToJ2000)*(Mat4d::translat</td><td> </td><td class="rblock"><span class="insert">c;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">ion(-Pos0));</span></td><td> </td><td class="rblock">                       LocTrans = (core-&gt;matVsop87ToJ2000)*(Mat4d::translat</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">ion(-earthPos));</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       myMoon-&gt;computePosition(myJD);</td><td> </td><td class="right">                       myMoon-&gt;computePosition(myJD);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       myMoon-&gt;computeTransMatrix(myJD);</td><td> </td><td class="right">                       myMoon-&gt;computeTransMatrix(myJD);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       Pos1 = myMoon-&gt;getHeliocentricEclipticPos();</td><td> </td><td class="right">                       Pos1 = myMoon-&gt;getHeliocentricEclipticPos();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       Pos2 = (core-&gt;j2000ToEquinoxEqu(LocTrans*Pos1))-RotO
bserver;</td><td> </td><td class="right">                       Pos2 = (core-&gt;j2000ToEquinoxEqu(LocTrans*Pos1))-RotO
bserver;</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0196" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               } else</td><td> </td><td class="rblock">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               <span class="delete">{</span>   // Planet <span class="delete">position:</span></td><td> </td><td class="rblock">               else // Planet <span class="insert">position</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                               myPlanet-&gt;computePosition(myJD);</td><td> </td><td class="rblock"><span class="insert">               {</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                               myPlanet-&gt;computeTransMatrix(myJD);</td><td> </td><td class="rblock">                       myPlanet-&gt;computePosition(myJD);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                               Pos1 = <span class="delete">myPlanet-&gt;getHeliocentricEclipticPos(</span></td><td> </td><td class="rblock">                       myPlanet-&gt;computeTransMatrix(myJD);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">);</span></td><td> </td><td class="rblock">                       Pos1 = <span class="insert">myPlanet-&gt;getHeliocentricEclipticPos();</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                               LocTrans = <span class="delete">(core-&gt;matVsop87ToJ2000)*(Mat4d::</span></td><td> </td><td class="rblock">                       LocTrans = <span class="insert">(core-&gt;matVsop87ToJ2000)*(Mat4d::translat</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">translation(-Pos0));</span></td><td> </td><td class="rblock"><span class="insert">ion(-earthPos));</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       Pos2 = core-&gt;j2000ToEquinoxEqu(LocTrans*Pos1);</td><td> </td><td class="rblock">                       Pos2 = core-&gt;j2000ToEquinoxEqu(LocTrans*Pos1);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               };</td><td> </td><td class="right">               };</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0197" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               <span class="delete">toRADec(Pos2,RA,Dec);</span></td><td> </td><td class="rblock">               <span class="insert">toRADec(Pos2,ra,dec);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               Vec3d <span class="delete">MoonAltAz</span> = <span class="delete">core-&gt;equinoxEquToAltAz(Pos2,StelCore::Ref</span></td><td> </td><td class="rblock">               Vec3d <span class="insert">moonAltAz</span> = <span class="insert">core-&gt;equinoxEquToAltAz(Pos2, StelCore::Re</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">ractionOff);</span></td><td> </td><td class="rblock"><span class="insert">fractionOff);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               raised</span> = <span class="delete">MoonAltAz[2]</span> &gt; <span class="delete">RefracHoriz;</span></td><td> </td><td class="rblock"><span class="insert">               hasRisen</span> = <span class="insert">moonAltAz[2]</span> &gt; <span class="insert">refractedHorizonAlt;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Initial guesses of rise/set/transit times.</td><td> </td><td class="right">// Initial guesses of rise/set/transit times.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// They are called 'Moon', but are also used for the Sun or planet:</td><td> </td><td class="right">// They are called 'Moon', but are also used for the Sun or planet:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0198" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               double Hcurr = -<span class="delete">HourAngle(mylat,alti,selDec)*sign(LocPos[1])
</span>;</td><td> </td><td class="rblock">               double Hcurr = -<span class="insert">calculateHourAngle(mylat,alti,selDec)*sign(L
ocPos[1])</span>;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               double SidT = toUnsignedRA(selRA + Hcurr);</td><td> </td><td class="right">               double SidT = toUnsignedRA(selRA + Hcurr);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               MoonCulm = -Hcurr;</td><td> </td><td class="right">               MoonCulm = -Hcurr;</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0199" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               MoonRise = <span class="delete">(-Hhoriz-Hcurr);</span></td><td> </td><td class="rblock">               MoonRise = <span class="insert">(-hHoriz-Hcurr);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               MoonSet = <span class="delete">(Hhoriz-Hcurr);</span></td><td> </td><td class="rblock">               MoonSet = <span class="insert">(hHoriz-Hcurr);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0200" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               if (raises) {</td><td> </td><td class="rblock">               if (raises)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       if <span class="delete">(raised==false)</span> {</td><td> </td><td class="rblock">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                       if <span class="insert">(!hasRisen)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               MoonRise += (MoonRise&lt;0.0)?24.0:0.0;</td><td> </td><td class="right">                               MoonRise += (MoonRise&lt;0.0)?24.0:0.0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               MoonSet -= (MoonSet&gt;0.0)?24.0:0.0;</td><td> </td><td class="right">                               MoonSet -= (MoonSet&gt;0.0)?24.0:0.0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0201" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       }<span class="delete">;</span></td><td> </td><td class="rblock">                       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Rise time:</td><td> </td><td class="right">// Rise time:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       tempEphH = MoonRise*TFrac;</td><td> </td><td class="right">                       tempEphH = MoonRise*TFrac;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       MoonRise = myJD + (MoonRise/24.);</td><td> </td><td class="right">                       MoonRise = myJD + (MoonRise/24.);</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0202" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       for (i=0; i&lt;N<span class="delete">iter</span>; i++)</td><td> </td><td class="rblock">                       for (i=0; i&lt;N<span class="insert">UM_ITER</span>; i++)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       {</td><td> </td><td class="right">                       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // Get modified coordinates:</td><td> </td><td class="right">       // Get modified coordinates:</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0203" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                               <span class="delete">jd1</span> = MoonRise;</td><td> </td><td class="rblock">                               <span class="insert">tempJd</span> = MoonRise;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0204" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                               if (<span class="delete">Kind</span>&lt;3)</td><td> </td><td class="rblock">                               if (<span class="insert">bodyType</span>&lt;3)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               {</td><td> </td><td class="right">                               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0205" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                       <span class="delete">getSunMoonCoords(core,jd1,RAS,DecS,R</span></td><td> </td><td class="rblock">                                       <span class="insert">getSunMoonCoords(core, tempJd,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">A,Dec,EclLon,false);</span></td><td> </td><td class="rblock"><span class="insert">                                                        raSun, decSun,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                                                        ra, dec,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                                                        eclLon, false);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               } else</td><td> </td><td class="right">                               } else</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               {</td><td> </td><td class="right">                               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0206" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                       getPlanetCoords(core,<span class="delete">jd1,RA,Dec,fals
</span>e);</td><td> </td><td class="rblock">                                       getPlanetCoords(core,<span class="insert"> tempJd, ra, de
c, fals</span>e);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               };</td><td> </td><td class="right">                               };</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0207" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                               if (<span class="delete">Kind==1) {RA = RAS; Dec = DecS;}</span>;</td><td> </td><td class="rblock">                               if (<span class="insert">bodyType==1) {ra = raSun; dec = decSun;}
</span>;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // Current hour angle at mod. coordinates:</td><td> </td><td class="right">       // Current hour angle at mod. coordinates:</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0208" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                               Hcurr = <span class="delete">toUnsignedRA(SidT-RA);</span></td><td> </td><td class="rblock">                               Hcurr = <span class="insert">toUnsignedRA(SidT-ra);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                               Hcurr -= <span class="delete">(raised)?0.0:24.;</span></td><td> </td><td class="rblock">                               Hcurr -= <span class="insert">(hasRisen)?0.0:24.;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               Hcurr -= (Hcurr&gt;12.)?24.0:0.0;</td><td> </td><td class="right">                               Hcurr -= (Hcurr&gt;12.)?24.0:0.0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // H at horizon for mod. coordinates:</td><td> </td><td class="right">       // H at horizon for mod. coordinates:</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0209" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                               <span class="delete">Hhoriz = HourAngle(mylat,RefracHoriz,D</span>ec);</td><td> </td><td class="rblock">                               <span class="insert">hHoriz = calculateHourAngle(mylat,refractedH
orizonAlt,d</span>ec);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // Compute eph. times for mod. coordinates:</td><td> </td><td class="right">       // Compute eph. times for mod. coordinates:</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0210" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                               <span class="delete">TempH</span> = <span class="delete">(-Hhoriz-Hcurr)*TFrac;</span></td><td> </td><td class="rblock">                               <span class="insert">tempH</span> = <span class="insert">(-hHoriz-Hcurr)*TFrac;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                               if <span class="delete">(raised==false) TempH</span> += <span class="delete">(TempH&lt;0.0)?24.0</span></td><td> </td><td class="rblock">                               if <span class="insert">(hasRisen==false) tempH</span> += <span class="insert">(tempH&lt;0.0)?24</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">:0.0;</span></td><td> </td><td class="rblock"><span class="insert">.0:0.0;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       // Check convergence:</td><td> </td><td class="right">                       // Check convergence:</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0211" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                               if (std::abs(<span class="delete">T</span>empH-tempEphH)&lt;JDsec) break;</td><td> </td><td class="rblock">                               if (std::abs(<span class="insert">t</span>empH-tempEphH)&lt;JDsec) break;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       // Update rise-time estimate:</td><td> </td><td class="right">                       // Update rise-time estimate:</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0212" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                               tempEphH = <span class="delete">T</span>empH;</td><td> </td><td class="rblock">                               tempEphH = <span class="insert">t</span>empH;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               MoonRise = myJD + (tempEphH/24.);</td><td> </td><td class="right">                               MoonRise = myJD + (tempEphH/24.);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       };</td><td> </td><td class="right">                       };</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Set time:</td><td> </td><td class="right">// Set time:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       tempEphH = MoonSet;</td><td> </td><td class="right">                       tempEphH = MoonSet;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       MoonSet = myJD + (MoonSet/24.);</td><td> </td><td class="right">                       MoonSet = myJD + (MoonSet/24.);</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0213" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       for (i=0; i&lt;N<span class="delete">iter</span>; i++)</td><td> </td><td class="rblock">                       for (i=0; i&lt;N<span class="insert">UM_ITER</span>; i++)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       {</td><td> </td><td class="right">                       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // Get modified coordinates:</td><td> </td><td class="right">       // Get modified coordinates:</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0214" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                               <span class="delete">jd1</span> = MoonSet;</td><td> </td><td class="rblock">                               <span class="insert">tempJd</span> = MoonSet;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0215" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                               if <span class="delete">(Kind&lt;3)</span></td><td> </td><td class="rblock">                               if <span class="insert">(bodyType &lt; 3)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                               {</span></td><td> </td><td class="rblock"><span class="insert">                                       getSunMoonCoords(core, tempJd,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                                       getSunMoonCoords(core,jd1,RAS,DecS,R</span></td><td> </td><td class="rblock"><span class="insert">                                                        raSun, decSun,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">A,Dec,EclLon,false);</span></td><td> </td><td class="rblock"><span class="insert">                                                        ra, dec,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                               }</span> else</td><td> </td><td class="rblock"><span class="insert">                                                        eclLon, false);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                               <span class="delete">{</span></td><td> </td><td class="rblock">                               else</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                                       getPlanetCoords(core,jd1,RA,Dec,fals</span></td><td> </td><td class="rblock">                                       <span class="insert">getPlanetCoords(core, tempJd, ra, de</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">e);</span></td><td> </td><td class="rblock"><span class="insert">c, false);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                               };</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0216" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                               if (<span class="delete">Kind==1) {RA = RAS; Dec = DecS;}</span>;</td><td> </td><td class="rblock">                               if (<span class="insert">bodyType==1) {ra = raSun; dec = decSun;}
</span>;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // Current hour angle at mod. coordinates:</td><td> </td><td class="right">       // Current hour angle at mod. coordinates:</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0217" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                               Hcurr = <span class="delete">toUnsignedRA(SidT-RA);</span></td><td> </td><td class="rblock">                               Hcurr = <span class="insert">toUnsignedRA(SidT-ra);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                               Hcurr -= <span class="delete">(raised)?24.:0.;</span></td><td> </td><td class="rblock">                               Hcurr -= <span class="insert">(hasRisen)?24.:0.;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               Hcurr += (Hcurr&lt;-12.)?24.0:0.0;</td><td> </td><td class="right">                               Hcurr += (Hcurr&lt;-12.)?24.0:0.0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // H at horizon for mod. coordinates:</td><td> </td><td class="right">       // H at horizon for mod. coordinates:</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0218" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                               <span class="delete">Hhoriz = HourAngle(mylat,RefracHoriz,D</span>ec);</td><td> </td><td class="rblock">                               <span class="insert">hHoriz = calculateHourAngle(mylat, refracted
HorizonAlt, d</span>ec);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // Compute eph. times for mod. coordinates:</td><td> </td><td class="right">       // Compute eph. times for mod. coordinates:</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0219" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                               <span class="delete">TempH</span> = <span class="delete">(Hhoriz-Hcurr)*TFrac;</span></td><td> </td><td class="rblock">                               <span class="insert">tempH</span> = <span class="insert">(hHoriz-Hcurr)*TFrac;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                               if <span class="delete">(raised==false) TempH</span> -= <span class="delete">(TempH&gt;0.0)?24.0</span></td><td> </td><td class="rblock">                               if <span class="insert">(!hasRisen)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">:0.0;</span></td><td> </td><td class="rblock"><span class="insert">                                       tempH</span> -= <span class="insert">(tempH&gt;0.0)?24.0:0.0;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               // Check convergence:</td><td> </td><td class="right">               // Check convergence:</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0220" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                               if <span class="delete">(std::abs(TempH-tempEphH)&lt;JDsec)</span> break;</td><td> </td><td class="rblock">                               if <span class="insert">(std::abs(tempH-tempEphH)&lt;JDsec)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                                       break;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               // Update set-time estimate:</td><td> </td><td class="right">               // Update set-time estimate:</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0221" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                               tempEphH = <span class="delete">T</span>empH;</td><td> </td><td class="rblock">                               tempEphH = <span class="insert">t</span>empH;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               MoonSet = myJD + (tempEphH/24.);</td><td> </td><td class="right">                               MoonSet = myJD + (tempEphH/24.);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       };</td><td> </td><td class="right">                       };</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               else // Comes from if(raises)</td><td> </td><td class="right">               else // Comes from if(raises)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0222" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       MoonSet = -1.0; MoonRise = -1.0;</td><td> </td><td class="rblock">                       MoonSet = -1.0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                       MoonRise = -1.0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               };</td><td> </td><td class="right">               };</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Culmination time:</td><td> </td><td class="right">// Culmination time:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               tempEphH = MoonCulm;</td><td> </td><td class="right">               tempEphH = MoonCulm;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               MoonCulm = myJD + (MoonCulm/24.);</td><td> </td><td class="right">               MoonCulm = myJD + (MoonCulm/24.);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0223" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               for (i=0; i&lt;N<span class="delete">iter</span>; i++)</td><td> </td><td class="rblock">               for (i=0; i&lt;N<span class="insert">UM_ITER</span>; i++)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0224" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       // Get modified coordinates:</td><td> </td><td class="rblock">                       // Get modified coordinates:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       <span class="delete">jd1</span> = MoonCulm;</td><td> </td><td class="rblock">                       <span class="insert">tempJd</span> = MoonCulm;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0225" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                               if <span class="delete">(Kind&lt;3)</span></td><td> </td><td class="rblock">                       if <span class="insert">(bodyType&lt;3)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                       {</td><td> </td><td class="rblock">                       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                       <span class="delete">getSunMoonCoords(core,jd1,RAS,DecS,R</span></td><td> </td><td class="rblock">                               <span class="insert">getSunMoonCoords(core,tempJd,raSun,decSun,ra</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">A,Dec,EclLon,false);</span></td><td> </td><td class="rblock"><span class="insert">,dec,eclLon,false);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                               } else</td><td> </td><td class="rblock">                       } else</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                               {</td><td> </td><td class="rblock">                       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                       <span class="delete">getPlanetCoords(core,jd1,RA,Dec,fals</span></td><td> </td><td class="rblock">                               <span class="insert">getPlanetCoords(core,tempJd,ra,dec,false);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">e);</span></td><td> </td><td class="rblock">                       };</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                               };</td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0226" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       if (<span class="delete">Kind==1) {RA = RAS; Dec = DecS</span>;};</td><td> </td><td class="rblock">                       if (<span class="insert">bodyType==1) {ra = raSun; dec = decSun</span>;};</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // Current hour angle at mod. coordinates:</td><td> </td><td class="right">       // Current hour angle at mod. coordinates:</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0227" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       Hcurr = toUnsignedRA(SidT-<span class="delete">RA</span>);</td><td> </td><td class="rblock">                       Hcurr = toUnsignedRA(SidT-<span class="insert">ra</span>);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       Hcurr += (LocPos[1]&lt;0.0)?24.0:-24.0;</td><td> </td><td class="right">                       Hcurr += (LocPos[1]&lt;0.0)?24.0:-24.0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       Hcurr -= (Hcurr&gt;12.)?24.0:0.0;</td><td> </td><td class="right">                       Hcurr -= (Hcurr&gt;12.)?24.0:0.0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // Compute eph. times for mod. coordinates:</td><td> </td><td class="right">       // Compute eph. times for mod. coordinates:</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0228" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       <span class="delete">T</span>empH = -Hcurr*TFrac;</td><td> </td><td class="rblock">                       <span class="insert">t</span>empH = -Hcurr*TFrac;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // Check convergence:</td><td> </td><td class="right">       // Check convergence:</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0229" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       if <span class="delete">(std::abs(TempH-tempEphH)&lt;JDsec)</span> break;</td><td> </td><td class="rblock">                       if <span class="insert">(std::abs(tempH-tempEphH)&lt;JDsec)</span> break;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       tempEphH = <span class="delete">TempH;</span></td><td> </td><td class="rblock">                       tempEphH = <span class="insert">tempH;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       MoonCulm = myJD + (tempEphH/24.);</td><td> </td><td class="right">                       MoonCulm = myJD + (tempEphH/24.);</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0230" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       culmAlt = std::abs(mylat-<span class="delete">D</span>ec); // 90 - altitude at t
ransit.</td><td> </td><td class="rblock">                       culmAlt = std::abs(mylat-<span class="insert">d</span>ec); // 90 - altitude at t
ransit.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               };</td><td> </td><td class="right">               };</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//             qDebug() &lt;&lt; q_("%1").arg(MoonCulm,0,'f',5);</td><td> </td><td class="right">//             qDebug() &lt;&lt; q_("%1").arg(MoonCulm,0,'f',5);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       lastJDMoon = myJD;</td><td> </td><td class="right">       lastJDMoon = myJD;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }; // Comes from if (std::abs(myJD-lastJDMoon)&gt;JDsec || LastObject!=
Kind)</td><td> </td><td class="right">       }; // Comes from if (std::abs(myJD-lastJDMoon)&gt;JDsec || LastObject!=
Kind)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Find out the days of Full Moon:</td><td> </td><td class="right">// Find out the days of Full Moon:</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0231" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       if (<span class="delete">Kind</span>==2 &amp;&amp; show_FullMoon) // || show_SuperMoon))</td><td> </td><td class="rblock">       if (<span class="insert">bodyType</span>==2 &amp;&amp; show_FullMoon) // || show_SuperMoon))</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // Only estimate date of Full Moon if we have changed Lunar month:</td><td> </td><td class="right">       // Only estimate date of Full Moon if we have changed Lunar month:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               if (myJD &gt; nextFullMoon || myJD &lt; prevFullMoon)</td><td> </td><td class="right">               if (myJD &gt; nextFullMoon || myJD &lt; prevFullMoon)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // Estimate the nearest (in time) Full Moon:</td><td> </td><td class="right">       // Estimate the nearest (in time) Full Moon:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       double nT;</td><td> </td><td class="right">                       double nT;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       double dT = std::modf((myJD-RefFullMoon)/MoonT,&amp;nT);</td><td> </td><td class="right">                       double dT = std::modf((myJD-RefFullMoon)/MoonT,&amp;nT);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       if (dT&gt;0.5) {nT += 1.0;};</td><td> </td><td class="right">                       if (dT&gt;0.5) {nT += 1.0;};</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l4" /><small>skipping to change at</small><em> line 1411</em></th><th> </th><th><a name="part-r4" /><small>skipping to change at</small><em> line 1488</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       for (int j=0; j&lt;2; j++)</td><td> </td><td class="right">                       for (int j=0; j&lt;2; j++)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       { // Two steps: one for the previos Full Moon and th
e other for the next one.</td><td> </td><td class="right">                       { // Two steps: one for the previos Full Moon and th
e other for the next one.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               iniEst1 =  TempFullMoon - 0.25*MoonT;</td><td> </td><td class="right">                               iniEst1 =  TempFullMoon - 0.25*MoonT;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               iniEst2 =  TempFullMoon + 0.25*MoonT;</td><td> </td><td class="right">                               iniEst2 =  TempFullMoon + 0.25*MoonT;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               Sec1 = iniEst1; // TempFullMoon - 0.05*MoonT
; // Initial estimates of Full-Moon dates</td><td> </td><td class="right">                               Sec1 = iniEst1; // TempFullMoon - 0.05*MoonT
; // Initial estimates of Full-Moon dates</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               Sec2 = iniEst2; // TempFullMoon + 0.05*MoonT
;</td><td> </td><td class="right">                               Sec2 = iniEst2; // TempFullMoon + 0.05*MoonT
;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0232" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                               <span class="delete">getSunMoonCoords(core,Sec1,RAS,DecS,RA,Dec,E</span></td><td> </td><td class="rblock">                               <span class="insert">getSunMoonCoords(core,Sec1,raSun,decSun,ra,d</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">clLon,false);</span></td><td> </td><td class="rblock"><span class="insert">ec,eclLon,false);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                               Temp1 = <span class="delete">EclLon;</span> //Lambda(RA,Dec,RAS,DecS);</td><td> </td><td class="rblock">                               Temp1 = <span class="insert">eclLon;</span> //Lambda(RA,Dec,RAS,DecS);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                               <span class="delete">getSunMoonCoords(core,Sec2,RAS,DecS,RA,Dec,E</span></td><td> </td><td class="rblock">                               <span class="insert">getSunMoonCoords(core,Sec2,raSun,decSun,ra,d</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">clLon,false);</span></td><td> </td><td class="rblock"><span class="insert">ec,eclLon,false);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                               Temp2 = <span class="delete">EclLon;</span> //Lambda(RA,Dec,RAS,DecS);</td><td> </td><td class="rblock">                               Temp2 = <span class="insert">eclLon;</span> //Lambda(RA,Dec,RAS,DecS);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               for (int i=0; i&lt;100; i++) // A limit of 100 
iterations.</td><td> </td><td class="right">                               for (int i=0; i&lt;100; i++) // A limit of 100 
iterations.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               {</td><td> </td><td class="right">                               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0233" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                        Phase1 = <span class="delete">(Sec2-Sec1)/(Temp1-Temp2)*</span></td><td> </td><td class="rblock">                                       Phase1 = <span class="insert">(Sec2-Sec1)/(Temp1-Temp2)*T</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">Temp1+Sec1;</span></td><td> </td><td class="rblock"><span class="insert">emp1+Sec1;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                                       getSunMoonCoords(core,Phase1,RAS,Dec</span></td><td> </td><td class="rblock"><span class="insert">                                       getSunMoonCoords(core,Phase1,raSun,d</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">S,RA,Dec,EclLon,false);</span></td><td> </td><td class="rblock"><span class="insert">ecSun,ra,dec,eclLon,false);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0234" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                       <span class="delete"> if (Temp1*E</span>clLon &lt; 0.0)</td><td> </td><td class="rblock">                                       <span class="insert">if (Temp1*e</span>clLon &lt; 0.0)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       {</td><td> </td><td class="right">                                       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                               Sec2 = Phase1;</td><td> </td><td class="right">                                               Sec2 = Phase1;</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0235" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                               Temp2 = <span class="delete">E</span>clLon;</td><td> </td><td class="rblock">                                               Temp2 = <span class="insert">e</span>clLon;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       } else {</td><td> </td><td class="right">                                       } else {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                               Sec1 = Phase1;</td><td> </td><td class="right">                                               Sec1 = Phase1;</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0236" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                               Temp1 = <span class="delete">E</span>clLon;</td><td> </td><td class="rblock">                                               Temp1 = <span class="insert">e</span>clLon;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       };</td><td> </td><td class="right">                                       };</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               //      qDebug() &lt;&lt; QString("%1 %2 %3 %4 ").
arg(Sec1).arg(Sec2).arg(Temp1).arg(Temp2);</td><td> </td><td class="right">                               //      qDebug() &lt;&lt; QString("%1 %2 %3 %4 ").
arg(Sec1).arg(Sec2).arg(Temp1).arg(Temp2);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       if (std::abs(Sec2-Sec1) &lt; 10.*dT)  /
/ 1 minute accuracy; convergence.</td><td> </td><td class="right">                                       if (std::abs(Sec2-Sec1) &lt; 10.*dT)  /
/ 1 minute accuracy; convergence.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       {</td><td> </td><td class="right">                                       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                               TempFullMoon = (Sec1+Sec2)/2
.;</td><td> </td><td class="right">                                               TempFullMoon = (Sec1+Sec2)/2
.;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               //              qDebug() &lt;&lt; QString("%1%2 ")
.arg(TempFullMoon);</td><td> </td><td class="right">                               //              qDebug() &lt;&lt; QString("%1%2 ")
.arg(TempFullMoon);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                               break;</td><td> </td><td class="right">                                               break;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l5" /><small>skipping to change at</small><em> line 1460</em></th><th> </th><th><a name="part-r5" /><small>skipping to change at</small><em> line 1537</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               };</td><td> </td><td class="right">                               };</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       };</td><td> </td><td class="right">                       };</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // Update the string shown in the screen:</td><td> </td><td class="right">       // Update the string shown in the screen:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       int fullDay, fullMonth,fullYear, fullHour, fullMinut
e, fullSecond;</td><td> </td><td class="right">                       int fullDay, fullMonth,fullYear, fullHour, fullMinut
e, fullSecond;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       double LocalPrev = prevFullMoon+GMTShift+0.5;  // Sh
ift to the local time.</td><td> </td><td class="right">                       double LocalPrev = prevFullMoon+GMTShift+0.5;  // Sh
ift to the local time.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       double LocalNext = nextFullMoon+GMTShift+0.5;</td><td> </td><td class="right">                       double LocalNext = nextFullMoon+GMTShift+0.5;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       double intMoon;</td><td> </td><td class="right">                       double intMoon;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       double LocalTMoon = 24.*modf(LocalPrev,&amp;intMoon);</td><td> </td><td class="right">                       double LocalTMoon = 24.*modf(LocalPrev,&amp;intMoon);</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0237" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       StelUtils::getDateFromJulianDay(intMoon,<span class="delete">&amp;fullYear,&amp;f
ullMonth,</span>&amp;fullDay);</td><td> </td><td class="rblock">                       StelUtils::getDateFromJulianDay(intMoon,<span class="insert"> &amp;fullYear, 
&amp;fullMonth, </span>&amp;fullDay);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       double2hms(toUnsignedRA(LocalTMoon),fullHour,fullMin
ute,fullSecond);</td><td> </td><td class="right">                       double2hms(toUnsignedRA(LocalTMoon),fullHour,fullMin
ute,fullSecond);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       if (getDateFormat())</td><td> </td><td class="right">                       if (getDateFormat())</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0238" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                               <span class="delete">bestNight = msgPrevFullMoon.arg(fullDay).arg
(months[fullMonth-1]).arg(fullHour).arg(fullMinute,2,10,QLatin1Char</span>('0'));</td><td> </td><td class="rblock">                               <span class="insert">lineBestNight = msgPrevFullMoon.arg(fullDay)
.arg(monthNames[fullMonth-1]).arg(fullHour).arg(fullMinute,2,10,QLatin1Char
</span>('0'));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       else</td><td> </td><td class="right">                       else</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0239" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                               <span class="delete">bestNight = msgPrevFullMoon.arg(months[fullM
onth-1]).arg(fullDay).arg(fullHour).arg(fullMinute,2,10,QLatin1Char</span>('0'));</td><td> </td><td class="rblock">                               <span class="insert">lineBestNight = msgPrevFullMoon.arg(monthNam
es[fullMonth-1]).arg(fullDay).arg(fullHour).arg(fullMinute,2,10,QLatin1Char
</span>('0'));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       LocalTMoon = 24.*modf(LocalNext,&amp;intMoon);</td><td> </td><td class="right">                       LocalTMoon = 24.*modf(LocalNext,&amp;intMoon);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       StelUtils::getDateFromJulianDay(intMoon,&amp;fullYear,&amp;f
ullMonth,&amp;fullDay);</td><td> </td><td class="right">                       StelUtils::getDateFromJulianDay(intMoon,&amp;fullYear,&amp;f
ullMonth,&amp;fullDay);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       double2hms(toUnsignedRA(LocalTMoon),fullHour,fullMin
ute,fullSecond);</td><td> </td><td class="right">                       double2hms(toUnsignedRA(LocalTMoon),fullHour,fullMin
ute,fullSecond);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       if (getDateFormat())</td><td> </td><td class="right">                       if (getDateFormat())</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0240" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                               <span class="delete">bestNight += msgNextFullMoon.arg(fullDay).ar
g(months[fullMonth-1]).arg(fullHour).arg(fullMinute,2,10,QLatin1Cha</span>r('0'));</td><td> </td><td class="rblock">                               <span class="insert">lineBestNight += msgNextFullMoon.arg(fullDay
).arg(monthNames[fullMonth-1]).arg(fullHour).arg(fullMinute,2,10,QLatin1Cha
</span>r('0'));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       else</td><td> </td><td class="right">                       else</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0241" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                               <span class="delete">bestNight += msgNextFullMoon.arg(months[full
Month-1]).arg(fullDay).arg(fullHour).arg(fullMinute,2,10,QLatin1Cha</span>r('0'));</td><td> </td><td class="rblock">                               <span class="insert">lineBestNight += msgNextFullMoon.arg(monthNa
mes[fullMonth-1]).arg(fullDay).arg(fullHour).arg(fullMinute,2,10,QLatin1Cha
</span>r('0'));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0242" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       <span class="delete">ObsRange = "";</span></td><td> </td><td class="rblock">                       <span class="insert">lineObservableRange.clear();</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                       AcroCos = "";</span></td><td> </td><td class="rblock"><span class="insert">                       lineAcroCos.clear();</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // Now, compute the days of all the Full Moons of the current year, 
and get the Earth/Moon distance:</td><td> </td><td class="right">       // Now, compute the days of all the Full Moons of the current year, 
and get the Earth/Moon distance:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//                     double monthFrac, monthTemp, maxMoonDate;</td><td> </td><td class="right">//                     double monthFrac, monthTemp, maxMoonDate;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//                     monthFrac = std::modf((nextFullMoon-Jan1stJD)/MoonT,
&amp;monthTemp);</td><td> </td><td class="right">//                     monthFrac = std::modf((nextFullMoon-Jan1stJD)/MoonT,
&amp;monthTemp);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//                     int PrevMonths = (int)(monthTemp+0.0*monthFrac);</td><td> </td><td class="right">//                     int PrevMonths = (int)(monthTemp+0.0*monthFrac);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//                     double BestDistance = 1.0; // initial dummy value fo
r Sun-Moon distance;</td><td> </td><td class="right">//                     double BestDistance = 1.0; // initial dummy value fo
r Sun-Moon distance;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//                     double Distance; // temporal variable to save Earth-
Moon distance at each month.</td><td> </td><td class="right">//                     double Distance; // temporal variable to save Earth-
Moon distance at each month.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//                     qDebug() &lt;&lt; q_("%1 ").arg(PrevMonths);</td><td> </td><td class="right">//                     qDebug() &lt;&lt; q_("%1 ").arg(PrevMonths);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l6" /><small>skipping to change at</small><em> line 1503</em></th><th> </th><th><a name="part-r6" /><small>skipping to change at</small><em> line 1580</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//                                     BestDistance = Distance;</td><td> </td><td class="right">//                                     BestDistance = Distance;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//                                     maxMoonDate = jd1;</td><td> </td><td class="right">//                                     maxMoonDate = jd1;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//                             };</td><td> </td><td class="right">//                             };</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//                     };</td><td> </td><td class="right">//                     };</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//                     maxMoonDate += GMTShift+0.5;</td><td> </td><td class="right">//                     maxMoonDate += GMTShift+0.5;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//                     StelUtils::getDateFromJulianDay(maxMoonDate,&amp;fullYea
r,&amp;fullMonth,&amp;fullDay);</td><td> </td><td class="right">//                     StelUtils::getDateFromJulianDay(maxMoonDate,&amp;fullYea
r,&amp;fullMonth,&amp;fullDay);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//                     double MoonSize = MoonPerilune/BestDistance*100.;</td><td> </td><td class="right">//                     double MoonSize = MoonPerilune/BestDistance*100.;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//                     ObsRange = q_("Greatest Full Moon: %1 "+months[fullM
onth-1]+" (%2% of Moon at Perilune)").arg(fullDay).arg(MoonSize,0,'f',2);</td><td> </td><td class="right">//                     ObsRange = q_("Greatest Full Moon: %1 "+months[fullM
onth-1]+" (%2% of Moon at Perilune)").arg(fullDay).arg(MoonSize,0,'f',2);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               };</td><td> </td><td class="right">               };</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0243" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       else if (<span class="delete">Kind</span> &lt;3)</td><td> </td><td class="rblock">       else if (<span class="insert">bodyType</span> &lt;3)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0244" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               <span class="delete">bestNight = "";</span></td><td> </td><td class="rblock">               <span class="insert">lineBestNight.clear();</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               ObsRange = "";</span></td><td> </td><td class="rblock"><span class="insert">               lineObservableRange.clear();</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               AcroCos = "";</span></td><td> </td><td class="rblock"><span class="insert">               lineAcroCos.clear();</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                           </td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       };</td><td> </td><td class="right">       };</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Return the Moon and Earth to its current position:</td><td> </td><td class="right">// Return the Moon and Earth to its current position:</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0245" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       if (<span class="delete">Kind</span>&lt;3)</td><td> </td><td class="rblock">       if (<span class="insert">bodyType</span>&lt;3)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0246" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               <span class="delete">getSunMoonCoords(core,myJD,RAS,DecS,RA,Dec,EclLon,true);</span></td><td> </td><td class="rblock">               <span class="insert">getSunMoonCoords(core, myJD, raSun, decSun, ra, dec, eclLon,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       } else</td><td> </td><td class="rblock"><span class="insert"> true);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       else</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0247" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               <span class="delete"> getPlanetCoords(core,myJD,RA,Dec,</span>true);</td><td> </td><td class="rblock">               <span class="insert">getPlanetCoords(core, myJD, ra, dec, </span>true);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       };</td><td> </td><td class="right">       };</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return raises;</td><td> </td><td class="right">       return raises;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//////////////////////////////////</td><td> </td><td class="right">//////////////////////////////////</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">///  STUFF FOR THE GUI CONFIG</td><td> </td><td class="right">///  STUFF FOR THE GUI CONFIG</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">bool Observability::configureGui(bool show)</td><td> </td><td class="right">bool Observability::configureGui(bool show)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (show)</td><td> </td><td class="right">       if (show)</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0248" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">{</span></td><td> </td><td class="rblock">               <span class="insert">configDialog-&gt;setVisible(true);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               StelGui* gui = dynamic_cast&lt;StelGui*&gt;(StelApp::getInstance()</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">.getGui());</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               gui-&gt;getGuiAction("actionShow_Observability_ConfigDialog")-&gt;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">setChecked(true);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       }</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                           </td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return true;</td><td> </td><td class="right">       return true;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0249" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">void <span class="delete">Observability::restoreDefaults(void)</span></td><td> </td><td class="rblock">void <span class="insert">Observability::resetConfiguration()</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">{</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       restoreDefaultConfigIni();</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       readSettingsFromConfig();</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">}</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">void Observability::restoreDefaultConfigIni(void)</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0250" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       <span class="insert">// Remove the plug-in's group from the configuration,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       // after that it will be loaded with default values.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       QSettings* conf = StelApp::getInstance().getSettings();</td><td> </td><td class="right">       QSettings* conf = StelApp::getInstance().getSettings();</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0251" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                           </td><td> </td><td class="rblock">       <span class="insert">Q_ASSERT(conf);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">conf-&gt;beginGroup("Observability");</span></td><td> </td><td class="rblock"><span class="insert">       conf-&gt;remove("Observability");</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"><span class="insert">       loadConfiguration();</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       // delete all existing settings...</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       conf-&gt;remove("");</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       // Set defaults</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       conf-&gt;setValue("font_size", 15);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       conf-&gt;setValue("Sun_Altitude", 12);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       conf-&gt;setValue("Horizon_Altitude", 0);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       conf-&gt;setValue("font_color", "0,0.5,1");</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       conf-&gt;setValue("show_AcroCos", true);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       conf-&gt;setValue("show_Good_Nights", true);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       conf-&gt;setValue("show_Best_Night", true);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       conf-&gt;setValue("show_Today", true);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       conf-&gt;setValue("show_FullMoon", true);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">//     conf-&gt;setValue("show_Crescent", true);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">//     conf-&gt;setValue("show_SuperMoon", true);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       conf-&gt;endGroup();</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0252" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">void Observability::<span class="delete">readSettingsFromConfig(void</span>)</td><td> </td><td class="rblock">void Observability::<span class="insert">loadConfiguration(</span>)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       QSettings* conf = StelApp::getInstance().getSettings();</td><td> </td><td class="right">       QSettings* conf = StelApp::getInstance().getSettings();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       conf-&gt;beginGroup("Observability");</td><td> </td><td class="right">       conf-&gt;beginGroup("Observability");</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // Load settings from main config file</td><td> </td><td class="right">       // Load settings from main config file</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       fontSize = conf-&gt;value("font_size",15).toInt();</td><td> </td><td class="right">       fontSize = conf-&gt;value("font_size",15).toInt();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       font.setPixelSize(fontSize);</td><td> </td><td class="right">       font.setPixelSize(fontSize);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       fontColor = StelUtils::strToVec3f(conf-&gt;value("font_color", "0,0.5,1
").toString());</td><td> </td><td class="right">       fontColor = StelUtils::strToVec3f(conf-&gt;value("font_color", "0,0.5,1
").toString());</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       show_AcroCos = conf-&gt;value("show_AcroCos", true).toBool();</td><td> </td><td class="right">       show_AcroCos = conf-&gt;value("show_AcroCos", true).toBool();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       show_Good_Nights = conf-&gt;value("show_Good_Nights", true).toBool();</td><td> </td><td class="right">       show_Good_Nights = conf-&gt;value("show_Good_Nights", true).toBool();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       show_Best_Night = conf-&gt;value("show_Best_Night", true).toBool();</td><td> </td><td class="right">       show_Best_Night = conf-&gt;value("show_Best_Night", true).toBool();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       show_Today = conf-&gt;value("show_Today", true).toBool();</td><td> </td><td class="right">       show_Today = conf-&gt;value("show_Today", true).toBool();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       show_FullMoon = conf-&gt;value("show_FullMoon", true).toBool();</td><td> </td><td class="right">       show_FullMoon = conf-&gt;value("show_FullMoon", true).toBool();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//     show_Crescent = conf-&gt;value("show_Crescent", true).toBool();</td><td> </td><td class="right">//     show_Crescent = conf-&gt;value("show_Crescent", true).toBool();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//     show_SuperMoon = conf-&gt;value("show_SuperMoon", true).toBool();</td><td> </td><td class="right">//     show_SuperMoon = conf-&gt;value("show_SuperMoon", true).toBool();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0253" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">iAltitude</span> = <span class="delete">conf-&gt;value("Sun_Altitude", 12).toInt();</span></td><td> </td><td class="rblock">       <span class="insert">// For backwards compatibility, the value of this key is stored with</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       AstroTwiAlti  = -((double)iAltitude)/Rad2Deg ;</span></td><td> </td><td class="rblock"><span class="insert">       // inverted sign.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       // TODO: Skip the sign inversion when the key is changed.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       int altitude</span> = <span class="insert">-(conf-&gt;value("Sun_Altitude", 12).toInt());</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       setTwilightAltitude(altitude);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0254" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">iHorizAltitude</span> = conf-&gt;value("Horizon_Altitude", 0).toInt();</td><td> </td><td class="rblock">       <span class="insert">altitude</span> = conf-&gt;value("Horizon_Altitude", 0).toInt();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">HorizAlti = ((double)iHorizAltitude)/Rad2Deg ;</span></td><td> </td><td class="rblock">       <span class="insert">setHorizonAltitude(altitude);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       conf-&gt;endGroup();</td><td> </td><td class="right">       conf-&gt;endGroup();</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0255" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                           </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       <span class="insert">// Load date format from main settings.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       // TODO: Handle date format properly.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       if (conf-&gt;value("localization/date_display_format", "system_default"</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">).toString() == "ddmmyyyy")</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               setDateFormat(true);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       else</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               setDateFormat(false);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0256" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">void Observability::save<span class="delete">SettingsToConfig(void</span>)</td><td> </td><td class="rblock">void Observability::save<span class="insert">Configuration(</span>)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       QSettings* conf = StelApp::getInstance().getSettings();</td><td> </td><td class="right">       QSettings* conf = StelApp::getInstance().getSettings();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       QString fontColorStr = QString("%1,%2,%3").arg(fontColor[0],0,'f',2)
.arg(fontColor[1],0,'f',2).arg(fontColor[2],0,'f',2);</td><td> </td><td class="right">       QString fontColorStr = QString("%1,%2,%3").arg(fontColor[0],0,'f',2)
.arg(fontColor[1],0,'f',2).arg(fontColor[2],0,'f',2);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // Set updated values</td><td> </td><td class="right">       // Set updated values</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       conf-&gt;beginGroup("Observability");</td><td> </td><td class="right">       conf-&gt;beginGroup("Observability");</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       conf-&gt;setValue("font_size", fontSize);</td><td> </td><td class="right">       conf-&gt;setValue("font_size", fontSize);</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0257" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       conf-&gt;setValue("Sun_Altitude", <span class="delete">iAltitude);</span></td><td> </td><td class="rblock">       <span class="insert">// For backwards compatibility, the value of this key is stored with</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       conf-&gt;setValue("Horizon_Altitude", <span class="delete">iHorizAltitude);</span></td><td> </td><td class="rblock"><span class="insert">       // inverted sign.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       // TODO: Skip the sign inversion when the key is changed.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       conf-&gt;setValue("Sun_Altitude", <span class="insert">-twilightAltDeg);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       conf-&gt;setValue("Horizon_Altitude", <span class="insert">horizonAltDeg);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       conf-&gt;setValue("font_color", fontColorStr);</td><td> </td><td class="right">       conf-&gt;setValue("font_color", fontColorStr);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       conf-&gt;setValue("show_AcroCos", show_AcroCos);</td><td> </td><td class="right">       conf-&gt;setValue("show_AcroCos", show_AcroCos);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       conf-&gt;setValue("show_Good_Nights", show_Good_Nights);</td><td> </td><td class="right">       conf-&gt;setValue("show_Good_Nights", show_Good_Nights);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       conf-&gt;setValue("show_Best_Night", show_Best_Night);</td><td> </td><td class="right">       conf-&gt;setValue("show_Best_Night", show_Best_Night);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       conf-&gt;setValue("show_Today", show_Today);</td><td> </td><td class="right">       conf-&gt;setValue("show_Today", show_Today);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       conf-&gt;setValue("show_FullMoon", show_FullMoon);</td><td> </td><td class="right">       conf-&gt;setValue("show_FullMoon", show_FullMoon);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//     conf-&gt;setValue("show_Crescent", show_Crescent);</td><td> </td><td class="right">//     conf-&gt;setValue("show_Crescent", show_Crescent);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//     conf-&gt;setValue("show_SuperMoon", show_SuperMoon);</td><td> </td><td class="right">//     conf-&gt;setValue("show_SuperMoon", show_SuperMoon);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       conf-&gt;endGroup();</td><td> </td><td class="right">       conf-&gt;endGroup();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0258" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">void Observability::<span class="delete">setShow(int output, bool setVal</span>)</td><td> </td><td class="rblock">void Observability::<span class="insert">enableTodayField(bool enabled</span>)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0259" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">switch(output)</span></td><td> </td><td class="rblock">       <span class="insert">show_Today = enabled;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       {</td><td> </td><td class="rblock"><span class="insert">       configChanged = true;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               <span class="delete">case 1: {show_Today = setVal; break;}</span></td><td> </td><td class="rblock"><span class="insert">}</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               case 2: {show_AcroCos = setVal; break;}</span></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               case 3: {show_Good_Nights = setVal; break;}</span></td><td> </td><td class="rblock"><span class="insert">void Observability::enableAcroCosField(bool enabled)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               case 4: {show_Best_Night = setVal; break;}</span></td><td> </td><td class="rblock"><span class="insert">{</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               case 5: {show_FullMoon = setVal; nextFullMoon=0.0; prevFullM</span></td><td> </td><td class="rblock"><span class="insert">       show_AcroCos = enabled;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">oon=0.0; break;}</span></td><td> </td><td class="rblock"><span class="insert">       configChanged = true;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">//             case 6: {show_Crescent = setVal; break;}</span></td><td> </td><td class="rblock"><span class="insert">}</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">//             case 7: {show_SuperMoon = setVal; break;}</span></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       };</span></td><td> </td><td class="rblock"><span class="insert">void Observability::enableGoodNightsField(bool enabled)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">{</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       show_Good_Nights = enabled;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       configChanged = true;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">}</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">void Observability::enableOppositionField(bool enabled)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">{</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       show_Best_Night = enabled;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       configChanged = true;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">}</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">void Observability::enableFullMoonField(bool enabled)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       <span class="insert">show_FullMoon = enabled;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       configChanged = true;</td><td> </td><td class="right">       configChanged = true;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">bool Observability::getShowFlags(int iFlag)</td><td> </td><td class="right">bool Observability::getShowFlags(int iFlag)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       switch (iFlag)</td><td> </td><td class="right">       switch (iFlag)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               case 1: return show_Today;</td><td> </td><td class="right">               case 1: return show_Today;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               case 2: return show_AcroCos;</td><td> </td><td class="right">               case 2: return show_AcroCos;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               case 3: return show_Good_Nights;</td><td> </td><td class="right">               case 3: return show_Good_Nights;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l7" /><small>skipping to change at</small><em> line 1656</em></th><th> </th><th><a name="part-r7" /><small>skipping to change at</small><em> line 1736</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">Vec3f Observability::getFontColor(void)</td><td> </td><td class="right">Vec3f Observability::getFontColor(void)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return fontColor;</td><td> </td><td class="right">       return fontColor;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">int Observability::getFontSize(void)</td><td> </td><td class="right">int Observability::getFontSize(void)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return fontSize;</td><td> </td><td class="right">       return fontSize;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0260" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">int Observability::get<span class="delete">SunAltitude(void</span>)</td><td> </td><td class="rblock">int Observability::get<span class="insert">TwilightAltitude(</span>)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0261" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       return <span class="delete">iAltitude</span>;</td><td> </td><td class="rblock">       return <span class="insert">twilightAltDeg</span>;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0262" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">int Observability::getHoriz<span class="delete">Altitude(void</span>)</td><td> </td><td class="rblock">int Observability::getHoriz<span class="insert">onAltitude(</span>)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0263" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       return <span class="delete">iHorizAltitude</span>;</td><td> </td><td class="rblock">       return <span class="insert">horizonAltDeg</span>;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0264" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">void Observability::setFontColor(<span class="delete">int color, int value</span>)</td><td> </td><td class="rblock">void Observability::setFontColor(<span class="insert">const Vec3f&amp; color</span>)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0265" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">float fValue</span> = <span class="delete">(float)(value) / 100.;</span></td><td> </td><td class="rblock">       <span class="insert">fontColor</span> = <span class="insert">color; // Vector3::operator =() is overloaded. :)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       fontColor[color] = fValue;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0266" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">void Observability::setFontSize(int <span class="delete">valu</span>e)</td><td> </td><td class="rblock">void Observability::setFontSize(int <span class="insert">siz</span>e)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0267" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       fontSize = <span class="delete">valu</span>e;</td><td> </td><td class="rblock">       fontSize = <span class="insert">siz</span>e;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0268" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">void Observability::set<span class="delete">SunAltitude(int valu</span>e)</td><td> </td><td class="rblock">void Observability::set<span class="insert">TwilightAltitude(int altitud</span>e)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0269" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">AstroTwiAlti</span>  = <span class="delete">-((double) value)/Rad2Deg</span> ;</td><td> </td><td class="rblock">       <span class="insert">twilightAltRad</span>  = <span class="insert">((double) altitude)/Rad2Deg</span> ;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">iAltitude</span> = <span class="delete">value;</span></td><td> </td><td class="rblock">       <span class="insert">twilightAltDeg</span> = <span class="insert">altitude;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       configChanged = true;</td><td> </td><td class="right">       configChanged = true;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0270" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">void Observability::setHoriz<span class="delete">Altitude(int valu</span>e)</td><td> </td><td class="rblock">void Observability::setHoriz<span class="insert">onAltitude(int altitud</span>e)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0271" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">HorizAlti</span> = ((double) <span class="delete">value)/Rad2Deg</span> ;</td><td> </td><td class="rblock">       <span class="insert">horizonAltitude</span> = ((double) <span class="insert">altitude)/Rad2Deg</span> ;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">iHorizAltitude</span> = <span class="delete">value;</span></td><td> </td><td class="rblock">       <span class="insert">horizonAltDeg</span> = <span class="insert">altitude;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       configChanged = true;</td><td> </td><td class="right">       configChanged = true;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0272" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">///  END OF STUFF FOR THE GUI CONFIG.</span></td><td> </td><td class="rblock">void <span class="insert">Observability::showReport(bool</span> b)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">///////////////////////////////</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">// Enable the Observability:</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">void <span class="delete">Observability::enableObservability(bool</span> b)</td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0273" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       flagShow<span class="delete">Observability</span> = b;</td><td> </td><td class="rblock">       flagShow<span class="insert">Report</span> = b;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>

     <tr><td></td><td class="left"></td><td> </td><td class="right"></td><td></td></tr>
     <tr bgcolor="gray"><th colspan="5" align="center"><a name="end">&nbsp;End of changes. 273 change blocks.&nbsp;</a></th></tr>
     <tr class="stats"><td></td><th><i>894 lines changed or deleted</i></th><th><i> </i></th><th><i>955 lines changed or added</i></th><td></td></tr>
     <tr><td colspan="5" align="center" class="small"><br/>This html diff was produced by rfcdiff 1.41. The latest version is available from <a href="http://www.tools.ietf.org/tools/rfcdiff/" >http://tools.ietf.org/tools/rfcdiff/</a> </td></tr>
   </table>
   </body>
   </html>
