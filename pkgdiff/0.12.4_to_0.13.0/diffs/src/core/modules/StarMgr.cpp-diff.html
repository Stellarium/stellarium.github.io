<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
<!-- Generated by rfcdiff 1.41: rfcdiff  --> 
<!-- <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional" > -->
<!-- System: Linux fomalhaut.local 3.13.0-38-generic #65-Ubuntu SMP Thu Oct 9 11:36:50 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux --> 
<!-- Using awk: /usr/bin/gawk: GNU Awk 4.0.1 --> 
<!-- Using diff: /usr/bin/diff: diff (GNU diffutils) 3.3 --> 
<!-- Using wdiff: /usr/bin/wdiff: wdiff (GNU wdiff) 1.2.1 --> 
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"> 
<head> 
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 
  <meta http-equiv="Content-Style-Type" content="text/css" /> 
  <title>Diff: StarMgr.cpp - StarMgr.cpp</title> 
  <style type="text/css"> 
    body    { font-size:16px; margin: 0.4ex; margin-right: auto; } 
    tr      { } 
    td      { white-space: pre; font-family: Consolas, "DejaVu Sans Mono", "Droid Sans Mono", Monaco, Monospace; vertical-align: top; font-size: 0.86em;} 
    th      { font-size: 0.86em; } 
    .small  { font-size: 0.6em; font-style: italic; font-family: Verdana, Helvetica, sans-serif; } 
    .left   { background-color: #EEE; } 
    .right  { background-color: #FFF; } 
    .diff   { background-color: #CCF; } 
    .lblock { background-color: #BFB; } 
    .rblock { background-color: #FF8; } 
    .insert { background-color: #8FF; } 
    .delete { background-color: #ACF; } 
    .void   { background-color: #FFB; } 
    .cont   { background-color: #EEE; } 
    .linebr { background-color: #AAA; } 
    .lineno { color: red; background-color: #FFF; font-size: 0.7em; text-align: right; padding: 0 2px; } 
    .elipsis{ background-color: #AAA; } 
    .left .cont { background-color: #DDD; } 
    .right .cont { background-color: #EEE; } 
    .lblock .cont { background-color: #9D9; } 
    .rblock .cont { background-color: #DD6; } 
    .insert .cont { background-color: #0DD; } 
    .delete .cont { background-color: #8AD; } 
    .stats, .stats td, .stats th { background-color: #EEE; padding: 2px 0; } 
  </style> 
</head> 
<body > 
  <table border="0" cellpadding="0" cellspacing="0"> 
  <tr bgcolor="orange"><th></th><th>&nbsp;StarMgr.cpp&nbsp;</th><th> </th><th>&nbsp;StarMgr.cpp&nbsp;</th><th></th></tr> 
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l1" /><small>skipping to change at</small><em> line 23</em></th><th> </th><th><a name="part-r1" /><small>skipping to change at</small><em> line 23</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"> * This program is distributed in the hope that it will be useful,</td><td> </td><td class="right"> * This program is distributed in the hope that it will be useful,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</td><td> </td><td class="right"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</td><td> </td><td class="right"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"> * GNU General Public License for more details.</td><td> </td><td class="right"> * GNU General Public License for more details.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"> *</td><td> </td><td class="right"> *</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"> * You should have received a copy of the GNU General Public License</td><td> </td><td class="right"> * You should have received a copy of the GNU General Public License</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"> * along with this program; if not, write to the Free Software</td><td> </td><td class="right"> * along with this program; if not, write to the Free Software</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"> * Foundation, Inc., 51 Franklin Street, Suite 500, Boston, MA  02110-1335,
 USA.</td><td> </td><td class="right"> * Foundation, Inc., 51 Franklin Street, Suite 500, Boston, MA  02110-1335,
 USA.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"> */</td><td> </td><td class="right"> */</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0001" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">#include &lt;QCryptographicHash&gt;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">#include &lt;QDebug&gt;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">#include &lt;QFile&gt;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">#include &lt;QFileInfo&gt;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">#include &lt;QRegExp&gt;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">#include &lt;QSettings&gt;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">#include &lt;QString&gt;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">#include &lt;QTextStream&gt;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">#include &lt;QDir&gt;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                           </td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#include "StelProjector.hpp"</td><td> </td><td class="right">#include "StelProjector.hpp"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#include "StarMgr.hpp"</td><td> </td><td class="right">#include "StarMgr.hpp"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#include "StelObject.hpp"</td><td> </td><td class="right">#include "StelObject.hpp"</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0002" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">#include <span class="delete">"renderer/StelRenderer.hpp"</span></td><td> </td><td class="rblock">#include <span class="insert">"StelTexture.hpp"</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">#include "renderer/StelTextureNew.hpp"</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#include "StelUtils.hpp"</td><td> </td><td class="right">#include "StelUtils.hpp"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#include "StelToneReproducer.hpp"</td><td> </td><td class="right">#include "StelToneReproducer.hpp"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#include "StelTranslator.hpp"</td><td> </td><td class="right">#include "StelTranslator.hpp"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#include "StelGeodesicGrid.hpp"</td><td> </td><td class="right">#include "StelGeodesicGrid.hpp"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#include "StelTranslator.hpp"</td><td> </td><td class="right">#include "StelTranslator.hpp"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#include "StelApp.hpp"</td><td> </td><td class="right">#include "StelApp.hpp"</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0003" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">#include "StelTextureMgr.hpp"</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#include "StelObjectMgr.hpp"</td><td> </td><td class="right">#include "StelObjectMgr.hpp"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#include "StelLocaleMgr.hpp"</td><td> </td><td class="right">#include "StelLocaleMgr.hpp"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#include "StelSkyCultureMgr.hpp"</td><td> </td><td class="right">#include "StelSkyCultureMgr.hpp"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#include "StelFileMgr.hpp"</td><td> </td><td class="right">#include "StelFileMgr.hpp"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#include "StelModuleMgr.hpp"</td><td> </td><td class="right">#include "StelModuleMgr.hpp"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#include "StelCore.hpp"</td><td> </td><td class="right">#include "StelCore.hpp"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#include "StelIniParser.hpp"</td><td> </td><td class="right">#include "StelIniParser.hpp"</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0004" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">#include "StelPainter.hpp"</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#include "StelJsonParser.hpp"</td><td> </td><td class="right">#include "StelJsonParser.hpp"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#include "ZoneArray.hpp"</td><td> </td><td class="right">#include "ZoneArray.hpp"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#include "StelSkyDrawer.hpp"</td><td> </td><td class="right">#include "StelSkyDrawer.hpp"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#include "RefractionExtinction.hpp"</td><td> </td><td class="right">#include "RefractionExtinction.hpp"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0005" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">#include <span class="delete">&lt;errno.h&gt;</span></td><td> </td><td class="rblock">#include <span class="insert">&lt;QTextStream&gt;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">#ifndef Q_OS_WIN</span></td><td> </td><td class="rblock">#include <span class="insert">&lt;QFile&gt;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">#include <span class="delete">&lt;unistd.h&gt;</span></td><td> </td><td class="rblock">#include <span class="insert">&lt;QSettings&gt;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">#else</span></td><td> </td><td class="rblock"><span class="insert">#include &lt;QString&gt;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">#include <span class="delete">"kdewin32/unistd.h"</span></td><td> </td><td class="rblock"><span class="insert">#include &lt;QRegExp&gt;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">#endif</span></td><td> </td><td class="rblock"><span class="insert">#include &lt;QDebug&gt;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">#include &lt;QFileInfo&gt;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">#include &lt;QDir&gt;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">#include &lt;QCryptographicHash&gt;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0006" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">using namespace BigStarCatalogExtension</span>;</td><td> </td><td class="rblock"><span class="insert">#include &lt;errno.h&gt</span>;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">static QStringList spectral_array;</td><td> </td><td class="right">static QStringList spectral_array;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">static QStringList component_array;</td><td> </td><td class="right">static QStringList component_array;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// This number must be incremented each time the content or file format of 
the stars catalogs change</td><td> </td><td class="right">// This number must be incremented each time the content or file format of 
the stars catalogs change</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// It can also be incremented when the defaultStarsConfig.json file change.</td><td> </td><td class="right">// It can also be incremented when the defaultStarsConfig.json file change.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// It should always matchs the version field of the defaultStarsConfig.json
 file</td><td> </td><td class="right">// It should always matchs the version field of the defaultStarsConfig.json
 file</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0007" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">static const int StarCatalogFormatVersion = <span class="delete">4</span>;</td><td> </td><td class="rblock">static const int StarCatalogFormatVersion = <span class="insert">6</span>;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Initialise statics</td><td> </td><td class="right">// Initialise statics</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">bool StarMgr::flagSciNames = true;</td><td> </td><td class="right">bool StarMgr::flagSciNames = true;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">QHash&lt;int,QString&gt; StarMgr::commonNamesMap;</td><td> </td><td class="right">QHash&lt;int,QString&gt; StarMgr::commonNamesMap;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">QHash&lt;int,QString&gt; StarMgr::commonNamesMapI18n;</td><td> </td><td class="right">QHash&lt;int,QString&gt; StarMgr::commonNamesMapI18n;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">QMap&lt;QString,int&gt; StarMgr::commonNamesIndexI18n;</td><td> </td><td class="right">QMap&lt;QString,int&gt; StarMgr::commonNamesIndexI18n;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">QMap&lt;QString,int&gt; StarMgr::commonNamesIndex;</td><td> </td><td class="right">QMap&lt;QString,int&gt; StarMgr::commonNamesIndex;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">QHash&lt;int,QString&gt; StarMgr::sciNamesMapI18n;</td><td> </td><td class="right">QHash&lt;int,QString&gt; StarMgr::sciNamesMapI18n;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">QMap&lt;QString,int&gt; StarMgr::sciNamesIndexI18n;</td><td> </td><td class="right">QMap&lt;QString,int&gt; StarMgr::sciNamesIndexI18n;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">QHash&lt;int,QString&gt; StarMgr::sciAdditionalNamesMapI18n;</td><td> </td><td class="right">QHash&lt;int,QString&gt; StarMgr::sciAdditionalNamesMapI18n;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l2" /><small>skipping to change at</small><em> line 126</em></th><th> </th><th><a name="part-r2" /><small>skipping to change at</small><em> line 120</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (index &lt; 0 || index &gt;= component_array.size())</td><td> </td><td class="right">       if (index &lt; 0 || index &gt;= component_array.size())</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               qDebug() &lt;&lt; "convertToComponentIds: bad index: " &lt;&lt; index &lt;&lt;
 ", max: " &lt;&lt; component_array.size();</td><td> </td><td class="right">               qDebug() &lt;&lt; "convertToComponentIds: bad index: " &lt;&lt; index &lt;&lt;
 ", max: " &lt;&lt; component_array.size();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               return "";</td><td> </td><td class="right">               return "";</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return component_array.at(index);</td><td> </td><td class="right">       return component_array.at(index);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void StarMgr::initTriangle(int lev,int index, const Vec3f &amp;c0, const Vec3f 
&amp;c1, const Vec3f &amp;c2)</td><td> </td><td class="right">void StarMgr::initTriangle(int lev,int index, const Vec3f &amp;c0, const Vec3f 
&amp;c1, const Vec3f &amp;c2)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0008" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">ZoneArrayMap::const_iterator it(zoneArrays.find(lev));</span></td><td> </td><td class="rblock">       <span class="insert">gridLevels[lev]-&gt;initTriangle(index,c0,c1,c2);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       if (it!=zoneArrays.constEnd())</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               it.value()-&gt;initTriangle(index,c0,c1,c2);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">StarMgr::StarMgr(void)</td><td> </td><td class="right">StarMgr::StarMgr(void)</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0009" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       : hipIndex(new HipIndexStruct[NR_OF_HIP+1])</td><td> </td><td class="rblock">       : <span class="insert">flagStarName(false)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">, texPointer(NULL)</span></td><td> </td><td class="rblock"><span class="insert">       , labelsAmount(0.)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       , gravityLabel(false)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       ,</span> hipIndex(new HipIndexStruct[NR_OF_HIP+1])</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       setObjectName("StarMgr");</td><td> </td><td class="right">       setObjectName("StarMgr");</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (hipIndex == 0)</td><td> </td><td class="right">       if (hipIndex == 0)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               qFatal("ERROR: StarMgr::StarMgr: no memory");</td><td> </td><td class="right">               qFatal("ERROR: StarMgr::StarMgr: no memory");</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       maxGeodesicGridLevel = -1;</td><td> </td><td class="right">       maxGeodesicGridLevel = -1;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       lastMaxSearchLevel = -1;</td><td> </td><td class="right">       lastMaxSearchLevel = -1;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       starFont.setPixelSize(StelApp::getInstance().getSettings()-&gt;value("g
ui/base_font_size", 13).toInt());</td><td> </td><td class="right">       starFont.setPixelSize(StelApp::getInstance().getSettings()-&gt;value("g
ui/base_font_size", 13).toInt());</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       objectMgr = GETSTELMODULE(StelObjectMgr);</td><td> </td><td class="right">       objectMgr = GETSTELMODULE(StelObjectMgr);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l3" /><small>skipping to change at</small><em> line 159</em></th><th> </th><th><a name="part-r3" /><small>skipping to change at</small><em> line 153</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">*************************************************************************/</td><td> </td><td class="right">*************************************************************************/</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">double StarMgr::getCallOrder(StelModuleActionName actionName) const</td><td> </td><td class="right">double StarMgr::getCallOrder(StelModuleActionName actionName) const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (actionName==StelModule::ActionDraw)</td><td> </td><td class="right">       if (actionName==StelModule::ActionDraw)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               return StelApp::getInstance().getModuleMgr().getModule("Cons
tellationMgr")-&gt;getCallOrder(actionName)+10;</td><td> </td><td class="right">               return StelApp::getInstance().getModuleMgr().getModule("Cons
tellationMgr")-&gt;getCallOrder(actionName)+10;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return 0;</td><td> </td><td class="right">       return 0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">StarMgr::~StarMgr(void)</td><td> </td><td class="right">StarMgr::~StarMgr(void)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0010" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">ZoneArrayMap::iterator it(zoneArrays.end());</span></td><td> </td><td class="rblock">       <span class="insert">foreach(ZoneArray* z, gridLevels)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       while (it!=zoneArrays.begin())</span></td><td> </td><td class="rblock">               delete <span class="insert">z;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       {</span></td><td> </td><td class="rblock"><span class="insert">       gridLevels.clear();</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               --it;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               delete <span class="delete">it.value();</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               it.value() = NULL;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       }</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       zoneArrays.clear();</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (hipIndex)</td><td> </td><td class="right">       if (hipIndex)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               delete[] hipIndex;</td><td> </td><td class="right">               delete[] hipIndex;</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0011" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">if(NULL != texPointer)</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       {</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               delete texPointer;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       }</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">QString StarMgr::getCommonName(int hip)</td><td> </td><td class="right">QString StarMgr::getCommonName(int hip)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       QHash&lt;int,QString&gt;::const_iterator it(commonNamesMapI18n.find(hip));</td><td> </td><td class="right">       QHash&lt;int,QString&gt;::const_iterator it(commonNamesMapI18n.find(hip));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (it!=commonNamesMapI18n.end())</td><td> </td><td class="right">       if (it!=commonNamesMapI18n.end())</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               return it.value();</td><td> </td><td class="right">               return it.value();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return QString();</td><td> </td><td class="right">       return QString();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l4" /><small>skipping to change at</small><em> line 287</em></th><th> </th><th><a name="part-r4" /><small>skipping to change at</small><em> line 272</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return -99;</td><td> </td><td class="right">       return -99;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void StarMgr::copyDefaultConfigFile()</td><td> </td><td class="right">void StarMgr::copyDefaultConfigFile()</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       try</td><td> </td><td class="right">       try</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               StelFileMgr::makeSureDirExistsAndIsWritable(StelFileMgr::get
UserDir()+"/stars/default");</td><td> </td><td class="right">               StelFileMgr::makeSureDirExistsAndIsWritable(StelFileMgr::get
UserDir()+"/stars/default");</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               starConfigFileFullPath = StelFileMgr::getUserDir()+"/stars/d
efault/starsConfig.json";</td><td> </td><td class="right">               starConfigFileFullPath = StelFileMgr::getUserDir()+"/stars/d
efault/starsConfig.json";</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               qDebug() &lt;&lt; "Creates file " &lt;&lt; QDir::toNativeSeparators(star
ConfigFileFullPath);</td><td> </td><td class="right">               qDebug() &lt;&lt; "Creates file " &lt;&lt; QDir::toNativeSeparators(star
ConfigFileFullPath);</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0012" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               <span class="delete">QFile::copy(StelFileMgr::findFile("stars/default/defaultStar</span></td><td> </td><td class="rblock">               <span class="insert">QFile::copy(StelFileMgr::getInstallationDir()+"/stars/defaul</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">sConfig.json"),</span> starConfigFileFullPath);</td><td> </td><td class="rblock"><span class="insert">t/defaultStarsConfig.json",</span> starConfigFileFullPath);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">               <span class="insert">QFile::setPermissions(starConfigFileFullPath, QFile::permiss</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">ions(starConfigFileFullPath) | QFileDevice::WriteOwner);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       catch (std::runtime_error&amp; e)</td><td> </td><td class="right">       catch (std::runtime_error&amp; e)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               qWarning() &lt;&lt; e.what();</td><td> </td><td class="right">               qWarning() &lt;&lt; e.what();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               qFatal("Could not create configuration file stars/default/st
arsConfig.json");</td><td> </td><td class="right">               qFatal("Could not create configuration file stars/default/st
arsConfig.json");</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void StarMgr::init()</td><td> </td><td class="right">void StarMgr::init()</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       QSettings* conf = StelApp::getInstance().getSettings();</td><td> </td><td class="right">       QSettings* conf = StelApp::getInstance().getSettings();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       Q_ASSERT(conf);</td><td> </td><td class="right">       Q_ASSERT(conf);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0013" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">try</span></td><td> </td><td class="rblock">       starConfigFileFullPath = <span class="insert">StelFileMgr::findFile("stars/default/starsC</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       {</span></td><td> </td><td class="rblock"><span class="insert">onfig.json", StelFileMgr::Flags(StelFileMgr::Writable|StelFileMgr::File));</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               starConfigFileFullPath = <span class="delete">StelFileMgr::findFile("stars/defaul</span></td><td> </td><td class="rblock"><span class="insert">       if (starConfigFileFullPath.isEmpty())</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">t/starsConfig.json", StelFileMgr::Flags(StelFileMgr::Writable|StelFileMgr::</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">File));</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       }</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       catch (std::runtime_error&amp; e)</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               qWarning() &lt;&lt; "Could not find the starsConfig.json file: wil
l copy the default one.";</td><td> </td><td class="right">               qWarning() &lt;&lt; "Could not find the starsConfig.json file: wil
l copy the default one.";</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               copyDefaultConfigFile();</td><td> </td><td class="right">               copyDefaultConfigFile();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       QFile fic(starConfigFileFullPath);</td><td> </td><td class="right">       QFile fic(starConfigFileFullPath);</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0014" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">fic.open(QIODevice::ReadOnly);</span></td><td> </td><td class="rblock">       <span class="insert">if(fic.open(QIODevice::ReadOnly))</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       starSettings = StelJsonParser::parse(&amp;fic).toMap();</td><td> </td><td class="rblock"><span class="insert">       {</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       fic.close();</td><td> </td><td class="rblock">               starSettings = StelJsonParser::parse(&amp;fic).toMap();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">               fic.close();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       <span class="insert">}</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // Increment the 1 each time any star catalog file change</td><td> </td><td class="right">       // Increment the 1 each time any star catalog file change</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (starSettings.value("version").toInt()!=StarCatalogFormatVersion)</td><td> </td><td class="right">       if (starSettings.value("version").toInt()!=StarCatalogFormatVersion)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               qWarning() &lt;&lt; "Found an old starsConfig.json file, upgrade..
";</td><td> </td><td class="right">               qWarning() &lt;&lt; "Found an old starsConfig.json file, upgrade..
";</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               fic.remove();</td><td> </td><td class="right">               fic.remove();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               copyDefaultConfigFile();</td><td> </td><td class="right">               copyDefaultConfigFile();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               QFile fic2(starConfigFileFullPath);</td><td> </td><td class="right">               QFile fic2(starConfigFileFullPath);</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0015" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               <span class="delete">fic2.open(QIODevice::ReadOnly);</span></td><td> </td><td class="rblock">               <span class="insert">if(fic2.open(QIODevice::ReadOnly))</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               starSettings = StelJsonParser::parse(&amp;fic2).toMap();</td><td> </td><td class="rblock"><span class="insert">               {</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               fic2.close();</td><td> </td><td class="rblock">                       starSettings = StelJsonParser::parse(&amp;fic2).toMap();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                       fic2.close();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">               <span class="insert">}</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       loadData(starSettings);</td><td> </td><td class="right">       loadData(starSettings);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       starFont.setPixelSize(StelApp::getInstance().getSettings()-&gt;value("g
ui/base_font_size", 13).toInt());</td><td> </td><td class="right">       starFont.setPixelSize(StelApp::getInstance().getSettings()-&gt;value("g
ui/base_font_size", 13).toInt());</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       setFlagStars(conf-&gt;value("astro/flag_stars", true).toBool());</td><td> </td><td class="right">       setFlagStars(conf-&gt;value("astro/flag_stars", true).toBool());</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       setFlagLabels(conf-&gt;value("astro/flag_star_name",true).toBool());</td><td> </td><td class="right">       setFlagLabels(conf-&gt;value("astro/flag_star_name",true).toBool());</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       setLabelsAmount(conf-&gt;value("stars/labels_amount",3.f).toFloat());</td><td> </td><td class="right">       setLabelsAmount(conf-&gt;value("stars/labels_amount",3.f).toFloat());</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       objectMgr-&gt;registerStelObjectMgr(this);</td><td> </td><td class="right">       objectMgr-&gt;registerStelObjectMgr(this);</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0016" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       texPointer = StelApp::getInstance().getTextureManager().createTextur
e(StelFileMgr::getInstallationDir()+"/textures/pointeur2.png");   // Load p
ointer texture</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       StelApp::getInstance().getCore()-&gt;getGeodesicGrid(maxGeodesicGridLev
el)-&gt;visitTriangles(maxGeodesicGridLevel,initTriangleFunc,this);</td><td> </td><td class="right">       StelApp::getInstance().getCore()-&gt;getGeodesicGrid(maxGeodesicGridLev
el)-&gt;visitTriangles(maxGeodesicGridLevel,initTriangleFunc,this);</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0017" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">for (ZoneArrayMap::const_iterator it(zoneArrays.begin()); it!=zoneAr</span></td><td> </td><td class="rblock">       <span class="insert">foreach(ZoneArray* z, gridLevels)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">rays.end();it++)</span></td><td> </td><td class="rblock"><span class="insert">               z-&gt;scaleAxis();</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       {</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               it.value()-&gt;scaleAxis();</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       }</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       StelApp *app = &amp;StelApp::getInstance();</td><td> </td><td class="right">       StelApp *app = &amp;StelApp::getInstance();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       connect(app, SIGNAL(languageChanged()), this, SLOT(updateI18n()));</td><td> </td><td class="right">       connect(app, SIGNAL(languageChanged()), this, SLOT(updateI18n()));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       connect(app, SIGNAL(skyCultureChanged(const QString&amp;)), this, SLOT(u
pdateSkyCulture(const QString&amp;)));</td><td> </td><td class="right">       connect(app, SIGNAL(skyCultureChanged(const QString&amp;)), this, SLOT(u
pdateSkyCulture(const QString&amp;)));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       connect(app, SIGNAL(colorSchemeChanged(const QString&amp;)), this, SLOT(
setStelStyle(const QString&amp;)));</td><td> </td><td class="right">       connect(app, SIGNAL(colorSchemeChanged(const QString&amp;)), this, SLOT(
setStelStyle(const QString&amp;)));</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0018" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                           </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       <span class="insert">QString displayGroup = N_("Display Options");</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       addAction("actionShow_Stars", displayGroup, N_("Stars"), "flagStarsD</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">isplayed", "S");</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       addAction("actionShow_Stars_Labels", displayGroup, N_("Stars labels"</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">), "flagLabelsDisplayed", "Alt+S");</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0019" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">void StarMgr::drawPointer(Stel<span class="delete">Renderer* renderer, StelProjectorP projector,
</span> const StelCore* core)</td><td> </td><td class="rblock">void StarMgr::drawPointer(Stel<span class="insert">Painter&amp; sPainter,</span> const StelCore* core)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       const QList&lt;StelObjectP&gt; newSelected = objectMgr-&gt;getSelectedObject(
"Star");</td><td> </td><td class="right">       const QList&lt;StelObjectP&gt; newSelected = objectMgr-&gt;getSelectedObject(
"Star");</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (!newSelected.empty())</td><td> </td><td class="right">       if (!newSelected.empty())</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               const StelObjectP obj = newSelected[0];</td><td> </td><td class="right">               const StelObjectP obj = newSelected[0];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               Vec3d pos=obj-&gt;getJ2000EquatorialPos(core);</td><td> </td><td class="right">               Vec3d pos=obj-&gt;getJ2000EquatorialPos(core);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0020" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               Vec3d <span class="delete">win</span>;</td><td> </td><td class="rblock">               Vec3d <span class="insert">screenpos</span>;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               // Compute 2D pos and return if outside screen</td><td> </td><td class="right">               // Compute 2D pos and return if outside screen</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0021" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               if <span class="delete">(!projector-&gt;project(pos, win))</span></td><td> </td><td class="rblock">               if <span class="insert">(!sPainter.getProjector()-&gt;project(pos, screenpos))</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               {</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       return;</td><td> </td><td class="right">                       return;</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0022" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               <span class="delete">}</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               if(NULL == texPointer)</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               {</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                       texPointer = renderer-&gt;createTexture("textures/point</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">eur2.png");   // Load pointer texture</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               }</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               Vec3f c(obj-&gt;getInfoColor());</td><td> </td><td class="right">               Vec3f c(obj-&gt;getInfoColor());</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0023" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               <span class="delete">if (StelApp::getInstance().getVisionModeNight())</span></td><td> </td><td class="rblock">               <span class="insert">sPainter.setColor(c[0],</span> c[1], c[2]);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                       c = StelUtils::getNightColor(c);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               renderer-&gt;setGlobalColor(c[0],</span> c[1], c[2]);</td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                           </td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               texPointer-&gt;bind();</td><td> </td><td class="right">               texPointer-&gt;bind();</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0024" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               <span class="delete">renderer-&gt;setBlendMode(BlendMode_Alpha);</span></td><td> </td><td class="rblock">               <span class="insert">sPainter.enableTexture2d(true);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               const float angle = StelApp::getInstance().getTotalRunTime()</span></td><td> </td><td class="rblock"><span class="insert">               glEnable(GL_BLEND);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"> * 40.0f;</span></td><td> </td><td class="rblock"><span class="insert">               glBlendFunc(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA); // Normal</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               renderer-&gt;drawTexturedRect(win[0] - 13.0f, win[1] - 13.0f, 2</span></td><td> </td><td class="rblock"><span class="insert"> transparency mode</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">6.0f, 26.0f, angle);</span></td><td> </td><td class="rblock"><span class="insert">               sPainter.drawSprite2dMode(screenpos[0], screenpos[1], 13.f, </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">StelApp::getInstance().getTotalRunTime()*40.);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void StarMgr::setStelStyle(const QString&amp; section)</td><td> </td><td class="right">void StarMgr::setStelStyle(const QString&amp; section)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // Load colors from config file</td><td> </td><td class="right">       // Load colors from config file</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       QSettings* conf = StelApp::getInstance().getSettings();</td><td> </td><td class="right">       QSettings* conf = StelApp::getInstance().getSettings();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       QString defaultColor = conf-&gt;value(section+"/default_color").toStrin
g();</td><td> </td><td class="right">       QString defaultColor = conf-&gt;value(section+"/default_color").toStrin
g();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       setLabelColor(StelUtils::strToVec3f(conf-&gt;value(section+"/star_label
_color", defaultColor).toString()));</td><td> </td><td class="right">       setLabelColor(StelUtils::strToVec3f(conf-&gt;value(section+"/star_label
_color", defaultColor).toString()));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0025" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">bool StarMgr::checkAndLoadCatalog(<span class="delete">QVariantMap</span> catDesc)</td><td> </td><td class="rblock">bool StarMgr::checkAndLoadCatalog(<span class="insert">const QVariantMap&amp;</span> catDesc)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       const bool checked = catDesc.value("checked").toBool();</td><td> </td><td class="right">       const bool checked = catDesc.value("checked").toBool();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       QString catalogFileName = catDesc.value("fileName").toString();</td><td> </td><td class="right">       QString catalogFileName = catDesc.value("fileName").toString();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // See if it is an absolute path, else prepend default path</td><td> </td><td class="right">       // See if it is an absolute path, else prepend default path</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (!(StelFileMgr::isAbsolute(catalogFileName)))</td><td> </td><td class="right">       if (!(StelFileMgr::isAbsolute(catalogFileName)))</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               catalogFileName = "stars/default/"+catalogFileName;</td><td> </td><td class="right">               catalogFileName = "stars/default/"+catalogFileName;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0026" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       QString <span class="delete">catalogFilePath;</span></td><td> </td><td class="rblock">       QString catalogFilePath = StelFileMgr::findFile(catalogFileName);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       try</span></td><td> </td><td class="rblock">       <span class="insert">if (catalogFilePath.isEmpty())</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       {</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               catalogFilePath = StelFileMgr::findFile(catalogFileName);</td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">}</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       catch (std::runtime_error e)</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               // The file is supposed to be checked, but we can't find it</td><td> </td><td class="right">               // The file is supposed to be checked, but we can't find it</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               if (checked)</td><td> </td><td class="right">               if (checked)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       qWarning() &lt;&lt; QString("Warning: could not find star 
catalog %1").arg(QDir::toNativeSeparators(catalogFileName));</td><td> </td><td class="right">                       qWarning() &lt;&lt; QString("Warning: could not find star 
catalog %1").arg(QDir::toNativeSeparators(catalogFileName));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       setCheckFlag(catDesc.value("id").toString(), false);</td><td> </td><td class="right">                       setCheckFlag(catDesc.value("id").toString(), false);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               return false;</td><td> </td><td class="right">               return false;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // Possibly fixes crash on Vista</td><td> </td><td class="right">       // Possibly fixes crash on Vista</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l5" /><small>skipping to change at</small><em> line 427</em></th><th> </th><th><a name="part-r5" /><small>skipping to change at</small><em> line 403</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               qWarning() &lt;&lt; QString("Warning: User does not have permissio
ns to read catalog %1").arg(QDir::toNativeSeparators(catalogFilePath));</td><td> </td><td class="right">               qWarning() &lt;&lt; QString("Warning: User does not have permissio
ns to read catalog %1").arg(QDir::toNativeSeparators(catalogFilePath));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               return false;</td><td> </td><td class="right">               return false;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (!checked)</td><td> </td><td class="right">       if (!checked)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               // The file is not checked but we found it, maybe from a pre
vious download/version</td><td> </td><td class="right">               // The file is not checked but we found it, maybe from a pre
vious download/version</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               qWarning() &lt;&lt; "Found file " &lt;&lt; QDir::toNativeSeparators(cata
logFilePath) &lt;&lt; ", checking md5sum..";</td><td> </td><td class="right">               qWarning() &lt;&lt; "Found file " &lt;&lt; QDir::toNativeSeparators(cata
logFilePath) &lt;&lt; ", checking md5sum..";</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               QFile fic(catalogFilePath);</td><td> </td><td class="right">               QFile fic(catalogFilePath);</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0027" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               <span class="delete">fic.open(QIODevice::ReadOnly</span> | <span class="delete">QIODevice::Unbuffered);</span></td><td> </td><td class="rblock">               <span class="insert">if(fic.open(QIODevice::ReadOnly</span> | <span class="insert">QIODevice::Unbuffered))</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               // Compute the MD5 sum</td><td> </td><td class="rblock"><span class="insert">               {</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               QCryptographicHash md5Hash(QCryptographicHash::Md5);</td><td> </td><td class="rblock">                       // Compute the MD5 sum</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               const qint64 cat_sz = fic.size();</td><td> </td><td class="rblock">                       QCryptographicHash md5Hash(QCryptographicHash::Md5);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               qint64 maxStarBufMd5 = qMin(cat_sz, <span class="delete">9223372036854775807LL);</span></td><td> </td><td class="rblock">                       const qint64 cat_sz = fic.size();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               uchar *cat = maxStarBufMd5 ? fic.map(0, <span class="delete">maxStarBufMd5)</span> : <span class="delete">NUL</span></td><td> </td><td class="rblock">                       qint64 maxStarBufMd5 = qMin(cat_sz, <span class="insert">9223372036854775</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">L;</span></td><td> </td><td class="rblock"><span class="insert">807LL);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               if (!cat)</td><td> </td><td class="rblock">                       uchar *cat = maxStarBufMd5 ? fic.map(0, <span class="insert">maxStarBufMd</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               <span class="delete">{</span></td><td> </td><td class="rblock"><span class="insert">5)</span> : <span class="insert">NULL;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                       // The OS was not able to map the file, revert to sl</span></td><td> </td><td class="rblock">                       if (!cat)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">ower not mmap based method</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                       static const qint64 maxStarBufMd5 = 1024*1024*8;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                       char* mmd5buf = (char*)malloc(maxStarBufMd5);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                       while (!fic.atEnd())</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       {</td><td> </td><td class="right">                       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0028" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                               qint64 sz = fic.read(mmd5buf, <span class="delete">maxStarBufMd5)</span></td><td> </td><td class="rblock">                               <span class="insert">// The OS was not able to map the file, reve</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">;</span></td><td> </td><td class="rblock"><span class="insert">rt to slower not mmap based method</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                               md5Hash.addData(mmd5buf, sz);</td><td> </td><td class="rblock"><span class="insert">                               static const qint64 maxStarBufMd5 = 1024*102</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">4*8;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                               char* mmd5buf = (char*)malloc(maxStarBufMd5)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                               while (!fic.atEnd())</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                               {</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                                       qint64 sz = fic.read(mmd5buf, <span class="insert">maxSta</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">rBufMd5);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                                       md5Hash.addData(mmd5buf, sz);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                               <span class="insert">}</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                               free(mmd5buf);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       }</td><td> </td><td class="right">                       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0029" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       <span class="delete">free(mmd5buf);</span></td><td> </td><td class="rblock">                       else</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               }</span></td><td> </td><td class="rblock">                       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               else</td><td> </td><td class="rblock">                               md5Hash.addData((const char*)cat, cat_sz);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               {</td><td> </td><td class="rblock">                               fic.unmap(cat);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       md5Hash.addData((const char*)cat, cat_sz);</td><td> </td><td class="rblock">                       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       fic.unmap(cat);</td><td> </td><td class="rblock">                       fic.close();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               }</td><td> </td><td class="rblock">                       if <span class="insert">(md5Hash.result().toHex()!=catDesc.value("checksu</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               fic.close();</td><td> </td><td class="rblock"><span class="insert">m").toByteArray())</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               if <span class="delete">(md5Hash.result().toHex()!=catDesc.value("checksum").toBy</span></td><td> </td><td class="rblock">                       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">teArray())</span></td><td> </td><td class="rblock">                               qWarning() &lt;&lt; "Error: File " &lt;&lt; <span class="insert">QDir::toNati</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               {</td><td> </td><td class="rblock"><span class="insert">veSeparators(catalogFileName)</span> &lt;&lt; " is corrupt, MD5 mismatch! Found " &lt;&lt; <span class="insert">md5</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       qWarning() &lt;&lt; "Error: File " &lt;&lt; <span class="delete">QDir::toNativeSepara</span></td><td> </td><td class="rblock"><span class="insert">Hash.result().toHex()</span> &lt;&lt; " expected " &lt;&lt; <span class="insert">catDesc.value("checksum").toByteAr</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">tors(catalogFileName)</span> &lt;&lt; " is corrupt, MD5 mismatch! Found " &lt;&lt; <span class="delete">md5Hash.res</span></td><td> </td><td class="rblock"><span class="insert">ray();</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">ult().toHex()</span> &lt;&lt; " expected " &lt;&lt; <span class="delete">catDesc.value("checksum").toByteArray();</span></td><td> </td><td class="rblock">                               fic.remove();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       fic.remove();</td><td> </td><td class="rblock">                               return false;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       return false;</td><td> </td><td class="rblock">                       <span class="insert">}</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       qWarning() &lt;&lt; "MD5 sum correct!";</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       setCheckFlag(catDesc.value("id").toString(), true);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0030" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               <span class="delete">qWarning() &lt;&lt; "MD5 sum correct!";</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               setCheckFlag(catDesc.value("id").toString(), true);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0031" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       ZoneArray* <span class="delete">const </span>z = ZoneArray::create(catalogFilePath, true);</td><td> </td><td class="rblock">       ZoneArray* z = ZoneArray::create(catalogFilePath, true);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (z)</td><td> </td><td class="right">       if (z)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0032" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               if <span class="delete">(maxGeodesicGridLevel &lt; z-&gt;level)</span></td><td> </td><td class="rblock">               if <span class="insert">(z-&gt;level&lt;gridLevels.size())</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               {</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                       maxGeodesicGridLevel = z-&gt;level;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               }</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               ZoneArray *pos(zoneArrays[z-&gt;level]);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               if (pos)</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       qWarning() &lt;&lt; QDir::toNativeSeparators(catalogFileNa
me) &lt;&lt; ", " &lt;&lt; z-&gt;level &lt;&lt; ": duplicate level";</td><td> </td><td class="right">                       qWarning() &lt;&lt; QDir::toNativeSeparators(catalogFileNa
me) &lt;&lt; ", " &lt;&lt; z-&gt;level &lt;&lt; ": duplicate level";</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       delete z;</td><td> </td><td class="right">                       delete z;</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0033" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       return true;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0034" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               <span class="delete">else</span></td><td> </td><td class="rblock">               <span class="insert">Q_ASSERT(z-&gt;level==maxGeodesicGridLevel+1);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               {</span></td><td> </td><td class="rblock"><span class="insert">               Q_ASSERT(z-&gt;level==gridLevels.size());</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                       zoneArrays[z-&gt;level] = z;</span></td><td> </td><td class="rblock"><span class="insert">               ++maxGeodesicGridLevel;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                       pos = z;</span></td><td> </td><td class="rblock"><span class="insert">               gridLevels.append(z);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               }</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return true;</td><td> </td><td class="right">       return true;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void StarMgr::setCheckFlag(const QString&amp; catId, bool b)</td><td> </td><td class="right">void StarMgr::setCheckFlag(const QString&amp; catId, bool b)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // Update the starConfigFileFullPath file to take into account that 
we now have a new catalog</td><td> </td><td class="right">       // Update the starConfigFileFullPath file to take into account that 
we now have a new catalog</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       int idx=0;</td><td> </td><td class="right">       int idx=0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       foreach (const QVariant&amp; catV, catalogsDescription)</td><td> </td><td class="right">       foreach (const QVariant&amp; catV, catalogsDescription)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l6" /><small>skipping to change at</small><em> line 500</em></th><th> </th><th><a name="part-r6" /><small>skipping to change at</small><em> line 473</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               QVariantMap m = catV.toMap();</td><td> </td><td class="right">               QVariantMap m = catV.toMap();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               if (m.value("id").toString()!=catId)</td><td> </td><td class="right">               if (m.value("id").toString()!=catId)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       continue;</td><td> </td><td class="right">                       continue;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               const bool checked = m.value("checked").toBool();</td><td> </td><td class="right">               const bool checked = m.value("checked").toBool();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               if (checked==b)</td><td> </td><td class="right">               if (checked==b)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       return;</td><td> </td><td class="right">                       return;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               m["checked"]=b;</td><td> </td><td class="right">               m["checked"]=b;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               catalogsDescription[idx-1]=m;</td><td> </td><td class="right">               catalogsDescription[idx-1]=m;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               starSettings["catalogs"]=catalogsDescription;</td><td> </td><td class="right">               starSettings["catalogs"]=catalogsDescription;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               QFile tmp(starConfigFileFullPath);</td><td> </td><td class="right">               QFile tmp(starConfigFileFullPath);</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0035" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               <span class="delete">tmp.open(QIODevice::WriteOnly);</span></td><td> </td><td class="rblock">               <span class="insert">if(tmp.open(QIODevice::WriteOnly))</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               StelJsonParser::write(starSettings, &amp;tmp);</td><td> </td><td class="rblock"><span class="insert">               {</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               tmp.close();</td><td> </td><td class="rblock">                       StelJsonParser::write(starSettings, &amp;tmp);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                       tmp.close();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">               <span class="insert">}</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void StarMgr::loadData(QVariantMap starsConfig)</td><td> </td><td class="right">void StarMgr::loadData(QVariantMap starsConfig)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // Please do not init twice:</td><td> </td><td class="right">       // Please do not init twice:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       Q_ASSERT(maxGeodesicGridLevel &lt; 0);</td><td> </td><td class="right">       Q_ASSERT(maxGeodesicGridLevel &lt; 0);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       qDebug() &lt;&lt; "Loading star data ...";</td><td> </td><td class="right">       qDebug() &lt;&lt; "Loading star data ...";</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l7" /><small>skipping to change at</small><em> line 526</em></th><th> </th><th><a name="part-r7" /><small>skipping to change at</small><em> line 501</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               QVariantMap m = catV.toMap();</td><td> </td><td class="right">               QVariantMap m = catV.toMap();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               checkAndLoadCatalog(m);</td><td> </td><td class="right">               checkAndLoadCatalog(m);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       for (int i=0; i&lt;=NR_OF_HIP; i++)</td><td> </td><td class="right">       for (int i=0; i&lt;=NR_OF_HIP; i++)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               hipIndex[i].a = 0;</td><td> </td><td class="right">               hipIndex[i].a = 0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               hipIndex[i].z = 0;</td><td> </td><td class="right">               hipIndex[i].z = 0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               hipIndex[i].s = 0;</td><td> </td><td class="right">               hipIndex[i].s = 0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0036" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">for (ZoneArrayMap::const_iterator it(zoneArrays.constBegin()); it !=</span></td><td> </td><td class="rblock">       <span class="insert">foreach(ZoneArray* z, gridLevels)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"> zoneArrays.constEnd();++it)</span></td><td> </td><td class="rblock"><span class="insert">               z-&gt;updateHipIndex(hipIndex);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       {</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               it.value()-&gt;updateHipIndex(hipIndex);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       }</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       const QString cat_hip_sp_file_name = starsConfig.value("hipSpectralF
ile").toString();</td><td> </td><td class="right">       const QString cat_hip_sp_file_name = starsConfig.value("hipSpectralF
ile").toString();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (cat_hip_sp_file_name.isEmpty())</td><td> </td><td class="right">       if (cat_hip_sp_file_name.isEmpty())</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               qWarning() &lt;&lt; "ERROR: stars:cat_hip_sp_file_name not found";</td><td> </td><td class="right">               qWarning() &lt;&lt; "ERROR: stars:cat_hip_sp_file_name not found";</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       else</td><td> </td><td class="right">       else</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0037" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               <span class="delete">try</span></td><td> </td><td class="rblock">               <span class="insert">QString tmpFic</span> = <span class="insert">StelFileMgr::findFile("stars/default/"</span> + <span class="insert">ca</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               {</span></td><td> </td><td class="rblock"><span class="insert">t_hip_sp_file_name);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                       spectral_array</span> = <span class="delete">initStringListFromFile(StelFileMgr:</span></td><td> </td><td class="rblock"><span class="insert">               if (tmpFic.isEmpty())</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">:findFile("stars/default/"</span> + <span class="delete">cat_hip_sp_file_name));</span></td><td> </td><td class="rblock">                       qWarning() &lt;&lt; "ERROR while loading data from " &lt;&lt; <span class="insert">QD</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               }</span></td><td> </td><td class="rblock"><span class="insert">ir::toNativeSeparators(("stars/default/"</span> + <span class="insert">cat_hip_sp_file_name));</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               catch (std::runtime_error&amp; e)</span></td><td> </td><td class="rblock"><span class="insert">               else</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               {</span></td><td> </td><td class="rblock"><span class="insert">                       spectral_array = initStringListFromFile(tmpFic);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       qWarning() &lt;&lt; "ERROR while loading data from "</td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                          &lt;&lt; <span class="delete">QDir::toNativeSeparators(("sta</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">rs/default/"</span> + <span class="delete">cat_hip_sp_file_name))</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                                          &lt;&lt; ": " &lt;&lt; e.what();</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               }</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       const QString cat_hip_cids_file_name = starsConfig.value("hipCompone
ntsIdsFile").toString();</td><td> </td><td class="right">       const QString cat_hip_cids_file_name = starsConfig.value("hipCompone
ntsIdsFile").toString();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (cat_hip_cids_file_name.isEmpty())</td><td> </td><td class="right">       if (cat_hip_cids_file_name.isEmpty())</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               qWarning() &lt;&lt; "ERROR: stars:cat_hip_cids_file_name not found
";</td><td> </td><td class="right">               qWarning() &lt;&lt; "ERROR: stars:cat_hip_cids_file_name not found
";</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       else</td><td> </td><td class="right">       else</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0038" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               <span class="delete">try</span></td><td> </td><td class="rblock">               <span class="insert">QString tmpFic</span> = <span class="insert">StelFileMgr::findFile("stars/default/"</span> + <span class="insert">ca</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               {</span></td><td> </td><td class="rblock"><span class="insert">t_hip_cids_file_name);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                       component_array</span> = <span class="delete">initStringListFromFile(StelFileMgr</span></td><td> </td><td class="rblock"><span class="insert">               if (tmpFic.isEmpty())</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">::findFile("stars/default/"</span> + <span class="delete">cat_hip_cids_file_name));</span></td><td> </td><td class="rblock">                       qWarning() &lt;&lt; "ERROR while loading data from " &lt;&lt; <span class="insert">QD</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               }</span></td><td> </td><td class="rblock"><span class="insert">ir::toNativeSeparators(("stars/default/"</span> + <span class="insert">cat_hip_cids_file_name));</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               catch (std::runtime_error&amp; e)</span></td><td> </td><td class="rblock"><span class="insert">               else</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               {</span></td><td> </td><td class="rblock"><span class="insert">                       component_array = initStringListFromFile(tmpFic);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       qWarning() &lt;&lt; "ERROR while loading data from "</td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                          &lt;&lt; <span class="delete">QDir::toNativeSeparators(("sta</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">rs/default/"</span> + <span class="delete">cat_hip_cids_file_name)) &lt;&lt; ": " &lt;&lt; e.what();</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               }</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       lastMaxSearchLevel = maxGeodesicGridLevel;</td><td> </td><td class="right">       lastMaxSearchLevel = maxGeodesicGridLevel;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       qDebug() &lt;&lt; "Finished loading star catalogue data, max_geodesic_leve
l: " &lt;&lt; maxGeodesicGridLevel;</td><td> </td><td class="right">       qDebug() &lt;&lt; "Finished loading star catalogue data, max_geodesic_leve
l: " &lt;&lt; maxGeodesicGridLevel;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Load common names from file</td><td> </td><td class="right">// Load common names from file</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">int StarMgr::loadCommonNames(const QString&amp; commonNameFile)</td><td> </td><td class="right">int StarMgr::loadCommonNames(const QString&amp; commonNameFile)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       commonNamesMap.clear();</td><td> </td><td class="right">       commonNamesMap.clear();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l8" /><small>skipping to change at</small><em> line 799</em></th><th> </th><th><a name="part-r8" /><small>skipping to change at</small><em> line 763</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               varStarsIndexI18n[variableStar.designation.toUpper()] = hip;</td><td> </td><td class="right">               varStarsIndexI18n[variableStar.designation.toUpper()] = hip;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               ++readOk;</td><td> </td><td class="right">               ++readOk;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       qDebug() &lt;&lt; "Loaded" &lt;&lt; readOk &lt;&lt; "/" &lt;&lt; totalRecords &lt;&lt; "variable s
tars";</td><td> </td><td class="right">       qDebug() &lt;&lt; "Loaded" &lt;&lt; readOk &lt;&lt; "/" &lt;&lt; totalRecords &lt;&lt; "variable s
tars";</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">int StarMgr::getMaxSearchLevel() const</td><td> </td><td class="right">int StarMgr::getMaxSearchLevel() const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       int rval = -1;</td><td> </td><td class="right">       int rval = -1;</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0039" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       for<span class="delete"> (ZoneArrayMap::const_iterator it(zoneArrays.constBegin());it!=zo
neArrays.constEnd();++it</span>)</td><td> </td><td class="rblock">       for<span class="insert">each(const ZoneArray* z, gridLevels</span>)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0040" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               const float mag_min = <span class="delete">0.001f*it.value()-&gt;mag_min;</span></td><td> </td><td class="rblock">               const float mag_min = <span class="insert">0.001f*z-&gt;mag_min;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               float rcmag[2];</span></td><td> </td><td class="rblock"><span class="insert">               RCMag rcmag;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               if (StelApp::getInstance().getCore()-&gt;getSkyDrawer()-&gt;comput</td><td> </td><td class="rblock">               if (StelApp::getInstance().getCore()-&gt;getSkyDrawer()-&gt;comput</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">eRCMag(mag_min,rcmag)==false)</span></td><td> </td><td class="rblock"><span class="insert">eRCMag(mag_min, &amp;rcmag)==false)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       break;</td><td> </td><td class="right">                       break;</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0041" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               rval = <span class="delete">it.key()</span>;</td><td> </td><td class="rblock">               rval = <span class="insert">z-&gt;level</span>;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return rval;</td><td> </td><td class="right">       return rval;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Draw all the stars</td><td> </td><td class="right">// Draw all the stars</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0042" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">void StarMgr::draw(StelCore* core<span class="delete">, StelRenderer* renderer</span>)</td><td> </td><td class="rblock">void StarMgr::draw(StelCore* core)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       const StelProjectorP prj = core-&gt;getProjection(StelCore::FrameJ2000)
;</td><td> </td><td class="right">       const StelProjectorP prj = core-&gt;getProjection(StelCore::FrameJ2000)
;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       StelSkyDrawer* skyDrawer = core-&gt;getSkyDrawer();</td><td> </td><td class="right">       StelSkyDrawer* skyDrawer = core-&gt;getSkyDrawer();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // If stars are turned off don't waste time below</td><td> </td><td class="right">       // If stars are turned off don't waste time below</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // projecting all stars just to draw disembodied labels</td><td> </td><td class="right">       // projecting all stars just to draw disembodied labels</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (!starsFader.getInterstate())</td><td> </td><td class="right">       if (!starsFader.getInterstate())</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               return;</td><td> </td><td class="right">               return;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       int maxSearchLevel = getMaxSearchLevel();</td><td> </td><td class="right">       int maxSearchLevel = getMaxSearchLevel();</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0043" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       const GeodesicSearchResult* geodesic_search_result = core-&gt;getGeodes</td><td> </td><td class="rblock">       <span class="insert">QVector&lt;SphericalCap&gt; viewportCaps = prj-&gt;getViewportConvexPolygon()</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">icGrid(maxSearchLevel)-&gt;search(prj-&gt;getViewportConvexPolygon()-&gt;getBounding</span></td><td> </td><td class="rblock"><span class="insert">-&gt;getBoundingSphericalCaps();</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">SphericalCaps(),maxSearchLevel);</span></td><td> </td><td class="rblock"><span class="insert">       viewportCaps.append(core-&gt;getVisibleSkyArea());</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       const GeodesicSearchResult* geodesic_search_result = core-&gt;getGeodes</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">icGrid(maxSearchLevel)-&gt;search(viewportCaps,maxSearchLevel);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // Set temporary static variable for optimization</td><td> </td><td class="right">       // Set temporary static variable for optimization</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       const float names_brightness = labelsFader.getInterstate() * starsFa
der.getInterstate();</td><td> </td><td class="right">       const float names_brightness = labelsFader.getInterstate() * starsFa
der.getInterstate();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0044" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       // Prepare for drawing many stars</td><td> </td><td class="rblock">       // Prepare <span class="insert">openGL</span> for drawing many stars</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">renderer-&gt;setFont(starFont);</span></td><td> </td><td class="rblock">       <span class="insert">StelPainter sPainter(prj);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       skyDrawer-&gt;preDrawPointSource();</span></td><td> </td><td class="rblock"><span class="insert">       sPainter.setFont(starFont);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                           </td><td> </td><td class="rblock"><span class="insert">       skyDrawer-&gt;preDrawPointSource(&amp;sPainter);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       // <span class="delete">draw</span> all the stars of all the selected zones</td><td> </td><td class="rblock">                                                                           </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">// GZ: This table must be enlarged from 2x256 to many more entries. </span></td><td> </td><td class="rblock">       // <span class="insert">Prepare a table for storing precomputed RCMag for all ZoneArrays</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">CORRELATE IN Zonearray.cpp!</span></td><td> </td><td class="rblock"><span class="insert">       RCMag rcmag_table[RCMAG_TABLE_SIZE];</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       //float rcmag_table[2*256];</span></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       //float rcmag_table[2*16384];</span></td><td> </td><td class="rblock"><span class="insert">       // Draw</span> all the stars of all the selected zones</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       float rcmag_table[2 * RCMAG_TABLE_SIZE];</span></td><td> </td><td class="rblock">       <span class="insert">foreach(const ZoneArray* z, gridLevels)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       for (ZoneArrayMap::const_iterator it(zoneArrays.constBegin()); it!=z</span></td><td> </td><td class="rblock">               <span class="insert">int limitMagIndex=RCMAG_TABLE_SIZE;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">oneArrays.constEnd();++it)</span></td><td> </td><td class="rblock">               const float mag_min = <span class="insert">0.001f*z-&gt;mag_min;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       {</td><td> </td><td class="rblock">               const float k = <span class="insert">(0.001f*z-&gt;mag_range)/z-&gt;mag_steps;</span> // <span class="insert">MagSt</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               const float mag_min = <span class="delete">0.001f*it.value()-&gt;mag_min;</span></td><td> </td><td class="rblock"><span class="insert">epIncrement</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               const float k = <span class="delete">(0.001f*it.value()-&gt;mag_range)/it.value()-&gt;m</span></td><td> </td><td class="rblock">               for (int <span class="insert">i=0;i&lt;RCMAG_TABLE_SIZE;++i)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">ag_steps; // MagStepIncrement</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               // <span class="delete">GZ: add a huge number of entries to rcMag</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               //for (int i=it.value()-&gt;mag_steps-1;i&gt;=0;--i)</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               for (int <span class="delete">i=RCMAG_TABLE_SIZE-1;i&gt;=0;--i)</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       const float mag = mag_min+k*i;</td><td> </td><td class="right">                       const float mag = mag_min+k*i;</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0045" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       if <span class="delete">(skyDrawer-&gt;computeRCMag(mag,rcmag_table + 2*i)==</span></td><td> </td><td class="rblock">                       if <span class="insert">(skyDrawer-&gt;computeRCMag(mag, &amp;rcmag_table[i])==f</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">false)</span></td><td> </td><td class="rblock"><span class="insert">alse)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                       {</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                               if (i==0) goto exit_loop;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                       }</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                       if (skyDrawer-&gt;getDrawStarsAsPoints())</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                       {</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                               rcmag_table[2*i+1] *= starsFader.getIntersta</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">te();</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                       }</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                       else</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       {</td><td> </td><td class="right">                       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0046" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                               <span class="delete">rcmag_table[2*i] *= starsFader.getInterstate</span></td><td> </td><td class="rblock">                               <span class="insert">if (i==0)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">();</span></td><td> </td><td class="rblock"><span class="insert">                                       goto exit_loop;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                               // The last magnitude at which the star is v</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">isible</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                               limitMagIndex = i-1;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                               // We reached the point where stars are not </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">visible anymore</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                               // Fill the rest of the table with zero and </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">leave.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                               for (;i&lt;RCMAG_TABLE_SIZE;++i)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                               {</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                                       rcmag_table[i].luminance=0;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                                       rcmag_table[i].radius=0;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                               }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                               break;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       }</td><td> </td><td class="right">                       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0047" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       rcmag_table[i].radius *= starsFader.getInterstate();</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0048" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               lastMaxSearchLevel = <span class="delete">it.key()</span>;</td><td> </td><td class="rblock">               lastMaxSearchLevel = <span class="insert">z-&gt;level</span>;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               unsigned int maxMagStarName = 0;</td><td> </td><td class="right">               unsigned int maxMagStarName = 0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               if (labelsFader.getInterstate()&gt;0.f)</td><td> </td><td class="right">               if (labelsFader.getInterstate()&gt;0.f)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       // Adapt magnitude limit of the stars labels accordi
ng to FOV and labelsAmount</td><td> </td><td class="right">                       // Adapt magnitude limit of the stars labels accordi
ng to FOV and labelsAmount</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       float maxMag = (skyDrawer-&gt;getLimitMagnitude()-6.5)*
0.7+(labelsAmount*1.2f)-2.f;</td><td> </td><td class="right">                       float maxMag = (skyDrawer-&gt;getLimitMagnitude()-6.5)*
0.7+(labelsAmount*1.2f)-2.f;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       int x = (int)((maxMag-mag_min)/k);</td><td> </td><td class="right">                       int x = (int)((maxMag-mag_min)/k);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       if (x &gt; 0)</td><td> </td><td class="right">                       if (x &gt; 0)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               maxMagStarName = x;</td><td> </td><td class="right">                               maxMagStarName = x;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               int zone;</td><td> </td><td class="right">               int zone;</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0049" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               for (GeodesicSearchInsideIterator it1(*geodesic_search_resul</td><td> </td><td class="rblock">                                                                           </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">t,it.key());(zone</span> = it1.next()) &gt;= 0;)</td><td> </td><td class="rblock">               for (GeodesicSearchInsideIterator it1(*geodesic_search_resul</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       <span class="delete">it.value()-&gt;draw(prj, renderer,</span> zone, true, <span class="delete">rcmag_ta</span></td><td> </td><td class="rblock"><span class="insert">t,z-&gt;level);(zone</span> = it1.next()) &gt;= 0;)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">ble,</span> core, maxMagStarName, <span class="delete">names_brightness);</span></td><td> </td><td class="rblock">                       <span class="insert">z-&gt;draw(&amp;sPainter,</span> zone, true, <span class="insert">rcmag_table, limitMag</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               for (GeodesicSearchBorderIterator it1(*geodesic_search_resul</td><td> </td><td class="rblock"><span class="insert">Index,</span> core, maxMagStarName, <span class="insert">names_brightness, viewportCaps);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">t,it.key());(zone</span> = it1.next()) &gt;= 0;)</td><td> </td><td class="rblock">               for (GeodesicSearchBorderIterator it1(*geodesic_search_resul</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       <span class="delete">it.value()-&gt;draw(prj, renderer,</span> zone, false, <span class="delete">rcmag_t</span></td><td> </td><td class="rblock"><span class="insert">t,z-&gt;level);(zone</span> = it1.next()) &gt;= 0;)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">able,</span> core, <span class="delete">maxMagStarName,names_brightness);</span></td><td> </td><td class="rblock">                       <span class="insert">z-&gt;draw(&amp;sPainter,</span> zone, false, <span class="insert">rcmag_table, limitMa</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">gIndex,</span> core, <span class="insert">maxMagStarName,names_brightness, viewportCaps);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       exit_loop:</td><td> </td><td class="right">       exit_loop:</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0050" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                                                                           </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // Finish drawing many stars</td><td> </td><td class="right">       // Finish drawing many stars</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0051" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       skyDrawer-&gt;postDrawPointSource(<span class="delete">prj</span>);</td><td> </td><td class="rblock">       skyDrawer-&gt;postDrawPointSource(<span class="insert">&amp;sPainter</span>);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (objectMgr-&gt;getFlagSelectedObjectPointer())</td><td> </td><td class="right">       if (objectMgr-&gt;getFlagSelectedObjectPointer())</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0052" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               drawPointer(<span class="delete">renderer, prj</span>, core);</td><td> </td><td class="rblock">               drawPointer(<span class="insert">sPainter</span>, core);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Return a stl vector containing the stars located</td><td> </td><td class="right">// Return a stl vector containing the stars located</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// inside the limFov circle around position v</td><td> </td><td class="right">// inside the limFov circle around position v</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">QList&lt;StelObjectP &gt; StarMgr::searchAround(const Vec3d&amp; vv, double limFov, c
onst StelCore* core) const</td><td> </td><td class="right">QList&lt;StelObjectP &gt; StarMgr::searchAround(const Vec3d&amp; vv, double limFov, c
onst StelCore* core) const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       QList&lt;StelObjectP &gt; result;</td><td> </td><td class="right">       QList&lt;StelObjectP &gt; result;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (!getFlagStars())</td><td> </td><td class="right">       if (!getFlagStars())</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               return result;</td><td> </td><td class="right">               return result;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l9" /><small>skipping to change at</small><em> line 937</em></th><th> </th><th><a name="part-r9" /><small>skipping to change at</small><em> line 909</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       e0 *= f;</td><td> </td><td class="right">       e0 *= f;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       e1 *= f;</td><td> </td><td class="right">       e1 *= f;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       e2 *= f;</td><td> </td><td class="right">       e2 *= f;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       e3 *= f;</td><td> </td><td class="right">       e3 *= f;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // Search the triangles</td><td> </td><td class="right">       // Search the triangles</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       SphericalConvexPolygon c(e3, e2, e2, e0);</td><td> </td><td class="right">       SphericalConvexPolygon c(e3, e2, e2, e0);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       const GeodesicSearchResult* geodesic_search_result = core-&gt;getGeodes
icGrid(lastMaxSearchLevel)-&gt;search(c.getBoundingSphericalCaps(),lastMaxSear
chLevel);</td><td> </td><td class="right">       const GeodesicSearchResult* geodesic_search_result = core-&gt;getGeodes
icGrid(lastMaxSearchLevel)-&gt;search(c.getBoundingSphericalCaps(),lastMaxSear
chLevel);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // Iterate over the stars inside the triangles</td><td> </td><td class="right">       // Iterate over the stars inside the triangles</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       f = cos(limFov * M_PI/180.);</td><td> </td><td class="right">       f = cos(limFov * M_PI/180.);</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0053" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       for<span class="delete"> (ZoneArrayMap::const_iterator it(zoneArrays.constBegin());it!=zo
neArrays.constEnd();it++</span>)</td><td> </td><td class="rblock">       for<span class="insert">each(ZoneArray* z, gridLevels</span>)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               //qDebug() &lt;&lt; "search inside(" &lt;&lt; it-&gt;first &lt;&lt; "):";</td><td> </td><td class="right">               //qDebug() &lt;&lt; "search inside(" &lt;&lt; it-&gt;first &lt;&lt; "):";</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               int zone;</td><td> </td><td class="right">               int zone;</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0054" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               for (GeodesicSearchInsideIterator it1(*geodesic_search_resul
t,<span class="delete">it.key()</span>);(zone = it1.next()) &gt;= 0;)</td><td> </td><td class="rblock">               for (GeodesicSearchInsideIterator it1(*geodesic_search_resul
t,<span class="insert">z-&gt;level</span>);(zone = it1.next()) &gt;= 0;)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0055" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       <span class="delete">it.value()</span>-&gt;searchAround(core, zone,v,f,result);</td><td> </td><td class="rblock">                       <span class="insert">z</span>-&gt;searchAround(core, zone,v,f,result);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       //qDebug() &lt;&lt; " " &lt;&lt; zone;</td><td> </td><td class="right">                       //qDebug() &lt;&lt; " " &lt;&lt; zone;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               //qDebug() &lt;&lt; endl &lt;&lt; "search border(" &lt;&lt; it-&gt;first &lt;&lt; "):";</td><td> </td><td class="right">               //qDebug() &lt;&lt; endl &lt;&lt; "search border(" &lt;&lt; it-&gt;first &lt;&lt; "):";</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0056" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               for (GeodesicSearchBorderIterator it1(*geodesic_search_resul
t,<span class="delete">it.key()</span>); (zone = it1.next()) &gt;= 0;)</td><td> </td><td class="rblock">               for (GeodesicSearchBorderIterator it1(*geodesic_search_resul
t,<span class="insert">z-&gt;level</span>); (zone = it1.next()) &gt;= 0;)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0057" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       <span class="delete">it.value()</span>-&gt;searchAround(core, zone,v,f,result);</td><td> </td><td class="rblock">                       <span class="insert">z</span>-&gt;searchAround(core, zone,v,f,result);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       //qDebug() &lt;&lt; " " &lt;&lt; zone;</td><td> </td><td class="right">                       //qDebug() &lt;&lt; " " &lt;&lt; zone;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return result;</td><td> </td><td class="right">       return result;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//! Update i18 names from english names according to passed translator.</td><td> </td><td class="right">//! Update i18 names from english names according to passed translator.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//! The translation is done using gettext with translated strings defined i
n translations.h</td><td> </td><td class="right">//! The translation is done using gettext with translated strings defined i
n translations.h</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void StarMgr::updateI18n()</td><td> </td><td class="right">void StarMgr::updateI18n()</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       QRegExp transRx("_[(]\"(.*)\"[)]");</td><td> </td><td class="right">       QRegExp transRx("_[(]\"(.*)\"[)]");</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0058" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">StelTranslator trans = StelApp::getInstance().getLocaleMgr().getSkyT
</span>ranslator();</td><td> </td><td class="rblock">       <span class="insert">const StelTranslator&amp; trans = StelApp::getInstance().getLocaleMgr().
getSkyT</span>ranslator();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       commonNamesMapI18n.clear();</td><td> </td><td class="right">       commonNamesMapI18n.clear();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       commonNamesIndexI18n.clear();</td><td> </td><td class="right">       commonNamesIndexI18n.clear();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       for (QHash&lt;int,QString&gt;::ConstIterator it(commonNamesMap.constBegin(
));it!=commonNamesMap.constEnd();it++)</td><td> </td><td class="right">       for (QHash&lt;int,QString&gt;::ConstIterator it(commonNamesMap.constBegin(
));it!=commonNamesMap.constEnd();it++)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               const int i = it.key();</td><td> </td><td class="right">               const int i = it.key();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               transRx.exactMatch(it.value());</td><td> </td><td class="right">               transRx.exactMatch(it.value());</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               QString tt = transRx.capturedTexts().at(1);</td><td> </td><td class="right">               QString tt = transRx.capturedTexts().at(1);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               const QString t = trans.qtranslate(tt);</td><td> </td><td class="right">               const QString t = trans.qtranslate(tt);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               //const QString t(trans.qtranslate(it.value()));</td><td> </td><td class="right">               //const QString t(trans.qtranslate(it.value()));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               commonNamesMapI18n[i] = t;</td><td> </td><td class="right">               commonNamesMapI18n[i] = t;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l10" /><small>skipping to change at</small><em> line 1285</em></th><th> </th><th><a name="part-r10" /><small>skipping to change at</small><em> line 1257</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               maxNbItem--;</td><td> </td><td class="right">                               maxNbItem--;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       }</td><td> </td><td class="right">                       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       result.sort();</td><td> </td><td class="right">       result.sort();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return result;</td><td> </td><td class="right">       return result;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//! Define font file name and size to use for star names display</td><td> </td><td class="right">//! Define font file name and size to use for star names display</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0059" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">void StarMgr::setFontSize(<span class="delete">double</span> newFontSize)</td><td> </td><td class="rblock">void StarMgr::setFontSize(<span class="insert">float</span> newFontSize)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       starFont.setPixelSize(newFontSize);</td><td> </td><td class="right">       starFont.setPixelSize(newFontSize);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void StarMgr::updateSkyCulture(const QString&amp; skyCultureDir)</td><td> </td><td class="right">void StarMgr::updateSkyCulture(const QString&amp; skyCultureDir)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // Load culture star names in english</td><td> </td><td class="right">       // Load culture star names in english</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0060" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">try</span></td><td> </td><td class="rblock">       <span class="insert">QString fic = StelFileMgr::findFile("skycultures/"</span> + <span class="insert">skyCultureDir</span> +</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       {</span></td><td> </td><td class="rblock"> <span class="insert">"/star_names.fab");</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               loadCommonNames(StelFileMgr::findFile("skycultures/"</span> + <span class="delete">skyCu</span></td><td> </td><td class="rblock"><span class="insert">       if (fic.isEmpty())</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">ltureDir</span> + <span class="delete">"/star_names.fab"));</span></td><td> </td><td class="rblock">               qDebug() &lt;&lt; "Could not load star_names.fab for sky culture "</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       }</span></td><td> </td><td class="rblock"> &lt;&lt; <span class="insert">QDir::toNativeSeparators(skyCultureDir);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       catch(std::runtime_error&amp; e)</span></td><td> </td><td class="rblock"><span class="insert">       else</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       {</span></td><td> </td><td class="rblock"><span class="insert">               loadCommonNames(fic);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               qDebug() &lt;&lt; "Could not load star_names.fab for sky culture "</td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"> &lt;&lt; <span class="delete">QDir::toNativeSeparators(skyCultureDir) &lt;&lt; ": " &lt;&lt; e.what();</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       }</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0061" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">try</span></td><td> </td><td class="rblock">       <span class="insert">fic = StelFileMgr::findFile("stars/default/name.fab");</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       {</span></td><td> </td><td class="rblock"><span class="insert">       if (fic.isEmpty())</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               loadSciNames(StelFileMgr::findFile("stars/default/name.fab")</span></td><td> </td><td class="rblock">               qWarning() &lt;&lt; "WARNING: could not load scientific star names</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">);</span></td><td> </td><td class="rblock"> file: <span class="insert">stars/default/name.fab";</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       }</span></td><td> </td><td class="rblock"><span class="insert">       else</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       catch (std::runtime_error&amp; e)</span></td><td> </td><td class="rblock"><span class="insert">               loadSciNames(fic);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       {</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               qWarning() &lt;&lt; "WARNING: could not load scientific star names</td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"> file: <span class="delete">" &lt;&lt; e.what();</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       }</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0062" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">try</span></td><td> </td><td class="rblock">       <span class="insert">fic = StelFileMgr::findFile("stars/default/gcvs_hip_part.dat");</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       {</span></td><td> </td><td class="rblock"><span class="insert">       if (fic.isEmpty())</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               loadGcvs(StelFileMgr::findFile("stars/default/gcvs_hip_part.</span></td><td> </td><td class="rblock">               qWarning() &lt;&lt; "WARNING: could not load variable stars file: </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">dat"));</span></td><td> </td><td class="rblock"><span class="insert">stars/default/gcvs_hip_part.dat";</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       }</span></td><td> </td><td class="rblock"><span class="insert">       else</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       catch (std::runtime_error&amp; e)</span></td><td> </td><td class="rblock"><span class="insert">               loadGcvs(fic);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       {</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               qWarning() &lt;&lt; "WARNING: could not load variable stars file: </td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">" &lt;&lt; e.what();</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       }</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // Turn on sci names/catalog names for western culture only</td><td> </td><td class="right">       // Turn on sci names/catalog names for western culture only</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       setFlagSciNames(skyCultureDir.startsWith("western"));</td><td> </td><td class="right">       setFlagSciNames(skyCultureDir.startsWith("western"));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       updateI18n();</td><td> </td><td class="right">       updateI18n();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>

     <tr><td></td><td class="left"></td><td> </td><td class="right"></td><td></td></tr>
     <tr bgcolor="gray"><th colspan="5" align="center"><a name="end">&nbsp;End of changes. 62 change blocks.&nbsp;</a></th></tr>
     <tr class="stats"><td></td><th><i>254 lines changed or deleted</i></th><th><i> </i></th><th><i>217 lines changed or added</i></th><td></td></tr>
     <tr><td colspan="5" align="center" class="small"><br/>This html diff was produced by rfcdiff 1.41. The latest version is available from <a href="http://www.tools.ietf.org/tools/rfcdiff/" >http://tools.ietf.org/tools/rfcdiff/</a> </td></tr>
   </table>
   </body>
   </html>
