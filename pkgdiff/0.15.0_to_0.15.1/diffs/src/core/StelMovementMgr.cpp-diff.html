<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
<!-- Generated by rfcdiff 1.41: rfcdiff  --> 
<!-- <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional" > -->
<!-- System: Linux fomalhaut.home 4.4.0-57-generic #78-Ubuntu SMP Fri Dec 9 23:50:32 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux --> 
<!-- Using awk: /usr/bin/gawk: GNU Awk 4.1.3, API: 1.1 (GNU MPFR 3.1.4, GNU MP 6.1.0) --> 
<!-- Using diff: /usr/bin/diff: diff (GNU diffutils) 3.3 --> 
<!-- Using wdiff: /usr/bin/wdiff: wdiff (GNU wdiff) 1.2.2 --> 
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"> 
<head> 
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 
  <meta http-equiv="Content-Style-Type" content="text/css" /> 
  <title>Diff: StelMovementMgr.cpp - StelMovementMgr.cpp</title> 
  <style type="text/css"> 
    body    { font-size:16px; margin: 0.4ex; margin-right: auto; } 
    tr      { } 
    td      { white-space: pre; font-family: Consolas, "DejaVu Sans Mono", "Droid Sans Mono", Monaco, Monospace; vertical-align: top; font-size: 0.86em;} 
    th      { font-size: 0.86em; } 
    .small  { font-size: 0.6em; font-style: italic; font-family: Verdana, Helvetica, sans-serif; } 
    .left   { background-color: #EEE; } 
    .right  { background-color: #FFF; } 
    .diff   { background-color: #CCF; } 
    .lblock { background-color: #BFB; } 
    .rblock { background-color: #FF8; } 
    .insert { background-color: #8FF; } 
    .delete { background-color: #ACF; } 
    .void   { background-color: #FFB; } 
    .cont   { background-color: #EEE; } 
    .linebr { background-color: #AAA; } 
    .lineno { color: red; background-color: #FFF; font-size: 0.7em; text-align: right; padding: 0 2px; } 
    .elipsis{ background-color: #AAA; } 
    .left .cont { background-color: #DDD; } 
    .right .cont { background-color: #EEE; } 
    .lblock .cont { background-color: #9D9; } 
    .rblock .cont { background-color: #DD6; } 
    .insert .cont { background-color: #0DD; } 
    .delete .cont { background-color: #8AD; } 
    .stats, .stats td, .stats th { background-color: #EEE; padding: 2px 0; } 
  </style> 
</head> 
<body > 
  <table border="0" cellpadding="0" cellspacing="0"> 
  <tr bgcolor="orange"><th></th><th>&nbsp;StelMovementMgr.cpp&nbsp;</th><th> </th><th>&nbsp;StelMovementMgr.cpp&nbsp;</th><th></th></tr> 
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l1" /><small>skipping to change at</small><em> line 19</em></th><th> </th><th><a name="part-r1" /><small>skipping to change at</small><em> line 19</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"> * of the License, or (at your option) any later version.</td><td> </td><td class="right"> * of the License, or (at your option) any later version.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"> *</td><td> </td><td class="right"> *</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"> * This program is distributed in the hope that it will be useful,</td><td> </td><td class="right"> * This program is distributed in the hope that it will be useful,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</td><td> </td><td class="right"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</td><td> </td><td class="right"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"> * GNU General Public License for more details.</td><td> </td><td class="right"> * GNU General Public License for more details.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"> *</td><td> </td><td class="right"> *</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"> * You should have received a copy of the GNU General Public License</td><td> </td><td class="right"> * You should have received a copy of the GNU General Public License</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"> * along with this program; if not, write to the Free Software</td><td> </td><td class="right"> * along with this program; if not, write to the Free Software</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"> * Foundation, Inc., 51 Franklin Street, Suite 500, Boston, MA  02110-1335,
 USA.</td><td> </td><td class="right"> * Foundation, Inc., 51 Franklin Street, Suite 500, Boston, MA  02110-1335,
 USA.</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0001" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"> */</td><td> </td><td class="rblock"> <span class="insert">*</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"> * TODO: Rewrite this class. It has been much of the easy feel of Stellariu</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">m, but is terribly complicated to maintain.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"> * Very likely some things can be  made clearer, more efficient, use modern</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"> Qt things instead of manual solutions, etc.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"> * Esp. the up-vector requirements for zenith views cause lots of headache.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"> * In case we want to have other mount modes (ecliptical, galactical, ...),</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"> several parts have to be extended.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">*/</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#include "StelMovementMgr.hpp"</td><td> </td><td class="right">#include "StelMovementMgr.hpp"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#include "StelObjectMgr.hpp"</td><td> </td><td class="right">#include "StelObjectMgr.hpp"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#include "StelModuleMgr.hpp"</td><td> </td><td class="right">#include "StelModuleMgr.hpp"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#include "StelApp.hpp"</td><td> </td><td class="right">#include "StelApp.hpp"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#include "StelCore.hpp"</td><td> </td><td class="right">#include "StelCore.hpp"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#include "StelUtils.hpp"</td><td> </td><td class="right">#include "StelUtils.hpp"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#include "StelTranslator.hpp"</td><td> </td><td class="right">#include "StelTranslator.hpp"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#include &lt;cmath&gt;</td><td> </td><td class="right">#include &lt;cmath&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l2" /><small>skipping to change at</small><em> line 41</em></th><th> </th><th><a name="part-r2" /><small>skipping to change at</small><em> line 46</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#include &lt;QTextStream&gt;</td><td> </td><td class="right">#include &lt;QTextStream&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#include &lt;QSettings&gt;</td><td> </td><td class="right">#include &lt;QSettings&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#include &lt;QKeyEvent&gt;</td><td> </td><td class="right">#include &lt;QKeyEvent&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#include &lt;QDebug&gt;</td><td> </td><td class="right">#include &lt;QDebug&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">StelMovementMgr::StelMovementMgr(StelCore* acore)</td><td> </td><td class="right">StelMovementMgr::StelMovementMgr(StelCore* acore)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       : currentFov(60.)</td><td> </td><td class="right">       : currentFov(60.)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       , initFov(60.)</td><td> </td><td class="right">       , initFov(60.)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       , minFov(0.001389)</td><td> </td><td class="right">       , minFov(0.001389)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       , maxFov(100.)</td><td> </td><td class="right">       , maxFov(100.)</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0002" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       , deltaFov(0.)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       , core(acore)</td><td> </td><td class="right">       , core(acore)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       , objectMgr(NULL)</td><td> </td><td class="right">       , objectMgr(NULL)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       , flagLockEquPos(false)</td><td> </td><td class="right">       , flagLockEquPos(false)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       , flagTracking(false)</td><td> </td><td class="right">       , flagTracking(false)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       , flagInhibitAllAutomoves(false)</td><td> </td><td class="right">       , flagInhibitAllAutomoves(false)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       , isMouseMovingHoriz(false)</td><td> </td><td class="right">       , isMouseMovingHoriz(false)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       , isMouseMovingVert(false)</td><td> </td><td class="right">       , isMouseMovingVert(false)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       , flagEnableMoveAtScreenEdge(false)</td><td> </td><td class="right">       , flagEnableMoveAtScreenEdge(false)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       , flagEnableMouseNavigation(true)</td><td> </td><td class="right">       , flagEnableMouseNavigation(true)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       , mouseZoomSpeed(30)</td><td> </td><td class="right">       , mouseZoomSpeed(30)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       , flagEnableZoomKeys(true)</td><td> </td><td class="right">       , flagEnableZoomKeys(true)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       , flagEnableMoveKeys(true)</td><td> </td><td class="right">       , flagEnableMoveKeys(true)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       , keyMoveSpeed(0.00025)</td><td> </td><td class="right">       , keyMoveSpeed(0.00025)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       , keyZoomSpeed(0.00025)</td><td> </td><td class="right">       , keyZoomSpeed(0.00025)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       , flagMoveSlow(false)</td><td> </td><td class="right">       , flagMoveSlow(false)</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0003" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       , <span class="delete">movementsSpeedFactor(1.5)</span></td><td> </td><td class="rblock">       , <span class="insert">movementsSpeedFactor(1.0)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       , move()</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       , flagAutoMove(false)</td><td> </td><td class="right">       , flagAutoMove(false)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       , zoomingMode(ZoomNone)</td><td> </td><td class="right">       , zoomingMode(ZoomNone)</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0004" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       , deltaFov(0.)</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       , deltaAlt(0.)</td><td> </td><td class="right">       , deltaAlt(0.)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       , deltaAz(0.)</td><td> </td><td class="right">       , deltaAz(0.)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       , flagManualZoom(false)</td><td> </td><td class="right">       , flagManualZoom(false)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       , autoMoveDuration(1.5)</td><td> </td><td class="right">       , autoMoveDuration(1.5)</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0005" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       , isDragging(false)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       , hasDragged(false)</td><td> </td><td class="right">       , hasDragged(false)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       , previousX(0)</td><td> </td><td class="right">       , previousX(0)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       , previousY(0)</td><td> </td><td class="right">       , previousY(0)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       , beforeTimeDragTimeRate(0.)</td><td> </td><td class="right">       , beforeTimeDragTimeRate(0.)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       , dragTimeMode(false)</td><td> </td><td class="right">       , dragTimeMode(false)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       , zoomMove()</td><td> </td><td class="right">       , zoomMove()</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0006" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       , <span class="delete">flagAutoZoom(0)</span></td><td> </td><td class="rblock">       , <span class="insert">flagAutoZoom(false)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       , <span class="delete">flagAutoZoomOutResetsDirection(0)</span></td><td> </td><td class="rblock">       , <span class="insert">flagAutoZoomOutResetsDirection(false)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       , mountMode(MountAltAzimuthal)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       , initViewPos(1., 0., 0.)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       , initViewUp(0., 0., 1.)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       , viewDirectionJ2000(0., 1., 0.)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       , viewDirectionMountFrame(0., 1., 0.)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       , upVectorMountFrame(0.,0.,1.)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       , dragTriggerDistance(4.f)</td><td> </td><td class="right">       , dragTriggerDistance(4.f)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       , viewportOffsetTimeline(NULL)</td><td> </td><td class="right">       , viewportOffsetTimeline(NULL)</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0007" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       <span class="insert">, oldViewportOffset(0.0f, 0.0f)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       , targetViewportOffset(0.0f, 0.0f)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       setObjectName("StelMovementMgr");</td><td> </td><td class="right">       setObjectName("StelMovementMgr");</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0008" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">isDragging = false;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       mountMode = MountAltAzimuthal;  // default</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       upVectorMountFrame.set(0.,0.,1.);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">StelMovementMgr::~StelMovementMgr()</td><td> </td><td class="right">StelMovementMgr::~StelMovementMgr()</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0009" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       if (viewportOffsetTimeline) delete viewportOffsetTimeline; <span class="delete">viewportO</span></td><td> </td><td class="rblock">       if (viewportOffsetTimeline)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">ffsetTimeline=NULL;</span></td><td> </td><td class="rblock">       <span class="insert">{</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">               delete viewportOffsetTimeline;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">               <span class="insert">viewportOffsetTimeline=NULL;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void StelMovementMgr::init()</td><td> </td><td class="right">void StelMovementMgr::init()</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       QSettings* conf = StelApp::getInstance().getSettings();</td><td> </td><td class="right">       QSettings* conf = StelApp::getInstance().getSettings();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       objectMgr = GETSTELMODULE(StelObjectMgr);</td><td> </td><td class="right">       objectMgr = GETSTELMODULE(StelObjectMgr);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       Q_ASSERT(conf);</td><td> </td><td class="right">       Q_ASSERT(conf);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       Q_ASSERT(objectMgr);</td><td> </td><td class="right">       Q_ASSERT(objectMgr);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       connect(objectMgr, SIGNAL(selectedObjectChanged(StelModule::StelModu
leSelectAction)),</td><td> </td><td class="right">       connect(objectMgr, SIGNAL(selectedObjectChanged(StelModule::StelModu
leSelectAction)),</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0010" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               <span class="delete">        this, SLOT(selectedObjectChange(StelModule::StelModu
leSelect</span>Action)));</td><td> </td><td class="rblock">               <span class="insert">this, SLOT(selectedObjectChange(StelModule::StelModuleSelect
</span>Action)));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0011" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       movementsSpeedFactor=1.;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       flagEnableMoveAtScreenEdge = conf-&gt;value("navigation/flag_enable_mov
e_at_screen_edge",false).toBool();</td><td> </td><td class="right">       flagEnableMoveAtScreenEdge = conf-&gt;value("navigation/flag_enable_mov
e_at_screen_edge",false).toBool();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       mouseZoomSpeed = conf-&gt;value("navigation/mouse_zoom",30).toInt();</td><td> </td><td class="right">       mouseZoomSpeed = conf-&gt;value("navigation/mouse_zoom",30).toInt();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       flagEnableZoomKeys = conf-&gt;value("navigation/flag_enable_zoom_keys")
.toBool();</td><td> </td><td class="right">       flagEnableZoomKeys = conf-&gt;value("navigation/flag_enable_zoom_keys")
.toBool();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       flagEnableMoveKeys = conf-&gt;value("navigation/flag_enable_move_keys")
.toBool();</td><td> </td><td class="right">       flagEnableMoveKeys = conf-&gt;value("navigation/flag_enable_move_keys")
.toBool();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       keyMoveSpeed = conf-&gt;value("navigation/move_speed",0.0004f).toFloat(
);</td><td> </td><td class="right">       keyMoveSpeed = conf-&gt;value("navigation/move_speed",0.0004f).toFloat(
);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       keyZoomSpeed = conf-&gt;value("navigation/zoom_speed", 0.0004f).toFloat
();</td><td> </td><td class="right">       keyZoomSpeed = conf-&gt;value("navigation/zoom_speed", 0.0004f).toFloat
();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       autoMoveDuration = conf-&gt;value ("navigation/auto_move_duration",1.5f
).toFloat();</td><td> </td><td class="right">       autoMoveDuration = conf-&gt;value ("navigation/auto_move_duration",1.5f
).toFloat();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       flagManualZoom = conf-&gt;value("navigation/flag_manual_zoom").toBool()
;</td><td> </td><td class="right">       flagManualZoom = conf-&gt;value("navigation/flag_manual_zoom").toBool()
;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       flagAutoZoomOutResetsDirection = conf-&gt;value("navigation/auto_zoom_o
ut_resets_direction", true).toBool();</td><td> </td><td class="right">       flagAutoZoomOutResetsDirection = conf-&gt;value("navigation/auto_zoom_o
ut_resets_direction", true).toBool();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       flagEnableMouseNavigation = conf-&gt;value("navigation/flag_enable_mous
e_navigation",true).toBool();</td><td> </td><td class="right">       flagEnableMouseNavigation = conf-&gt;value("navigation/flag_enable_mous
e_navigation",true).toBool();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       minFov = conf-&gt;value("navigation/min_fov",0.001389).toDouble(); // d
efault: minimal FOV = 5"</td><td> </td><td class="right">       minFov = conf-&gt;value("navigation/min_fov",0.001389).toDouble(); // d
efault: minimal FOV = 5"</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0012" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       maxFov = 100.;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       initFov = conf-&gt;value("navigation/init_fov",60.f).toFloat();</td><td> </td><td class="right">       initFov = conf-&gt;value("navigation/init_fov",60.f).toFloat();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       currentFov = initFov;</td><td> </td><td class="right">       currentFov = initFov;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0013" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       <span class="insert">// we must set mount mode before potentially loading zenith views et</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">c.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       QString tmpstr = conf-&gt;value("navigation/viewing_mode", "horizon").t</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">oString();</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       if (tmpstr=="equator")</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               setMountMode(StelMovementMgr::MountEquinoxEquatorial);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       else</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       {</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               if (tmpstr=="horizon")</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       setMountMode(StelMovementMgr::MountAltAzimuthal);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               else</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               {</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       qWarning() &lt;&lt; "ERROR: Unknown viewing mode type: " &lt;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">&lt; tmpstr;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       setMountMode(StelMovementMgr::MountEquinoxEquatorial</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                           </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // With a special code of init_view_position=x/y/1 (or actually, any
thing equal or larger to 1) you can set zenith into the center and atan2(x/
y) to bottom of screen.</td><td> </td><td class="right">       // With a special code of init_view_position=x/y/1 (or actually, any
thing equal or larger to 1) you can set zenith into the center and atan2(x/
y) to bottom of screen.</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0014" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       // examples: <span class="delete">1/0-&gt;0</span>         NORTH is bottom</td><td> </td><td class="rblock">       // examples:  <span class="insert">1/0   -&gt;0</span>     NORTH is bottom</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       //           -1/0 -&gt;180     SOUTH is bottom</td><td> </td><td class="rblock">       //           -1/0   -&gt;180   SOUTH is bottom</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       //            0/-1 <span class="delete">--&gt;</span> 90   EAST is bottom</td><td> </td><td class="rblock">       //            0/-1  <span class="insert">-&gt;</span> 90   EAST is bottom</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       //            0/1  -&gt;270    WEST is bottom</td><td> </td><td class="rblock">       //            0/1   -&gt;270   WEST is bottom</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       Vec3f tmp = StelUtils::strToVec3f(conf-&gt;value("navigation/init_view_</td><td> </td><td class="rblock">       Vec3f tmp = StelUtils::strToVec3f(conf-&gt;value("navigation/init_view_</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">pos").toString());</span></td><td> </td><td class="rblock"><span class="insert">pos", "1,0,0").toString());</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       //qDebug() &lt;&lt; "initViewPos" &lt;&lt; tmp[0] &lt;&lt; "/" &lt;&lt; tmp[1] &lt;&lt; "/" &lt;&lt; tmp</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">[2];</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (tmp[2]&gt;=1)</td><td> </td><td class="right">       if (tmp[2]&gt;=1)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               //qDebug() &lt;&lt; "Special zenith setup:";</td><td> </td><td class="right">               //qDebug() &lt;&lt; "Special zenith setup:";</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               setViewDirectionJ2000(mountFrameToJ2000(Vec3d(0., 0., 1.)));</td><td> </td><td class="right">               setViewDirectionJ2000(mountFrameToJ2000(Vec3d(0., 0., 1.)));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               initViewPos.set(0., 0., 1.);</td><td> </td><td class="right">               initViewPos.set(0., 0., 1.);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               // It is not good to code 0/0/1 as view vector: bottom azimu
th is undefined. Use default-south:</td><td> </td><td class="right">               // It is not good to code 0/0/1 as view vector: bottom azimu
th is undefined. Use default-south:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               if ((tmp[0]==0.) &amp;&amp; (tmp[1]==0.))</td><td> </td><td class="right">               if ((tmp[0]==0.) &amp;&amp; (tmp[1]==0.))</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       tmp[0]=-1.;</td><td> </td><td class="right">                       tmp[0]=-1.;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               upVectorMountFrame.set(tmp[0], tmp[1], 0.);</td><td> </td><td class="right">               upVectorMountFrame.set(tmp[0], tmp[1], 0.);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               upVectorMountFrame.normalize();</td><td> </td><td class="right">               upVectorMountFrame.normalize();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               initViewUp=upVectorMountFrame;</td><td> </td><td class="right">               initViewUp=upVectorMountFrame;</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0015" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               //qDebug() &lt;&lt; "InitViewUp: " &lt;&lt; initViewUp;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       else</td><td> </td><td class="right">       else</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0016" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">               <span class="insert">//qDebug() &lt;&lt; "simpler view vectors...";</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               //qDebug() &lt;&lt; "   initViewPos becomes " &lt;&lt; tmp[0] &lt;&lt; "/" &lt;&lt; </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">tmp[1] &lt;&lt; "/" &lt;&lt; tmp[2];</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               initViewPos.set(tmp[0], tmp[1], tmp[2]);</td><td> </td><td class="right">               initViewPos.set(tmp[0], tmp[1], tmp[2]);</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0017" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               <span class="delete">initViewUp.set(0., 0., 1.)</span>;</td><td> </td><td class="rblock">               <span class="insert">//qDebug() &lt;&lt; "   initViewPos is " &lt;&lt; initViewPos[0] &lt;&lt; "/" 
&lt;&lt; initViewPos[1] &lt;&lt; "/" &lt;&lt; initViewPos[2]</span>;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               viewDirectionJ2000 = core-&gt;altAzToJ2000(initViewPos, StelCor
e::RefractionOff);</td><td> </td><td class="right">               viewDirectionJ2000 = core-&gt;altAzToJ2000(initViewPos, StelCor
e::RefractionOff);</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0018" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">}</span></td><td> </td><td class="rblock">               <span class="insert">//qDebug() &lt;&lt; "viewDirectionJ2000: " &lt;&lt; viewDirectionJ2000[0</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">] &lt;&lt; "/" &lt;&lt; viewDirectionJ2000[1] &lt;&lt; "/" &lt;&lt; viewDirectionJ2000[2];</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               setViewDirectionJ2000(viewDirectionJ2000);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               //qDebug() &lt;&lt; "   up2000 initViewUp becomes " &lt;&lt; initViewUp[</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">0] &lt;&lt; "/" &lt;&lt; initViewUp[1] &lt;&lt; "/" &lt;&lt; initViewUp[2];</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               setViewUpVector(initViewUp);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0019" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">QString tmpstr = conf-&gt;value("navigation/viewing_mode", "horizon").t</span></td><td> </td><td class="rblock">               <span class="insert">//qDebug() &lt;&lt; "   upVectorMountFrame becomes</span> " <span class="insert">&lt;&lt; upVectorMo</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">oString();</span></td><td> </td><td class="rblock"><span class="insert">untFrame[0] &lt;&lt; "/" &lt;&lt; upVectorMountFrame[1] &lt;&lt; "/" &lt;&lt; upVectorMountFrame[2]</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       if (tmpstr=="equator")</span></td><td> </td><td class="rblock"><span class="insert">;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               setMountMode(StelMovementMgr::MountEquinoxEquatorial);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       else</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       {</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               if (tmpstr=="horizon")</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                       setMountMode(StelMovementMgr::MountAltAzimuthal);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               else</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               {</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                       qWarning() &lt;&lt; "ERROR: Unknown viewing mode type:</span> " <span class="delete">&lt;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">&lt; tmpstr;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                       setMountMode(StelMovementMgr::MountEquinoxEquatorial</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               }</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       QString movementGroup = N_("Movement and Selection");</td><td> </td><td class="right">       QString movementGroup = N_("Movement and Selection");</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       addAction("actionSwitch_Equatorial_Mount", N_("Miscellaneous"), N_("
Switch between equatorial and azimuthal mount"), "equatorialMount", "Ctrl+M
");</td><td> </td><td class="right">       addAction("actionSwitch_Equatorial_Mount", N_("Miscellaneous"), N_("
Switch between equatorial and azimuthal mount"), "equatorialMount", "Ctrl+M
");</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       addAction("actionGoto_Selected_Object", movementGroup, N_("Center on
 selected object"), "setFlagTracking()", "Space");</td><td> </td><td class="right">       addAction("actionGoto_Selected_Object", movementGroup, N_("Center on
 selected object"), "setFlagTracking()", "Space");</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       addAction("actionZoom_In_Auto", movementGroup, N_("Zoom in on select
ed object"), "autoZoomIn()", "/");</td><td> </td><td class="right">       addAction("actionZoom_In_Auto", movementGroup, N_("Zoom in on select
ed object"), "autoZoomIn()", "/");</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       addAction("actionZoom_Out_Auto", movementGroup, N_("Zoom out"), "aut
oZoomOut()", "\\");</td><td> </td><td class="right">       addAction("actionZoom_Out_Auto", movementGroup, N_("Zoom out"), "aut
oZoomOut()", "\\");</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       addAction("actionSet_Tracking", movementGroup, N_("Track object"), "
tracking", "T");</td><td> </td><td class="right">       addAction("actionSet_Tracking", movementGroup, N_("Track object"), "
tracking", "T");</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // Implementation of quick turning to different directions (examples
: CdC, HNSKY)</td><td> </td><td class="right">       // Implementation of quick turning to different directions (examples
: CdC, HNSKY)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       addAction("actionLook_Towards_East", movementGroup, N_("Look towards
 East"), "lookEast()", "Shift+E");</td><td> </td><td class="right">       addAction("actionLook_Towards_East", movementGroup, N_("Look towards
 East"), "lookEast()", "Shift+E");</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       addAction("actionLook_Towards_West", movementGroup, N_("Look towards
 West"), "lookWest()", "Shift+W");</td><td> </td><td class="right">       addAction("actionLook_Towards_West", movementGroup, N_("Look towards
 West"), "lookWest()", "Shift+W");</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       addAction("actionLook_Towards_North", movementGroup, N_("Look toward
s North"), "lookNorth()", "Shift+N");</td><td> </td><td class="right">       addAction("actionLook_Towards_North", movementGroup, N_("Look toward
s North"), "lookNorth()", "Shift+N");</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       addAction("actionLook_Towards_South", movementGroup, N_("Look toward
s South"), "lookSouth()", "Shift+S");</td><td> </td><td class="right">       addAction("actionLook_Towards_South", movementGroup, N_("Look toward
s South"), "lookSouth()", "Shift+S");</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       addAction("actionLook_Towards_Zenith", movementGroup, N_("Look towar
ds Zenith"), "lookZenith()", "Shift+Z");</td><td> </td><td class="right">       addAction("actionLook_Towards_Zenith", movementGroup, N_("Look towar
ds Zenith"), "lookZenith()", "Shift+Z");</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0020" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       <span class="insert">// Additional hooks</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       addAction("actionLook_Towards_NCP", movementGroup, N_("Look towards </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">North Celestial pole"), "lookTowardsNCP()", "Alt+Shift+N");</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       addAction("actionLook_Towards_SCP", movementGroup, N_("Look towards </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">South Celestial pole"), "lookTowardsSCP()", "Alt+Shift+S");</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       viewportOffsetTimeline=new QTimeLine(1000, this);</td><td> </td><td class="right">       viewportOffsetTimeline=new QTimeLine(1000, this);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       viewportOffsetTimeline-&gt;setFrameRange(0, 100);</td><td> </td><td class="right">       viewportOffsetTimeline-&gt;setFrameRange(0, 100);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       connect(viewportOffsetTimeline, SIGNAL(valueChanged(qreal)), this, S
LOT(handleViewportOffsetMovement(qreal)));</td><td> </td><td class="right">       connect(viewportOffsetTimeline, SIGNAL(valueChanged(qreal)), this, S
LOT(handleViewportOffsetMovement(qreal)));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       targetViewportOffset.set(core-&gt;getViewportHorizontalOffset(), core-&gt;
getViewportVerticalOffset());</td><td> </td><td class="right">       targetViewportOffset.set(core-&gt;getViewportHorizontalOffset(), core-&gt;
getViewportVerticalOffset());</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void StelMovementMgr::setMountMode(MountMode m)</td><td> </td><td class="right">void StelMovementMgr::setMountMode(MountMode m)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       mountMode = m;</td><td> </td><td class="right">       mountMode = m;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l3" /><small>skipping to change at</small><em> line 189</em></th><th> </th><th><a name="part-r3" /><small>skipping to change at</small><em> line 217</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       emit equatorialMountChanged(m==MountEquinoxEquatorial);</td><td> </td><td class="right">       emit equatorialMountChanged(m==MountEquinoxEquatorial);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void StelMovementMgr::setFlagLockEquPos(bool b)</td><td> </td><td class="right">void StelMovementMgr::setFlagLockEquPos(bool b)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       flagLockEquPos=b;</td><td> </td><td class="right">       flagLockEquPos=b;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void StelMovementMgr::setViewUpVectorJ2000(const Vec3d&amp; up)</td><td> </td><td class="right">void StelMovementMgr::setViewUpVectorJ2000(const Vec3d&amp; up)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0021" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       //qDebug() &lt;&lt; "setViewUpvectorJ2000()";</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       upVectorMountFrame = j2000ToMountFrame(up);</td><td> </td><td class="right">       upVectorMountFrame = j2000ToMountFrame(up);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// For simplicity you can set this directly. Take care when looking into po
les like zenith in altaz mode:</td><td> </td><td class="right">// For simplicity you can set this directly. Take care when looking into po
les like zenith in altaz mode:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// We have a problem if alt=+/-90degrees: view and up angles are ill-define
d (actually, angle between them=0 and therefore we saw shaky rounding effec
ts), therefore Bug LP:1068529</td><td> </td><td class="right">// We have a problem if alt=+/-90degrees: view and up angles are ill-define
d (actually, angle between them=0 and therefore we saw shaky rounding effec
ts), therefore Bug LP:1068529</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void StelMovementMgr::setViewUpVector(const Vec3d&amp; up)</td><td> </td><td class="right">void StelMovementMgr::setViewUpVector(const Vec3d&amp; up)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0022" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       //qDebug() &lt;&lt; "setViewUpvector()";</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       upVectorMountFrame = up;</td><td> </td><td class="right">       upVectorMountFrame = up;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">Vec3d StelMovementMgr::getViewUpVectorJ2000() const</td><td> </td><td class="right">Vec3d StelMovementMgr::getViewUpVectorJ2000() const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return mountFrameToJ2000(upVectorMountFrame);</td><td> </td><td class="right">       return mountFrameToJ2000(upVectorMountFrame);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">bool StelMovementMgr::handleMouseMoves(int x, int y, Qt::MouseButtons)</td><td> </td><td class="right">bool StelMovementMgr::handleMouseMoves(int x, int y, Qt::MouseButtons)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // Turn if the mouse is at the edge of the screen unless config asks
 otherwise</td><td> </td><td class="right">       // Turn if the mouse is at the edge of the screen unless config asks
 otherwise</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (flagEnableMoveAtScreenEdge)</td><td> </td><td class="right">       if (flagEnableMoveAtScreenEdge)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               if (x &lt;= 1)</td><td> </td><td class="right">               if (x &lt;= 1)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0023" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       turnLeft(<span class="delete">1</span>);</td><td> </td><td class="rblock">                       turnLeft(<span class="insert">true</span>);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       isMouseMovingHoriz = true;</td><td> </td><td class="right">                       isMouseMovingHoriz = true;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               else if (x &gt;= core-&gt;getProjection2d()-&gt;getViewportWidth() - 
2)</td><td> </td><td class="right">               else if (x &gt;= core-&gt;getProjection2d()-&gt;getViewportWidth() - 
2)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0024" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       turnRight(<span class="delete">1</span>);</td><td> </td><td class="rblock">                       turnRight(<span class="insert">true</span>);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       isMouseMovingHoriz = true;</td><td> </td><td class="right">                       isMouseMovingHoriz = true;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               else if (isMouseMovingHoriz)</td><td> </td><td class="right">               else if (isMouseMovingHoriz)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0025" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       turnLeft(<span class="delete">0</span>);</td><td> </td><td class="rblock">                       turnLeft(<span class="insert">false</span>);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       isMouseMovingHoriz = false;</td><td> </td><td class="right">                       isMouseMovingHoriz = false;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               if (y &lt;= 1)</td><td> </td><td class="right">               if (y &lt;= 1)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0026" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       turnUp(<span class="delete">1</span>);</td><td> </td><td class="rblock">                       turnUp(<span class="insert">true</span>);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       isMouseMovingVert = true;</td><td> </td><td class="right">                       isMouseMovingVert = true;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               else if (y &gt;= core-&gt;getProjection2d()-&gt;getViewportHeight() -
 2)</td><td> </td><td class="right">               else if (y &gt;= core-&gt;getProjection2d()-&gt;getViewportHeight() -
 2)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0027" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       turnDown(<span class="delete">1</span>);</td><td> </td><td class="rblock">                       turnDown(<span class="insert">true</span>);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       isMouseMovingVert = true;</td><td> </td><td class="right">                       isMouseMovingVert = true;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               else if (isMouseMovingVert)</td><td> </td><td class="right">               else if (isMouseMovingVert)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0028" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       turnUp(<span class="delete">0</span>);</td><td> </td><td class="rblock">                       turnUp(<span class="insert">false</span>);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       isMouseMovingVert = false;</td><td> </td><td class="right">                       isMouseMovingVert = false;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0029" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">// We can hardly use the mouse exactly enough to go to the zenith/po</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">le. Any mouse motion can safely reset the simplified up vector.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       setViewUpVector(Vec3d(0., 0., 1.));</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                           </td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (isDragging &amp;&amp; flagEnableMouseNavigation)</td><td> </td><td class="right">       if (isDragging &amp;&amp; flagEnableMouseNavigation)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               if (hasDragged || (std::sqrt((float)((x-previousX)*(x-previo
usX) +(y-previousY)*(y-previousY)))&gt;dragTriggerDistance))</td><td> </td><td class="right">               if (hasDragged || (std::sqrt((float)((x-previousX)*(x-previo
usX) +(y-previousY)*(y-previousY)))&gt;dragTriggerDistance))</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       hasDragged = true;</td><td> </td><td class="right">                       hasDragged = true;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       setFlagTracking(false);</td><td> </td><td class="right">                       setFlagTracking(false);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       dragView(previousX, previousY, x, y);</td><td> </td><td class="right">                       dragView(previousX, previousY, x, y);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       previousX = x;</td><td> </td><td class="right">                       previousX = x;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       previousY = y;</td><td> </td><td class="right">                       previousY = y;</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0030" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                       <span class="insert">// We can hardly use the mouse exactly enough to go </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">to the zenith/pole. Any mouse motion can safely reset the simplified up vec</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">tor.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       //qDebug() &lt;&lt; "handleMouseMoves: resetting Up vector</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">.";</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       setViewUpVector(Vec3d(0., 0., 1.));</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       return true;</td><td> </td><td class="right">                       return true;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return false;</td><td> </td><td class="right">       return false;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">double StelMovementMgr::getCallOrder(StelModuleActionName actionName) const</td><td> </td><td class="right">double StelMovementMgr::getCallOrder(StelModuleActionName actionName) const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0031" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       // <span class="delete">GZ: allow a few plugins to intercept keys</span>!</td><td> </td><td class="rblock">       // <span class="insert">allow plugins to intercept keys by using a lower number than this
</span>!</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (actionName == StelModule::ActionHandleKeys)</td><td> </td><td class="right">       if (actionName == StelModule::ActionHandleKeys)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               return 5;</td><td> </td><td class="right">               return 5;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return 0;</td><td> </td><td class="right">       return 0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void StelMovementMgr::handleKeys(QKeyEvent* event)</td><td> </td><td class="right">void StelMovementMgr::handleKeys(QKeyEvent* event)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">        if (event-&gt;type() == QEvent::KeyPress)</td><td> </td><td class="right">        if (event-&gt;type() == QEvent::KeyPress)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               // Direction and zoom deplacements</td><td> </td><td class="right">               // Direction and zoom deplacements</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l4" /><small>skipping to change at</small><em> line 299</em></th><th> </th><th><a name="part-r4" /><small>skipping to change at</small><em> line 329</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               } else {</td><td> </td><td class="right">                               } else {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       turnDown(true);</td><td> </td><td class="right">                                       turnDown(true);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               }</td><td> </td><td class="right">                               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               break;</td><td> </td><td class="right">                               break;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       case Qt::Key_PageUp:</td><td> </td><td class="right">                       case Qt::Key_PageUp:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               zoomIn(true); break;</td><td> </td><td class="right">                               zoomIn(true); break;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       case Qt::Key_PageDown:</td><td> </td><td class="right">                       case Qt::Key_PageDown:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               zoomOut(true); break;</td><td> </td><td class="right">                               zoomOut(true); break;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       case Qt::Key_Shift:</td><td> </td><td class="right">                       case Qt::Key_Shift:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               moveSlow(true); break;</td><td> </td><td class="right">                               moveSlow(true); break;</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0032" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       <span class="delete">case Qt::Key_Space:</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                               if (event-&gt;modifiers().testFlag(Qt::ControlM</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">odifier))</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                                       setDragTimeMode(true);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                               break;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       default:</td><td> </td><td class="right">                       default:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               return;</td><td> </td><td class="right">                               return;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       else</td><td> </td><td class="right">       else</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               // When a deplacement key is released stop moving</td><td> </td><td class="right">               // When a deplacement key is released stop moving</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               switch (event-&gt;key())</td><td> </td><td class="right">               switch (event-&gt;key())</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       case Qt::Key_Left:</td><td> </td><td class="right">                       case Qt::Key_Left:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l5" /><small>skipping to change at</small><em> line 339</em></th><th> </th><th><a name="part-r5" /><small>skipping to change at</small><em> line 365</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               moveSlow(false); break;</td><td> </td><td class="right">                               moveSlow(false); break;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       case Qt::Key_Control:</td><td> </td><td class="right">                       case Qt::Key_Control:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               // This can be all that is seen for anything
 with control, so stop them all.</td><td> </td><td class="right">                               // This can be all that is seen for anything
 with control, so stop them all.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               // This is true for 4.8.1</td><td> </td><td class="right">                               // This is true for 4.8.1</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               turnRight(false);</td><td> </td><td class="right">                               turnRight(false);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               turnLeft(false);</td><td> </td><td class="right">                               turnLeft(false);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               zoomIn(false);</td><td> </td><td class="right">                               zoomIn(false);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               zoomOut(false);</td><td> </td><td class="right">                               zoomOut(false);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               turnDown(false);</td><td> </td><td class="right">                               turnDown(false);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               turnUp(false);</td><td> </td><td class="right">                               turnUp(false);</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0033" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                               <span class="delete">setDragTimeMode(false)</span>;</td><td> </td><td class="rblock">                               <span class="insert">dragTimeMode=false</span>;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               break;</td><td> </td><td class="right">                               break;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       default:</td><td> </td><td class="right">                       default:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               return;</td><td> </td><td class="right">                               return;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       event-&gt;accept();</td><td> </td><td class="right">       event-&gt;accept();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//! Handle mouse wheel events.</td><td> </td><td class="right">//! Handle mouse wheel events.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void StelMovementMgr::handleMouseWheel(QWheelEvent* event)</td><td> </td><td class="right">void StelMovementMgr::handleMouseWheel(QWheelEvent* event)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (flagEnableMouseNavigation==false)</td><td> </td><td class="right">       if (flagEnableMouseNavigation==false)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               return;</td><td> </td><td class="right">               return;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0034" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       // <span class="delete">Manage</span> only vertical wheel <span class="delete">event</span></td><td> </td><td class="rblock">       // <span class="insert">This managed</span> only vertical wheel <span class="insert">events.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       if (event-&gt;orientation() != Qt::Vertical)</span></td><td> </td><td class="rblock"><span class="insert">       // However, Alt-wheel switches this to horizontal, so allow alt-whee</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               return;</span></td><td> </td><td class="rblock"><span class="insert">l and handle angles properly!</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                           </td><td> </td><td class="rblock">       const float numSteps = <span class="insert">(event-&gt;angleDelta().x() + event-&gt;angleDelta(</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       const float numSteps = <span class="delete">event-&gt;delta()</span> / 120.f;</td><td> </td><td class="rblock"><span class="insert">).y())</span> / 120.f;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       const float zoomFactor = std::exp(-mouseZoomSpeed * numSteps / <span class="delete">60.f)</span></td><td> </td><td class="rblock">                                                                           </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">;</span></td><td> </td><td class="rblock">       <span class="insert">if (event-&gt;modifiers() &amp; Qt::ControlModifier)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       const float zoomDuration = 0.2f * qAbs(numSteps);</td><td> </td><td class="rblock"><span class="insert">       {</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       zoomTo(getAimFov() * zoomFactor, zoomDuration);</td><td> </td><td class="rblock"><span class="insert">               if ((event-&gt;modifiers() &amp; Qt::AltModifier) &amp;&amp; (event-&gt;modifi</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                           </td><td> </td><td class="rblock"><span class="insert">ers() &amp; Qt::ShiftModifier))</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               {</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       // move time by years</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       double jdNow=core-&gt;getJD();</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       int year, month, day, hour, min, sec, millis;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       StelUtils::getDateFromJulianDay(jdNow, &amp;year, &amp;month</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">, &amp;day);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       StelUtils::getTimeFromJulianDay(jdNow, &amp;hour, &amp;min, </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">&amp;sec, &amp;millis);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       double jdNew;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       StelUtils::getJDFromDate(&amp;jdNew, year+floor(numSteps</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">), month, day, hour, min, sec);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       core-&gt;setJD(jdNew);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       emit core-&gt;dateChanged();</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               else if (event-&gt;modifiers() &amp; Qt::AltModifier)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               {</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       // move time by days</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       core-&gt;setJD(core-&gt;getJD()+floor(numSteps));</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       emit core-&gt;dateChanged();</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               else if (event-&gt;modifiers() &amp; Qt::ShiftModifier)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               {</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       // move time by hours</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       core-&gt;setJD(core-&gt;getJD()+floor(numSteps)/(24.f));</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               else</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               {</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       // move time by minutes</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       core-&gt;setJD(core-&gt;getJD()+floor(numSteps)/(24.f*60.f</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">));</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       else</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       {</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">               const float zoomFactor = std::exp(-mouseZoomSpeed * numSteps</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"> / <span class="insert">60.f);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">               const float zoomDuration = 0.2f * qAbs(numSteps);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">               zoomTo(getAimFov() * zoomFactor, zoomDuration);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       <span class="insert">}</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       event-&gt;accept();</td><td> </td><td class="right">       event-&gt;accept();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void StelMovementMgr::addTimeDragPoint(int x, int y)</td><td> </td><td class="right">void StelMovementMgr::addTimeDragPoint(int x, int y)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       DragHistoryEntry e;</td><td> </td><td class="right">       DragHistoryEntry e;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       e.runTime=StelApp::getInstance().getTotalRunTime();</td><td> </td><td class="right">       e.runTime=StelApp::getInstance().getTotalRunTime();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       e.jd=core-&gt;getJD();</td><td> </td><td class="right">       e.jd=core-&gt;getJD();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       e.x=x;</td><td> </td><td class="right">       e.x=x;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       e.y=y;</td><td> </td><td class="right">       e.y=y;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l6" /><small>skipping to change at</small><em> line 403</em></th><th> </th><th><a name="part-r6" /><small>skipping to change at</small><em> line 461</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void StelMovementMgr::handleMouseClicks(QMouseEvent* event)</td><td> </td><td class="right">void StelMovementMgr::handleMouseClicks(QMouseEvent* event)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       switch (event-&gt;button())</td><td> </td><td class="right">       switch (event-&gt;button())</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               case Qt::RightButton:</td><td> </td><td class="right">               case Qt::RightButton:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       if (event-&gt;type()==QEvent::MouseButtonRelease)</td><td> </td><td class="right">                       if (event-&gt;type()==QEvent::MouseButtonRelease)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       {</td><td> </td><td class="right">                       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               // Deselect the selected object</td><td> </td><td class="right">                               // Deselect the selected object</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               StelApp::getInstance().getStelObjectMgr().un
Select();</td><td> </td><td class="right">                               StelApp::getInstance().getStelObjectMgr().un
Select();</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0035" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                               setFlagLockEquPos(false);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               event-&gt;accept();</td><td> </td><td class="right">                               event-&gt;accept();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               return;</td><td> </td><td class="right">                               return;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       }</td><td> </td><td class="right">                       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       break;</td><td> </td><td class="right">                       break;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               case Qt::LeftButton :</td><td> </td><td class="right">               case Qt::LeftButton :</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       if (event-&gt;type()==QEvent::MouseButtonPress)</td><td> </td><td class="right">                       if (event-&gt;type()==QEvent::MouseButtonPress)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       {</td><td> </td><td class="right">                       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0036" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                               <span class="insert">if (event-&gt;modifiers() &amp; Qt::ControlModifier</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                               {</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                                       dragTimeMode=true;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                                       beforeTimeDragTimeRate=core-&gt;getTime</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">Rate();</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                                       timeDragHistory.clear();</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                                       addTimeDragPoint(event-&gt;x(), event-&gt;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">y());</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                               }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               isDragging = true;</td><td> </td><td class="right">                               isDragging = true;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               hasDragged = false;</td><td> </td><td class="right">                               hasDragged = false;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               previousX = event-&gt;x();</td><td> </td><td class="right">                               previousX = event-&gt;x();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               previousY = event-&gt;y();</td><td> </td><td class="right">                               previousY = event-&gt;y();</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0037" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                               <span class="delete">beforeTimeDragTimeRate=core-&gt;getTimeRate();</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                               if (dragTimeMode)</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                               {</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                                       timeDragHistory.clear();</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                                       addTimeDragPoint(event-&gt;pos().x(), e</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">vent-&gt;pos().y());</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                               }</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               event-&gt;accept();</td><td> </td><td class="right">                               event-&gt;accept();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               return;</td><td> </td><td class="right">                               return;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       }</td><td> </td><td class="right">                       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0038" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       else</td><td> </td><td class="rblock">                       else<span class="insert"> if (event-&gt;type()==QEvent::MouseButtonRelease)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       {</td><td> </td><td class="right">                       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               isDragging = false;</td><td> </td><td class="right">                               isDragging = false;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               if (hasDragged)</td><td> </td><td class="right">                               if (hasDragged)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               {</td><td> </td><td class="right">                               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       event-&gt;accept();</td><td> </td><td class="right">                                       event-&gt;accept();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       if (dragTimeMode)</td><td> </td><td class="right">                                       if (dragTimeMode)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       {</td><td> </td><td class="right">                                       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                               if (timeDragHistory.size()&gt;=
3)</td><td> </td><td class="right">                                               if (timeDragHistory.size()&gt;=
3)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                               {</td><td> </td><td class="right">                                               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                                       const double deltaT 
= timeDragHistory.last().runTime-timeDragHistory.first().runTime;</td><td> </td><td class="right">                                                       const double deltaT 
= timeDragHistory.last().runTime-timeDragHistory.first().runTime;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l7" /><small>skipping to change at</small><em> line 460</em></th><th> </th><th><a name="part-r7" /><small>skipping to change at</small><em> line 520</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                                               }</td><td> </td><td class="right">                                                               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                                               else</td><td> </td><td class="right">                                                               else</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                                                       core
-&gt;setTimeRate(beforeTimeDragTimeRate);</td><td> </td><td class="right">                                                                       core
-&gt;setTimeRate(beforeTimeDragTimeRate);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                                       }</td><td> </td><td class="right">                                                       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                               }</td><td> </td><td class="right">                                               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                               else</td><td> </td><td class="right">                                               else</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                                       core-&gt;setTimeRate(be
foreTimeDragTimeRate);</td><td> </td><td class="right">                                                       core-&gt;setTimeRate(be
foreTimeDragTimeRate);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       }</td><td> </td><td class="right">                                       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       return;</td><td> </td><td class="right">                                       return;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               }</td><td> </td><td class="right">                               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0039" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                               else</td><td> </td><td class="rblock">                               else<span class="insert"> // has not dragged...</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               {</td><td> </td><td class="right">                               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       // It's a normal click release</td><td> </td><td class="right">                                       // It's a normal click release</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       // TODO: Leave time dragging in Natu
ral speed or zero speed (config option?) if mouse was resting</td><td> </td><td class="right">                                       // TODO: Leave time dragging in Natu
ral speed or zero speed (config option?) if mouse was resting</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       #ifdef Q_OS_MAC</td><td> </td><td class="right">                       #ifdef Q_OS_MAC</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0040" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                       // CTRL + left clic<span class="delete"> = right clic for
</span> 1 button mouse</td><td> </td><td class="rblock">                                       // CTRL + left clic<span class="insert">k = right click f
or</span> 1 button mouse</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       if (event-&gt;modifiers().testFlag(Qt::
ControlModifier))</td><td> </td><td class="right">                                       if (event-&gt;modifiers().testFlag(Qt::
ControlModifier))</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       {</td><td> </td><td class="right">                                       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                               StelApp::getInstance().getSt
elObjectMgr().unSelect();</td><td> </td><td class="right">                                               StelApp::getInstance().getSt
elObjectMgr().unSelect();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                               event-&gt;accept();</td><td> </td><td class="right">                                               event-&gt;accept();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                               return;</td><td> </td><td class="right">                                               return;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       }</td><td> </td><td class="right">                                       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       // Try to select object at that posi
tion</td><td> </td><td class="right">                                       // Try to select object at that posi
tion</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       StelApp::getInstance().getStelObject
Mgr().findAndSelect(StelApp::getInstance().getCore(), event-&gt;x(), event-&gt;y(
),</td><td> </td><td class="right">                                       StelApp::getInstance().getStelObject
Mgr().findAndSelect(StelApp::getInstance().getCore(), event-&gt;x(), event-&gt;y(
),</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                               event-&gt;modifiers().testFlag(
Qt::MetaModifier) ? StelModule::AddToSelection : StelModule::ReplaceSelecti
on);</td><td> </td><td class="right">                                               event-&gt;modifiers().testFlag(
Qt::MetaModifier) ? StelModule::AddToSelection : StelModule::ReplaceSelecti
on);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l8" /><small>skipping to change at</small><em> line 489</em></th><th> </th><th><a name="part-r8" /><small>skipping to change at</small><em> line 549</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       #endif</td><td> </td><td class="right">                       #endif</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       if (StelApp::getInstance().getStelOb
jectMgr().getWasSelected())</td><td> </td><td class="right">                                       if (StelApp::getInstance().getStelOb
jectMgr().getWasSelected())</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       {</td><td> </td><td class="right">                                       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                               setFlagTracking(false);</td><td> </td><td class="right">                                               setFlagTracking(false);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       }</td><td> </td><td class="right">                                       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       //GZ: You must comment out this line
 for testing Landscape transparency debug prints.</td><td> </td><td class="right">                                       //GZ: You must comment out this line
 for testing Landscape transparency debug prints.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       //event-&gt;accept();</td><td> </td><td class="right">                                       //event-&gt;accept();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       return;</td><td> </td><td class="right">                                       return;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               }</td><td> </td><td class="right">                               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       }</td><td> </td><td class="right">                       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0041" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                       <span class="insert">else</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       {</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                               qDebug() &lt;&lt; "StelMovementMgr::handleMouseCli</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">cks: unknown mouse event type, skipping: " &lt;&lt; event-&gt;type();</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       break;</td><td> </td><td class="right">                       break;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               case Qt::MidButton :</td><td> </td><td class="right">               case Qt::MidButton :</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       if (event-&gt;type()==QEvent::MouseButtonRelease)</td><td> </td><td class="right">                       if (event-&gt;type()==QEvent::MouseButtonRelease)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       {</td><td> </td><td class="right">                       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               if (objectMgr-&gt;getWasSelected())</td><td> </td><td class="right">                               if (objectMgr-&gt;getWasSelected())</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               {</td><td> </td><td class="right">                               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       moveToObject(objectMgr-&gt;getSelectedO
bject()[0],autoMoveDuration);</td><td> </td><td class="right">                                       moveToObject(objectMgr-&gt;getSelectedO
bject()[0],autoMoveDuration);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       setFlagTracking(true);</td><td> </td><td class="right">                                       setFlagTracking(true);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               }</td><td> </td><td class="right">                               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       }</td><td> </td><td class="right">                       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       break;</td><td> </td><td class="right">                       break;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               default: break;</td><td> </td><td class="right">               default: break;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return;</td><td> </td><td class="right">       return;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void StelMovementMgr::setInitViewDirectionToCurrent()</td><td> </td><td class="right">void StelMovementMgr::setInitViewDirectionToCurrent()</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0042" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       // 2016-12 TODO: Create azimuth indication for zenith views.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       initViewPos = core-&gt;j2000ToAltAz(viewDirectionJ2000, StelCore::Refra
ctionOff);</td><td> </td><td class="right">       initViewPos = core-&gt;j2000ToAltAz(viewDirectionJ2000, StelCore::Refra
ctionOff);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       QString dirStr = QString("%1,%2,%3").arg(initViewPos[0]).arg(initVie
wPos[1]).arg(initViewPos[2]);</td><td> </td><td class="right">       QString dirStr = QString("%1,%2,%3").arg(initViewPos[0]).arg(initVie
wPos[1]).arg(initViewPos[2]);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       StelApp::getInstance().getSettings()-&gt;setValue("navigation/init_view
_pos", dirStr);</td><td> </td><td class="right">       StelApp::getInstance().getSettings()-&gt;setValue("navigation/init_view
_pos", dirStr);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">/*************************************************************************</td><td> </td><td class="right">/*************************************************************************</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"> The selected objects changed, follow it if we were already following anoth
er one</td><td> </td><td class="right"> The selected objects changed, follow it if we were already following anoth
er one</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">*************************************************************************/</td><td> </td><td class="right">*************************************************************************/</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void StelMovementMgr::selectedObjectChange(StelModule::StelModuleSelectActi
on)</td><td> </td><td class="right">void StelMovementMgr::selectedObjectChange(StelModule::StelModuleSelectActi
on)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l9" /><small>skipping to change at</small><em> line 594</em></th><th> </th><th><a name="part-r9" /><small>skipping to change at</small><em> line 659</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void StelMovementMgr::lookEast(void)</td><td> </td><td class="right">void StelMovementMgr::lookEast(void)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       float cx, cy;</td><td> </td><td class="right">       float cx, cy;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       Vec3f dir;</td><td> </td><td class="right">       Vec3f dir;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       StelUtils::rectToSphe(&amp;cy,&amp;cx,core-&gt;j2000ToAltAz(getViewDirectionJ20
00(), StelCore::RefractionOff));</td><td> </td><td class="right">       StelUtils::rectToSphe(&amp;cy,&amp;cx,core-&gt;j2000ToAltAz(getViewDirectionJ20
00(), StelCore::RefractionOff));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       cy = M_PI/2.;</td><td> </td><td class="right">       cy = M_PI/2.;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       StelUtils::spheToRect(cy, cx, dir);</td><td> </td><td class="right">       StelUtils::spheToRect(cy, cx, dir);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       setViewDirectionJ2000(core-&gt;altAzToJ2000(Vec3d(dir[0], dir[1], dir[2
]), StelCore::RefractionOff));</td><td> </td><td class="right">       setViewDirectionJ2000(core-&gt;altAzToJ2000(Vec3d(dir[0], dir[1], dir[2
]), StelCore::RefractionOff));</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0043" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       <span class="insert">//qDebug() &lt;&lt; "Setting East at Alt:" &lt;&lt; cx*180./M_PI;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       if ((mountMode==MountAltAzimuthal) &amp;&amp; (cx&gt;M_PI/2-0.0001) &amp;&amp; (upVecto</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">rMountFrame[2]&lt;0.001))</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       {</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               // Special case: we already look into zenith (with rounding </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">tolerance). Bring East to bottom of screen.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               upVectorMountFrame.set(0., -1., 0.);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               //qDebug() &lt;&lt; "lookEast: better Up is " &lt;&lt; upVectorMountFram</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">e[0] &lt;&lt; "/" &lt;&lt; upVectorMountFrame[1] &lt;&lt; "/" &lt;&lt; upVectorMountFrame[2];</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void StelMovementMgr::lookWest(void)</td><td> </td><td class="right">void StelMovementMgr::lookWest(void)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       float cx, cy;</td><td> </td><td class="right">       float cx, cy;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       Vec3f dir;</td><td> </td><td class="right">       Vec3f dir;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       StelUtils::rectToSphe(&amp;cy,&amp;cx,core-&gt;j2000ToAltAz(getViewDirectionJ20
00(), StelCore::RefractionOff));</td><td> </td><td class="right">       StelUtils::rectToSphe(&amp;cy,&amp;cx,core-&gt;j2000ToAltAz(getViewDirectionJ20
00(), StelCore::RefractionOff));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       cy = 3.*M_PI/2.;</td><td> </td><td class="right">       cy = 3.*M_PI/2.;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       StelUtils::spheToRect(cy, cx, dir);</td><td> </td><td class="right">       StelUtils::spheToRect(cy, cx, dir);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       setViewDirectionJ2000(core-&gt;altAzToJ2000(Vec3d(dir[0], dir[1], dir[2
]), StelCore::RefractionOff));</td><td> </td><td class="right">       setViewDirectionJ2000(core-&gt;altAzToJ2000(Vec3d(dir[0], dir[1], dir[2
]), StelCore::RefractionOff));</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0044" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       <span class="insert">//qDebug() &lt;&lt; "Setting West at Alt:" &lt;&lt; cx*180./M_PI;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       if ((mountMode==MountAltAzimuthal) &amp;&amp;  (cx&gt;M_PI/2-0.0001) &amp;&amp; (upVect</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">orMountFrame[2]&lt;0.001))</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       {</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               // Special case: we already look into zenith (with rounding </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">tolerance). Bring West to bottom of screen.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               upVectorMountFrame.set(0., 1., 0.);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               //qDebug() &lt;&lt; "lookEast: better Up is " &lt;&lt; upVectorMountFram</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">e[0] &lt;&lt; "/" &lt;&lt; upVectorMountFrame[1] &lt;&lt; "/" &lt;&lt; upVectorMountFrame[2];</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void StelMovementMgr::lookNorth(void)</td><td> </td><td class="right">void StelMovementMgr::lookNorth(void)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       float cx, cy;</td><td> </td><td class="right">       float cx, cy;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       Vec3f dir;</td><td> </td><td class="right">       Vec3f dir;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       StelUtils::rectToSphe(&amp;cy,&amp;cx,core-&gt;j2000ToAltAz(getViewDirectionJ20
00(), StelCore::RefractionOff));</td><td> </td><td class="right">       StelUtils::rectToSphe(&amp;cy,&amp;cx,core-&gt;j2000ToAltAz(getViewDirectionJ20
00(), StelCore::RefractionOff));</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0045" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                                                                           </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       cy = M_PI;</td><td> </td><td class="right">       cy = M_PI;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       StelUtils::spheToRect(cy, cx, dir);</td><td> </td><td class="right">       StelUtils::spheToRect(cy, cx, dir);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       setViewDirectionJ2000(core-&gt;altAzToJ2000(Vec3d(dir[0], dir[1], dir[2
]), StelCore::RefractionOff));</td><td> </td><td class="right">       setViewDirectionJ2000(core-&gt;altAzToJ2000(Vec3d(dir[0], dir[1], dir[2
]), StelCore::RefractionOff));</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0046" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                           </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       <span class="insert">//qDebug() &lt;&lt; "Setting North at Alt:" &lt;&lt; cx*180./M_PI;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       if ((mountMode==MountAltAzimuthal) &amp;&amp;  (cx&gt;M_PI/2-0.0001) &amp;&amp; (upVect</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">orMountFrame[2]&lt;0.001))</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       {</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               // Special case: we already look into zenith (with rounding </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">tolerance). Bring North to bottom of screen.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               upVectorMountFrame.set(1., 0., 0.);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               //qDebug() &lt;&lt; "lookNorth: better Up is " &lt;&lt; upVectorMountFra</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">me[0] &lt;&lt; "/" &lt;&lt; upVectorMountFrame[1] &lt;&lt; "/" &lt;&lt; upVectorMountFrame[2];</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void StelMovementMgr::lookSouth(void)</td><td> </td><td class="right">void StelMovementMgr::lookSouth(void)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       float cx, cy;</td><td> </td><td class="right">       float cx, cy;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       Vec3f dir;</td><td> </td><td class="right">       Vec3f dir;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       StelUtils::rectToSphe(&amp;cy,&amp;cx,core-&gt;j2000ToAltAz(getViewDirectionJ20
00(), StelCore::RefractionOff));</td><td> </td><td class="right">       StelUtils::rectToSphe(&amp;cy,&amp;cx,core-&gt;j2000ToAltAz(getViewDirectionJ20
00(), StelCore::RefractionOff));</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0047" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                                                                           </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       cy = 0.;</td><td> </td><td class="right">       cy = 0.;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       StelUtils::spheToRect(cy, cx, dir);</td><td> </td><td class="right">       StelUtils::spheToRect(cy, cx, dir);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       setViewDirectionJ2000(core-&gt;altAzToJ2000(Vec3d(dir[0], dir[1], dir[2
]), StelCore::RefractionOff));</td><td> </td><td class="right">       setViewDirectionJ2000(core-&gt;altAzToJ2000(Vec3d(dir[0], dir[1], dir[2
]), StelCore::RefractionOff));</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0048" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                           </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       <span class="insert">//qDebug() &lt;&lt; "Setting South at Alt:" &lt;&lt; cx*180./M_PI;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       if ((mountMode==MountAltAzimuthal) &amp;&amp;  (cx&gt;M_PI/2-0.0001) &amp;&amp; (upVect</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">orMountFrame[2]&lt;0.001))</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       {</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               // Special case: we already look into zenith (with rounding </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">tolerance). Bring South to bottom of screen.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               upVectorMountFrame.set(-1., 0., 0.);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               //qDebug() &lt;&lt; "lookSouth: better Up is " &lt;&lt; upVectorMountFra</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">me[0] &lt;&lt; "/" &lt;&lt; upVectorMountFrame[1] &lt;&lt; "/" &lt;&lt; upVectorMountFrame[2];</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void StelMovementMgr::lookZenith(void)</td><td> </td><td class="right">void StelMovementMgr::lookZenith(void)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       Vec3f dir;</td><td> </td><td class="right">       Vec3f dir;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       StelUtils::spheToRect(M_PI, M_PI/2., dir);</td><td> </td><td class="right">       StelUtils::spheToRect(M_PI, M_PI/2., dir);</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0049" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       //qDebug() &lt;&lt; "lookZenith: Up is " &lt;&lt; upVectorMountFrame[0] &lt;&lt; "/" &lt;
&lt; upVectorMountFrame[1] &lt;&lt; "/" &lt;&lt; upVectorMountFrame[2];</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       setViewDirectionJ2000(core-&gt;altAzToJ2000(Vec3d(dir[0], dir[1], dir[2
]), StelCore::RefractionOff));</td><td> </td><td class="right">       setViewDirectionJ2000(core-&gt;altAzToJ2000(Vec3d(dir[0], dir[1], dir[2
]), StelCore::RefractionOff));</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0050" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       <span class="insert">//qDebug() &lt;&lt; "lookZenith: View is " &lt;&lt; viewDirectionMountFrame[0] &lt;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">&lt; "/" &lt;&lt; viewDirectionMountFrame[1] &lt;&lt; "/" &lt;&lt; viewDirectionMountFrame[2];</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       if (mountMode==MountAltAzimuthal)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       {       // ensure a stable up vector that makes the bottom of the sc</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">reen point south.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               upVectorMountFrame.set(-1., 0., 0.);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               //qDebug() &lt;&lt; "lookZenith: better Up is " &lt;&lt; upVectorMountFr</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">ame[0] &lt;&lt; "/" &lt;&lt; upVectorMountFrame[1] &lt;&lt; "/" &lt;&lt; upVectorMountFrame[2];</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">}</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">void StelMovementMgr::lookTowardsNCP(void)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">{</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       setViewDirectionJ2000(core-&gt;equinoxEquToJ2000(Vec3d(0,0,1)));</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">}</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">void StelMovementMgr::lookTowardsSCP(void)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">{</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       setViewDirectionJ2000(core-&gt;equinoxEquToJ2000(Vec3d(0,0,-1)));</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Increment/decrement smoothly the vision field and position</td><td> </td><td class="right">// Increment/decrement smoothly the vision field and position</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void StelMovementMgr::updateMotion(double deltaTime)</td><td> </td><td class="right">void StelMovementMgr::updateMotion(double deltaTime)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       updateVisionVector(deltaTime);</td><td> </td><td class="right">       updateVisionVector(deltaTime);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       const StelProjectorP proj = core-&gt;getProjection(StelCore::FrameJ2000
);</td><td> </td><td class="right">       const StelProjectorP proj = core-&gt;getProjection(StelCore::FrameJ2000
);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // the more it is zoomed, the lower the moving speed is (in angle)</td><td> </td><td class="right">       // the more it is zoomed, the lower the moving speed is (in angle)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double depl=keyMoveSpeed*deltaTime*1000*currentFov;</td><td> </td><td class="right">       double depl=keyMoveSpeed*deltaTime*1000*currentFov;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l10" /><small>skipping to change at</small><em> line 677</em></th><th> </th><th><a name="part-r10" /><small>skipping to change at</small><em> line 792</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       else if (deltaAlt&gt;0)</td><td> </td><td class="right">       else if (deltaAlt&gt;0)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               deltaAlt = depl/30;</td><td> </td><td class="right">               deltaAlt = depl/30;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               if (deltaAlt&gt;0.2)</td><td> </td><td class="right">               if (deltaAlt&gt;0.2)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       deltaAlt = 0.2;</td><td> </td><td class="right">                       deltaAlt = 0.2;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (deltaFov&lt;0)</td><td> </td><td class="right">       if (deltaFov&lt;0)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0051" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               deltaFov = -deplzoom*5;</td><td> </td><td class="rblock"><span class="insert">//</span>             deltaFov = -deplzoom*5;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               if (deltaFov&lt;-0.15*currentFov)</td><td> </td><td class="rblock"><span class="insert">//</span>             if (deltaFov&lt;-0.15*currentFov)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       deltaFov = -0.15*currentFov;</td><td> </td><td class="rblock"><span class="insert">//</span>                     deltaFov = -0.15*currentFov;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">               <span class="insert">deltaFov=qMax(-0.15*currentFov, -deplzoom*5);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       else if (deltaFov&gt;0)</td><td> </td><td class="right">       else if (deltaFov&gt;0)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0052" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               deltaFov = <span class="delete">deplzoom*5;</span></td><td> </td><td class="rblock">               deltaFov = <span class="insert">qMin(20., deplzoom*5.);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               if (deltaFov&gt;20)</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                       deltaFov = 20;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (deltaFov != 0 )</td><td> </td><td class="right">       if (deltaFov != 0 )</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               changeFov(deltaFov);</td><td> </td><td class="right">               changeFov(deltaFov);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       panView(deltaAz, deltaAlt);</td><td> </td><td class="right">       panView(deltaAz, deltaAlt);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       updateAutoZoom(deltaTime);</td><td> </td><td class="right">       updateAutoZoom(deltaTime);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0053" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">// called at begin of updateMotion()</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void StelMovementMgr::updateVisionVector(double deltaTime)</td><td> </td><td class="right">void StelMovementMgr::updateVisionVector(double deltaTime)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // Specialized setups cannot use this functionality!</td><td> </td><td class="right">       // Specialized setups cannot use this functionality!</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (flagInhibitAllAutomoves)</td><td> </td><td class="right">       if (flagInhibitAllAutomoves)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               return;</td><td> </td><td class="right">               return;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (flagAutoMove)</td><td> </td><td class="right">       if (flagAutoMove)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               if (!move.targetObject.isNull())</td><td> </td><td class="right">               if (!move.targetObject.isNull())</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l11" /><small>skipping to change at</small><em> line 722</em></th><th> </th><th><a name="part-r11" /><small>skipping to change at</small><em> line 837</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       {</td><td> </td><td class="right">                       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               case MountAltAzimuthal:</td><td> </td><td class="right">                               case MountAltAzimuthal:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       v = move.targetObject-&gt;getAltAzPosAu
to(core);</td><td> </td><td class="right">                                       v = move.targetObject-&gt;getAltAzPosAu
to(core);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       break;</td><td> </td><td class="right">                                       break;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               case MountEquinoxEquatorial:</td><td> </td><td class="right">                               case MountEquinoxEquatorial:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       v = move.targetObject-&gt;getEquinoxEqu
atorialPos(core);</td><td> </td><td class="right">                                       v = move.targetObject-&gt;getEquinoxEqu
atorialPos(core);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       break;</td><td> </td><td class="right">                                       break;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               case MountGalactic:</td><td> </td><td class="right">                               case MountGalactic:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       v = move.targetObject-&gt;getGalacticPo
s(core);</td><td> </td><td class="right">                                       v = move.targetObject-&gt;getGalacticPo
s(core);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       break;</td><td> </td><td class="right">                                       break;</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0054" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                               <span class="insert">case MountSupergalactic:</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                                       v = move.targetObject-&gt;getSupergalac</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">ticPos(core);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                                       break;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               default:</td><td> </td><td class="right">                               default:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       qWarning() &lt;&lt; "StelMovementMgr: unex
pected mountMode" &lt;&lt; mountMode;</td><td> </td><td class="right">                                       qWarning() &lt;&lt; "StelMovementMgr: unex
pected mountMode" &lt;&lt; mountMode;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       Q_ASSERT(0);</td><td> </td><td class="right">                                       Q_ASSERT(0);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       v = move.targetObject-&gt;getAltAzPosAu
to(core); // still do something useful</td><td> </td><td class="right">                                       v = move.targetObject-&gt;getAltAzPosAu
to(core); // still do something useful</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       }</td><td> </td><td class="right">                       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       double lat, lon;</td><td> </td><td class="right">                       double lat, lon;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       StelUtils::rectToSphe(&amp;lon, &amp;lat, v);</td><td> </td><td class="right">                       StelUtils::rectToSphe(&amp;lon, &amp;lat, v);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       float altOffset=core-&gt;getCurrentStelProjectorParams(
).viewportCenterOffset[1]*currentFov*M_PI/180.0f;</td><td> </td><td class="right">                       float altOffset=core-&gt;getCurrentStelProjectorParams(
).viewportCenterOffset[1]*currentFov*M_PI/180.0f;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       lat+=altOffset;</td><td> </td><td class="right">                       lat+=altOffset;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       StelUtils::spheToRect(lon, lat, v);</td><td> </td><td class="right">                       StelUtils::spheToRect(lon, lat, v);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       move.aim=mountFrameToJ2000(v);</td><td> </td><td class="right">                       move.aim=mountFrameToJ2000(v);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       move.aim.normalize();</td><td> </td><td class="right">                       move.aim.normalize();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       move.aim*=2.;</td><td> </td><td class="right">                       move.aim*=2.;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       // For aiming at objects, we can assume simple up ve
ctor.</td><td> </td><td class="right">                       // For aiming at objects, we can assume simple up ve
ctor.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       move.startUp=getViewUpVectorJ2000();</td><td> </td><td class="right">                       move.startUp=getViewUpVectorJ2000();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       move.aimUp=mountFrameToJ2000(Vec3d(0., 0., 1.));</td><td> </td><td class="right">                       move.aimUp=mountFrameToJ2000(Vec3d(0., 0., 1.));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0055" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               else</td><td> </td><td class="rblock">               else<span class="insert"> // no targetObject:</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//                     if (move.mountMode == MountAltAzimuthal)</td><td> </td><td class="right">//                     if (move.mountMode == MountAltAzimuthal)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//                     {</td><td> </td><td class="right">//                     {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//                             move.startUp=Vec3d(0., 0., 1.);</td><td> </td><td class="right">//                             move.startUp=Vec3d(0., 0., 1.);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//                             move.aimUp=Vec3d(0., 0., 1.);</td><td> </td><td class="right">//                             move.aimUp=Vec3d(0., 0., 1.);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//                     }</td><td> </td><td class="right">//                     }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//                     else</td><td> </td><td class="right">//                     else</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//                     { // March 2016</td><td> </td><td class="right">//                     { // March 2016</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               move.startUp=getViewUpVectorJ2000();</td><td> </td><td class="right">                               move.startUp=getViewUpVectorJ2000();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               move.aimUp=mountFrameToJ2000(Vec3d(0., 0., 1
.));</td><td> </td><td class="right">                               move.aimUp=mountFrameToJ2000(Vec3d(0., 0., 1
.));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//                     }</td><td> </td><td class="right">//                     }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               move.coef+=move.speed*deltaTime*1000;</td><td> </td><td class="right">               move.coef+=move.speed*deltaTime*1000;</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0056" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">               <span class="insert">//qDebug() &lt;&lt; "updateVisionVector: setViewUpvectorJ2000 L813</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">";</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               setViewUpVectorJ2000(move.aimUp);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               if (move.coef&gt;=1.)</td><td> </td><td class="right">               if (move.coef&gt;=1.)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0057" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                       setViewUpVectorJ2000(move.aimUp);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       //qDebug() &lt;&lt; "AutoMove finished. Setting Up vector 
(in mount frame) to " &lt;&lt; upVectorMountFrame.v[0] &lt;&lt; "/" &lt;&lt; upVectorMountFra
me.v[1] &lt;&lt; "/" &lt;&lt; upVectorMountFrame.v[2];</td><td> </td><td class="right">                       //qDebug() &lt;&lt; "AutoMove finished. Setting Up vector 
(in mount frame) to " &lt;&lt; upVectorMountFrame.v[0] &lt;&lt; "/" &lt;&lt; upVectorMountFra
me.v[1] &lt;&lt; "/" &lt;&lt; upVectorMountFrame.v[2];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       flagAutoMove=false;</td><td> </td><td class="right">                       flagAutoMove=false;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       move.coef=1.;</td><td> </td><td class="right">                       move.coef=1.;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0058" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               <span class="delete">else</span></td><td> </td><td class="rblock">                                                                           </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               {       // 2016-03 Maybe this is the culprit?</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                       //setViewUpVectorJ2000(move.startUp*(1.-move.coef) +</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"> move.aimUp*move.coef);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                       setViewUpVectorJ2000(move.aimUp);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               }</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               // Use a smooth function</td><td> </td><td class="right">               // Use a smooth function</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0059" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               <span class="delete">float smooth = 4.f;</span></td><td> </td><td class="rblock">               <span class="insert">const float smooth = 4.f; // (empirically tested)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               double c;</td><td> </td><td class="right">               double c;</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0060" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               <span class="delete">if (zoomingMode==ZoomIn)</span></td><td> </td><td class="rblock">               <span class="insert">switch (zoomingMode){</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               {</span></td><td> </td><td class="rblock"><span class="insert">                       case ZoomIn:</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                       if (move.coef&gt;.9)</span></td><td> </td><td class="rblock"><span class="insert">                               c=(move.coef&gt;.9 ? 1. :</span> 1. - <span class="insert">pow(1.-1.11*move</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                       {</span></td><td> </td><td class="rblock"><span class="insert">.coef,3.)); break;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                               c = 1.;</span></td><td> </td><td class="rblock"><span class="insert">                       case ZoomOut:</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                       }</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                       else</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                       {</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                               c =</span> 1. - <span class="delete">pow(1.-1.11*move.coef,3.);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                       }</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               }</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               else if (zoomingMode==ZoomOut)</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               {</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                       if (move.coef&lt;0.1)</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                       {</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               // keep in view at first as zoom out</td><td> </td><td class="right">                               // keep in view at first as zoom out</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0061" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                               c = <span class="delete">0;</span></td><td> </td><td class="rblock">                               <span class="insert">c=(move.coef&lt;0.1 ? 0. : pow(1.11*(move.coef-</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                       }</span></td><td> </td><td class="rblock"><span class="insert">.1),3.)); break;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                       else</span></td><td> </td><td class="rblock"><span class="insert">                       default:</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                       {</span></td><td> </td><td class="rblock">                               c = <span class="insert">std::atan(smooth * 2.*move.coef-smooth)/</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                               c =  pow(1.11*(move.coef-.1),3.);</span></td><td> </td><td class="rblock"><span class="insert">std::atan(smooth)/2+0.5;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                       }</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0062" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               <span class="delete">else</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                       c = std::atan(smooth * 2.*move.coef-smooth)/std::ata</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">n(smooth)/2+0.5;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               // 2016-03: In case of azimuthal moves, it is not useful to 
compute anything from J2000 coordinates.</td><td> </td><td class="right">               // 2016-03: In case of azimuthal moves, it is not useful to 
compute anything from J2000 coordinates.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               // Imagine a slow AltAz move during speedy timelapse: Aim wi
ll move!</td><td> </td><td class="right">               // Imagine a slow AltAz move during speedy timelapse: Aim wi
ll move!</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               // TODO: all variants...</td><td> </td><td class="right">               // TODO: all variants...</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               Vec3d tmpStart;</td><td> </td><td class="right">               Vec3d tmpStart;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               Vec3d tmpAim;</td><td> </td><td class="right">               Vec3d tmpAim;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               if (move.mountMode==MountAltAzimuthal)</td><td> </td><td class="right">               if (move.mountMode==MountAltAzimuthal)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       tmpStart=move.start;</td><td> </td><td class="right">                       tmpStart=move.start;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       tmpAim=move.aim;</td><td> </td><td class="right">                       tmpAim=move.aim;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l12" /><small>skipping to change at</small><em> line 842</em></th><th> </th><th><a name="part-r12" /><small>skipping to change at</small><em> line 941</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//             }</td><td> </td><td class="right">//             }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//             else</td><td> </td><td class="right">//             else</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       setViewDirectionJ2000(mountFrameToJ2000(tmp));</td><td> </td><td class="right">                       setViewDirectionJ2000(mountFrameToJ2000(tmp));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//                     if (move.mountMode==MountAltAzimuthal)</td><td> </td><td class="right">//                     if (move.mountMode==MountAltAzimuthal)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//                     {</td><td> </td><td class="right">//                     {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//                             setViewUpVector(Vec3d(0., 0., 1.));</td><td> </td><td class="right">//                             setViewUpVector(Vec3d(0., 0., 1.));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//                             qDebug() &lt;&lt; "We do indeed set this";</td><td> </td><td class="right">//                             qDebug() &lt;&lt; "We do indeed set this";</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//                     }</td><td> </td><td class="right">//                     }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               // qDebug() &lt;&lt; "setting view direction to " &lt;&lt; tmp.v[0] &lt;&lt; "
/" &lt;&lt; tmp.v[1] &lt;&lt; "/" &lt;&lt; tmp.v[2];</td><td> </td><td class="right">               // qDebug() &lt;&lt; "setting view direction to " &lt;&lt; tmp.v[0] &lt;&lt; "
/" &lt;&lt; tmp.v[1] &lt;&lt; "/" &lt;&lt; tmp.v[2];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0063" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       else</td><td> </td><td class="rblock">       else<span class="insert"> // no autoMove</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               if (flagTracking &amp;&amp; objectMgr-&gt;getWasSelected()) // Equatori
al vision vector locked on selected object</td><td> </td><td class="right">               if (flagTracking &amp;&amp; objectMgr-&gt;getWasSelected()) // Equatori
al vision vector locked on selected object</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       Vec3d v;</td><td> </td><td class="right">                       Vec3d v;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       switch (mountMode)</td><td> </td><td class="right">                       switch (mountMode)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       {</td><td> </td><td class="right">                       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               case MountAltAzimuthal:</td><td> </td><td class="right">                               case MountAltAzimuthal:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       v = objectMgr-&gt;getSelectedObject()[0
]-&gt;getAltAzPosAuto(core);</td><td> </td><td class="right">                                       v = objectMgr-&gt;getSelectedObject()[0
]-&gt;getAltAzPosAuto(core);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       break;</td><td> </td><td class="right">                                       break;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               case MountEquinoxEquatorial:</td><td> </td><td class="right">                               case MountEquinoxEquatorial:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       v = objectMgr-&gt;getSelectedObject()[0
]-&gt;getEquinoxEquatorialPos(core);</td><td> </td><td class="right">                                       v = objectMgr-&gt;getSelectedObject()[0
]-&gt;getEquinoxEquatorialPos(core);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       break;</td><td> </td><td class="right">                                       break;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               case MountGalactic:</td><td> </td><td class="right">                               case MountGalactic:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       v = objectMgr-&gt;getSelectedObject()[0
]-&gt;getGalacticPos(core);</td><td> </td><td class="right">                                       v = objectMgr-&gt;getSelectedObject()[0
]-&gt;getGalacticPos(core);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       break;</td><td> </td><td class="right">                                       break;</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0064" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                               <span class="insert">case MountSupergalactic:</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                                       v = objectMgr-&gt;getSelectedObject()[0</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">]-&gt;getSupergalacticPos(core);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                                       break;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               default:</td><td> </td><td class="right">                               default:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       qWarning() &lt;&lt; "StelMovementMgr: unex
pected mountMode" &lt;&lt; mountMode;</td><td> </td><td class="right">                                       qWarning() &lt;&lt; "StelMovementMgr: unex
pected mountMode" &lt;&lt; mountMode;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       Q_ASSERT(0);</td><td> </td><td class="right">                                       Q_ASSERT(0);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       v = move.targetObject-&gt;getAltAzPosAu
to(core); // still do something useful in release build</td><td> </td><td class="right">                                       v = move.targetObject-&gt;getAltAzPosAu
to(core); // still do something useful in release build</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       }</td><td> </td><td class="right">                       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       double lat, lon; // general: longitudinal, latitudin
al</td><td> </td><td class="right">                       double lat, lon; // general: longitudinal, latitudin
al</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       StelUtils::rectToSphe(&amp;lon, &amp;lat, v);</td><td> </td><td class="right">                       StelUtils::rectToSphe(&amp;lon, &amp;lat, v);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       float latOffset=core-&gt;getCurrentStelProjectorParams(
).viewportCenterOffset[1]*currentFov*M_PI/180.0f;</td><td> </td><td class="right">                       float latOffset=core-&gt;getCurrentStelProjectorParams(
).viewportCenterOffset[1]*currentFov*M_PI/180.0f;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       lat+=latOffset;</td><td> </td><td class="right">                       lat+=latOffset;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       StelUtils::spheToRect(lon, lat, v);</td><td> </td><td class="right">                       StelUtils::spheToRect(lon, lat, v);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       setViewDirectionJ2000(mountFrameToJ2000(v));</td><td> </td><td class="right">                       setViewDirectionJ2000(mountFrameToJ2000(v));</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0065" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       //qDebug() &lt;&lt; "setViewUpVector() L930";</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       setViewUpVectorJ2000(mountFrameToJ2000(Vec3d(0., 0.,
 1.))); // Does not disturb to reassure this former default.</td><td> </td><td class="right">                       setViewUpVectorJ2000(mountFrameToJ2000(Vec3d(0., 0.,
 1.))); // Does not disturb to reassure this former default.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0066" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               else</td><td> </td><td class="rblock">               else<span class="insert"> // not tracking or no selection</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       if (flagLockEquPos) // Equatorial vision vector lock
ed</td><td> </td><td class="right">                       if (flagLockEquPos) // Equatorial vision vector lock
ed</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       {</td><td> </td><td class="right">                       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               // Recalc local vision vector</td><td> </td><td class="right">                               // Recalc local vision vector</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               setViewDirectionJ2000(viewDirectionJ2000);</td><td> </td><td class="right">                               setViewDirectionJ2000(viewDirectionJ2000);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       }</td><td> </td><td class="right">                       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       else</td><td> </td><td class="right">                       else</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       {</td><td> </td><td class="right">                       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               // Vision vector locked to its position in t
he mountFrame</td><td> </td><td class="right">                               // Vision vector locked to its position in t
he mountFrame</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               setViewDirectionJ2000(mountFrameToJ2000(view
DirectionMountFrame));</td><td> </td><td class="right">                               setViewDirectionJ2000(mountFrameToJ2000(view
DirectionMountFrame));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               // After setting time, moveToAltAz broke the
 up vector without this:</td><td> </td><td class="right">                               // After setting time, moveToAltAz broke the
 up vector without this:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               // Make sure this does not now break zenith 
views!</td><td> </td><td class="right">                               // Make sure this does not now break zenith 
views!</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               // Or make sure to call moveToAltAz twice.</td><td> </td><td class="right">                               // Or make sure to call moveToAltAz twice.</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0067" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                               <span class="delete">setViewUpVectorJ2000(mountFrameToJ2000(Vec3d</span></td><td> </td><td class="rblock">                               <span class="insert">//qDebug() &lt;&lt; "setUpVectorJ2000 woe L947";</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">(0.,0.,1.)));</span></td><td> </td><td class="rblock"><span class="insert">                               //setViewUpVectorJ2000(mountFrameToJ2000(Vec</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">3d(0.,0.,1.)));</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                               setViewUpVectorJ2000(mountFrameToJ2000(upVec</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">torMountFrame)); // maybe fixes? / &lt; &lt; &lt; &lt; &lt; &lt; &lt; &lt; &lt; &lt; THIS WAS THE BIG ONE</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       }</td><td> </td><td class="right">                       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Go and zoom to the selected object. (Action linked to key, default "/")</td><td> </td><td class="right">// Go and zoom to the selected object. (Action linked to key, default "/")</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void StelMovementMgr::autoZoomIn(float moveDuration, bool allowManualZoom)</td><td> </td><td class="right">void StelMovementMgr::autoZoomIn(float moveDuration, bool allowManualZoom)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (!objectMgr-&gt;getWasSelected())</td><td> </td><td class="right">       if (!objectMgr-&gt;getWasSelected())</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               return;</td><td> </td><td class="right">               return;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l13" /><small>skipping to change at</small><em> line 1043</em></th><th> </th><th><a name="part-r13" /><small>skipping to change at</small><em> line 1148</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       move.targetObject = target;</td><td> </td><td class="right">       move.targetObject = target;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       //move.mountMode=mountMode;  // Maybe better to have MountEquinoxEqu
atorial here? ==&gt; YES, fixed orientation problem.</td><td> </td><td class="right">       //move.mountMode=mountMode;  // Maybe better to have MountEquinoxEqu
atorial here? ==&gt; YES, fixed orientation problem.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       move.mountMode=MountEquinoxEquatorial;</td><td> </td><td class="right">       move.mountMode=MountEquinoxEquatorial;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       flagAutoMove = true;</td><td> </td><td class="right">       flagAutoMove = true;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// March 2016: This call does nothing when mount frame is not AltAzi! (TODO
 later: rethink&amp;fix.)</td><td> </td><td class="right">// March 2016: This call does nothing when mount frame is not AltAzi! (TODO
 later: rethink&amp;fix.)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void StelMovementMgr::moveToAltAzi(const Vec3d&amp; aim, const Vec3d &amp;aimUp, fl
oat moveDuration, ZoomingMode zooming)</td><td> </td><td class="right">void StelMovementMgr::moveToAltAzi(const Vec3d&amp; aim, const Vec3d &amp;aimUp, fl
oat moveDuration, ZoomingMode zooming)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (mountMode!=StelMovementMgr::MountAltAzimuthal)</td><td> </td><td class="right">       if (mountMode!=StelMovementMgr::MountAltAzimuthal)</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0068" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       <span class="insert">{</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               qDebug() &lt;&lt; "StelMovementMgr: called moveToAltAzi, but not i</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">n AltAz mount frame. Ignoring.";</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               return;</td><td> </td><td class="right">               return;</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0069" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       moveDuration /= movementsSpeedFactor;</td><td> </td><td class="right">       moveDuration /= movementsSpeedFactor;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0070" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       // <span class="delete">TODO: Specify start and aim vectors in AltAz system! Then the aut
o functions should be able to work it out properly with only minor edits</span>.</td><td> </td><td class="rblock">       // <span class="insert">Specify start and aim vectors in AltAz system! Then the auto func
tions can work it out properly</span>.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       zoomingMode = zooming;</td><td> </td><td class="right">       zoomingMode = zooming;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       move.aim=aim;</td><td> </td><td class="right">       move.aim=aim;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       move.aim.normalize();</td><td> </td><td class="right">       move.aim.normalize();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       move.aim*=2.;</td><td> </td><td class="right">       move.aim*=2.;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       move.aimUp=aimUp; // the new up vector. We cannot simply keep vertic
al axis, there may be the intention to look into the zenith or so.</td><td> </td><td class="right">       move.aimUp=aimUp; // the new up vector. We cannot simply keep vertic
al axis, there may be the intention to look into the zenith or so.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       move.aimUp.normalize();</td><td> </td><td class="right">       move.aimUp.normalize();</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0071" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       // TODO: Replace by fixed current orientation!</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       move.start=core-&gt;j2000ToAltAz(viewDirectionJ2000, StelCore::Refracti
onOff);</td><td> </td><td class="right">       move.start=core-&gt;j2000ToAltAz(viewDirectionJ2000, StelCore::Refracti
onOff);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       move.start.normalize();</td><td> </td><td class="right">       move.start.normalize();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       move.startUp.set(0., 0., 1.);</td><td> </td><td class="right">       move.startUp.set(0., 0., 1.);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       move.speed=1.f/(moveDuration*1000);</td><td> </td><td class="right">       move.speed=1.f/(moveDuration*1000);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       move.coef=0.;</td><td> </td><td class="right">       move.coef=0.;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       move.targetObject.clear();</td><td> </td><td class="right">       move.targetObject.clear();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       move.mountMode=MountAltAzimuthal; // This signals: start and aim are
 given in AltAz coordinates.</td><td> </td><td class="right">       move.mountMode=MountAltAzimuthal; // This signals: start and aim are
 given in AltAz coordinates.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       flagAutoMove = true;</td><td> </td><td class="right">       flagAutoMove = true;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       //      // debug output if required</td><td> </td><td class="right">       //      // debug output if required</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       //      double currAlt, currAzi, newAlt, newAzi;</td><td> </td><td class="right">       //      double currAlt, currAzi, newAlt, newAzi;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       //      StelUtils::rectToSphe(&amp;currAzi, &amp;currAlt, move.start);</td><td> </td><td class="right">       //      StelUtils::rectToSphe(&amp;currAzi, &amp;currAlt, move.start);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       //      StelUtils::rectToSphe(&amp;newAzi, &amp;newAlt, move.aim);</td><td> </td><td class="right">       //      StelUtils::rectToSphe(&amp;newAzi, &amp;newAlt, move.aim);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       //      qDebug() &lt;&lt; "StelMovementMgr::moveToAltAzi() from alt:" &lt;&lt; c
urrAlt*(180./M_PI) &lt;&lt; "/azi" &lt;&lt; currAzi*(180./M_PI)  &lt;&lt; "to alt:" &lt;&lt; newAlt
*(180./M_PI)  &lt;&lt; "azi" &lt;&lt; newAzi*(180./M_PI) ;</td><td> </td><td class="right">       //      qDebug() &lt;&lt; "StelMovementMgr::moveToAltAzi() from alt:" &lt;&lt; c
urrAlt*(180./M_PI) &lt;&lt; "/azi" &lt;&lt; currAzi*(180./M_PI)  &lt;&lt; "to alt:" &lt;&lt; newAlt
*(180./M_PI)  &lt;&lt; "azi" &lt;&lt; newAzi*(180./M_PI) ;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">Vec3d StelMovementMgr::j2000ToMountFrame(const Vec3d&amp; v) const</td><td> </td><td class="right">Vec3d StelMovementMgr::j2000ToMountFrame(const Vec3d&amp; v) const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       switch (mountMode)</td><td> </td><td class="right">       switch (mountMode)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               case MountAltAzimuthal:</td><td> </td><td class="right">               case MountAltAzimuthal:</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0072" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       return core-&gt;j2000ToAltAz(v, StelCore::RefractionOff
);</td><td> </td><td class="rblock">                       return core-&gt;j2000ToAltAz(v, StelCore::RefractionOff
);<span class="insert"> // TODO: Decide if RefractionAuto?</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               case MountEquinoxEquatorial:</td><td> </td><td class="right">               case MountEquinoxEquatorial:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       return core-&gt;j2000ToEquinoxEqu(v);</td><td> </td><td class="right">                       return core-&gt;j2000ToEquinoxEqu(v);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               case MountGalactic:</td><td> </td><td class="right">               case MountGalactic:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       return core-&gt;j2000ToGalactic(v);</td><td> </td><td class="right">                       return core-&gt;j2000ToGalactic(v);</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0073" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">               <span class="insert">case MountSupergalactic:</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       return core-&gt;j2000ToSupergalactic(v);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       Q_ASSERT(0);</td><td> </td><td class="right">       Q_ASSERT(0);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return Vec3d(0);</td><td> </td><td class="right">       return Vec3d(0);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">Vec3d StelMovementMgr::mountFrameToJ2000(const Vec3d&amp; v) const</td><td> </td><td class="right">Vec3d StelMovementMgr::mountFrameToJ2000(const Vec3d&amp; v) const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       switch (mountMode)</td><td> </td><td class="right">       switch (mountMode)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               case MountAltAzimuthal:</td><td> </td><td class="right">               case MountAltAzimuthal:</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0074" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       return core-&gt;altAzToJ2000(v, StelCore::RefractionOff
);</td><td> </td><td class="rblock">                       return core-&gt;altAzToJ2000(v, StelCore::RefractionOff
);<span class="insert"> // TODO: Decide if RefractionAuto?</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               case MountEquinoxEquatorial:</td><td> </td><td class="right">               case MountEquinoxEquatorial:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       return core-&gt;equinoxEquToJ2000(v);</td><td> </td><td class="right">                       return core-&gt;equinoxEquToJ2000(v);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               case MountGalactic:</td><td> </td><td class="right">               case MountGalactic:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       return core-&gt;galacticToJ2000(v);</td><td> </td><td class="right">                       return core-&gt;galacticToJ2000(v);</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0075" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">               <span class="insert">case MountSupergalactic:</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       return core-&gt;supergalacticToJ2000(v);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       Q_ASSERT(0);</td><td> </td><td class="right">       Q_ASSERT(0);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return Vec3d(0);</td><td> </td><td class="right">       return Vec3d(0);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void StelMovementMgr::setViewDirectionJ2000(const Vec3d&amp; v)</td><td> </td><td class="right">void StelMovementMgr::setViewDirectionJ2000(const Vec3d&amp; v)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       core-&gt;lookAtJ2000(v, getViewUpVectorJ2000());</td><td> </td><td class="right">       core-&gt;lookAtJ2000(v, getViewUpVectorJ2000());</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       viewDirectionJ2000 = v;</td><td> </td><td class="right">       viewDirectionJ2000 = v;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       viewDirectionMountFrame = j2000ToMountFrame(v);</td><td> </td><td class="right">       viewDirectionMountFrame = j2000ToMountFrame(v);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void StelMovementMgr::panView(const double deltaAz, const double deltaAlt)</td><td> </td><td class="right">void StelMovementMgr::panView(const double deltaAz, const double deltaAlt)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0076" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       // DONE 2016-12 FIX UP VECTOR PROBLEM</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // The function is called in update loops, so make a quick check for
 exit.</td><td> </td><td class="right">       // The function is called in update loops, so make a quick check for
 exit.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if ((deltaAz==0.) &amp;&amp; (deltaAlt==0.))</td><td> </td><td class="right">       if ((deltaAz==0.) &amp;&amp; (deltaAlt==0.))</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               return;</td><td> </td><td class="right">               return;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double azVision, altVision;</td><td> </td><td class="right">       double azVision, altVision;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       StelUtils::rectToSphe(&amp;azVision,&amp;altVision,j2000ToMountFrame(viewDir
ectionJ2000));</td><td> </td><td class="right">       StelUtils::rectToSphe(&amp;azVision,&amp;altVision,j2000ToMountFrame(viewDir
ectionJ2000));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // Az is counted from South, eastward.</td><td> </td><td class="right">       // Az is counted from South, eastward.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0077" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">// </span>qDebug() &lt;&lt; "Azimuth:" &lt;&lt; azVision * 180./M_PI &lt;&lt; "Altitude:" &lt;&lt; 
altVision * 180./M_PI &lt;&lt; "Up.X=" &lt;&lt; upVectorMountFrame.v[0] &lt;&lt; "Up.Y=" &lt;&lt; u
pVectorMountFrame.v[1] &lt;&lt; "Up.Z=" &lt;&lt; upVectorMountFrame.v[2];</td><td> </td><td class="rblock">       <span class="insert"> //</span>qDebug() &lt;&lt; "Azimuth:" &lt;&lt; azVision * 180./M_PI &lt;&lt; "Altitude:" &lt;&lt; 
altVision * 180./M_PI &lt;&lt; "Up.X=" &lt;&lt; upVectorMountFrame.v[0] &lt;&lt; "Up.Y=" &lt;&lt; u
pVectorMountFrame.v[1] &lt;&lt; "Up.Z=" &lt;&lt; upVectorMountFrame.v[2];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // if we are just looking into the pole, azimuth can hopefully be re
covered from the customized up vector!</td><td> </td><td class="right">       // if we are just looking into the pole, azimuth can hopefully be re
covered from the customized up vector!</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // When programmatically centering on a pole, we should have set a b
etter up vector for |alt|&gt;0.9*M_PI/2.</td><td> </td><td class="right">       // When programmatically centering on a pole, we should have set a b
etter up vector for |alt|&gt;0.9*M_PI/2.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (fabs(altVision)&gt; 0.95* M_PI/2.)</td><td> </td><td class="right">       if (fabs(altVision)&gt; 0.95* M_PI/2.)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               if (upVectorMountFrame.v[2] &lt; 0.9)</td><td> </td><td class="right">               if (upVectorMountFrame.v[2] &lt; 0.9)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0078" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       <span class="delete">// qDebug() &lt;&lt; "</span>Recovering azimuth...";</td><td> </td><td class="rblock">                       <span class="insert"> //qDebug() &lt;&lt; "panView: </span>Recovering azimuth...";</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       azVision=atan2(-upVectorMountFrame.v[1], -upVectorMo
untFrame.v[0]);</td><td> </td><td class="right">                       azVision=atan2(-upVectorMountFrame.v[1], -upVectorMo
untFrame.v[0]);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       if (altVision &lt; 0.)</td><td> </td><td class="right">                       if (altVision &lt; 0.)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               azVision+=M_PI;</td><td> </td><td class="right">                               azVision+=M_PI;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0079" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">//             else</td><td> </td><td class="rblock">               // <span class="insert">Remove these lines if all is OK.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">//</span>             {</td><td> </td><td class="rblock">               else</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">//                     // qDebug()</span> &lt;&lt; <span class="delete">"UpVector:"</span> &lt;&lt; <span class="delete">upVectorMountFrame.v[0</span></td><td> </td><td class="rblock">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">]</span> &lt;&lt; "/" &lt;&lt; upVectorMountFrame.v[1] &lt;&lt; "/" &lt;&lt; <span class="delete">upVectorMountFrame.v[2]</span> &lt;&lt; <span class="delete">"C</span></td><td> </td><td class="rblock">                        <span class="insert">//qDebug()</span> &lt;&lt; <span class="insert">"panView: UpVector:"</span> &lt;&lt; <span class="insert">upVectorMount</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">annot</span> recover azimuth. Hope it's OK";</td><td> </td><td class="rblock"><span class="insert">Frame.v[0]</span> &lt;&lt; "/" &lt;&lt; upVectorMountFrame.v[1] &lt;&lt; "/" &lt;&lt; <span class="insert">upVectorMountFrame.v</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">//</span>             }</td><td> </td><td class="rblock"><span class="insert">[2]</span> &lt;&lt; <span class="insert">"Cannot</span> recover azimuth. Hope it's OK";</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // if we are moving in the Azimuthal angle (left/right)</td><td> </td><td class="right">       // if we are moving in the Azimuthal angle (left/right)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (deltaAz)</td><td> </td><td class="right">       if (deltaAz)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               azVision-=deltaAz;</td><td> </td><td class="right">               azVision-=deltaAz;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (deltaAlt)</td><td> </td><td class="right">       if (deltaAlt)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0080" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               <span class="delete">if</span> (altVision+deltaAlt &lt;= M_PI_2 &amp;&amp; altVision+deltaAlt &gt;= <span class="delete">-M</span></td><td> </td><td class="rblock">               <span class="insert">//if</span> (altVision+deltaAlt &lt;= M_PI_2 &amp;&amp; altVision+deltaAlt &gt;= </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">_PI_2)</span> altVision+=deltaAlt;</td><td> </td><td class="rblock"><span class="insert">-M_PI_2)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               <span class="delete">if</span> (altVision+deltaAlt &gt; M_PI_2) altVision = M_PI_2 - <span class="delete">0.0000</span></td><td> </td><td class="rblock">                       altVision+=deltaAlt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">01;</span>         // Prevent <span class="delete">bug</span></td><td> </td><td class="rblock">               <span class="insert">//if</span> (altVision+deltaAlt &gt;  M_PI_2) altVision =  M_PI_2 - <span class="insert">0.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               if</span> (altVision+deltaAlt &lt; -M_PI_2) altVision = -M_PI_2 + <span class="delete">0.00</span></td><td> </td><td class="rblock"><span class="insert">000001;</span> // Prevent <span class="insert">bug: manual pans (keyboard or mouse!) can never really r</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">0001;</span>       // Prevent <span class="delete">bug</span></td><td> </td><td class="rblock"><span class="insert">each the zenith, but we can accept this.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               //if</span> (altVision+deltaAlt &lt; -M_PI_2) altVision = -M_PI_2 + <span class="insert">0.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">000001;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               if (altVision &gt;  M_PI_2) altVision =  M_PI_2 - 0.000001;</span> // </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">Prevent <span class="insert">bug: manual pans (keyboard or mouse!) can never really reach the ze</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">nith, but we can accept this.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               if (altVision &lt; -M_PI_2) altVision = -M_PI_2 + 0.000001;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // recalc all the position variables</td><td> </td><td class="right">       // recalc all the position variables</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (deltaAz || deltaAlt)</td><td> </td><td class="right">       if (deltaAz || deltaAlt)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               setFlagTracking(false);</td><td> </td><td class="right">               setFlagTracking(false);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               Vec3d tmp;</td><td> </td><td class="right">               Vec3d tmp;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               StelUtils::spheToRect(azVision, altVision, tmp);</td><td> </td><td class="right">               StelUtils::spheToRect(azVision, altVision, tmp);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               setViewDirectionJ2000(mountFrameToJ2000(tmp));</td><td> </td><td class="right">               setViewDirectionJ2000(mountFrameToJ2000(tmp));</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0081" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               setViewUpVector(Vec3d(0., 0., 1.)); <span class="delete">// We ensured above that</span></td><td> </td><td class="rblock">               <span class="insert">if (fabs(altVision)&gt;0.95*M_PI/2.)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"> view vector is never parallel to this simple up vector.</span></td><td> </td><td class="rblock"><span class="insert">               { // do something about zenith</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       setViewUpVector(Vec3d(-cos(azVision), -sin(azVision)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">, 0.) * (altVision&gt;0. ? 1. : -1. )); // 2016-12-14: WORKS AGAIN!</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               else</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               {</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                       setViewUpVector(Vec3d(0., 0., 1.));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">               <span class="insert">}</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0082" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">//<span class="delete">! Make the first screen position correspond to the second (useful for mou
s</span>e dragging)</td><td> </td><td class="rblock">//<span class="insert"> Make the first screen position correspond to the second (useful for mous
</span>e dragging)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void StelMovementMgr::dragView(int x1, int y1, int x2, int y2)</td><td> </td><td class="right">void StelMovementMgr::dragView(int x1, int y1, int x2, int y2)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (dragTimeMode)</td><td> </td><td class="right">       if (dragTimeMode)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               core-&gt;setTimeRate(0);</td><td> </td><td class="right">               core-&gt;setTimeRate(0);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               Vec3d v1, v2;</td><td> </td><td class="right">               Vec3d v1, v2;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               const StelProjectorP prj = core-&gt;getProjection(StelCore::Fra
meEquinoxEqu);</td><td> </td><td class="right">               const StelProjectorP prj = core-&gt;getProjection(StelCore::Fra
meEquinoxEqu);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               prj-&gt;unProject(x2,y2, v2);</td><td> </td><td class="right">               prj-&gt;unProject(x2,y2, v2);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               prj-&gt;unProject(x1,y1, v1);</td><td> </td><td class="right">               prj-&gt;unProject(x1,y1, v1);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               v1[2]=0; v1.normalize();</td><td> </td><td class="right">               v1[2]=0; v1.normalize();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l14" /><small>skipping to change at</small><em> line 1234</em></th><th> </th><th><a name="part-r14" /><small>skipping to change at</small><em> line 1357</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       {</td><td> </td><td class="right">                       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               case MountAltAzimuthal:</td><td> </td><td class="right">                               case MountAltAzimuthal:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       v = objectMgr-&gt;getSelectedObject()[0
]-&gt;getAltAzPosAuto(core);</td><td> </td><td class="right">                                       v = objectMgr-&gt;getSelectedObject()[0
]-&gt;getAltAzPosAuto(core);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       break;</td><td> </td><td class="right">                                       break;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               case MountEquinoxEquatorial:</td><td> </td><td class="right">                               case MountEquinoxEquatorial:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       v = objectMgr-&gt;getSelectedObject()[0
]-&gt;getEquinoxEquatorialPos(core);</td><td> </td><td class="right">                                       v = objectMgr-&gt;getSelectedObject()[0
]-&gt;getEquinoxEquatorialPos(core);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       break;</td><td> </td><td class="right">                                       break;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               case MountGalactic:</td><td> </td><td class="right">                               case MountGalactic:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       v = objectMgr-&gt;getSelectedObject()[0
]-&gt;getGalacticPos(core);</td><td> </td><td class="right">                                       v = objectMgr-&gt;getSelectedObject()[0
]-&gt;getGalacticPos(core);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       break;</td><td> </td><td class="right">                                       break;</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0083" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                               <span class="insert">case MountSupergalactic:</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                                       v = objectMgr-&gt;getSelectedObject()[0</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">]-&gt;getSupergalacticPos(core);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                                       break;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               default:</td><td> </td><td class="right">                               default:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       qWarning() &lt;&lt; "StelMovementMgr: unex
pected mountMode" &lt;&lt; mountMode;</td><td> </td><td class="right">                                       qWarning() &lt;&lt; "StelMovementMgr: unex
pected mountMode" &lt;&lt; mountMode;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       Q_ASSERT(0);</td><td> </td><td class="right">                                       Q_ASSERT(0);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       }</td><td> </td><td class="right">                       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       double lat, lon; // general: longitudinal, latitudin
al</td><td> </td><td class="right">                       double lat, lon; // general: longitudinal, latitudin
al</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       StelUtils::rectToSphe(&amp;lon, &amp;lat, v); // guaranteed 
to be normalized.</td><td> </td><td class="right">                       StelUtils::rectToSphe(&amp;lon, &amp;lat, v); // guaranteed 
to be normalized.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       // vUp could usually be (0/0/1) in most cases, unles
s |lat|==pi/2. We MUST build an adequate Up vector!</td><td> </td><td class="right">                       // vUp could usually be (0/0/1) in most cases, unles
s |lat|==pi/2. We MUST build an adequate Up vector!</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       if (fabs(lat)&gt;0.9*M_PI/2.0)</td><td> </td><td class="right">                       if (fabs(lat)&gt;0.9*M_PI/2.0)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       {</td><td> </td><td class="right">                       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l15" /><small>skipping to change at</small><em> line 1263</em></th><th> </th><th><a name="part-r15" /><small>skipping to change at</small><em> line 1389</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       {</td><td> </td><td class="right">                       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               move.aim=mountFrameToJ2000(v);</td><td> </td><td class="right">                               move.aim=mountFrameToJ2000(v);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               move.aim.normalize();</td><td> </td><td class="right">                               move.aim.normalize();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               move.aim*=2.;</td><td> </td><td class="right">                               move.aim*=2.;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               move.aimUp=mountFrameToJ2000(vUp);</td><td> </td><td class="right">                               move.aimUp=mountFrameToJ2000(vUp);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               move.aimUp.normalize();</td><td> </td><td class="right">                               move.aimUp.normalize();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       }</td><td> </td><td class="right">                       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       else</td><td> </td><td class="right">                       else</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       {</td><td> </td><td class="right">                       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               setViewDirectionJ2000(mountFrameToJ2000(v));</td><td> </td><td class="right">                               setViewDirectionJ2000(mountFrameToJ2000(v));</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0084" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                               //qDebug() &lt;&lt; "setViewUpVector L1340";</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               setViewUpVectorJ2000(mountFrameToJ2000(vUp))
;</td><td> </td><td class="right">                               setViewUpVectorJ2000(mountFrameToJ2000(vUp))
;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       }</td><td> </td><td class="right">                       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Zoom to the given field of view</td><td> </td><td class="right">// Zoom to the given field of view</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void StelMovementMgr::zoomTo(double aim_fov, float moveDuration)</td><td> </td><td class="right">void StelMovementMgr::zoomTo(double aim_fov, float moveDuration)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       moveDuration /= movementsSpeedFactor;</td><td> </td><td class="right">       moveDuration /= movementsSpeedFactor;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l16" /><small>skipping to change at</small><em> line 1319</em></th><th> </th><th><a name="part-r16" /><small>skipping to change at</small><em> line 1446</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       targetViewportOffset.set(offsetX, offsetY);</td><td> </td><td class="right">       targetViewportOffset.set(offsetX, offsetY);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if(offsetX != oldTargetViewportOffset[0])</td><td> </td><td class="right">       if(offsetX != oldTargetViewportOffset[0])</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               emit viewportHorizontalOffsetTargetChanged(offsetX);</td><td> </td><td class="right">               emit viewportHorizontalOffsetTargetChanged(offsetX);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if(offsetY != oldTargetViewportOffset[1])</td><td> </td><td class="right">       if(offsetY != oldTargetViewportOffset[1])</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               emit viewportVerticalOffsetTargetChanged(offsetY);</td><td> </td><td class="right">               emit viewportVerticalOffsetTargetChanged(offsetY);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (duration&lt;=0.0f)</td><td> </td><td class="right">       if (duration&lt;=0.0f)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               //avoid using the timeline to minimize overhead</td><td> </td><td class="right">               //avoid using the timeline to minimize overhead</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0085" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               <span class="delete">core-&gt;setViewportHorizontalOffset(targetViewportOffset[0]);</span></td><td> </td><td class="rblock">               <span class="insert">core-&gt;setViewportOffset(offsetX, offsetY);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               core-&gt;setViewportVerticalOffset(targetViewportOffset[1]);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               return;</td><td> </td><td class="right">               return;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // Frame will now be 0..100, and we must interpolate in handleViewpo
rtOffsetMovement(frame) between old and new offsets.</td><td> </td><td class="right">       // Frame will now be 0..100, and we must interpolate in handleViewpo
rtOffsetMovement(frame) between old and new offsets.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       oldViewportOffset.set(core-&gt;getViewportHorizontalOffset(), core-&gt;get
ViewportVerticalOffset());</td><td> </td><td class="right">       oldViewportOffset.set(core-&gt;getViewportHorizontalOffset(), core-&gt;get
ViewportVerticalOffset());</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       viewportOffsetTimeline-&gt;stop();</td><td> </td><td class="right">       viewportOffsetTimeline-&gt;stop();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       viewportOffsetTimeline-&gt;setDuration(1000.*duration);</td><td> </td><td class="right">       viewportOffsetTimeline-&gt;setDuration(1000.*duration);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       //qDebug() &lt;&lt; "moveViewport() started, from " &lt;&lt; oldViewportOffset.v
[0] &lt;&lt; "/" &lt;&lt; oldViewportOffset.v[1] &lt;&lt; " towards " &lt;&lt; offsetX &lt;&lt; "/" &lt;&lt; of
fsetY;</td><td> </td><td class="right">       //qDebug() &lt;&lt; "moveViewport() started, from " &lt;&lt; oldViewportOffset.v
[0] &lt;&lt; "/" &lt;&lt; oldViewportOffset.v[1] &lt;&lt; " towards " &lt;&lt; offsetX &lt;&lt; "/" &lt;&lt; of
fsetY;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       viewportOffsetTimeline-&gt;start();</td><td> </td><td class="right">       viewportOffsetTimeline-&gt;start();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// slot which is connected to the viewportOffsetTimeline and does the actua
l updates.</td><td> </td><td class="right">// slot which is connected to the viewportOffsetTimeline and does the actua
l updates.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void StelMovementMgr::handleViewportOffsetMovement(qreal value)</td><td> </td><td class="right">void StelMovementMgr::handleViewportOffsetMovement(qreal value)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // value is always 0...1</td><td> </td><td class="right">       // value is always 0...1</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       float offsetX=oldViewportOffset.v[0] + (targetViewportOffset.v[0]-ol
dViewportOffset.v[0])*value;</td><td> </td><td class="right">       float offsetX=oldViewportOffset.v[0] + (targetViewportOffset.v[0]-ol
dViewportOffset.v[0])*value;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       float offsetY=oldViewportOffset.v[1] + (targetViewportOffset.v[1]-ol
dViewportOffset.v[1])*value;</td><td> </td><td class="right">       float offsetY=oldViewportOffset.v[1] + (targetViewportOffset.v[1]-ol
dViewportOffset.v[1])*value;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       //qDebug() &lt;&lt; "handleViewportOffsetMovement(" &lt;&lt; value &lt;&lt; "): Settin
g viewport offset to " &lt;&lt; offsetX &lt;&lt; "/" &lt;&lt; offsetY;</td><td> </td><td class="right">       //qDebug() &lt;&lt; "handleViewportOffsetMovement(" &lt;&lt; value &lt;&lt; "): Settin
g viewport offset to " &lt;&lt; offsetX &lt;&lt; "/" &lt;&lt; offsetY;</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0086" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">core-&gt;setViewportHorizontalOffset(offsetX);</span></td><td> </td><td class="rblock">       <span class="insert">core-&gt;setViewportOffset(offsetX, offsetY);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       core-&gt;setViewportVerticalOffset(offsetY);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>

     <tr><td></td><td class="left"></td><td> </td><td class="right"></td><td></td></tr>
     <tr bgcolor="gray"><th colspan="5" align="center"><a name="end">&nbsp;End of changes. 86 change blocks.&nbsp;</a></th></tr>
     <tr class="stats"><td></td><th><i>141 lines changed or deleted</i></th><th><i> </i></th><th><i>313 lines changed or added</i></th><td></td></tr>
     <tr><td colspan="5" align="center" class="small"><br/>This html diff was produced by rfcdiff 1.41. The latest version is available from <a href="http://www.tools.ietf.org/tools/rfcdiff/" >http://tools.ietf.org/tools/rfcdiff/</a> </td></tr>
   </table>
   </body>
   </html>
