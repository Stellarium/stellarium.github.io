<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
<!-- Generated by rfcdiff 1.41: rfcdiff  --> 
<!-- <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional" > -->
<!-- System: Linux fomalhaut.local 3.13.0-38-generic #65-Ubuntu SMP Thu Oct 9 11:36:50 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux --> 
<!-- Using awk: /usr/bin/gawk: GNU Awk 4.0.1 --> 
<!-- Using diff: /usr/bin/diff: diff (GNU diffutils) 3.3 --> 
<!-- Using wdiff: /usr/bin/wdiff: wdiff (GNU wdiff) 1.2.1 --> 
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"> 
<head> 
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /> 
  <meta http-equiv="Content-Style-Type" content="text/css" /> 
  <title>Diff: StelUtils.cpp - StelUtils.cpp</title> 
  <style type="text/css"> 
    body    { font-size:16px; margin: 0.4ex; margin-right: auto; } 
    tr      { } 
    td      { white-space: pre; font-family: Consolas, "DejaVu Sans Mono", "Droid Sans Mono", Monaco, Monospace; vertical-align: top; font-size: 0.86em;} 
    th      { font-size: 0.86em; } 
    .small  { font-size: 0.6em; font-style: italic; font-family: Verdana, Helvetica, sans-serif; } 
    .left   { background-color: #EEE; } 
    .right  { background-color: #FFF; } 
    .diff   { background-color: #CCF; } 
    .lblock { background-color: #BFB; } 
    .rblock { background-color: #FF8; } 
    .insert { background-color: #8FF; } 
    .delete { background-color: #ACF; } 
    .void   { background-color: #FFB; } 
    .cont   { background-color: #EEE; } 
    .linebr { background-color: #AAA; } 
    .lineno { color: red; background-color: #FFF; font-size: 0.7em; text-align: right; padding: 0 2px; } 
    .elipsis{ background-color: #AAA; } 
    .left .cont { background-color: #DDD; } 
    .right .cont { background-color: #EEE; } 
    .lblock .cont { background-color: #9D9; } 
    .rblock .cont { background-color: #DD6; } 
    .insert .cont { background-color: #0DD; } 
    .delete .cont { background-color: #8AD; } 
    .stats, .stats td, .stats th { background-color: #EEE; padding: 2px 0; } 
  </style> 
</head> 
<body > 
  <table border="0" cellpadding="0" cellspacing="0"> 
  <tr bgcolor="orange"><th></th><th>&nbsp;StelUtils.cpp&nbsp;</th><th> </th><th>&nbsp;StelUtils.cpp&nbsp;</th><th></th></tr> 
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l1" /><small>skipping to change at</small><em> line 1115</em></th><th> </th><th><a name="part-r1" /><small>skipping to change at</small><em> line 1115</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// For the standard epochs for many formulae, we use</td><td> </td><td class="right">// For the standard epochs for many formulae, we use</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// J2000.0=2000-jan-1.5=2451545.0,</td><td> </td><td class="right">// J2000.0=2000-jan-1.5=2451545.0,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//  1900.0=1900-jan-0.5=2415020.0</td><td> </td><td class="right">//  1900.0=1900-jan-0.5=2415020.0</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//  1820.0=1820-jan-0.5=2385800.0</td><td> </td><td class="right">//  1820.0=1820-jan-0.5=2385800.0</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//  1810.0=1810-jan-0.5=2382148.0</td><td> </td><td class="right">//  1810.0=1810-jan-0.5=2382148.0</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//  1800.0=1800-jan-0.5=2378496.0</td><td> </td><td class="right">//  1800.0=1800-jan-0.5=2378496.0</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//  1735.0=1735-jan-0.5=2354755.0</td><td> </td><td class="right">//  1735.0=1735-jan-0.5=2354755.0</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//  1625.0=1625-jan-0.5=2314579.0</td><td> </td><td class="right">//  1625.0=1625-jan-0.5=2314579.0</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">*/</td><td> </td><td class="right">*/</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0001" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">double <span class="delete">decYear2DeltaT(const</span> double <span class="delete">y)</span></td><td> </td><td class="rblock"><span class="insert">// Implementation of algorithm by Espenak &amp; Meeus (2006) for DeltaT computa</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">tion</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">double <span class="insert">getDeltaTByEspenakMeeus(const</span> double <span class="insert">jDay)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0002" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       <span class="insert">int year, month, day;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       getDateFromJulianDay(jDay, &amp;year, &amp;month, &amp;day);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                           </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // Note: the method here is adapted from</td><td> </td><td class="right">       // Note: the method here is adapted from</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // "Five Millennium Canon of Solar Eclipses" [Espenak and Meeus, 200
6]</td><td> </td><td class="right">       // "Five Millennium Canon of Solar Eclipses" [Espenak and Meeus, 200
6]</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // A summary is described here:</td><td> </td><td class="right">       // A summary is described here:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // http://eclipse.gsfc.nasa.gov/SEhelp/deltatpoly2004.html</td><td> </td><td class="right">       // http://eclipse.gsfc.nasa.gov/SEhelp/deltatpoly2004.html</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // GZ: I replaced the std::pow() calls by Horner's scheme with rever
sed factors, it's more accurate and efficient.</td><td> </td><td class="right">       // GZ: I replaced the std::pow() calls by Horner's scheme with rever
sed factors, it's more accurate and efficient.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       //     Old code left for readability, but can also be deleted.</td><td> </td><td class="right">       //     Old code left for readability, but can also be deleted.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0003" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       <span class="insert">double y = year+((month-1)*30.5+day/31*30.5)/366;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                           </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // set the default value for Delta T</td><td> </td><td class="right">       // set the default value for Delta T</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double u = (y-1820)/100.;</td><td> </td><td class="right">       double u = (y-1820)/100.;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double r = (-20 + 32 * u * u);</td><td> </td><td class="right">       double r = (-20 + 32 * u * u);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (y &lt; -500)</td><td> </td><td class="right">       if (y &lt; -500)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               // values are equal to defaults!</td><td> </td><td class="right">               // values are equal to defaults!</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               // u = (y-1820)/100.;</td><td> </td><td class="right">               // u = (y-1820)/100.;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               // r = (-20 + 32 * u * u);</td><td> </td><td class="right">               // r = (-20 + 32 * u * u);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l2" /><small>skipping to change at</small><em> line 1220</em></th><th> </th><th><a name="part-r2" /><small>skipping to change at</small><em> line 1226</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       else if (y &lt; 2150)</td><td> </td><td class="right">       else if (y &lt; 2150)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               //r = (-20 + 32 * std::pow((y-1820)/100,2) - 0.5628 * (2150 
- y));</td><td> </td><td class="right">               //r = (-20 + 32 * std::pow((y-1820)/100,2) - 0.5628 * (2150 
- y));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               // r has been precomputed before, just add the term patching
 the discontinuity</td><td> </td><td class="right">               // r has been precomputed before, just add the term patching
 the discontinuity</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               r -= 0.5628*(2150.0-y);</td><td> </td><td class="right">               r -= 0.5628*(2150.0-y);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return r;</td><td> </td><td class="right">       return r;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0004" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">// Implementation of algorithm by Espenak &amp; Meeus (2006) for DeltaT computa</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">tion</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">double getDeltaTByEspenakMeeus(const double jDay)</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">{</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       int year, month, day;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       getDateFromJulianDay(jDay, &amp;year, &amp;month, &amp;day);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       // approximate "decimal year" = year + (month - 0.5)/12</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       //return decYear2DeltaT(year + (month - 0.5)/12);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       return decYear2DeltaT(year+((month-1)*30.5+day/31*30.5)/366);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">}</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                           </td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Implementation of algorithm by Schoch (1931) for DeltaT computation</td><td> </td><td class="right">// Implementation of algorithm by Schoch (1931) for DeltaT computation</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">double getDeltaTBySchoch(const double jDay)</td><td> </td><td class="right">double getDeltaTBySchoch(const double jDay)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double u=(jDay-2378496.0)/36525.0; // (1800-jan-0.5)</td><td> </td><td class="right">       double u=(jDay-2378496.0)/36525.0; // (1800-jan-0.5)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return -36.28 + 36.28*std::pow(u,2);</td><td> </td><td class="right">       return -36.28 + 36.28*std::pow(u,2);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Implementation of algorithm by Clemence (1948) for DeltaT computation</td><td> </td><td class="right">// Implementation of algorithm by Clemence (1948) for DeltaT computation</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">double getDeltaTByClemence(const double jDay)</td><td> </td><td class="right">double getDeltaTByClemence(const double jDay)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double u=(jDay-2415020.0)/36525.0; // (1900-jan-0.5)</td><td> </td><td class="right">       double u=(jDay-2415020.0)/36525.0; // (1900-jan-0.5)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return +8.72 + 26.75*u + 11.22*std::pow(u,2);</td><td> </td><td class="right">       return +8.72 + 26.75*u + 11.22*std::pow(u,2);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Implementation of algorithm by IAU (1952) for DeltaT computation</td><td> </td><td class="right">// Implementation of algorithm by IAU (1952) for DeltaT computation</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">double getDeltaTByIAU(const double jDay)</td><td> </td><td class="right">double getDeltaTByIAU(const double jDay)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double u=(jDay-2415020.0)/36525.0; // (1900-jan-0.5)</td><td> </td><td class="right">       double u=(jDay-2415020.0)/36525.0; // (1900-jan-0.5)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // TODO: Calculate Moon's longitude fluctuation</td><td> </td><td class="right">       // TODO: Calculate Moon's longitude fluctuation</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0005" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       return (29.9<span class="delete">49*u +72.3165)*u +24.349 /* + 1.821*b</span>*/ ;</td><td> </td><td class="rblock">       return (29.9<span class="insert">50*u +72.318)*u +24.349 /* + 1.82144*b </span>*/ ;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Implementation of algorithm by Astronomical Ephemeris (1960) for DeltaT 
computation, also used by Mucke&amp;Meeus, Canon of Solar Eclipses, Vienna 1983</td><td> </td><td class="right">// Implementation of algorithm by Astronomical Ephemeris (1960) for DeltaT 
computation, also used by Mucke&amp;Meeus, Canon of Solar Eclipses, Vienna 1983</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">double getDeltaTByAstronomicalEphemeris(const double jDay)</td><td> </td><td class="right">double getDeltaTByAstronomicalEphemeris(const double jDay)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double u=(jDay-2415020.0)/36525.0; // (1900-jan-0.5)</td><td> </td><td class="right">       double u=(jDay-2415020.0)/36525.0; // (1900-jan-0.5)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // TODO: Calculate Moon's longitude fluctuation</td><td> </td><td class="right">       // TODO: Calculate Moon's longitude fluctuation</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // Note: also Mucke&amp;Meeus 1983 ignore b</td><td> </td><td class="right">       // Note: also Mucke&amp;Meeus 1983 ignore b</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0006" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       return (29.9<span class="delete">50*u +72.318)*u +24.349 /* + 1.82144*b </span>*/ ;</td><td> </td><td class="rblock">       return (29.9<span class="insert">49*u +72.3165)*u +24.349 /* + 1.821*b</span>*/ ;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Implementation of algorithm by Tuckerman (1962, 1964) &amp; Goldstine (1973)
 for DeltaT computation</td><td> </td><td class="right">// Implementation of algorithm by Tuckerman (1962, 1964) &amp; Goldstine (1973)
 for DeltaT computation</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">double getDeltaTByTuckermanGoldstine(const double jDay)</td><td> </td><td class="right">double getDeltaTByTuckermanGoldstine(const double jDay)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double u=(jDay-2415020.0)/36525.0; // (1900-jan-0.5)</td><td> </td><td class="right">       double u=(jDay-2415020.0)/36525.0; // (1900-jan-0.5)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return (36.79*u +35.06)*u + 4.87;</td><td> </td><td class="right">       return (36.79*u +35.06)*u + 4.87;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Implementation of algorithm by Muller &amp; Stephenson (1975) for DeltaT com
putation</td><td> </td><td class="right">// Implementation of algorithm by Muller &amp; Stephenson (1975) for DeltaT com
putation</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l3" /><small>skipping to change at</small><em> line 1316</em></th><th> </th><th><a name="part-r3" /><small>skipping to change at</small><em> line 1311</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Implementation of algorithm by Stephenson &amp; Morrison (1984) for DeltaT c
omputation</td><td> </td><td class="right">// Implementation of algorithm by Stephenson &amp; Morrison (1984) for DeltaT c
omputation</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">double getDeltaTByStephensonMorrison1984(const double jDay)</td><td> </td><td class="right">double getDeltaTByStephensonMorrison1984(const double jDay)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       int year, month, day;</td><td> </td><td class="right">       int year, month, day;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double deltaT = 0.;</td><td> </td><td class="right">       double deltaT = 0.;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       getDateFromJulianDay(jDay, &amp;year, &amp;month, &amp;day);</td><td> </td><td class="right">       getDateFromJulianDay(jDay, &amp;year, &amp;month, &amp;day);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double yeardec=year+((month-1)*30.5+day/31*30.5)/366;</td><td> </td><td class="right">       double yeardec=year+((month-1)*30.5+day/31*30.5)/366;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double u = (yeardec-1800)/100;</td><td> </td><td class="right">       double u = (yeardec-1800)/100;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0007" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       if (-391 &lt; year <span class="delete">and</span> year &lt;= 948)</td><td> </td><td class="rblock">       if (-391 &lt; year <span class="insert">&amp;&amp;</span> year &lt;= 948)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               deltaT = (44.3*u +320.0)*u +1360.0;</td><td> </td><td class="right">               deltaT = (44.3*u +320.0)*u +1360.0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0008" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       if (948 &lt; year <span class="delete">and</span> year &lt;= 1600)</td><td> </td><td class="rblock">       if (948 &lt; year <span class="insert">&amp;&amp;</span> year &lt;= 1600)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               deltaT = 25.5*u*u;</td><td> </td><td class="right">               deltaT = 25.5*u*u;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return deltaT;</td><td> </td><td class="right">       return deltaT;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Implementation of algorithm by Stephenson &amp; Morrison (1995) for DeltaT c
omputation</td><td> </td><td class="right">// Implementation of algorithm by Stephenson &amp; Morrison (1995) for DeltaT c
omputation</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">double getDeltaTByStephensonMorrison1995(const double jDay)</td><td> </td><td class="right">double getDeltaTByStephensonMorrison1995(const double jDay)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double u=(jDay-2385800.0)/36525.0; // (1820-jan-0.5)</td><td> </td><td class="right">       double u=(jDay-2385800.0)/36525.0; // (1820-jan-0.5)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return -20.0 + 31.0*u*u;</td><td> </td><td class="right">       return -20.0 + 31.0*u*u;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l4" /><small>skipping to change at</small><em> line 1344</em></th><th> </th><th><a name="part-r4" /><small>skipping to change at</small><em> line 1339</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       int year, month, day;</td><td> </td><td class="right">       int year, month, day;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double u;</td><td> </td><td class="right">       double u;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double deltaT = 0.;</td><td> </td><td class="right">       double deltaT = 0.;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       getDateFromJulianDay(jDay, &amp;year, &amp;month, &amp;day);</td><td> </td><td class="right">       getDateFromJulianDay(jDay, &amp;year, &amp;month, &amp;day);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double yeardec=year+((month-1)*30.5+day/31*30.5)/366;</td><td> </td><td class="right">       double yeardec=year+((month-1)*30.5+day/31*30.5)/366;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (year &lt;= 948)</td><td> </td><td class="right">       if (year &lt;= 948)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               u = (yeardec-948)/100;</td><td> </td><td class="right">               u = (yeardec-948)/100;</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0009" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               deltaT = (46.5*u -405.0)*u + 1830.0;<span class="delete"> // GZ: TODO: merge conf
lict, did I mess orig -405-&gt;+405? Or AW?</span></td><td> </td><td class="rblock">               deltaT = (46.5*u -405.0)*u + 1830.0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0010" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       if (948 &lt; year <span class="delete">and</span> year &lt;= 1600)</td><td> </td><td class="rblock">       if (948 &lt; year <span class="insert">&amp;&amp;</span> year &lt;= 1600)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               u = (yeardec-1850)/100;</td><td> </td><td class="right">               u = (yeardec-1850)/100;</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0011" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               deltaT = 2<span class="delete">5</span>.5*u*u;</td><td> </td><td class="rblock">               deltaT = 2<span class="insert">2</span>.5*u*u;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return deltaT;</td><td> </td><td class="right">       return deltaT;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Implementation of algorithm by Espenak (1987, 1989) for DeltaT computati
on</td><td> </td><td class="right">// Implementation of algorithm by Espenak (1987, 1989) for DeltaT computati
on</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">double getDeltaTByEspenak(const double jDay)</td><td> </td><td class="right">double getDeltaTByEspenak(const double jDay)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double u=(jDay-2451545.0)/36525.0; // (2000-jan-1.5)</td><td> </td><td class="right">       double u=(jDay-2451545.0)/36525.0; // (2000-jan-1.5)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return (64.3*u +61.0)*u +67.0;</td><td> </td><td class="right">       return (64.3*u +61.0)*u +67.0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l5" /><small>skipping to change at</small><em> line 1387</em></th><th> </th><th><a name="part-r5" /><small>skipping to change at</small><em> line 1382</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Implementation of algorithm by Chapront-Touzé &amp; Chapront (1991) for Delt
aT computation</td><td> </td><td class="right">// Implementation of algorithm by Chapront-Touzé &amp; Chapront (1991) for Delt
aT computation</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">double getDeltaTByChaprontTouze(const double jDay)</td><td> </td><td class="right">double getDeltaTByChaprontTouze(const double jDay)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       int year, month, day;</td><td> </td><td class="right">       int year, month, day;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double deltaT = 0.;</td><td> </td><td class="right">       double deltaT = 0.;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       getDateFromJulianDay(jDay, &amp;year, &amp;month, &amp;day);</td><td> </td><td class="right">       getDateFromJulianDay(jDay, &amp;year, &amp;month, &amp;day);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double u=(jDay-2451545.0)/36525.0; // (2000-jan-1.5)</td><td> </td><td class="right">       double u=(jDay-2451545.0)/36525.0; // (2000-jan-1.5)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0012" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       if (-391 &lt; year <span class="delete">and</span> year &lt;= 948)</td><td> </td><td class="rblock">       if (-391 &lt; year <span class="insert">&amp;&amp;</span> year &lt;= 948)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               deltaT = (42.4*u <span class="delete">-495.0)*u</span> + 2177.0;</td><td> </td><td class="rblock">               deltaT = (42.4*u <span class="insert">+495.0)*u</span> + 2177.0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       if (948 &lt; year <span class="delete">and</span> year &lt;= 1600)</td><td> </td><td class="rblock">       if (948 &lt; year <span class="insert">&amp;&amp;</span> year &lt;= 1600)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               deltaT = (23.6*u +100.0)*u + 102.0;</td><td> </td><td class="right">               deltaT = (23.6*u +100.0)*u + 102.0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return deltaT;</td><td> </td><td class="right">       return deltaT;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Implementation of algorithm by JPL Horizons for DeltaT computation</td><td> </td><td class="right">// Implementation of algorithm by JPL Horizons for DeltaT computation</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">double getDeltaTByJPLHorizons(const double jDay)</td><td> </td><td class="right">double getDeltaTByJPLHorizons(const double jDay)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{ // GZ: TODO: FIXME! It does not make sense to have zeros after 1620 in a 
JPL Horizons compatible implementation!</td><td> </td><td class="right">{ // GZ: TODO: FIXME! It does not make sense to have zeros after 1620 in a 
JPL Horizons compatible implementation!</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       int year, month, day;</td><td> </td><td class="right">       int year, month, day;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double u;</td><td> </td><td class="right">       double u;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double deltaT = 0.;</td><td> </td><td class="right">       double deltaT = 0.;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       getDateFromJulianDay(jDay, &amp;year, &amp;month, &amp;day);</td><td> </td><td class="right">       getDateFromJulianDay(jDay, &amp;year, &amp;month, &amp;day);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0013" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       if (-2999 &lt; year <span class="delete">and</span> year &lt; 948)</td><td> </td><td class="rblock">       if (-2999 &lt; year <span class="insert">&amp;&amp;</span> year &lt; 948)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               u=(jDay-2385800.0)/36525.0; // (1820-jan-1.5)</td><td> </td><td class="right">               u=(jDay-2385800.0)/36525.0; // (1820-jan-1.5)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               deltaT = 31.0*u*u;</td><td> </td><td class="right">               deltaT = 31.0*u*u;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0014" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       if (948 &lt; year <span class="delete">and</span> year &lt;= 1620)</td><td> </td><td class="rblock">       if (948 &lt; year <span class="insert">&amp;&amp;</span> year &lt;= 1620)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               u=(jDay-2451545.0)/36525.0; // (2000-jan-1.5)</td><td> </td><td class="right">               u=(jDay-2451545.0)/36525.0; // (2000-jan-1.5)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               deltaT = (22.5*u +67.5)*u + 50.6;</td><td> </td><td class="right">               deltaT = (22.5*u +67.5)*u + 50.6;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return deltaT;</td><td> </td><td class="right">       return deltaT;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Implementation of algorithm by Morrison &amp; Stephenson (2004, 2005) for De
ltaT computation</td><td> </td><td class="right">// Implementation of algorithm by Morrison &amp; Stephenson (2004, 2005) for De
ltaT computation</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">double getDeltaTByMorrisonStephenson2004(const double jDay)</td><td> </td><td class="right">double getDeltaTByMorrisonStephenson2004(const double jDay)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l6" /><small>skipping to change at</small><em> line 1544</em></th><th> </th><th><a name="part-r6" /><small>skipping to change at</small><em> line 1539</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       else if (year &lt; 1770)</td><td> </td><td class="right">       else if (year &lt; 1770)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               u = 2.70 + ub;</td><td> </td><td class="right">               u = 2.70 + ub;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               //deltaT = +10.2 + 11.3*u - std::pow(u,2) - 16.0*std::pow(u,
3) + 70.0*std::pow(u,4);</td><td> </td><td class="right">               //deltaT = +10.2 + 11.3*u - std::pow(u,2) - 16.0*std::pow(u,
3) + 70.0*std::pow(u,4);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               deltaT = (((70.0*u -16.0)*u -1.0)*u +11.3)*u +10.2;</td><td> </td><td class="right">               deltaT = (((70.0*u -16.0)*u -1.0)*u +11.3)*u +10.2;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       else if (year &lt; 1820)</td><td> </td><td class="right">       else if (year &lt; 1820)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               u = 2.05 + ub;</td><td> </td><td class="right">               u = 2.05 + ub;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               //deltaT = +14.7 - 18.8*u - 22.0*std::pow(u,2) + 173.0*std::
pow(u,3) + 6.0*std::pow(u,4);</td><td> </td><td class="right">               //deltaT = +14.7 - 18.8*u - 22.0*std::pow(u,2) + 173.0*std::
pow(u,3) + 6.0*std::pow(u,4);</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0015" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               deltaT = (((6.0*u <span class="delete">-</span>173.0)*u -22.0)*u -18.8)*u +14.7;</td><td> </td><td class="rblock">               deltaT = (((6.0*u <span class="insert">+</span>173.0)*u -22.0)*u -18.8)*u +14.7;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       else if (year &lt; 1870)</td><td> </td><td class="right">       else if (year &lt; 1870)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               u = 1.55 + ub;</td><td> </td><td class="right">               u = 1.55 + ub;</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0016" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               //deltaT = +5.7 + 12.7*u + 111.0*std::pow(u,2) - 534.0*std::</td><td> </td><td class="rblock">               //deltaT = +5.7 + 12.7*u + 111.0*std::pow(u,2) - 534.0*std::</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">pow(u,3) <span class="delete">+</span> 1654.0*std::pow(u,4);</td><td> </td><td class="rblock">pow(u,3) <span class="insert">-</span> 1654.0*std::pow(u,4);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               deltaT = <span class="delete">(((1654.0*u</span> -534.0)*u +111)*u +12.7)*u +5.7;</td><td> </td><td class="rblock">               deltaT = <span class="insert">(((-1654.0*u</span> -534.0)*u +111)*u +12.7)*u +5.7;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       else if (year &lt; 1900)</td><td> </td><td class="right">       else if (year &lt; 1900)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               u = 1.15 + ub;</td><td> </td><td class="right">               u = 1.15 + ub;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               //deltaT = -5.8 - 14.6*u + 27.0*std::pow(u,2) + 101.0*std::p
ow(u,3) + 8234.0*std::pow(u,4);</td><td> </td><td class="right">               //deltaT = -5.8 - 14.6*u + 27.0*std::pow(u,2) + 101.0*std::p
ow(u,3) + 8234.0*std::pow(u,4);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               deltaT = (((8234.0*u +101.0)*u +27.0)*u - 14.6)*u -5.8;</td><td> </td><td class="right">               deltaT = (((8234.0*u +101.0)*u +27.0)*u - 14.6)*u -5.8;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       else if (year &lt; 1940)</td><td> </td><td class="right">       else if (year &lt; 1940)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               u = 0.80 + ub;</td><td> </td><td class="right">               u = 0.80 + ub;</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0017" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               //deltaT = +21.4 + 67.0*u <span class="delete">+</span> 443.0*std::pow(u,2) + 19.0*std::</td><td> </td><td class="rblock">               //deltaT = +21.4 + 67.0*u <span class="insert">-</span> 443.0*std::pow(u,2) + 19.0*std::</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">pow(u,3) + 4441.0*std::pow(u,4);</td><td> </td><td class="rblock">pow(u,3) + 4441.0*std::pow(u,4);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               deltaT = (((4441.0*u + 19.0)*u <span class="delete">+443.0)*u</span> +67.0)*u +21.4;</td><td> </td><td class="rblock">               deltaT = (((4441.0*u + 19.0)*u <span class="insert">-443.0)*u</span> +67.0)*u +21.4;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       else if (year &lt; 1990)</td><td> </td><td class="right">       else if (year &lt; 1990)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               u = 0.35 + ub;</td><td> </td><td class="right">               u = 0.35 + ub;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               //deltaT = +36.2 + 74.0*u + 189.0*std::pow(u,2) - 140.0*std:
:pow(u,3) - 1883.0*std::pow(u,4);</td><td> </td><td class="right">               //deltaT = +36.2 + 74.0*u + 189.0*std::pow(u,2) - 140.0*std:
:pow(u,3) - 1883.0*std::pow(u,4);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               deltaT = (((-1883.0*u -140.0)*u +189.0)*u +74.0)*u +36.2;</td><td> </td><td class="right">               deltaT = (((-1883.0*u -140.0)*u +189.0)*u +74.0)*u +36.2;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       else if (year &lt;= 2000)</td><td> </td><td class="right">       else if (year &lt;= 2000)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               u = 0.05 + ub;</td><td> </td><td class="right">               u = 0.05 + ub;</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0018" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               //deltaT = +60.8 + 82.0*u <span class="delete">+</span> 188.0*std::pow(u,2) - 5034.0*std</td><td> </td><td class="rblock">               //deltaT = +60.8 + 82.0*u <span class="insert">-</span> 188.0*std::pow(u,2) - 5034.0*std</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">::pow(u,3);</td><td> </td><td class="rblock">::pow(u,3);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               deltaT = ((-5034.0*u <span class="delete">+188.0)*u</span> +82.0)*u +60.8;</td><td> </td><td class="rblock">               deltaT = ((-5034.0*u <span class="insert">-188.0)*u</span> +82.0)*u +60.8;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return deltaT;</td><td> </td><td class="right">       return deltaT;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Implementation of algorithm by Reingold &amp; Dershowitz (Cal. Calc. 1997, 2
001, 2007, Cal. Tab. 2002) for DeltaT computation.</td><td> </td><td class="right">// Implementation of algorithm by Reingold &amp; Dershowitz (Cal. Calc. 1997, 2
001, 2007, Cal. Tab. 2002) for DeltaT computation.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// GZ: Created as yet another multi-segment polynomial fit through the tabl
e in Meeus: Astronomical Algorithms (1991).</td><td> </td><td class="right">// GZ: Created as yet another multi-segment polynomial fit through the tabl
e in Meeus: Astronomical Algorithms (1991).</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// GZ: Note that only the Third edition (2007) adds the 1700-1799 term.</td><td> </td><td class="right">// GZ: Note that only the Third edition (2007) adds the 1700-1799 term.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// GZ: More efficient reimplementation with stricter adherence to the sourc
e.</td><td> </td><td class="right">// GZ: More efficient reimplementation with stricter adherence to the sourc
e.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">double getDeltaTByReingoldDershowitz(const double jDay)</td><td> </td><td class="right">double getDeltaTByReingoldDershowitz(const double jDay)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l7" /><small>skipping to change at</small><em> line 1621</em></th><th> </th><th><a name="part-r7" /><small>skipping to change at</small><em> line 1616</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       deltaT = (((((((-0.212591*c +0.677066)*c -0.861938)*
c +0.553040)*c -0.181133)*c +0.025184)*c +0.000297)*c -0.00002) * 86400.0;</td><td> </td><td class="right">                       deltaT = (((((((-0.212591*c +0.677066)*c -0.861938)*
c +0.553040)*c -0.181133)*c +0.025184)*c +0.000297)*c -0.00002) * 86400.0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               else //if (year &gt;= 1800)</td><td> </td><td class="right">               else //if (year &gt;= 1800)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       deltaT = ((((((((((2.043794*c +11.636204)*c +28.3162
89)*c +38.291999)*c +31.332267)*c +15.845535)*c +4.867575)*c +0.865736)*c +
0.083563)*c +0.003844)*c -0.000009) * 86400.0;</td><td> </td><td class="right">                       deltaT = ((((((((((2.043794*c +11.636204)*c +28.3162
89)*c +38.291999)*c +31.332267)*c +15.845535)*c +4.867575)*c +0.865736)*c +
0.083563)*c +0.003844)*c -0.000009) * 86400.0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       else if (year &gt;= 1700)</td><td> </td><td class="right">       else if (year &gt;= 1700)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       { // This term was added in the third edition (2007), its omission w
as a fault of the authors!</td><td> </td><td class="right">       { // This term was added in the third edition (2007), its omission w
as a fault of the authors!</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               double yDiff1700 = year-1700.0;</td><td> </td><td class="right">               double yDiff1700 = year-1700.0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0019" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               deltaT = ((-0.0000266484*yDiff1700 +0.003336121)*yDiff1700 <span class="delete">+</span>
 0.005092142)*yDiff1700 + 8.118780842;</td><td> </td><td class="rblock">               deltaT = ((-0.0000266484*yDiff1700 +0.003336121)*yDiff1700 <span class="insert">-</span>
 0.005092142)*yDiff1700 + 8.118780842;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       else if (year &gt;= 1620)</td><td> </td><td class="right">       else if (year &gt;= 1620)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               double yDiff1600 = year-1600.0;</td><td> </td><td class="right">               double yDiff1600 = year-1600.0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               deltaT = (0.0219167*yDiff1600 -4.0675)*yDiff1600 +196.58333;</td><td> </td><td class="right">               deltaT = (0.0219167*yDiff1600 -4.0675)*yDiff1600 +196.58333;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return deltaT;</td><td> </td><td class="right">       return deltaT;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0020" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">// Implementation of algorithm by Banjevic (2006) for DeltaT computation.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">double getDeltaTByBanjevic(const double jDay)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">{</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       int year, month, day;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       getDateFromJulianDay(jDay, &amp;year, &amp;month, &amp;day);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       double u, c;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       if (year&gt;=-2020 &amp;&amp; year&lt;=-700)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       {</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               u = (jDay-2378496.0)/36525.0; // 1800.0=1800-jan-0.5=2378496</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">.0</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               c = 30.86;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       else if (year&gt;-700 &amp;&amp; year&lt;=1620)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       {</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               u = (jDay-2385800.0)/36525.0; // 1820.0=1820-jan-0.5=2385800</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">.0</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               c = 31;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       else</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       {</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               u = 0.;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               c = 0.;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       return c*u*u;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">}</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">// Implementation of algorithm by Islam, Sadiq &amp; Qureshi (2008 + revisited </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">2013) for DeltaT computation.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">double getDeltaTByIslamSadiqQureshi(const double jDay)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">{</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       int year, month, day;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       getDateFromJulianDay(jDay, &amp;year, &amp;month, &amp;day);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       double deltaT = 0.0; // Return deltaT = 0 outside valid range.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       double u;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       const double ub=(jDay-2454101.0)/36525.0; // (2007-jan-0.5)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       if (year &gt;= 1620 &amp;&amp; year &lt;= 1698)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       {</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               u = 3.48 + ub;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               deltaT = (((1162.805 * u - 273.116) * u + 14.523) * u - 105.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">262) * u + 38.067;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       else if (year &lt;= 1806)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       {</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               u = 2.545 + ub;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               deltaT = (((-71.724 * u - 39.048) * u + 7.591) * u + 13.893)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"> * u + 13.759;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       else if (year &lt;= 1872)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       {</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               u = 1.675 + ub;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               deltaT = (((-1612.55 * u - 157.977) * u + 161.524) * u - 3.6</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">54) * u + 5.859;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       else if (year &lt;= 1906)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       {</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               u = 1.175 + ub;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               deltaT = (((6250.501 * u + 1006.463) * u + 139.921) * u - 2.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">732) * u - 6.203;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       else if (year &lt;= 1953)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       {</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               // revised 2013 per email</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               u = 0.77 + ub;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               deltaT = (((-390.785 * u + 901.514) * u - 88.044) * u + 8.99</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">7) * u + 24.006;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       else if (year &lt;= 2007)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       {</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               // revised 2013 per email</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               u = 0.265 + ub;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               deltaT = (((1314.759 * u - 296.018) * u - 101.898) * u + 88.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">659) * u + 49.997;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       return deltaT;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">}</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                           </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">double getMoonSecularAcceleration(const double jDay, const double nd)</td><td> </td><td class="right">double getMoonSecularAcceleration(const double jDay, const double nd)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       int year, month, day;</td><td> </td><td class="right">       int year, month, day;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       getDateFromJulianDay(jDay, &amp;year, &amp;month, &amp;day);</td><td> </td><td class="right">       getDateFromJulianDay(jDay, &amp;year, &amp;month, &amp;day);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double yeardec=year+((month-1)*30.5+day/31*30.5)/366.0;</td><td> </td><td class="right">       double yeardec=year+((month-1)*30.5+day/31*30.5)/366.0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double t = (yeardec-1955.5)/100.0;</td><td> </td><td class="right">       double t = (yeardec-1955.5)/100.0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // n.dot for secular acceleration of the Moon in ELP2000-82B</td><td> </td><td class="right">       // n.dot for secular acceleration of the Moon in ELP2000-82B</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // have value -23.8946 "/cy/cy</td><td> </td><td class="right">       // have value -23.8946 "/cy/cy</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return -0.91072 * (-23.8946 + std::abs(nd))*t*t;</td><td> </td><td class="right">       return -0.91072 * (-23.8946 + std::abs(nd))*t*t;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">double getDeltaTStandardError(const double jDay)</td><td> </td><td class="right">double getDeltaTStandardError(const double jDay)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       int year, month, day;</td><td> </td><td class="right">       int year, month, day;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       getDateFromJulianDay(jDay, &amp;year, &amp;month, &amp;day);</td><td> </td><td class="right">       getDateFromJulianDay(jDay, &amp;year, &amp;month, &amp;day);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       //double yeardec=year+((month-1)*30.5+day/31*30.5)/366;</td><td> </td><td class="right">       //double yeardec=year+((month-1)*30.5+day/31*30.5)/366;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double sigma = -1.;</td><td> </td><td class="right">       double sigma = -1.;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0021" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       if (-1000 &lt;= year <span class="delete">and</span> year &lt;= 1600)</td><td> </td><td class="rblock">       if (-1000 &lt;= year <span class="insert">&amp;&amp;</span> year &lt;= 1600)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               double cDiff1820= (jDay-2385800.0)/36525.0; //    1820.0=182
0-jan-0.5=2385800.0</td><td> </td><td class="right">               double cDiff1820= (jDay-2385800.0)/36525.0; //    1820.0=182
0-jan-0.5=2385800.0</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               // sigma = std::pow((yeardec-1820.0)/100,2); // sigma(DeltaT
) = 0.8*u^2</td><td> </td><td class="right">               // sigma = std::pow((yeardec-1820.0)/100,2); // sigma(DeltaT
) = 0.8*u^2</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               sigma = 0.8 * cDiff1820 * cDiff1820;</td><td> </td><td class="right">               sigma = 0.8 * cDiff1820 * cDiff1820;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return sigma;</td><td> </td><td class="right">       return sigma;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">} // end of the StelUtils namespace</td><td> </td><td class="right">} // end of the StelUtils namespace</td><td class="lineno" valign="top"></td></tr>

     <tr><td></td><td class="left"></td><td> </td><td class="right"></td><td></td></tr>
     <tr bgcolor="gray"><th colspan="5" align="center"><a name="end">&nbsp;End of changes. 21 change blocks.&nbsp;</a></th></tr>
     <tr class="stats"><td></td><th><i>37 lines changed or deleted</i></th><th><i> </i></th><th><i>112 lines changed or added</i></th><td></td></tr>
     <tr><td colspan="5" align="center" class="small"><br/>This html diff was produced by rfcdiff 1.41. The latest version is available from <a href="http://www.tools.ietf.org/tools/rfcdiff/" >http://tools.ietf.org/tools/rfcdiff/</a> </td></tr>
   </table>
   </body>
   </html>
