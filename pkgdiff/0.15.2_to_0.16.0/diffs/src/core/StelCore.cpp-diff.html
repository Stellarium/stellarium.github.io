<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
<!-- Generated by rfcdiff 1.41: rfcdiff  --> 
<!-- <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional" > -->
<!-- System: Linux fomalhaut.home 4.4.0-80-generic #101-Ubuntu SMP Thu Jun 8 15:35:06 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux --> 
<!-- Using awk: /usr/bin/gawk: GNU Awk 4.1.3, API: 1.1 (GNU MPFR 3.1.4, GNU MP 6.1.0) --> 
<!-- Using diff: /usr/bin/diff: diff (GNU diffutils) 3.3 --> 
<!-- Using wdiff: /usr/bin/wdiff: wdiff (GNU wdiff) 1.2.2 --> 
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"> 
<head> 
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 
  <meta http-equiv="Content-Style-Type" content="text/css" /> 
  <title>Diff: StelCore.cpp - StelCore.cpp</title> 
  <style type="text/css"> 
    body    { font-size:16px; margin: 0.4ex; margin-right: auto; } 
    tr      { } 
    td      { white-space: pre; font-family: Consolas, "DejaVu Sans Mono", "Droid Sans Mono", Monaco, Monospace; vertical-align: top; font-size: 0.86em;} 
    th      { font-size: 0.86em; } 
    .small  { font-size: 0.6em; font-style: italic; font-family: Verdana, Helvetica, sans-serif; } 
    .left   { background-color: #EEE; } 
    .right  { background-color: #FFF; } 
    .diff   { background-color: #CCF; } 
    .lblock { background-color: #BFB; } 
    .rblock { background-color: #FF8; } 
    .insert { background-color: #8FF; } 
    .delete { background-color: #ACF; } 
    .void   { background-color: #FFB; } 
    .cont   { background-color: #EEE; } 
    .linebr { background-color: #AAA; } 
    .lineno { color: red; background-color: #FFF; font-size: 0.7em; text-align: right; padding: 0 2px; } 
    .elipsis{ background-color: #AAA; } 
    .left .cont { background-color: #DDD; } 
    .right .cont { background-color: #EEE; } 
    .lblock .cont { background-color: #9D9; } 
    .rblock .cont { background-color: #DD6; } 
    .insert .cont { background-color: #0DD; } 
    .delete .cont { background-color: #8AD; } 
    .stats, .stats td, .stats th { background-color: #EEE; padding: 2px 0; } 
  </style> 
</head> 
<body > 
  <table border="0" cellpadding="0" cellspacing="0"> 
  <tr bgcolor="orange"><th></th><th>&nbsp;StelCore.cpp&nbsp;</th><th> </th><th>&nbsp;StelCore.cpp&nbsp;</th><th></th></tr> 
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l1" /><small>skipping to change at</small><em> line 42</em></th><th> </th><th><a name="part-r1" /><small>skipping to change at</small><em> line 42</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#include "StelLocationMgr.hpp"</td><td> </td><td class="right">#include "StelLocationMgr.hpp"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#include "StelObserver.hpp"</td><td> </td><td class="right">#include "StelObserver.hpp"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#include "StelObjectMgr.hpp"</td><td> </td><td class="right">#include "StelObjectMgr.hpp"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#include "Planet.hpp"</td><td> </td><td class="right">#include "Planet.hpp"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#include "SolarSystem.hpp"</td><td> </td><td class="right">#include "SolarSystem.hpp"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#include "LandscapeMgr.hpp"</td><td> </td><td class="right">#include "LandscapeMgr.hpp"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#include "StelTranslator.hpp"</td><td> </td><td class="right">#include "StelTranslator.hpp"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#include "StelActionMgr.hpp"</td><td> </td><td class="right">#include "StelActionMgr.hpp"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#include "StelPropertyMgr.hpp"</td><td> </td><td class="right">#include "StelPropertyMgr.hpp"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#include "StelFileMgr.hpp"</td><td> </td><td class="right">#include "StelFileMgr.hpp"</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0001" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">#include "StelMainView.hpp"</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#include "EphemWrapper.hpp"</td><td> </td><td class="right">#include "EphemWrapper.hpp"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#include "precession.h"</td><td> </td><td class="right">#include "precession.h"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#include &lt;QSettings&gt;</td><td> </td><td class="right">#include &lt;QSettings&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#include &lt;QDebug&gt;</td><td> </td><td class="right">#include &lt;QDebug&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#include &lt;QMetaEnum&gt;</td><td> </td><td class="right">#include &lt;QMetaEnum&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#include &lt;QTimeZone&gt;</td><td> </td><td class="right">#include &lt;QTimeZone&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#include &lt;QFile&gt;</td><td> </td><td class="right">#include &lt;QFile&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#include &lt;QDir&gt;</td><td> </td><td class="right">#include &lt;QDir&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#include &lt;iostream&gt;</td><td> </td><td class="right">#include &lt;iostream&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#include &lt;fstream&gt;</td><td> </td><td class="right">#include &lt;fstream&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0002" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">// Init static<span class="delete">s</span> transfo matrices</td><td> </td><td class="rblock">// Init static transfo matrices</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// See vsop87.doc:</td><td> </td><td class="right">// See vsop87.doc:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">const Mat4d StelCore::matJ2000ToVsop87(Mat4d::xrotation(-23.439280305555555
5556*(M_PI/180)) * Mat4d::zrotation(0.0000275*(M_PI/180)));</td><td> </td><td class="right">const Mat4d StelCore::matJ2000ToVsop87(Mat4d::xrotation(-23.439280305555555
5556*(M_PI/180)) * Mat4d::zrotation(0.0000275*(M_PI/180)));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">const Mat4d StelCore::matVsop87ToJ2000(matJ2000ToVsop87.transpose());</td><td> </td><td class="right">const Mat4d StelCore::matVsop87ToJ2000(matJ2000ToVsop87.transpose());</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">const Mat4d StelCore::matJ2000ToGalactic(-0.054875539726, 0.494109453312, -
0.867666135858, 0, -0.873437108010, -0.444829589425, -0.198076386122, 0, -0
.483834985808, 0.746982251810, 0.455983795705, 0, 0, 0, 0, 1);</td><td> </td><td class="right">const Mat4d StelCore::matJ2000ToGalactic(-0.054875539726, 0.494109453312, -
0.867666135858, 0, -0.873437108010, -0.444829589425, -0.198076386122, 0, -0
.483834985808, 0.746982251810, 0.455983795705, 0, 0, 0, 0, 1);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">const Mat4d StelCore::matGalacticToJ2000(matJ2000ToGalactic.transpose());</td><td> </td><td class="right">const Mat4d StelCore::matGalacticToJ2000(matJ2000ToGalactic.transpose());</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">const Mat4d StelCore::matJ2000ToSupergalactic(0.37501548, -0.89832046, 0.22
887497, 0, 0.34135896, -0.09572714, -0.93504565, 0, 0.86188018, 0.42878511,
 0.27075058, 0, 0, 0, 0, 1);</td><td> </td><td class="right">const Mat4d StelCore::matJ2000ToSupergalactic(0.37501548, -0.89832046, 0.22
887497, 0, 0.34135896, -0.09572714, -0.93504565, 0, 0.86188018, 0.42878511,
 0.27075058, 0, 0, 0, 0, 1);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">const Mat4d StelCore::matSupergalacticToJ2000(matJ2000ToSupergalactic.trans
pose());</td><td> </td><td class="right">const Mat4d StelCore::matSupergalacticToJ2000(matJ2000ToSupergalactic.trans
pose());</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">Mat4d StelCore::matJ2000ToJ1875; // gets to be initialized in constructor.</td><td> </td><td class="right">Mat4d StelCore::matJ2000ToJ1875; // gets to be initialized in constructor.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">const double StelCore::JD_SECOND = 0.000011574074074074074074; // 1/(24*60*
60)=1/86400</td><td> </td><td class="right">const double StelCore::JD_SECOND = 0.000011574074074074074074; // 1/(24*60*
60)=1/86400</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">const double StelCore::JD_MINUTE = 0.00069444444444444444444;  // 1/(24*60)
   =1/1440</td><td> </td><td class="right">const double StelCore::JD_MINUTE = 0.00069444444444444444444;  // 1/(24*60)
   =1/1440</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">const double StelCore::JD_HOUR   = 0.041666666666666666666;    // 1/24</td><td> </td><td class="right">const double StelCore::JD_HOUR   = 0.041666666666666666666;    // 1/24</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">const double StelCore::JD_DAY    = 1.;</td><td> </td><td class="right">const double StelCore::JD_DAY    = 1.;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">const double StelCore::ONE_OVER_JD_SECOND = 86400;             // 86400</td><td> </td><td class="right">const double StelCore::ONE_OVER_JD_SECOND = 86400;             // 86400</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">const double StelCore::TZ_ERA_BEGINNING = 2395996.5;           // December 
1, 1847</td><td> </td><td class="right">const double StelCore::TZ_ERA_BEGINNING = 2395996.5;           // December 
1, 1847</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">StelCore::StelCore()</td><td> </td><td class="right">StelCore::StelCore()</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0003" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       : <span class="delete">skyDrawer(NULL)</span></td><td> </td><td class="rblock">       : <span class="insert">skyDrawer(Q_NULLPTR)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       , <span class="delete">movementMgr(NULL)</span></td><td> </td><td class="rblock">       , <span class="insert">movementMgr(Q_NULLPTR)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       , <span class="delete">geodesicGrid(NULL)</span></td><td> </td><td class="rblock">       , <span class="insert">geodesicGrid(Q_NULLPTR)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       , currentProjectionType(ProjectionStereographic)</td><td> </td><td class="right">       , currentProjectionType(ProjectionStereographic)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       , currentDeltaTAlgorithm(EspenakMeeus)</td><td> </td><td class="right">       , currentDeltaTAlgorithm(EspenakMeeus)</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0004" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       , position(<span class="delete">NULL</span>)</td><td> </td><td class="rblock">       , position(<span class="insert">Q_NULLPTR</span>)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       , flagUseNutation(true)</td><td> </td><td class="right">       , flagUseNutation(true)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       , flagUseTopocentricCoordinates(true)</td><td> </td><td class="right">       , flagUseTopocentricCoordinates(true)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       , timeSpeed(JD_SECOND)</td><td> </td><td class="right">       , timeSpeed(JD_SECOND)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       , JD(0.,0.)</td><td> </td><td class="right">       , JD(0.,0.)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       , presetSkyTime(0.)</td><td> </td><td class="right">       , presetSkyTime(0.)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       , milliSecondsOfLastJDUpdate(0.)</td><td> </td><td class="right">       , milliSecondsOfLastJDUpdate(0.)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       , jdOfLastJDUpdate(0.)</td><td> </td><td class="right">       , jdOfLastJDUpdate(0.)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       , flagUseDST(true)</td><td> </td><td class="right">       , flagUseDST(true)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       , flagUseCTZ(false)</td><td> </td><td class="right">       , flagUseCTZ(false)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       , deltaTCustomNDot(-26.0)</td><td> </td><td class="right">       , deltaTCustomNDot(-26.0)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l2" /><small>skipping to change at</small><em> line 136</em></th><th> </th><th><a name="part-r2" /><small>skipping to change at</small><em> line 137</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       currentProjectorParams.gravityLabels = conf-&gt;value("viewing/flag_gra
vity_labels").toBool();</td><td> </td><td class="right">       currentProjectorParams.gravityLabels = conf-&gt;value("viewing/flag_gra
vity_labels").toBool();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       currentProjectorParams.devicePixelsPerPixel = StelApp::getInstance()
.getDevicePixelsPerPixel();</td><td> </td><td class="right">       currentProjectorParams.devicePixelsPerPixel = StelApp::getInstance()
.getDevicePixelsPerPixel();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       flagUseNutation=conf-&gt;value("astro/flag_nutation", true).toBool();</td><td> </td><td class="right">       flagUseNutation=conf-&gt;value("astro/flag_nutation", true).toBool();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       flagUseTopocentricCoordinates=conf-&gt;value("astro/flag_topocentric_co
ordinates", true).toBool();</td><td> </td><td class="right">       flagUseTopocentricCoordinates=conf-&gt;value("astro/flag_topocentric_co
ordinates", true).toBool();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       flagUseDST=conf-&gt;value("localization/flag_dst", true).toBool();</td><td> </td><td class="right">       flagUseDST=conf-&gt;value("localization/flag_dst", true).toBool();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // Initialize matJ2000ToJ1875 matrix</td><td> </td><td class="right">       // Initialize matJ2000ToJ1875 matrix</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0005" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       double <span class="delete">jd1875,</span> eps1875, chi1875, omega1875, psi1875;</td><td> </td><td class="rblock">       double eps1875, chi1875, omega1875, psi1875;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">StelUtils::getJDFromDate(&amp;jd1875, 1875, 1, 0, 0, 0, 0);</span></td><td> </td><td class="rblock">       <span class="insert">double jdB1875 = StelUtils::getJDFromBesselianEpoch(1875.0);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       getPrecessionAnglesVondrak(jd1875,</span> &amp;eps1875, &amp;chi1875, &amp;omega1875, <span class="delete">&amp;</span></td><td> </td><td class="rblock"><span class="insert">       getPrecessionAnglesVondrak(jdB1875,</span> &amp;eps1875, &amp;chi1875, &amp;omega1875, </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">psi1875);</span></td><td> </td><td class="rblock"><span class="insert">&amp;psi1875);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       matJ2000ToJ1875= Mat4d::xrotation(84381.406*1./3600.*M_PI/180.) * Ma
t4d::zrotation(-psi1875) * Mat4d::xrotation(-omega1875) * Mat4d::zrotation(
chi1875);</td><td> </td><td class="right">       matJ2000ToJ1875= Mat4d::xrotation(84381.406*1./3600.*M_PI/180.) * Ma
t4d::zrotation(-psi1875) * Mat4d::xrotation(-omega1875) * Mat4d::zrotation(
chi1875);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       matJ2000ToJ1875=matJ2000ToJ1875.transpose();</td><td> </td><td class="right">       matJ2000ToJ1875=matJ2000ToJ1875.transpose();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">StelCore::~StelCore()</td><td> </td><td class="right">StelCore::~StelCore()</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0006" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       delete toneReproducer; <span class="delete">toneReproducer=NULL;</span></td><td> </td><td class="rblock">       delete toneReproducer; <span class="insert">toneReproducer=Q_NULLPTR;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       delete geodesicGrid; <span class="delete">geodesicGrid=NULL;</span></td><td> </td><td class="rblock">       delete geodesicGrid; <span class="insert">geodesicGrid=Q_NULLPTR;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       delete skyDrawer; <span class="delete">skyDrawer=NULL;</span></td><td> </td><td class="rblock">       delete skyDrawer; <span class="insert">skyDrawer=Q_NULLPTR;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       delete position; <span class="delete">position=NULL;</span></td><td> </td><td class="rblock">       delete position; <span class="insert">position=Q_NULLPTR;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">/*************************************************************************</td><td> </td><td class="right">/*************************************************************************</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"> Load core data and initialize with default values</td><td> </td><td class="right"> Load core data and initialize with default values</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">*************************************************************************/</td><td> </td><td class="right">*************************************************************************/</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void StelCore::init()</td><td> </td><td class="right">void StelCore::init()</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       QSettings* conf = StelApp::getInstance().getSettings();</td><td> </td><td class="right">       QSettings* conf = StelApp::getInstance().getSettings();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (conf-&gt;childGroups().contains("location_run_once"))</td><td> </td><td class="right">       if (conf-&gt;childGroups().contains("location_run_once"))</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l3" /><small>skipping to change at</small><em> line 319</em></th><th> </th><th><a name="part-r3" /><small>skipping to change at</small><em> line 320</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">QString StelCore::getDefaultProjectionTypeKey() const</td><td> </td><td class="right">QString StelCore::getDefaultProjectionTypeKey() const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       QSettings* conf = StelApp::getInstance().getSettings();</td><td> </td><td class="right">       QSettings* conf = StelApp::getInstance().getSettings();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return conf-&gt;value("projection/type", "ProjectionStereographic").toS
tring();</td><td> </td><td class="right">       return conf-&gt;value("projection/type", "ProjectionStereographic").toS
tring();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Get the shared instance of StelGeodesicGrid.</td><td> </td><td class="right">// Get the shared instance of StelGeodesicGrid.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// The returned instance is garanteed to allow for at least maxLevel levels</td><td> </td><td class="right">// The returned instance is garanteed to allow for at least maxLevel levels</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">const StelGeodesicGrid* StelCore::getGeodesicGrid(int maxLevel) const</td><td> </td><td class="right">const StelGeodesicGrid* StelCore::getGeodesicGrid(int maxLevel) const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0007" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       if (geodesicGrid==<span class="delete">NULL</span>)</td><td> </td><td class="rblock">       if (geodesicGrid==<span class="insert">Q_NULLPTR</span>)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               geodesicGrid = new StelGeodesicGrid(maxLevel);</td><td> </td><td class="right">               geodesicGrid = new StelGeodesicGrid(maxLevel);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       else if (maxLevel&gt;geodesicGrid-&gt;getMaxLevel())</td><td> </td><td class="right">       else if (maxLevel&gt;geodesicGrid-&gt;getMaxLevel())</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               delete geodesicGrid;</td><td> </td><td class="right">               delete geodesicGrid;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               geodesicGrid = new StelGeodesicGrid(maxLevel);</td><td> </td><td class="right">               geodesicGrid = new StelGeodesicGrid(maxLevel);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return geodesicGrid;</td><td> </td><td class="right">       return geodesicGrid;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l4" /><small>skipping to change at</small><em> line 622</em></th><th> </th><th><a name="part-r4" /><small>skipping to change at</small><em> line 623</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return currentProjectorParams.flipHorz;</td><td> </td><td class="right">       return currentProjectorParams.flipHorz;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">bool StelCore::getFlipVert(void) const</td><td> </td><td class="right">bool StelCore::getFlipVert(void) const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return currentProjectorParams.flipVert;</td><td> </td><td class="right">       return currentProjectorParams.flipVert;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Get current value for horizontal viewport offset [-50...50]</td><td> </td><td class="right">// Get current value for horizontal viewport offset [-50...50]</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0008" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">double StelCore::getViewportHorizontalOffset(void)</td><td> </td><td class="rblock">double StelCore::getViewportHorizontalOffset(void)<span class="insert"> const</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return (currentProjectorParams.viewportCenterOffset[0] * 100.0f);</td><td> </td><td class="right">       return (currentProjectorParams.viewportCenterOffset[0] * 100.0f);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Set horizontal viewport offset. Argument will be clamped to be inside [-
50...50]</td><td> </td><td class="right">// Set horizontal viewport offset. Argument will be clamped to be inside [-
50...50]</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void StelCore::setViewportHorizontalOffset(double newOffsetPct)</td><td> </td><td class="right">void StelCore::setViewportHorizontalOffset(double newOffsetPct)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0009" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       currentProjectorParams.viewportCenterOffset[0]=0.01f* q<span class="delete">Min(50., qMax
(-50., newOffsetPct)</span>);</td><td> </td><td class="rblock">       currentProjectorParams.viewportCenterOffset[0]=0.01f* q<span class="insert">Bound(-50., n
ewOffsetPct, 50.</span>);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       currentProjectorParams.viewportCenter.set(currentProjectorParams.vie
wportXywh[0]+(0.5f+currentProjectorParams.viewportCenterOffset.v[0])*curren
tProjectorParams.viewportXywh[2],</td><td> </td><td class="right">       currentProjectorParams.viewportCenter.set(currentProjectorParams.vie
wportXywh[0]+(0.5f+currentProjectorParams.viewportCenterOffset.v[0])*curren
tProjectorParams.viewportXywh[2],</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                               currentProjectorParams.viewp
ortXywh[1]+(0.5f+currentProjectorParams.viewportCenterOffset.v[1])*currentP
rojectorParams.viewportXywh[3]);</td><td> </td><td class="right">                                               currentProjectorParams.viewp
ortXywh[1]+(0.5f+currentProjectorParams.viewportCenterOffset.v[1])*currentP
rojectorParams.viewportXywh[3]);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Get current value for vertical viewport offset [-50...50]</td><td> </td><td class="right">// Get current value for vertical viewport offset [-50...50]</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0010" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">double StelCore::getViewportVerticalOffset(void)</td><td> </td><td class="rblock">double StelCore::getViewportVerticalOffset(void)<span class="insert"> const</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return (currentProjectorParams.viewportCenterOffset[1] * 100.0f);</td><td> </td><td class="right">       return (currentProjectorParams.viewportCenterOffset[1] * 100.0f);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Set vertical viewport offset. Argument will be clamped to be inside [-50
...50]</td><td> </td><td class="right">// Set vertical viewport offset. Argument will be clamped to be inside [-50
...50]</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void StelCore::setViewportVerticalOffset(double newOffsetPct)</td><td> </td><td class="right">void StelCore::setViewportVerticalOffset(double newOffsetPct)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0011" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       currentProjectorParams.viewportCenterOffset[1]=0.01f* q<span class="delete">Min(50., qMax
(-50., newOffsetPct)</span>);</td><td> </td><td class="rblock">       currentProjectorParams.viewportCenterOffset[1]=0.01f* q<span class="insert">Bound(-50., n
ewOffsetPct, 50.</span>);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       currentProjectorParams.viewportCenter.set(currentProjectorParams.vie
wportXywh[0]+(0.5f+currentProjectorParams.viewportCenterOffset.v[0])*curren
tProjectorParams.viewportXywh[2],</td><td> </td><td class="right">       currentProjectorParams.viewportCenter.set(currentProjectorParams.vie
wportXywh[0]+(0.5f+currentProjectorParams.viewportCenterOffset.v[0])*curren
tProjectorParams.viewportXywh[2],</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                               currentProjectorParams.viewp
ortXywh[1]+(0.5f+currentProjectorParams.viewportCenterOffset.v[1])*currentP
rojectorParams.viewportXywh[3]);</td><td> </td><td class="right">                                               currentProjectorParams.viewp
ortXywh[1]+(0.5f+currentProjectorParams.viewportCenterOffset.v[1])*currentP
rojectorParams.viewportXywh[3]);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Set both viewport offsets. Arguments will be clamped to be inside [-50..
.50]. I (GZ) hope this will avoid some of the shaking.</td><td> </td><td class="right">// Set both viewport offsets. Arguments will be clamped to be inside [-50..
.50]. I (GZ) hope this will avoid some of the shaking.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void StelCore::setViewportOffset(double newHorizontalOffsetPct, double newV
erticalOffsetPct)</td><td> </td><td class="right">void StelCore::setViewportOffset(double newHorizontalOffsetPct, double newV
erticalOffsetPct)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0012" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       currentProjectorParams.viewportCenterOffset[0]=0.01f* <span class="delete">qMin(50., qMax</span></td><td> </td><td class="rblock">       currentProjectorParams.viewportCenterOffset[0]=0.01f* <span class="insert">qBound(-50., n</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">(-50., newHorizontalOffsetPct));</span></td><td> </td><td class="rblock"><span class="insert">ewHorizontalOffsetPct, 50.);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       currentProjectorParams.viewportCenterOffset[1]=0.01f* <span class="delete">qMin(50., qMax</span></td><td> </td><td class="rblock">       currentProjectorParams.viewportCenterOffset[1]=0.01f* <span class="insert">qBound(-50., n</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">(-50., newVerticalOffsetPct));</span></td><td> </td><td class="rblock"><span class="insert">ewVerticalOffsetPct,   50.);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       currentProjectorParams.viewportCenter.set(currentProjectorParams.vie
wportXywh[0]+(0.5f+currentProjectorParams.viewportCenterOffset.v[0])*curren
tProjectorParams.viewportXywh[2],</td><td> </td><td class="right">       currentProjectorParams.viewportCenter.set(currentProjectorParams.vie
wportXywh[0]+(0.5f+currentProjectorParams.viewportCenterOffset.v[0])*curren
tProjectorParams.viewportXywh[2],</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                               currentProjectorParams.viewp
ortXywh[1]+(0.5f+currentProjectorParams.viewportCenterOffset.v[1])*currentP
rojectorParams.viewportXywh[3]);</td><td> </td><td class="right">                                               currentProjectorParams.viewp
ortXywh[1]+(0.5f+currentProjectorParams.viewportCenterOffset.v[1])*currentP
rojectorParams.viewportXywh[3]);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void StelCore::setViewportStretch(float stretch)</td><td> </td><td class="right">void StelCore::setViewportStretch(float stretch)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       currentProjectorParams.widthStretch=qMax(0.001f, stretch);</td><td> </td><td class="right">       currentProjectorParams.widthStretch=qMax(0.001f, stretch);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">QString StelCore::getDefaultLocationID() const</td><td> </td><td class="right">QString StelCore::getDefaultLocationID() const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l5" /><small>skipping to change at</small><em> line 717</em></th><th> </th><th><a name="part-r5" /><small>skipping to change at</small><em> line 718</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       u.normalize();</td><td> </td><td class="right">       u.normalize();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       matAltAzModelView.set(s[0],u[0],-f[0],0.,</td><td> </td><td class="right">       matAltAzModelView.set(s[0],u[0],-f[0],0.,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                             s[1],u[1],-f[1],0.,</td><td> </td><td class="right">                             s[1],u[1],-f[1],0.,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                             s[2],u[2],-f[2],0.,</td><td> </td><td class="right">                             s[2],u[2],-f[2],0.,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                             0.,0.,0.,1.);</td><td> </td><td class="right">                             0.,0.,0.,1.);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       invertMatAltAzModelView = matAltAzModelView.inverse();</td><td> </td><td class="right">       invertMatAltAzModelView = matAltAzModelView.inverse();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">Vec3d StelCore::altAzToEquinoxEqu(const Vec3d&amp; v, RefractionMode refMode) c
onst</td><td> </td><td class="right">Vec3d StelCore::altAzToEquinoxEqu(const Vec3d&amp; v, RefractionMode refMode) c
onst</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0013" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       if (refMode==RefractionOff || skyDrawer==<span class="delete">NULL || (refMode==Refractio
</span>nAuto &amp;&amp; skyDrawer-&gt;getFlagHasAtmosphere()==false))</td><td> </td><td class="rblock">       if (refMode==RefractionOff || skyDrawer==<span class="insert">Q_NULLPTR || (refMode==Refr
actio</span>nAuto &amp;&amp; skyDrawer-&gt;getFlagHasAtmosphere()==false))</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               return matAltAzToEquinoxEqu*v;</td><td> </td><td class="right">               return matAltAzToEquinoxEqu*v;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       Vec3d r(v);</td><td> </td><td class="right">       Vec3d r(v);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       skyDrawer-&gt;getRefraction().backward(r);</td><td> </td><td class="right">       skyDrawer-&gt;getRefraction().backward(r);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       r.transfo4d(matAltAzToEquinoxEqu);</td><td> </td><td class="right">       r.transfo4d(matAltAzToEquinoxEqu);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return r;</td><td> </td><td class="right">       return r;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">Vec3d StelCore::equinoxEquToAltAz(const Vec3d&amp; v, RefractionMode refMode) c
onst</td><td> </td><td class="right">Vec3d StelCore::equinoxEquToAltAz(const Vec3d&amp; v, RefractionMode refMode) c
onst</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0014" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       if (refMode==RefractionOff || skyDrawer==<span class="delete">NULL || (refMode==Refractio
</span>nAuto &amp;&amp; skyDrawer-&gt;getFlagHasAtmosphere()==false))</td><td> </td><td class="rblock">       if (refMode==RefractionOff || skyDrawer==<span class="insert">Q_NULLPTR || (refMode==Refr
actio</span>nAuto &amp;&amp; skyDrawer-&gt;getFlagHasAtmosphere()==false))</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               return matEquinoxEquToAltAz*v;</td><td> </td><td class="right">               return matEquinoxEquToAltAz*v;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       Vec3d r(v);</td><td> </td><td class="right">       Vec3d r(v);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       r.transfo4d(matEquinoxEquToAltAz);</td><td> </td><td class="right">       r.transfo4d(matEquinoxEquToAltAz);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       skyDrawer-&gt;getRefraction().forward(r);</td><td> </td><td class="right">       skyDrawer-&gt;getRefraction().forward(r);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return r;</td><td> </td><td class="right">       return r;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">Vec3d StelCore::altAzToJ2000(const Vec3d&amp; v, RefractionMode refMode) const</td><td> </td><td class="right">Vec3d StelCore::altAzToJ2000(const Vec3d&amp; v, RefractionMode refMode) const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0015" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       if (refMode==RefractionOff || skyDrawer==<span class="delete">NULL || (refMode==Refractio
</span>nAuto &amp;&amp; skyDrawer-&gt;getFlagHasAtmosphere()==false))</td><td> </td><td class="rblock">       if (refMode==RefractionOff || skyDrawer==<span class="insert">Q_NULLPTR || (refMode==Refr
actio</span>nAuto &amp;&amp; skyDrawer-&gt;getFlagHasAtmosphere()==false))</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               return matEquinoxEquToJ2000*matAltAzToEquinoxEqu*v;</td><td> </td><td class="right">               return matEquinoxEquToJ2000*matAltAzToEquinoxEqu*v;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       Vec3d r(v);</td><td> </td><td class="right">       Vec3d r(v);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       skyDrawer-&gt;getRefraction().backward(r);</td><td> </td><td class="right">       skyDrawer-&gt;getRefraction().backward(r);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       r.transfo4d(matEquinoxEquToJ2000*matAltAzToEquinoxEqu);</td><td> </td><td class="right">       r.transfo4d(matEquinoxEquToJ2000*matAltAzToEquinoxEqu);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return r;</td><td> </td><td class="right">       return r;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">Vec3d StelCore::j2000ToAltAz(const Vec3d&amp; v, RefractionMode refMode) const</td><td> </td><td class="right">Vec3d StelCore::j2000ToAltAz(const Vec3d&amp; v, RefractionMode refMode) const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0016" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       if (refMode==RefractionOff || skyDrawer==<span class="delete">NULL || (refMode==Refractio
</span>nAuto &amp;&amp; skyDrawer-&gt;getFlagHasAtmosphere()==false))</td><td> </td><td class="rblock">       if (refMode==RefractionOff || skyDrawer==<span class="insert">Q_NULLPTR || (refMode==Refr
actio</span>nAuto &amp;&amp; skyDrawer-&gt;getFlagHasAtmosphere()==false))</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               return matJ2000ToAltAz*v;</td><td> </td><td class="right">               return matJ2000ToAltAz*v;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       Vec3d r(v);</td><td> </td><td class="right">       Vec3d r(v);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       r.transfo4d(matJ2000ToAltAz);</td><td> </td><td class="right">       r.transfo4d(matJ2000ToAltAz);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       skyDrawer-&gt;getRefraction().forward(r);</td><td> </td><td class="right">       skyDrawer-&gt;getRefraction().forward(r);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return r;</td><td> </td><td class="right">       return r;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">Vec3d StelCore::galacticToJ2000(const Vec3d&amp; v) const</td><td> </td><td class="right">Vec3d StelCore::galacticToJ2000(const Vec3d&amp; v) const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return matGalacticToJ2000*v;</td><td> </td><td class="right">       return matGalacticToJ2000*v;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">Vec3d StelCore::supergalacticToJ2000(const Vec3d&amp; v) const</td><td> </td><td class="right">Vec3d StelCore::supergalacticToJ2000(const Vec3d&amp; v) const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return matSupergalacticToJ2000*v;</td><td> </td><td class="right">       return matSupergalacticToJ2000*v;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">Vec3d StelCore::equinoxEquToJ2000(const Vec3d&amp; v, RefractionMode refMode) c
onst</td><td> </td><td class="right">Vec3d StelCore::equinoxEquToJ2000(const Vec3d&amp; v, RefractionMode refMode) c
onst</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0017" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       if (refMode==RefractionOff || skyDrawer==<span class="delete">NULL || (refMode==Refractio
</span>nAuto &amp;&amp; skyDrawer-&gt;getFlagHasAtmosphere()==false))</td><td> </td><td class="rblock">       if (refMode==RefractionOff || skyDrawer==<span class="insert">Q_NULLPTR || (refMode==Refr
actio</span>nAuto &amp;&amp; skyDrawer-&gt;getFlagHasAtmosphere()==false))</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               return matEquinoxEquToJ2000*v;</td><td> </td><td class="right">               return matEquinoxEquToJ2000*v;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       Vec3d r(v);</td><td> </td><td class="right">       Vec3d r(v);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       r.transfo4d(matEquinoxEquToAltAz);</td><td> </td><td class="right">       r.transfo4d(matEquinoxEquToAltAz);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       skyDrawer-&gt;getRefraction().backward(r);</td><td> </td><td class="right">       skyDrawer-&gt;getRefraction().backward(r);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       r.transfo4d(matAltAzToJ2000);</td><td> </td><td class="right">       r.transfo4d(matAltAzToJ2000);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return r;</td><td> </td><td class="right">       return r;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">Vec3d StelCore::j2000ToEquinoxEqu(const Vec3d&amp; v, RefractionMode refMode) c
onst</td><td> </td><td class="right">Vec3d StelCore::j2000ToEquinoxEqu(const Vec3d&amp; v, RefractionMode refMode) c
onst</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0018" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       if (refMode==RefractionOff || skyDrawer==<span class="delete">NULL || (refMode==Refractio
</span>nAuto &amp;&amp; skyDrawer-&gt;getFlagHasAtmosphere()==false))</td><td> </td><td class="rblock">       if (refMode==RefractionOff || skyDrawer==<span class="insert">Q_NULLPTR || (refMode==Refr
actio</span>nAuto &amp;&amp; skyDrawer-&gt;getFlagHasAtmosphere()==false))</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               return matJ2000ToEquinoxEqu*v;</td><td> </td><td class="right">               return matJ2000ToEquinoxEqu*v;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       Vec3d r(v);</td><td> </td><td class="right">       Vec3d r(v);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       r.transfo4d(matJ2000ToAltAz);</td><td> </td><td class="right">       r.transfo4d(matJ2000ToAltAz);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       skyDrawer-&gt;getRefraction().forward(r);</td><td> </td><td class="right">       skyDrawer-&gt;getRefraction().forward(r);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       r.transfo4d(matAltAzToEquinoxEqu);</td><td> </td><td class="right">       r.transfo4d(matAltAzToEquinoxEqu);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return r;</td><td> </td><td class="right">       return r;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">Vec3d StelCore::j2000ToJ1875(const Vec3d&amp; v) const</td><td> </td><td class="right">Vec3d StelCore::j2000ToJ1875(const Vec3d&amp; v) const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l6" /><small>skipping to change at</small><em> line 805</em></th><th> </th><th><a name="part-r6" /><small>skipping to change at</small><em> line 806</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">Vec3d StelCore::j2000ToSupergalactic(const Vec3d&amp; v) const</td><td> </td><td class="right">Vec3d StelCore::j2000ToSupergalactic(const Vec3d&amp; v) const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return matJ2000ToSupergalactic*v;</td><td> </td><td class="right">       return matJ2000ToSupergalactic*v;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//! Transform vector from heliocentric ecliptic coordinate to altazimuthal</td><td> </td><td class="right">//! Transform vector from heliocentric ecliptic coordinate to altazimuthal</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">Vec3d StelCore::heliocentricEclipticToAltAz(const Vec3d&amp; v, RefractionMode 
refMode) const</td><td> </td><td class="right">Vec3d StelCore::heliocentricEclipticToAltAz(const Vec3d&amp; v, RefractionMode 
refMode) const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0019" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       if (refMode==RefractionOff || skyDrawer==<span class="delete">NULL || (refMode==Refractio
</span>nAuto &amp;&amp; skyDrawer-&gt;getFlagHasAtmosphere()==false))</td><td> </td><td class="rblock">       if (refMode==RefractionOff || skyDrawer==<span class="insert">Q_NULLPTR || (refMode==Refr
actio</span>nAuto &amp;&amp; skyDrawer-&gt;getFlagHasAtmosphere()==false))</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               return matHeliocentricEclipticJ2000ToAltAz*v;</td><td> </td><td class="right">               return matHeliocentricEclipticJ2000ToAltAz*v;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       Vec3d r(v);</td><td> </td><td class="right">       Vec3d r(v);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       r.transfo4d(matHeliocentricEclipticJ2000ToAltAz);</td><td> </td><td class="right">       r.transfo4d(matHeliocentricEclipticJ2000ToAltAz);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       skyDrawer-&gt;getRefraction().forward(r);</td><td> </td><td class="right">       skyDrawer-&gt;getRefraction().forward(r);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return r;</td><td> </td><td class="right">       return r;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//! Transform from heliocentric coordinate to equatorial at current equinox
 (for the planet where the observer stands)</td><td> </td><td class="right">//! Transform from heliocentric coordinate to equatorial at current equinox
 (for the planet where the observer stands)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">Vec3d StelCore::heliocentricEclipticToEquinoxEqu(const Vec3d&amp; v) const</td><td> </td><td class="right">Vec3d StelCore::heliocentricEclipticToEquinoxEqu(const Vec3d&amp; v) const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l7" /><small>skipping to change at</small><em> line 831</em></th><th> </th><th><a name="part-r7" /><small>skipping to change at</small><em> line 832</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//! coordinate but centered on the observer position (useful for objects cl
ose to earth)</td><td> </td><td class="right">//! coordinate but centered on the observer position (useful for objects cl
ose to earth)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//! Unused as of V0.13</td><td> </td><td class="right">//! Unused as of V0.13</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">Vec3d StelCore::heliocentricEclipticToEarthPosEquinoxEqu(const Vec3d&amp; v) co
nst</td><td> </td><td class="right">Vec3d StelCore::heliocentricEclipticToEarthPosEquinoxEqu(const Vec3d&amp; v) co
nst</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return matAltAzToEquinoxEqu*matHeliocentricEclipticToAltAz*v;</td><td> </td><td class="right">       return matAltAzToEquinoxEqu*matHeliocentricEclipticToAltAz*v;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">*/</td><td> </td><td class="right">*/</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">StelProjector::ModelViewTranformP StelCore::getHeliocentricEclipticModelVie
wTransform(RefractionMode refMode) const</td><td> </td><td class="right">StelProjector::ModelViewTranformP StelCore::getHeliocentricEclipticModelVie
wTransform(RefractionMode refMode) const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0020" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       if (refMode==RefractionOff || skyDrawer==<span class="delete">NULL || (refMode==Refractio
</span>nAuto &amp;&amp; skyDrawer-&gt;getFlagHasAtmosphere()==false))</td><td> </td><td class="rblock">       if (refMode==RefractionOff || skyDrawer==<span class="insert">Q_NULLPTR || (refMode==Refr
actio</span>nAuto &amp;&amp; skyDrawer-&gt;getFlagHasAtmosphere()==false))</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               return StelProjector::ModelViewTranformP(new StelProjector::
Mat4dTransform(matAltAzModelView*matHeliocentricEclipticJ2000ToAltAz));</td><td> </td><td class="right">               return StelProjector::ModelViewTranformP(new StelProjector::
Mat4dTransform(matAltAzModelView*matHeliocentricEclipticJ2000ToAltAz));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       Refraction* refr = new Refraction(skyDrawer-&gt;getRefraction());</td><td> </td><td class="right">       Refraction* refr = new Refraction(skyDrawer-&gt;getRefraction());</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // The pretransform matrix will convert from input coordinates to Al
tAz needed by the refraction function.</td><td> </td><td class="right">       // The pretransform matrix will convert from input coordinates to Al
tAz needed by the refraction function.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       refr-&gt;setPreTransfoMat(matHeliocentricEclipticJ2000ToAltAz);</td><td> </td><td class="right">       refr-&gt;setPreTransfoMat(matHeliocentricEclipticJ2000ToAltAz);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       refr-&gt;setPostTransfoMat(matAltAzModelView);</td><td> </td><td class="right">       refr-&gt;setPostTransfoMat(matAltAzModelView);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return StelProjector::ModelViewTranformP(refr);</td><td> </td><td class="right">       return StelProjector::ModelViewTranformP(refr);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//! Get the modelview matrix for observer-centric ecliptic J2000 (Vsop87A) 
drawing</td><td> </td><td class="right">//! Get the modelview matrix for observer-centric ecliptic J2000 (Vsop87A) 
drawing</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">StelProjector::ModelViewTranformP StelCore::getObservercentricEclipticJ2000
ModelViewTransform(RefractionMode refMode) const</td><td> </td><td class="right">StelProjector::ModelViewTranformP StelCore::getObservercentricEclipticJ2000
ModelViewTransform(RefractionMode refMode) const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0021" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       if (refMode==RefractionOff || skyDrawer==<span class="delete">NULL || (refMode==Refractio
</span>nAuto &amp;&amp; skyDrawer-&gt;getFlagHasAtmosphere()==false))</td><td> </td><td class="rblock">       if (refMode==RefractionOff || skyDrawer==<span class="insert">Q_NULLPTR || (refMode==Refr
actio</span>nAuto &amp;&amp; skyDrawer-&gt;getFlagHasAtmosphere()==false))</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               return StelProjector::ModelViewTranformP(new StelProjector::
Mat4dTransform(matAltAzModelView*matJ2000ToAltAz*matVsop87ToJ2000));</td><td> </td><td class="right">               return StelProjector::ModelViewTranformP(new StelProjector::
Mat4dTransform(matAltAzModelView*matJ2000ToAltAz*matVsop87ToJ2000));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       Refraction* refr = new Refraction(skyDrawer-&gt;getRefraction());</td><td> </td><td class="right">       Refraction* refr = new Refraction(skyDrawer-&gt;getRefraction());</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // The pretransform matrix will convert from input coordinates to Al
tAz needed by the refraction function.</td><td> </td><td class="right">       // The pretransform matrix will convert from input coordinates to Al
tAz needed by the refraction function.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       refr-&gt;setPreTransfoMat(matJ2000ToAltAz*matVsop87ToJ2000);</td><td> </td><td class="right">       refr-&gt;setPreTransfoMat(matJ2000ToAltAz*matVsop87ToJ2000);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       refr-&gt;setPostTransfoMat(matAltAzModelView);</td><td> </td><td class="right">       refr-&gt;setPostTransfoMat(matAltAzModelView);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return StelProjector::ModelViewTranformP(refr);</td><td> </td><td class="right">       return StelProjector::ModelViewTranformP(refr);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//! Get the modelview matrix for observer-centric ecliptic-of-date drawing</td><td> </td><td class="right">//! Get the modelview matrix for observer-centric ecliptic-of-date drawing</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">StelProjector::ModelViewTranformP StelCore::getObservercentricEclipticOfDat
eModelViewTransform(RefractionMode refMode) const</td><td> </td><td class="right">StelProjector::ModelViewTranformP StelCore::getObservercentricEclipticOfDat
eModelViewTransform(RefractionMode refMode) const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double eps_A=getPrecessionAngleVondrakCurrentEpsilonA();</td><td> </td><td class="right">       double eps_A=getPrecessionAngleVondrakCurrentEpsilonA();</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0022" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       if (refMode==RefractionOff || skyDrawer==<span class="delete">NULL || (refMode==Refractio
</span>nAuto &amp;&amp; skyDrawer-&gt;getFlagHasAtmosphere()==false))</td><td> </td><td class="rblock">       if (refMode==RefractionOff || skyDrawer==<span class="insert">Q_NULLPTR || (refMode==Refr
actio</span>nAuto &amp;&amp; skyDrawer-&gt;getFlagHasAtmosphere()==false))</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               return StelProjector::ModelViewTranformP(new StelProjector::
Mat4dTransform(matAltAzModelView*matEquinoxEquToAltAz* Mat4d::xrotation(eps
_A)));</td><td> </td><td class="right">               return StelProjector::ModelViewTranformP(new StelProjector::
Mat4dTransform(matAltAzModelView*matEquinoxEquToAltAz* Mat4d::xrotation(eps
_A)));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       Refraction* refr = new Refraction(skyDrawer-&gt;getRefraction());</td><td> </td><td class="right">       Refraction* refr = new Refraction(skyDrawer-&gt;getRefraction());</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // The pretransform matrix will convert from input coordinates to Al
tAz needed by the refraction function.</td><td> </td><td class="right">       // The pretransform matrix will convert from input coordinates to Al
tAz needed by the refraction function.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       refr-&gt;setPreTransfoMat(matEquinoxEquToAltAz* Mat4d::xrotation(eps_A)
);</td><td> </td><td class="right">       refr-&gt;setPreTransfoMat(matEquinoxEquToAltAz* Mat4d::xrotation(eps_A)
);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       refr-&gt;setPostTransfoMat(matAltAzModelView);</td><td> </td><td class="right">       refr-&gt;setPostTransfoMat(matAltAzModelView);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return StelProjector::ModelViewTranformP(refr);</td><td> </td><td class="right">       return StelProjector::ModelViewTranformP(refr);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//! Get the modelview matrix for observer-centric equatorial at equinox dra
wing</td><td> </td><td class="right">//! Get the modelview matrix for observer-centric equatorial at equinox dra
wing</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">StelProjector::ModelViewTranformP StelCore::getEquinoxEquModelViewTransform
(RefractionMode refMode) const</td><td> </td><td class="right">StelProjector::ModelViewTranformP StelCore::getEquinoxEquModelViewTransform
(RefractionMode refMode) const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0023" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       if (refMode==RefractionOff || skyDrawer==<span class="delete">NULL || (refMode==Refractio
</span>nAuto &amp;&amp; skyDrawer-&gt;getFlagHasAtmosphere()==false))</td><td> </td><td class="rblock">       if (refMode==RefractionOff || skyDrawer==<span class="insert">Q_NULLPTR || (refMode==Refr
actio</span>nAuto &amp;&amp; skyDrawer-&gt;getFlagHasAtmosphere()==false))</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               return StelProjector::ModelViewTranformP(new StelProjector::
Mat4dTransform(matAltAzModelView*matEquinoxEquToAltAz));</td><td> </td><td class="right">               return StelProjector::ModelViewTranformP(new StelProjector::
Mat4dTransform(matAltAzModelView*matEquinoxEquToAltAz));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       Refraction* refr = new Refraction(skyDrawer-&gt;getRefraction());</td><td> </td><td class="right">       Refraction* refr = new Refraction(skyDrawer-&gt;getRefraction());</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // The pretransform matrix will convert from input coordinates to Al
tAz needed by the refraction function.</td><td> </td><td class="right">       // The pretransform matrix will convert from input coordinates to Al
tAz needed by the refraction function.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       refr-&gt;setPreTransfoMat(matEquinoxEquToAltAz);</td><td> </td><td class="right">       refr-&gt;setPreTransfoMat(matEquinoxEquToAltAz);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       refr-&gt;setPostTransfoMat(matAltAzModelView);</td><td> </td><td class="right">       refr-&gt;setPostTransfoMat(matAltAzModelView);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return StelProjector::ModelViewTranformP(refr);</td><td> </td><td class="right">       return StelProjector::ModelViewTranformP(refr);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//! Get the modelview matrix for observer-centric altazimuthal drawing</td><td> </td><td class="right">//! Get the modelview matrix for observer-centric altazimuthal drawing</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">StelProjector::ModelViewTranformP StelCore::getAltAzModelViewTransform(Refr
actionMode refMode) const</td><td> </td><td class="right">StelProjector::ModelViewTranformP StelCore::getAltAzModelViewTransform(Refr
actionMode refMode) const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0024" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       if (refMode==RefractionOff || skyDrawer==<span class="delete">NULL || (refMode==Refractio
</span>nAuto &amp;&amp; skyDrawer-&gt;getFlagHasAtmosphere()==false))</td><td> </td><td class="rblock">       if (refMode==RefractionOff || skyDrawer==<span class="insert">Q_NULLPTR || (refMode==Refr
actio</span>nAuto &amp;&amp; skyDrawer-&gt;getFlagHasAtmosphere()==false))</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               // Catch problem with improperly initialized matAltAzModelVi
ew</td><td> </td><td class="right">               // Catch problem with improperly initialized matAltAzModelVi
ew</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               Q_ASSERT(matAltAzModelView[0]==matAltAzModelView[0]);</td><td> </td><td class="right">               Q_ASSERT(matAltAzModelView[0]==matAltAzModelView[0]);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               return StelProjector::ModelViewTranformP(new StelProjector::
Mat4dTransform(matAltAzModelView));</td><td> </td><td class="right">               return StelProjector::ModelViewTranformP(new StelProjector::
Mat4dTransform(matAltAzModelView));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       Refraction* refr = new Refraction(skyDrawer-&gt;getRefraction());</td><td> </td><td class="right">       Refraction* refr = new Refraction(skyDrawer-&gt;getRefraction());</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // The pretransform matrix will convert from input coordinates to Al
tAz needed by the refraction function.</td><td> </td><td class="right">       // The pretransform matrix will convert from input coordinates to Al
tAz needed by the refraction function.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       refr-&gt;setPostTransfoMat(matAltAzModelView);</td><td> </td><td class="right">       refr-&gt;setPostTransfoMat(matAltAzModelView);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return StelProjector::ModelViewTranformP(refr);</td><td> </td><td class="right">       return StelProjector::ModelViewTranformP(refr);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//! Get the modelview matrix for observer-centric J2000 equatorial drawing</td><td> </td><td class="right">//! Get the modelview matrix for observer-centric J2000 equatorial drawing</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">StelProjector::ModelViewTranformP StelCore::getJ2000ModelViewTransform(Refr
actionMode refMode) const</td><td> </td><td class="right">StelProjector::ModelViewTranformP StelCore::getJ2000ModelViewTransform(Refr
actionMode refMode) const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0025" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       if (refMode==RefractionOff || skyDrawer==<span class="delete">NULL || (refMode==Refractio
</span>nAuto &amp;&amp; skyDrawer-&gt;getFlagHasAtmosphere()==false))</td><td> </td><td class="rblock">       if (refMode==RefractionOff || skyDrawer==<span class="insert">Q_NULLPTR || (refMode==Refr
actio</span>nAuto &amp;&amp; skyDrawer-&gt;getFlagHasAtmosphere()==false))</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               return StelProjector::ModelViewTranformP(new StelProjector::
Mat4dTransform(matAltAzModelView*matEquinoxEquToAltAz*matJ2000ToEquinoxEqu)
);</td><td> </td><td class="right">               return StelProjector::ModelViewTranformP(new StelProjector::
Mat4dTransform(matAltAzModelView*matEquinoxEquToAltAz*matJ2000ToEquinoxEqu)
);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       Refraction* refr = new Refraction(skyDrawer-&gt;getRefraction());</td><td> </td><td class="right">       Refraction* refr = new Refraction(skyDrawer-&gt;getRefraction());</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // The pretransform matrix will convert from input coordinates to Al
tAz needed by the refraction function.</td><td> </td><td class="right">       // The pretransform matrix will convert from input coordinates to Al
tAz needed by the refraction function.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       refr-&gt;setPreTransfoMat(matEquinoxEquToAltAz*matJ2000ToEquinoxEqu);</td><td> </td><td class="right">       refr-&gt;setPreTransfoMat(matEquinoxEquToAltAz*matJ2000ToEquinoxEqu);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       refr-&gt;setPostTransfoMat(matAltAzModelView);</td><td> </td><td class="right">       refr-&gt;setPostTransfoMat(matAltAzModelView);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return StelProjector::ModelViewTranformP(refr);</td><td> </td><td class="right">       return StelProjector::ModelViewTranformP(refr);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//! Get the modelview matrix for observer-centric Galactic equatorial drawi
ng</td><td> </td><td class="right">//! Get the modelview matrix for observer-centric Galactic equatorial drawi
ng</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">StelProjector::ModelViewTranformP StelCore::getGalacticModelViewTransform(R
efractionMode refMode) const</td><td> </td><td class="right">StelProjector::ModelViewTranformP StelCore::getGalacticModelViewTransform(R
efractionMode refMode) const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0026" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       if (refMode==RefractionOff || skyDrawer==<span class="delete">NULL || (refMode==Refractio
</span>nAuto &amp;&amp; skyDrawer-&gt;getFlagHasAtmosphere()==false))</td><td> </td><td class="rblock">       if (refMode==RefractionOff || skyDrawer==<span class="insert">Q_NULLPTR || (refMode==Refr
actio</span>nAuto &amp;&amp; skyDrawer-&gt;getFlagHasAtmosphere()==false))</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               return StelProjector::ModelViewTranformP(new StelProjector::
Mat4dTransform(matAltAzModelView*matEquinoxEquToAltAz*matJ2000ToEquinoxEqu*
matGalacticToJ2000));</td><td> </td><td class="right">               return StelProjector::ModelViewTranformP(new StelProjector::
Mat4dTransform(matAltAzModelView*matEquinoxEquToAltAz*matJ2000ToEquinoxEqu*
matGalacticToJ2000));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       Refraction* refr = new Refraction(skyDrawer-&gt;getRefraction());</td><td> </td><td class="right">       Refraction* refr = new Refraction(skyDrawer-&gt;getRefraction());</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // The pretransform matrix will convert from input coordinates to Al
tAz needed by the refraction function.</td><td> </td><td class="right">       // The pretransform matrix will convert from input coordinates to Al
tAz needed by the refraction function.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       refr-&gt;setPreTransfoMat(matEquinoxEquToAltAz*matJ2000ToEquinoxEqu*mat
GalacticToJ2000);</td><td> </td><td class="right">       refr-&gt;setPreTransfoMat(matEquinoxEquToAltAz*matJ2000ToEquinoxEqu*mat
GalacticToJ2000);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       refr-&gt;setPostTransfoMat(matAltAzModelView);</td><td> </td><td class="right">       refr-&gt;setPostTransfoMat(matAltAzModelView);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return StelProjector::ModelViewTranformP(refr);</td><td> </td><td class="right">       return StelProjector::ModelViewTranformP(refr);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//! Get the modelview matrix for observer-centric Supergalactic equatorial 
drawing</td><td> </td><td class="right">//! Get the modelview matrix for observer-centric Supergalactic equatorial 
drawing</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">StelProjector::ModelViewTranformP StelCore::getSupergalacticModelViewTransf
orm(RefractionMode refMode) const</td><td> </td><td class="right">StelProjector::ModelViewTranformP StelCore::getSupergalacticModelViewTransf
orm(RefractionMode refMode) const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0027" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       if (refMode==RefractionOff || skyDrawer==<span class="delete">NULL || (refMode==Refractio
</span>nAuto &amp;&amp; skyDrawer-&gt;getFlagHasAtmosphere()==false))</td><td> </td><td class="rblock">       if (refMode==RefractionOff || skyDrawer==<span class="insert">Q_NULLPTR || (refMode==Refr
actio</span>nAuto &amp;&amp; skyDrawer-&gt;getFlagHasAtmosphere()==false))</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               return StelProjector::ModelViewTranformP(new StelProjector::
Mat4dTransform(matAltAzModelView*matEquinoxEquToAltAz*matJ2000ToEquinoxEqu*
matSupergalacticToJ2000));</td><td> </td><td class="right">               return StelProjector::ModelViewTranformP(new StelProjector::
Mat4dTransform(matAltAzModelView*matEquinoxEquToAltAz*matJ2000ToEquinoxEqu*
matSupergalacticToJ2000));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       Refraction* refr = new Refraction(skyDrawer-&gt;getRefraction());</td><td> </td><td class="right">       Refraction* refr = new Refraction(skyDrawer-&gt;getRefraction());</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // The pretransform matrix will convert from input coordinates to Al
tAz needed by the refraction function.</td><td> </td><td class="right">       // The pretransform matrix will convert from input coordinates to Al
tAz needed by the refraction function.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       refr-&gt;setPreTransfoMat(matEquinoxEquToAltAz*matJ2000ToEquinoxEqu*mat
SupergalacticToJ2000);</td><td> </td><td class="right">       refr-&gt;setPreTransfoMat(matEquinoxEquToAltAz*matJ2000ToEquinoxEqu*mat
SupergalacticToJ2000);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       refr-&gt;setPostTransfoMat(matAltAzModelView);</td><td> </td><td class="right">       refr-&gt;setPostTransfoMat(matAltAzModelView);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return StelProjector::ModelViewTranformP(refr);</td><td> </td><td class="right">       return StelProjector::ModelViewTranformP(refr);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// GZ: One of the most important functions, totally void of doc. :-(</td><td> </td><td class="right">// GZ: One of the most important functions, totally void of doc. :-(</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// called in update() (for every frame)</td><td> </td><td class="right">// called in update() (for every frame)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l8" /><small>skipping to change at</small><em> line 949</em></th><th> </th><th><a name="part-r8" /><small>skipping to change at</small><em> line 950</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       matEquinoxEquToJ2000 = matVsop87ToJ2000 * position-&gt;getRotEquatorial
ToVsop87();</td><td> </td><td class="right">       matEquinoxEquToJ2000 = matVsop87ToJ2000 * position-&gt;getRotEquatorial
ToVsop87();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       matJ2000ToEquinoxEqu = matEquinoxEquToJ2000.transpose();</td><td> </td><td class="right">       matJ2000ToEquinoxEqu = matEquinoxEquToJ2000.transpose();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       matJ2000ToAltAz = matEquinoxEquToAltAz*matJ2000ToEquinoxEqu;</td><td> </td><td class="right">       matJ2000ToAltAz = matEquinoxEquToAltAz*matJ2000ToEquinoxEqu;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       matAltAzToJ2000 = matJ2000ToAltAz.transpose();</td><td> </td><td class="right">       matAltAzToJ2000 = matJ2000ToAltAz.transpose();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       matHeliocentricEclipticToEquinoxEqu = matJ2000ToEquinoxEqu * matVsop
87ToJ2000 * Mat4d::translation(-position-&gt;getCenterVsop87Pos());</td><td> </td><td class="right">       matHeliocentricEclipticToEquinoxEqu = matJ2000ToEquinoxEqu * matVsop
87ToJ2000 * Mat4d::translation(-position-&gt;getCenterVsop87Pos());</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // These two next have to take into account the position of the obse
rver on the earth/planet of observation.</td><td> </td><td class="right">       // These two next have to take into account the position of the obse
rver on the earth/planet of observation.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // GZ tmp could be called matAltAzToVsop87</td><td> </td><td class="right">       // GZ tmp could be called matAltAzToVsop87</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       Mat4d tmp = matJ2000ToVsop87 * matEquinoxEquToJ2000 * matAltAzToEqui
noxEqu;</td><td> </td><td class="right">       Mat4d tmp = matJ2000ToVsop87 * matEquinoxEquToJ2000 * matAltAzToEqui
noxEqu;</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0028" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       //Mat4d tmp1 = matJ2000ToVsop87 * matEquinoxEquToJ2000;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // Before 0.14 getDistanceFromCenter assumed spherical planets. Now 
uses rectangular coordinates for observer!</td><td> </td><td class="right">       // Before 0.14 getDistanceFromCenter assumed spherical planets. Now 
uses rectangular coordinates for observer!</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0029" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       <span class="insert">// In series 0.14 and 0.15, this was erroneous: offset by distance r</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">ho, but in the wrong direction.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       // Attempt to fix LP:1275092. This improves the situation, but is st</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">ill not perfect.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       // Please keep the commented stuff until situation is really solved.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (flagUseTopocentricCoordinates)</td><td> </td><td class="right">       if (flagUseTopocentricCoordinates)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0030" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">               <span class="insert">Vec3d offset=position-&gt;getTopographicOffsetFromCenter(); // </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">[rho cosPhi', rho sinPhi', phi'_rad]</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               const double sigma=position-&gt;getCurrentLocation().latitude*M</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">_PI/180.0 - offset.v[2];</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               const double rho=position-&gt;getDistanceFromCenter();</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                           </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               matAltAzToHeliocentricEclipticJ2000 =  Mat4d::translation(po
sition-&gt;getCenterVsop87Pos()) * tmp *</td><td> </td><td class="right">               matAltAzToHeliocentricEclipticJ2000 =  Mat4d::translation(po
sition-&gt;getCenterVsop87Pos()) * tmp *</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0031" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                               Mat4d::translation(Vec3d(<span class="delete">0.,0., position-&gt;ge
tDistanceFromCenter()</span>));</td><td> </td><td class="rblock">                               Mat4d::translation(Vec3d(<span class="insert">rho*sin(sigma), 0.,
 rho*cos(sigma) </span>));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0032" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               matHeliocentricEclipticJ2000ToAltAz =  <span class="delete">Mat4d::translation(Ve</span></td><td> </td><td class="rblock">               matHeliocentricEclipticJ2000ToAltAz =</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">c3d(0.,0.,-position-&gt;getDistanceFromCenter()))</span> * tmp.transpose() *</td><td> </td><td class="rblock">                               <span class="insert">Mat4d::translation(Vec3d(-rho*sin(sigma), 0.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">, -rho*cos(sigma)))</span> * tmp.transpose() *</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               Mat4d::translation(-position-&gt;getCenterVsop8
7Pos());</td><td> </td><td class="right">                               Mat4d::translation(-position-&gt;getCenterVsop8
7Pos());</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0033" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                           </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">               <span class="insert">// Here I tried to split tmp matrix. This does not work:</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">//             matAltAzToHeliocentricEclipticJ2000 =  Mat4d::translation(po</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">sition-&gt;getCenterVsop87Pos()) * tmp1 *</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">//                             Mat4d::translation(Vec3d(rho*sin(sigma), 0.,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"> rho*cos(sigma) )) * matAltAzToEquinoxEqu;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">//             matHeliocentricEclipticJ2000ToAltAz =</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">//                             matEquinoxEquToAltAz *</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">//                             Mat4d::translation(Vec3d(-rho*sin(sigma), 0.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">, -rho*cos(sigma))) * tmp1.transpose() *</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">//                             Mat4d::translation(-position-&gt;getCenterVsop8</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">7Pos());</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">//             matAltAzToHeliocentricEclipticJ2000 =  Mat4d::translation(po</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">sition-&gt;getCenterVsop87Pos()) * tmp *</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">//                             Mat4d::translation(Vec3d(0.,0., position-&gt;ge</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">tDistanceFromCenter()));</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">//             matHeliocentricEclipticJ2000ToAltAz =  Mat4d::translation(Ve</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">c3d(0.,0.,-position-&gt;getDistanceFromCenter())) * tmp.transpose() *</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">//                             Mat4d::translation(-position-&gt;getCenterVsop8</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">7Pos());</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                           </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       else</td><td> </td><td class="right">       else</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               matAltAzToHeliocentricEclipticJ2000 =  Mat4d::translation(po
sition-&gt;getCenterVsop87Pos()) * tmp;</td><td> </td><td class="right">               matAltAzToHeliocentricEclipticJ2000 =  Mat4d::translation(po
sition-&gt;getCenterVsop87Pos()) * tmp;</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0034" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                           </td><td> </td><td class="rblock">               matHeliocentricEclipticJ2000ToAltAz =  tmp.transpose() * <span class="insert">Mat</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               matHeliocentricEclipticJ2000ToAltAz =  tmp.transpose() *</td><td> </td><td class="rblock"><span class="insert">4d::translation(-position-&gt;getCenterVsop87Pos());</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                               <span class="delete">Mat4d::translation(-position-&gt;getCenterVsop8</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">7Pos());</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Return the observer heliocentric position</td><td> </td><td class="right">// Return the observer heliocentric position</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">Vec3d StelCore::getObserverHeliocentricEclipticPos() const</td><td> </td><td class="right">Vec3d StelCore::getObserverHeliocentricEclipticPos() const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return Vec3d(matAltAzToHeliocentricEclipticJ2000[12], matAltAzToHeli
ocentricEclipticJ2000[13], matAltAzToHeliocentricEclipticJ2000[14]);</td><td> </td><td class="right">       return Vec3d(matAltAzToHeliocentricEclipticJ2000[12], matAltAzToHeli
ocentricEclipticJ2000[13], matAltAzToHeliocentricEclipticJ2000[14]);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Set the location to use by default at startup</td><td> </td><td class="right">// Set the location to use by default at startup</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l9" /><small>skipping to change at</small><em> line 1021</em></th><th> </th><th><a name="part-r9" /><small>skipping to change at</small><em> line 1045</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (loc.isValid())</td><td> </td><td class="right">       if (loc.isValid())</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               moveObserverTo(loc, 0.);</td><td> </td><td class="right">               moveObserverTo(loc, 0.);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       PlanetP p = GETSTELMODULE(SolarSystem)-&gt;searchByEnglishName(loc.plan
etName);</td><td> </td><td class="right">       PlanetP p = GETSTELMODULE(SolarSystem)-&gt;searchByEnglishName(loc.plan
etName);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       QSettings* conf = StelApp::getInstance().getSettings();</td><td> </td><td class="right">       QSettings* conf = StelApp::getInstance().getSettings();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       LandscapeMgr* landscapeMgr = GETSTELMODULE(LandscapeMgr);</td><td> </td><td class="right">       LandscapeMgr* landscapeMgr = GETSTELMODULE(LandscapeMgr);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       landscapeMgr-&gt;setCurrentLandscapeID(landscapeMgr-&gt;getDefaultLandscap
eID());</td><td> </td><td class="right">       landscapeMgr-&gt;setCurrentLandscapeID(landscapeMgr-&gt;getDefaultLandscap
eID());</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       landscapeMgr-&gt;setFlagAtmosphere(p-&gt;hasAtmosphere() &amp;&amp; conf-&gt;value("l
andscape/flag_atmosphere", true).toBool());</td><td> </td><td class="right">       landscapeMgr-&gt;setFlagAtmosphere(p-&gt;hasAtmosphere() &amp;&amp; conf-&gt;value("l
andscape/flag_atmosphere", true).toBool());</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       landscapeMgr-&gt;setFlagFog(p-&gt;hasAtmosphere() &amp;&amp; conf-&gt;value("landscap
e/flag_fog", true).toBool());</td><td> </td><td class="right">       landscapeMgr-&gt;setFlagFog(p-&gt;hasAtmosphere() &amp;&amp; conf-&gt;value("landscap
e/flag_fog", true).toBool());</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0035" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       landscapeMgr-&gt;setFlagLandscape(!p-&gt;getEnglishName().contains("observ
er", Qt::CaseInsensitive) &amp;&amp; conf-&gt;value("landscape/flag_landscape", true).
toBool());</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       GETSTELMODULE(StelObjectMgr)-&gt;unSelect();</td><td> </td><td class="right">       GETSTELMODULE(StelObjectMgr)-&gt;unSelect();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       StelMovementMgr* smmgr = getMovementMgr();</td><td> </td><td class="right">       StelMovementMgr* smmgr = getMovementMgr();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       smmgr-&gt;setViewDirectionJ2000(altAzToJ2000(smmgr-&gt;getInitViewingDirec
tion(), StelCore::RefractionOff));</td><td> </td><td class="right">       smmgr-&gt;setViewDirectionJ2000(altAzToJ2000(smmgr-&gt;getInitViewingDirec
tion(), StelCore::RefractionOff));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       smmgr-&gt;zoomTo(smmgr-&gt;getInitFov(), 1.);</td><td> </td><td class="right">       smmgr-&gt;zoomTo(smmgr-&gt;getInitFov(), 1.);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">double StelCore::getJDOfLastJDUpdate() const</td><td> </td><td class="right">double StelCore::getJDOfLastJDUpdate() const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l10" /><small>skipping to change at</small><em> line 1122</em></th><th> </th><th><a name="part-r10" /><small>skipping to change at</small><em> line 1147</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               Planet* pl = dynamic_cast&lt;Planet*&gt;(objmgr-&gt;getSelectedObject
()[0].data());</td><td> </td><td class="right">               Planet* pl = dynamic_cast&lt;Planet*&gt;(objmgr-&gt;getSelectedObject
()[0].data());</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               if (pl)</td><td> </td><td class="right">               if (pl)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       // We need to move to the selected planet. Try to ge
nerate a location from the current one</td><td> </td><td class="right">                       // We need to move to the selected planet. Try to ge
nerate a location from the current one</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       StelLocation loc = getCurrentLocation();</td><td> </td><td class="right">                       StelLocation loc = getCurrentLocation();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       if (loc.planetName != pl-&gt;getEnglishName())</td><td> </td><td class="right">                       if (loc.planetName != pl-&gt;getEnglishName())</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       {</td><td> </td><td class="right">                       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               loc.planetName = pl-&gt;getEnglishName();</td><td> </td><td class="right">                               loc.planetName = pl-&gt;getEnglishName();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               loc.name = "-";</td><td> </td><td class="right">                               loc.name = "-";</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               loc.state = "";</td><td> </td><td class="right">                               loc.state = "";</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0036" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                           </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                               <span class="insert">// Let's try guess name of location...</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                               LocationMap results = StelApp::getInstance()</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">.getLocationMgr().pickLocationsNearby(loc.planetName, loc.longitude, loc.la</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">titude, 1.0f);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                               if (results.size()&gt;0)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                                       loc = results.value(results.firstKey</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">()); // ...and use it!</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                           </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               moveObserverTo(loc);</td><td> </td><td class="right">                               moveObserverTo(loc);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               LandscapeMgr* landscapeMgr = GETSTELMODULE(L
andscapeMgr);</td><td> </td><td class="right">                               LandscapeMgr* landscapeMgr = GETSTELMODULE(L
andscapeMgr);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               if (pl-&gt;getEnglishName().contains("Observer"
, Qt::CaseInsensitive))</td><td> </td><td class="right">                               if (pl-&gt;getEnglishName().contains("Observer"
, Qt::CaseInsensitive))</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               {</td><td> </td><td class="right">                               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       landscapeMgr-&gt;setFlagAtmosphere(fals
e);</td><td> </td><td class="right">                                       landscapeMgr-&gt;setFlagAtmosphere(fals
e);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       landscapeMgr-&gt;setFlagFog(false);</td><td> </td><td class="right">                                       landscapeMgr-&gt;setFlagFog(false);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       landscapeMgr-&gt;setFlagLandscape(false
);</td><td> </td><td class="right">                                       landscapeMgr-&gt;setFlagLandscape(false
);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               }</td><td> </td><td class="right">                               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               else</td><td> </td><td class="right">                               else</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l11" /><small>skipping to change at</small><em> line 1170</em></th><th> </th><th><a name="part-r11" /><small>skipping to change at</small><em> line 1201</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void StelCore::setObserver(StelObserver *obs)</td><td> </td><td class="right">void StelCore::setObserver(StelObserver *obs)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       delete position;</td><td> </td><td class="right">       delete position;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       position = obs;</td><td> </td><td class="right">       position = obs;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Smoothly move the observer to the given location</td><td> </td><td class="right">// Smoothly move the observer to the given location</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void StelCore::moveObserverTo(const StelLocation&amp; target, double duration, 
double durationIfPlanetChange)</td><td> </td><td class="right">void StelCore::moveObserverTo(const StelLocation&amp; target, double duration, 
double durationIfPlanetChange)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0037" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       emit(locationChanged(target));</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double d = (getCurrentLocation().planetName==target.planetName) ? du
ration : durationIfPlanetChange;</td><td> </td><td class="right">       double d = (getCurrentLocation().planetName==target.planetName) ? du
ration : durationIfPlanetChange;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (d&gt;0.)</td><td> </td><td class="right">       if (d&gt;0.)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               StelLocation curLoc = getCurrentLocation();</td><td> </td><td class="right">               StelLocation curLoc = getCurrentLocation();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               if (position-&gt;isTraveling())</td><td> </td><td class="right">               if (position-&gt;isTraveling())</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       // Avoid using a temporary location name to create a
nother temporary one (otherwise it looks like loc1 -&gt; loc2 -&gt; loc3 etc..)</td><td> </td><td class="right">                       // Avoid using a temporary location name to create a
nother temporary one (otherwise it looks like loc1 -&gt; loc2 -&gt; loc3 etc..)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       curLoc.name = ".";</td><td> </td><td class="right">                       curLoc.name = ".";</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               SpaceShipObserver* newObs = new SpaceShipObserver(curLoc, ta
rget, d);</td><td> </td><td class="right">               SpaceShipObserver* newObs = new SpaceShipObserver(curLoc, ta
rget, d);</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0038" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               <span class="delete">delete position;</span></td><td> </td><td class="rblock">               <span class="insert">setObserver(newObs);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               position = newObs;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               newObs-&gt;update(0);</td><td> </td><td class="right">               newObs-&gt;update(0);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       else</td><td> </td><td class="right">       else</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0039" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               <span class="delete">delete position;</span></td><td> </td><td class="rblock">               <span class="insert">setObserver(new StelObserver(target));</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               position = new StelObserver(target);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0040" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       <span class="insert">emit targetLocationChanged(target);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       emit locationChanged(getCurrentLocation());</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">float StelCore::getUTCOffset(const double JD) const</td><td> </td><td class="right">float StelCore::getUTCOffset(const double JD) const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       int year, month, day, hour, minute, second;</td><td> </td><td class="right">       int year, month, day, hour, minute, second;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       StelUtils::getDateFromJulianDay(JD, &amp;year, &amp;month, &amp;day);</td><td> </td><td class="right">       StelUtils::getDateFromJulianDay(JD, &amp;year, &amp;month, &amp;day);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       StelUtils::getTimeFromJulianDay(JD, &amp;hour, &amp;minute, &amp;second);</td><td> </td><td class="right">       StelUtils::getTimeFromJulianDay(JD, &amp;hour, &amp;minute, &amp;second);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // as analogous to second statement in getJDFromDate, nkerr</td><td> </td><td class="right">       // as analogous to second statement in getJDFromDate, nkerr</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if ( year &lt;= 0 )</td><td> </td><td class="right">       if ( year &lt;= 0 )</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l12" /><small>skipping to change at</small><em> line 1243</em></th><th> </th><th><a name="part-r12" /><small>skipping to change at</small><em> line 1273</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               else</td><td> </td><td class="right">               else</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       shiftInSeconds = (loc.longitude/15.f)*3600.f; // Loc
al Mean Solar Time</td><td> </td><td class="right">                       shiftInSeconds = (loc.longitude/15.f)*3600.f; // Loc
al Mean Solar Time</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               if (tzName=="LTST")</td><td> </td><td class="right">               if (tzName=="LTST")</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       shiftInSeconds += getSolutionEquationOfTime(JD)*60;</td><td> </td><td class="right">                       shiftInSeconds += getSolutionEquationOfTime(JD)*60;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       delete tz;</td><td> </td><td class="right">       delete tz;</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0041" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       tz = <span class="delete">NULL</span>;</td><td> </td><td class="rblock">       tz = <span class="insert">Q_NULLPTR</span>;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       float shiftInHours = shiftInSeconds / 3600.0f;</td><td> </td><td class="right">       float shiftInHours = shiftInSeconds / 3600.0f;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return shiftInHours;</td><td> </td><td class="right">       return shiftInHours;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">QString StelCore::getCurrentTimeZone() const</td><td> </td><td class="right">QString StelCore::getCurrentTimeZone() const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return currentTimeZone;</td><td> </td><td class="right">       return currentTimeZone;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l13" /><small>skipping to change at</small><em> line 1754</em></th><th> </th><th><a name="part-r13" /><small>skipping to change at</small><em> line 1784</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       jdOfLastJDUpdate = getJD();</td><td> </td><td class="right">       jdOfLastJDUpdate = getJD();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       //use currentMsecsSinceEpoch directly instead of StelApp::getTotalRu
ntime,</td><td> </td><td class="right">       //use currentMsecsSinceEpoch directly instead of StelApp::getTotalRu
ntime,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       //because the StelApp::startMSecs gets subtracted anyways in update(
)</td><td> </td><td class="right">       //because the StelApp::startMSecs gets subtracted anyways in update(
)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       //also changed to qint64 to increase precision</td><td> </td><td class="right">       //also changed to qint64 to increase precision</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       milliSecondsOfLastJDUpdate = QDateTime::currentMSecsSinceEpoch();</td><td> </td><td class="right">       milliSecondsOfLastJDUpdate = QDateTime::currentMSecsSinceEpoch();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       emit timeSyncOccurred(jdOfLastJDUpdate);</td><td> </td><td class="right">       emit timeSyncOccurred(jdOfLastJDUpdate);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void StelCore::registerMathMetaTypes()</td><td> </td><td class="right">void StelCore::registerMathMetaTypes()</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0042" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       //enables use of these types in QVariant, StelProperty, signals and 
slots</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       qRegisterMetaType&lt;Vec2d&gt;();</td><td> </td><td class="right">       qRegisterMetaType&lt;Vec2d&gt;();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       qRegisterMetaType&lt;Vec2f&gt;();</td><td> </td><td class="right">       qRegisterMetaType&lt;Vec2f&gt;();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       qRegisterMetaType&lt;Vec2i&gt;();</td><td> </td><td class="right">       qRegisterMetaType&lt;Vec2i&gt;();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       qRegisterMetaType&lt;Vec3d&gt;();</td><td> </td><td class="right">       qRegisterMetaType&lt;Vec3d&gt;();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       qRegisterMetaType&lt;Vec3f&gt;();</td><td> </td><td class="right">       qRegisterMetaType&lt;Vec3f&gt;();</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0043" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       qRegisterMetaType&lt;Vec3i&gt;();</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       qRegisterMetaType&lt;Vec4d&gt;();</td><td> </td><td class="right">       qRegisterMetaType&lt;Vec4d&gt;();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       qRegisterMetaType&lt;Vec4f&gt;();</td><td> </td><td class="right">       qRegisterMetaType&lt;Vec4f&gt;();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       qRegisterMetaType&lt;Vec4i&gt;();</td><td> </td><td class="right">       qRegisterMetaType&lt;Vec4i&gt;();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       qRegisterMetaType&lt;Mat4d&gt;();</td><td> </td><td class="right">       qRegisterMetaType&lt;Mat4d&gt;();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       qRegisterMetaType&lt;Mat4f&gt;();</td><td> </td><td class="right">       qRegisterMetaType&lt;Mat4f&gt;();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       qRegisterMetaType&lt;Mat3d&gt;();</td><td> </td><td class="right">       qRegisterMetaType&lt;Mat3d&gt;();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       qRegisterMetaType&lt;Mat3f&gt;();</td><td> </td><td class="right">       qRegisterMetaType&lt;Mat3f&gt;();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0044" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       <span class="insert">//registers the QDataStream operators, so that QVariants with these </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">types can be saved</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       qRegisterMetaTypeStreamOperators&lt;Vec2d&gt;();</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       qRegisterMetaTypeStreamOperators&lt;Vec2f&gt;();</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       qRegisterMetaTypeStreamOperators&lt;Vec2i&gt;();</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       qRegisterMetaTypeStreamOperators&lt;Vec3d&gt;();</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       qRegisterMetaTypeStreamOperators&lt;Vec3f&gt;();</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       qRegisterMetaTypeStreamOperators&lt;Vec3i&gt;();</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       qRegisterMetaTypeStreamOperators&lt;Vec4d&gt;();</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       qRegisterMetaTypeStreamOperators&lt;Vec4f&gt;();</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       qRegisterMetaTypeStreamOperators&lt;Vec4i&gt;();</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       qRegisterMetaTypeStreamOperators&lt;Mat4d&gt;();</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       qRegisterMetaTypeStreamOperators&lt;Mat4f&gt;();</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       qRegisterMetaTypeStreamOperators&lt;Mat3d&gt;();</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       qRegisterMetaTypeStreamOperators&lt;Mat3f&gt;();</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                           </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       //for debugging QVariants with these types, it helps if we register 
the string converters</td><td> </td><td class="right">       //for debugging QVariants with these types, it helps if we register 
the string converters</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0045" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       <span class="insert">QMetaType::registerConverter(&amp;Vec2d::toString);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       QMetaType::registerConverter(&amp;Vec2f::toString);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       QMetaType::registerConverter(&amp;Vec2i::toString);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       QMetaType::registerConverter(&amp;Vec3d::toString);</td><td> </td><td class="right">       QMetaType::registerConverter(&amp;Vec3d::toString);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       QMetaType::registerConverter(&amp;Vec3f::toString);</td><td> </td><td class="right">       QMetaType::registerConverter(&amp;Vec3f::toString);</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0046" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       QMetaType::registerConverter(&amp;Vec3i::toString);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       QMetaType::registerConverter(&amp;Vec4d::toString);</td><td> </td><td class="right">       QMetaType::registerConverter(&amp;Vec4d::toString);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       QMetaType::registerConverter(&amp;Vec4f::toString);</td><td> </td><td class="right">       QMetaType::registerConverter(&amp;Vec4f::toString);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       QMetaType::registerConverter(&amp;Vec4i::toString);</td><td> </td><td class="right">       QMetaType::registerConverter(&amp;Vec4i::toString);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void StelCore::setStartupTimeMode(const QString&amp; s)</td><td> </td><td class="right">void StelCore::setStartupTimeMode(const QString&amp; s)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       startupTimeMode = s;</td><td> </td><td class="right">       startupTimeMode = s;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l14" /><small>skipping to change at</small><em> line 2054</em></th><th> </th><th><a name="part-r14" /><small>skipping to change at</small><em> line 2105</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       break;</td><td> </td><td class="right">                       break;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               case StephensonMorrisonHohenkerk2016:</td><td> </td><td class="right">               case StephensonMorrisonHohenkerk2016:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       deltaTnDot = -25.82; // n.dot = -25.82 "/cy/cy</td><td> </td><td class="right">                       deltaTnDot = -25.82; // n.dot = -25.82 "/cy/cy</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       deltaTfunc=StelUtils::getDeltaTByStephensonMorrisonH
ohenkerk2016;</td><td> </td><td class="right">                       deltaTfunc=StelUtils::getDeltaTByStephensonMorrisonH
ohenkerk2016;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       deltaTstart     = -720;</td><td> </td><td class="right">                       deltaTstart     = -720;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       deltaTfinish    = 2015;</td><td> </td><td class="right">                       deltaTfinish    = 2015;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       break;</td><td> </td><td class="right">                       break;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               case Custom:</td><td> </td><td class="right">               case Custom:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       // User defined coefficients for quadratic equation 
for DeltaT. These can change, and we don't use the function pointer here.</td><td> </td><td class="right">                       // User defined coefficients for quadratic equation 
for DeltaT. These can change, and we don't use the function pointer here.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       deltaTnDot = deltaTCustomNDot; // n.dot = custom val
ue "/cy/cy</td><td> </td><td class="right">                       deltaTnDot = deltaTCustomNDot; // n.dot = custom val
ue "/cy/cy</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0047" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       deltaTfunc=<span class="delete">NULL</span>;</td><td> </td><td class="rblock">                       deltaTfunc=<span class="insert">Q_NULLPTR</span>;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       deltaTstart     = INT_MIN; // Range unknown!</td><td> </td><td class="right">                       deltaTstart     = INT_MIN; // Range unknown!</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       deltaTfinish    = INT_MAX;</td><td> </td><td class="right">                       deltaTfinish    = INT_MAX;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       break;</td><td> </td><td class="right">                       break;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               default:</td><td> </td><td class="right">               default:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       deltaTnDot = -26.0; // n.dot = -26.0 "/cy/cy</td><td> </td><td class="right">                       deltaTnDot = -26.0; // n.dot = -26.0 "/cy/cy</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0048" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       deltaTfunc=<span class="delete">NULL</span>;</td><td> </td><td class="rblock">                       deltaTfunc=<span class="insert">Q_NULLPTR</span>;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       deltaTstart     = INT_MIN; // Range unknown!</td><td> </td><td class="right">                       deltaTstart     = INT_MIN; // Range unknown!</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       deltaTfinish    = INT_MAX;</td><td> </td><td class="right">                       deltaTfinish    = INT_MAX;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       qCritical() &lt;&lt; "StelCore: unknown DeltaT algorithm s
elected (" &lt;&lt; currentDeltaTAlgorithm &lt;&lt; ")! (setting nDot=-26., but no func
tion!!)";</td><td> </td><td class="right">                       qCritical() &lt;&lt; "StelCore: unknown DeltaT algorithm s
elected (" &lt;&lt; currentDeltaTAlgorithm &lt;&lt; ")! (setting nDot=-26., but no func
tion!!)";</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0049" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       Q_ASSERT((currentDeltaTAlgorithm==Custom) || (deltaTfunc!=<span class="delete">NULL)</span>);</td><td> </td><td class="rblock">       Q_ASSERT((currentDeltaTAlgorithm==Custom) || (deltaTfunc!=<span class="insert">Q_NULLPTR)
</span>);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//! Set the current algorithm for time correction to use</td><td> </td><td class="right">//! Set the current algorithm for time correction to use</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void StelCore::setCurrentDeltaTAlgorithmKey(QString key)</td><td> </td><td class="right">void StelCore::setCurrentDeltaTAlgorithmKey(QString key)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       const QMetaEnum&amp; en = metaObject()-&gt;enumerator(metaObject()-&gt;indexOf
Enumerator("DeltaTAlgorithm"));</td><td> </td><td class="right">       const QMetaEnum&amp; en = metaObject()-&gt;enumerator(metaObject()-&gt;indexOf
Enumerator("DeltaTAlgorithm"));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       DeltaTAlgorithm algo = (DeltaTAlgorithm)en.keyToValue(key.toLatin1()
.data());</td><td> </td><td class="right">       DeltaTAlgorithm algo = (DeltaTAlgorithm)en.keyToValue(key.toLatin1()
.data());</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (algo&lt;0)</td><td> </td><td class="right">       if (algo&lt;0)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               qWarning() &lt;&lt; "Unknown DeltaT algorithm: " &lt;&lt; key &lt;&lt; "settin
g \"WithoutCorrection\" instead";</td><td> </td><td class="right">               qWarning() &lt;&lt; "Unknown DeltaT algorithm: " &lt;&lt; key &lt;&lt; "settin
g \"WithoutCorrection\" instead";</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l15" /><small>skipping to change at</small><em> line 2372</em></th><th> </th><th><a name="part-r15" /><small>skipping to change at</small><em> line 2423</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if(de431Available)</td><td> </td><td class="right">       if(de431Available)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               qDebug() &lt;&lt; "DE431 at: " &lt;&lt; de431FilePath;</td><td> </td><td class="right">               qDebug() &lt;&lt; "DE431 at: " &lt;&lt; de431FilePath;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               EphemWrapper::init_de431(de431FilePath.toStdString().c_str()
);</td><td> </td><td class="right">               EphemWrapper::init_de431(de431FilePath.toStdString().c_str()
);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       setDe431Active(de431Available &amp;&amp; conf-&gt;value("astro/flag_use_de431",
 false).toBool());</td><td> </td><td class="right">       setDe431Active(de431Available &amp;&amp; conf-&gt;value("astro/flag_use_de431",
 false).toBool());</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Methods for finding constellation from J2000 position.</td><td> </td><td class="right">// Methods for finding constellation from J2000 position.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">typedef struct iau_constline{</td><td> </td><td class="right">typedef struct iau_constline{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0050" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">float</span> RAlow;  // low value of 1875.0 right ascension segment, <span class="delete">HH.ddd</span></td><td> </td><td class="rblock">       <span class="insert">double</span> RAlow;  // low value of 1875.0 right ascension segment, <span class="insert">HH.dd</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">d</span></td><td> </td><td class="rblock"><span class="insert">dd</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       float</span> RAhigh; // high value of 1875.0 right ascension segment, <span class="delete">HH.dd</span></td><td> </td><td class="rblock"><span class="insert">       double</span> RAhigh; // high value of 1875.0 right ascension segment, <span class="insert">HH.d</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">dd</span></td><td> </td><td class="rblock"><span class="insert">ddd</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       float</span> decLow; // declination 1875.0 of southern border, DD.dddd</td><td> </td><td class="rblock"><span class="insert">       double</span> decLow; // declination 1875.0 of southern border, DD.dddd</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       QString constellation; // 3-letter code of constellation</td><td> </td><td class="right">       QString constellation; // 3-letter code of constellation</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">} iau_constelspan;</td><td> </td><td class="right">} iau_constelspan;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">static QVector&lt;iau_constelspan&gt; iau_constlineVec;</td><td> </td><td class="right">static QVector&lt;iau_constelspan&gt; iau_constlineVec;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">static bool iau_constlineVecInitialized=false;</td><td> </td><td class="right">static bool iau_constlineVecInitialized=false;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0051" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">// File iau_constellations_spans.dat is file data.dat from <span class="delete">ADC</span> catalog <span class="delete">VI/4</span></td><td> </td><td class="rblock">// File iau_constellations_spans.dat is <span class="insert">converted from</span> file data.dat from <span class="insert">A</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">2</span></td><td> </td><td class="rblock"><span class="insert">DC</span> catalog <span class="insert">VI/42.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">QString StelCore::getIAUConstellation(const Vec3d <span class="delete">positionJ2000)</span> const</td><td> </td><td class="rblock"><span class="insert">// We converted back to HH:MM:SS format to avoid the inherent rounding erro</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">rs present in that file (Bug LP:#1690615).</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">QString StelCore::getIAUConstellation(const Vec3d <span class="insert">positionEqJnow)</span> const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // Precess positionJ2000 to 1875.0</td><td> </td><td class="right">       // Precess positionJ2000 to 1875.0</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0052" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       Vec3d <span class="delete">pos1875=j2000ToJ1875(positionJ2000);</span></td><td> </td><td class="rblock">       Vec3d <span class="insert">pos1875=j2000ToJ1875(equinoxEquToJ2000(positionEqJnow));</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       float</span> RA1875;</td><td> </td><td class="rblock"><span class="insert">       double</span> RA1875;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">float</span> dec1875;</td><td> </td><td class="rblock">       <span class="insert">double</span> dec1875;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       StelUtils::rectToSphe(&amp;RA1875, &amp;dec1875, pos1875);</td><td> </td><td class="right">       StelUtils::rectToSphe(&amp;RA1875, &amp;dec1875, pos1875);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       RA1875 *= 12./M_PI; // hours</td><td> </td><td class="right">       RA1875 *= 12./M_PI; // hours</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0053" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       if (RA1875 &lt;0.<span class="delete">f) RA1875+=24.f</span>;</td><td> </td><td class="rblock">       if (RA1875 &lt;0.<span class="insert">) RA1875+=24.</span>;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       dec1875 *= 180./M_PI; // degrees</td><td> </td><td class="right">       dec1875 *= 180./M_PI; // degrees</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0054" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">Q_ASSERT(RA1875&gt;=0.0f);</span></td><td> </td><td class="rblock">       <span class="insert">Q_ASSERT(RA1875&gt;=0.0);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       Q_ASSERT(RA1875&lt;=24.0f);</span></td><td> </td><td class="rblock"><span class="insert">       Q_ASSERT(RA1875&lt;=24.0);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       Q_ASSERT(dec1875&lt;=90.0f);</span></td><td> </td><td class="rblock"><span class="insert">       Q_ASSERT(dec1875&lt;=90.0);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       Q_ASSERT(dec1875&gt;=-90.0f);</span></td><td> </td><td class="rblock"><span class="insert">       Q_ASSERT(dec1875&gt;=-90.0);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // read file into structure.</td><td> </td><td class="right">       // read file into structure.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (!iau_constlineVecInitialized)</td><td> </td><td class="right">       if (!iau_constlineVecInitialized)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               //struct iau_constline line;</td><td> </td><td class="right">               //struct iau_constline line;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               QFile file(StelFileMgr::findFile("data/constellations_spans.
dat"));</td><td> </td><td class="right">               QFile file(StelFileMgr::findFile("data/constellations_spans.
dat"));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               if (!file.open(QIODevice::ReadOnly | QIODevice::Text))</td><td> </td><td class="right">               if (!file.open(QIODevice::ReadOnly | QIODevice::Text))</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       qWarning() &lt;&lt; "IAU constellation line data file data
/constellations_spans.dat not found.";</td><td> </td><td class="right">                       qWarning() &lt;&lt; "IAU constellation line data file data
/constellations_spans.dat not found.";</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l16" /><small>skipping to change at</small><em> line 2426</em></th><th> </th><th><a name="part-r16" /><small>skipping to change at</small><em> line 2478</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       if (emptyLine.exactMatch((line))) continue;</td><td> </td><td class="right">                       if (emptyLine.exactMatch((line))) continue;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       if (line.at(0)=='#') continue; // skip comment lines
.</td><td> </td><td class="right">                       if (line.at(0)=='#') continue; // skip comment lines
.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       //QStringList list = line.split(QRegExp("\\b\\s+\\b"
));</td><td> </td><td class="right">                       //QStringList list = line.split(QRegExp("\\b\\s+\\b"
));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       QStringList list = line.trimmed().split(QRegExp("\\s
+"));</td><td> </td><td class="right">                       QStringList list = line.trimmed().split(QRegExp("\\s
+"));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       if (list.count() != 4)</td><td> </td><td class="right">                       if (list.count() != 4)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       {</td><td> </td><td class="right">                       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               qWarning() &lt;&lt; "IAU constellation file conste
llations_spans.dat has bad line:" &lt;&lt; line &lt;&lt; "with" &lt;&lt; list.count() &lt;&lt; "ele
ments";</td><td> </td><td class="right">                               qWarning() &lt;&lt; "IAU constellation file conste
llations_spans.dat has bad line:" &lt;&lt; line &lt;&lt; "with" &lt;&lt; list.count() &lt;&lt; "ele
ments";</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               continue;</td><td> </td><td class="right">                               continue;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       }</td><td> </td><td class="right">                       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       //qDebug() &lt;&lt; "Creating span for decl=" &lt;&lt; list.at(2
) &lt;&lt; " from RA=" &lt;&lt; list.at(0) &lt;&lt; "to" &lt;&lt; list.at(1) &lt;&lt; ": " &lt;&lt; list.at(3);</td><td> </td><td class="right">                       //qDebug() &lt;&lt; "Creating span for decl=" &lt;&lt; list.at(2
) &lt;&lt; " from RA=" &lt;&lt; list.at(0) &lt;&lt; "to" &lt;&lt; list.at(1) &lt;&lt; ": " &lt;&lt; list.at(3);</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0055" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       <span class="delete">span.RAlow=atof(list.at(0).toLatin1());</span></td><td> </td><td class="rblock">                       <span class="insert">QStringList numList=list.at(0).split(QRegExp(":"));</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                       span.RAhigh=atof(list.at(1).toLatin1());</span></td><td> </td><td class="rblock"><span class="insert">                       span.RAlow= atof(numList.at(0).toLatin1()) + atof(nu</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                       span.decLow=atof(list.at(2).toLatin1());</span></td><td> </td><td class="rblock"><span class="insert">mList.at(1).toLatin1())/60. + atof(numList.at(2).toLatin1())/3600.;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       numList=list.at(1).split(QRegExp(":"));</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       span.RAhigh=atof(numList.at(0).toLatin1()) + atof(nu</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">mList.at(1).toLatin1())/60. + atof(numList.at(2).toLatin1())/3600.;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       numList=list.at(2).split(QRegExp(":"));</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       span.decLow=atof(numList.at(0).toLatin1()) + atof(nu</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">mList.at(1).toLatin1())/60.;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       span.constellation=list.at(3);</td><td> </td><td class="right">                       span.constellation=list.at(3);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       iau_constlineVec.append(span);</td><td> </td><td class="right">                       iau_constlineVec.append(span);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               file.close();</td><td> </td><td class="right">               file.close();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               iau_constlineVecInitialized=true;</td><td> </td><td class="right">               iau_constlineVecInitialized=true;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // iterate through vector, find entry where declination is lower.</td><td> </td><td class="right">       // iterate through vector, find entry where declination is lower.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       int entry=0;</td><td> </td><td class="right">       int entry=0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       while (iau_constlineVec.at(entry).decLow &gt; dec1875)</td><td> </td><td class="right">       while (iau_constlineVec.at(entry).decLow &gt; dec1875)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l17" /><small>skipping to change at</small><em> line 2454</em></th><th> </th><th><a name="part-r17" /><small>skipping to change at</small><em> line 2509</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               while (iau_constlineVec.at(entry).RAlow &gt;= RA1875)</td><td> </td><td class="right">               while (iau_constlineVec.at(entry).RAlow &gt;= RA1875)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       entry++;</td><td> </td><td class="right">                       entry++;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               if (iau_constlineVec.at(entry).RAhigh &gt; RA1875)</td><td> </td><td class="right">               if (iau_constlineVec.at(entry).RAhigh &gt; RA1875)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       return iau_constlineVec.at(entry).constellation;</td><td> </td><td class="right">                       return iau_constlineVec.at(entry).constellation;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               else</td><td> </td><td class="right">               else</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       entry++;</td><td> </td><td class="right">                       entry++;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       qDebug() &lt;&lt; "getIAUconstellation error: Cannot determine, algorithm 
failed.";</td><td> </td><td class="right">       qDebug() &lt;&lt; "getIAUconstellation error: Cannot determine, algorithm 
failed.";</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return "(?)";</td><td> </td><td class="right">       return "(?)";</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0056" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                           </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">Vec3d StelCore::getMouseJ2000Pos() const</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">{</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       const StelProjectorP prj = getProjection(StelCore::FrameJ2000, StelC</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">ore::RefractionAuto);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       float ppx = getCurrentStelProjectorParams().devicePixelsPerPixel;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       QPoint p = StelMainView::getInstance().getMousePos(); // get screen </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">coordinates of mouse cursor</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       Vec3d mousePosition;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       float wh = prj-&gt;getViewportWidth()/2.; // get half of width of the s</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">creen</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       float hh = prj-&gt;getViewportHeight()/2.; // get half of height of the</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"> screen</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       float mx = p.x()*ppx-wh; // point 0 in center of the screen, axis X </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">directed to right</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       float my = p.y()*ppx-hh; // point 0 in center of the screen, axis Y </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">directed to bottom</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       // calculate position of mouse cursor via position of center of the </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">screen (and invert axis Y)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       // If coordinates are invalid, don't draw them.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       bool coordsValid = prj-&gt;unProject((prj-&gt;getViewportPosX()+wh+mx), (p</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">rj-&gt;getViewportPosY()+hh+1-my), mousePosition);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       if (coordsValid)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       { // Nick Fedoseev patch</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               Vec3d win;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               prj-&gt;project(mousePosition,win);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               float dx = prj-&gt;getViewportPosX()+wh+mx - win.v[0];</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               float dy = prj-&gt;getViewportPosY()+hh+1-my - win.v[1];</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               prj-&gt;unProject((prj-&gt;getViewportPosX()+wh+mx+dx), (prj-&gt;getV</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">iewportPosY()+hh+1-my+dy), mousePosition);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       return mousePosition;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">}</span></td><td class="lineno" valign="top"></td></tr>

     <tr><td></td><td class="left"></td><td> </td><td class="right"></td><td></td></tr>
     <tr bgcolor="gray"><th colspan="5" align="center"><a name="end">&nbsp;End of changes. 56 change blocks.&nbsp;</a></th></tr>
     <tr class="stats"><td></td><th><i>72 lines changed or deleted</i></th><th><i> </i></th><th><i>147 lines changed or added</i></th><td></td></tr>
     <tr><td colspan="5" align="center" class="small"><br/>This html diff was produced by rfcdiff 1.41. The latest version is available from <a href="http://www.tools.ietf.org/tools/rfcdiff/" >http://tools.ietf.org/tools/rfcdiff/</a> </td></tr>
   </table>
   </body>
   </html>
