<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
<!-- Generated by rfcdiff 1.41: rfcdiff  --> 
<!-- <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional" > -->
<!-- System: Linux fomalhaut.local 3.13.0-62-generic #101-Ubuntu SMP Thu Jul 30 09:01:36 UTC 2015 x86_64 x86_64 x86_64 GNU/Linux --> 
<!-- Using awk: /usr/bin/gawk: GNU Awk 4.0.1 --> 
<!-- Using diff: /usr/bin/diff: diff (GNU diffutils) 3.3 --> 
<!-- Using wdiff: /usr/bin/wdiff: wdiff (GNU wdiff) 1.2.1 --> 
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"> 
<head> 
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 
  <meta http-equiv="Content-Style-Type" content="text/css" /> 
  <title>Diff: sidereal_time.c - sidereal_time.c</title> 
  <style type="text/css"> 
    body    { font-size:16px; margin: 0.4ex; margin-right: auto; } 
    tr      { } 
    td      { white-space: pre; font-family: Consolas, "DejaVu Sans Mono", "Droid Sans Mono", Monaco, Monospace; vertical-align: top; font-size: 0.86em;} 
    th      { font-size: 0.86em; } 
    .small  { font-size: 0.6em; font-style: italic; font-family: Verdana, Helvetica, sans-serif; } 
    .left   { background-color: #EEE; } 
    .right  { background-color: #FFF; } 
    .diff   { background-color: #CCF; } 
    .lblock { background-color: #BFB; } 
    .rblock { background-color: #FF8; } 
    .insert { background-color: #8FF; } 
    .delete { background-color: #ACF; } 
    .void   { background-color: #FFB; } 
    .cont   { background-color: #EEE; } 
    .linebr { background-color: #AAA; } 
    .lineno { color: red; background-color: #FFF; font-size: 0.7em; text-align: right; padding: 0 2px; } 
    .elipsis{ background-color: #AAA; } 
    .left .cont { background-color: #DDD; } 
    .right .cont { background-color: #EEE; } 
    .lblock .cont { background-color: #9D9; } 
    .rblock .cont { background-color: #DD6; } 
    .insert .cont { background-color: #0DD; } 
    .delete .cont { background-color: #8AD; } 
    .stats, .stats td, .stats th { background-color: #EEE; padding: 2px 0; } 
  </style> 
</head> 
<body > 
  <table border="0" cellpadding="0" cellspacing="0"> 
  <tr bgcolor="orange"><th></th><th>&nbsp;sidereal_time.c&nbsp;</th><th> </th><th>&nbsp;sidereal_time.c&nbsp;</th><th></th></tr> 
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l1" /><small>skipping to change at</small><em> line 17</em></th><th> </th><th><a name="part-r1" /><small>skipping to change at</small><em> line 17</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">This program is distributed in the hope that it will be useful,</td><td> </td><td class="right">This program is distributed in the hope that it will be useful,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">but WITHOUT ANY WARRANTY; without even the implied warranty of</td><td> </td><td class="right">but WITHOUT ANY WARRANTY; without even the implied warranty of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</td><td> </td><td class="right">MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">GNU General Public License for more details.</td><td> </td><td class="right">GNU General Public License for more details.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">You should have received a copy of the GNU General Public License</td><td> </td><td class="right">You should have received a copy of the GNU General Public License</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">along with this program; if not, write to the Free Software</td><td> </td><td class="right">along with this program; if not, write to the Free Software</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">Foundation, Inc., 51 Franklin Street, Suite 500, Boston, MA  02110-1335, US
A.</td><td> </td><td class="right">Foundation, Inc., 51 Franklin Street, Suite 500, Boston, MA  02110-1335, US
A.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">Copyright (C) 2000 Liam Girdwood &lt;liam@nova-ioe.org&gt;</td><td> </td><td class="right">Copyright (C) 2000 Liam Girdwood &lt;liam@nova-ioe.org&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0001" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">Copyright (C) 2015 Georg Zotti (deactivated old IAU-1980 Nutation functions
, update to IAU-2000B)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">*/</td><td> </td><td class="right">*/</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#include &lt;math.h&gt;</td><td> </td><td class="right">#include &lt;math.h&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0002" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">#include &lt;assert.h&gt;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">#include "precession.h"</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#ifndef M_PI</td><td> </td><td class="right">#ifndef M_PI</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#define M_PI           3.14159265358979323846</td><td> </td><td class="right">#define M_PI           3.14159265358979323846</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#endif</td><td> </td><td class="right">#endif</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">/* puts a large angle in the correct range 0 - 360 degrees */</td><td> </td><td class="right">/* puts a large angle in the correct range 0 - 360 degrees */</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">double range_degrees(double d)</td><td> </td><td class="right">double range_degrees(double d)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       d = fmod( d, 360.);</td><td> </td><td class="right">       d = fmod( d, 360.);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if(d&lt;0.) d += 360.;</td><td> </td><td class="right">       if(d&lt;0.) d += 360.;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l2" /><small>skipping to change at</small><em> line 46</em></th><th> </th><th><a name="part-r2" /><small>skipping to change at</small><em> line 49</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       r = fmod( r, 2.*M_PI );</td><td> </td><td class="right">       r = fmod( r, 2.*M_PI );</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (r&lt;0.) r += 2.*M_PI;</td><td> </td><td class="right">       if (r&lt;0.) r += 2.*M_PI;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return r;</td><td> </td><td class="right">       return r;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#define TERMS 63</td><td> </td><td class="right">#define TERMS 63</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">/* compute only every tenths of day:  */</td><td> </td><td class="right">/* compute only every tenths of day:  */</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#define LN_NUTATION_EPOCH_THRESHOLD 0.1</td><td> </td><td class="right">#define LN_NUTATION_EPOCH_THRESHOLD 0.1</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0003" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">/* Nutation is a <span class="delete">period</span> oscillation of the <span class="delete">Earths</span> rotational axis around <span class="delete">it</span></td><td> </td><td class="rblock">/* Nutation is a <span class="insert">periodic</span> oscillation of the <span class="insert">Earth's</span> rotational axis around</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">'s</span> mean position.*/</td><td> </td><td class="rblock"> <span class="insert">its</span> mean position.*/</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">/* GZ: These data from IAU1980 nutation are no longer in use: V0.14+ uses N</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">utation IAU-2000B, implemented in precession.c. */</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">/*</td><td> </td><td class="right">/*</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"> Contains Nutation in longitude, obliquity and ecliptic obliquity.</td><td> </td><td class="right"> Contains Nutation in longitude, obliquity and ecliptic obliquity.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"> Angles are expressed in degrees.</td><td> </td><td class="right"> Angles are expressed in degrees.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">*/</td><td> </td><td class="right">*/</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0004" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">/* Structs no longer used</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"> *</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">struct ln_nutation</td><td> </td><td class="right">struct ln_nutation</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0005" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       double <span class="delete">longitude;       /*!&lt;</span> Nutation in longitude <span class="delete">*/</span></td><td> </td><td class="rblock">       double <span class="insert">deltaPsi;        //!&lt; DeltaPsi,</span> Nutation in longitude</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       double <span class="delete">obliquity;       /*!&lt;</span> Nutation in obliquity <span class="delete">*/</span></td><td> </td><td class="rblock">       double <span class="insert">deltaEps;        //!&lt; DeltaEps,</span> Nutation in obliquity</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       double ecliptic;        <span class="delete">/*!&lt;</span> Obliquity of the ecliptic <span class="delete">*/</span></td><td> </td><td class="rblock">       double ecliptic;        <span class="insert">//!&lt; epsilon, Mean</span> Obliquity of the ecliptic</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">};</td><td> </td><td class="right">};</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">struct nutation_arguments</td><td> </td><td class="right">struct nutation_arguments</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double D;</td><td> </td><td class="right">       double D;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double M;</td><td> </td><td class="right">       double M;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double MM;</td><td> </td><td class="right">       double MM;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double F;</td><td> </td><td class="right">       double F;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double O;</td><td> </td><td class="right">       double O;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">};</td><td> </td><td class="right">};</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">struct nutation_coefficients</td><td> </td><td class="right">struct nutation_coefficients</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double longitude1;</td><td> </td><td class="right">       double longitude1;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double longitude2;</td><td> </td><td class="right">       double longitude2;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double obliquity1;</td><td> </td><td class="right">       double obliquity1;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double obliquity2;</td><td> </td><td class="right">       double obliquity2;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">};</td><td> </td><td class="right">};</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0006" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                                                                           </span></td><td> </td><td class="rblock"><span class="insert">*/</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">/* arguments and coefficients taken from table 21A on page 133 */</td><td> </td><td class="right">/* arguments and coefficients taken from table 21A on page 133 */</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0007" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">/* Table no longer used.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">static const struct nutation_arguments arguments[TERMS] = {</td><td> </td><td class="right">static const struct nutation_arguments arguments[TERMS] = {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {0.0,   0.0,    0.0,    0.0,    1.0},</td><td> </td><td class="right">       {0.0,   0.0,    0.0,    0.0,    1.0},</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {-2.0,  0.0,    0.0,    2.0,    2.0},</td><td> </td><td class="right">       {-2.0,  0.0,    0.0,    2.0,    2.0},</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {0.0,   0.0,    0.0,    2.0,    2.0},</td><td> </td><td class="right">       {0.0,   0.0,    0.0,    2.0,    2.0},</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {0.0,   0.0,    0.0,    0.0,    2.0},</td><td> </td><td class="right">       {0.0,   0.0,    0.0,    0.0,    2.0},</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {0.0,   1.0,    0.0,    0.0,    0.0},</td><td> </td><td class="right">       {0.0,   1.0,    0.0,    0.0,    0.0},</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {0.0,   0.0,    1.0,    0.0,    0.0},</td><td> </td><td class="right">       {0.0,   0.0,    1.0,    0.0,    0.0},</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {-2.0,  1.0,    0.0,    2.0,    2.0},</td><td> </td><td class="right">       {-2.0,  1.0,    0.0,    2.0,    2.0},</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {0.0,   0.0,    0.0,    2.0,    1.0},</td><td> </td><td class="right">       {0.0,   0.0,    0.0,    2.0,    1.0},</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {0.0,   0.0,    1.0,    2.0,    2.0},</td><td> </td><td class="right">       {0.0,   0.0,    1.0,    2.0,    2.0},</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l3" /><small>skipping to change at</small><em> line 207</em></th><th> </th><th><a name="part-r3" /><small>skipping to change at</small><em> line 214</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {-4.0,  0.0,    0.0,    0.0},</td><td> </td><td class="right">       {-4.0,  0.0,    0.0,    0.0},</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {-4.0,  0.0,    0.0,    0.0},</td><td> </td><td class="right">       {-4.0,  0.0,    0.0,    0.0},</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {3.0,   0.0,    0.0,    0.0},</td><td> </td><td class="right">       {3.0,   0.0,    0.0,    0.0},</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {-3.0,  0.0,    0.0,    0.0},</td><td> </td><td class="right">       {-3.0,  0.0,    0.0,    0.0},</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {-3.0,  0.0,    0.0,    0.0},</td><td> </td><td class="right">       {-3.0,  0.0,    0.0,    0.0},</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {-3.0,  0.0,    0.0,    0.0},</td><td> </td><td class="right">       {-3.0,  0.0,    0.0,    0.0},</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {-3.0,  0.0,    0.0,    0.0},</td><td> </td><td class="right">       {-3.0,  0.0,    0.0,    0.0},</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {-3.0,  0.0,    0.0,    0.0},</td><td> </td><td class="right">       {-3.0,  0.0,    0.0,    0.0},</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {-3.0,  0.0,    0.0,    0.0},</td><td> </td><td class="right">       {-3.0,  0.0,    0.0,    0.0},</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {-3.0,  0.0,    0.0,    0.0}};</td><td> </td><td class="right">       {-3.0,  0.0,    0.0,    0.0}};</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0008" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">*/</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">/* cache values */</td><td> </td><td class="right">/* cache values */</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0009" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">static double c_JD = 0.0, c_longitude = 0.0, c_obliquity = 0.0, c_ecliptic 
</span>= 0.0;</td><td> </td><td class="rblock"><span class="insert">// static double c_JDE = 0.0, c_longitude = 0.0, c_obliquity = 0.0, c_eclip
tic </span>= 0.0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">/* Calculate nutation of longitude and obliquity in degrees from Julian Eph
emeris Day</td><td> </td><td class="right">/* Calculate nutation of longitude and obliquity in degrees from Julian Eph
emeris Day</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0010" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">* params : JD<span class="delete"> Julian Day</span>, nutation Pointer to store nutation.</td><td> </td><td class="rblock">* params : JD<span class="insert">E Julian Day (ET/TT)</span>, nutation Pointer to store nutation.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">* Meeus, Astr. Alg. (1st ed., 1994), Chapter 21 pg 131-134 Using Table 21A 
*/</td><td> </td><td class="right">* Meeus, Astr. Alg. (1st ed., 1994), Chapter 21 pg 131-134 Using Table 21A 
*/</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">/* GZ: Changed: ecliptic obliquity used to be constant J2000.0.</td><td> </td><td class="right">/* GZ: Changed: ecliptic obliquity used to be constant J2000.0.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"> * If you don't compute this, you may as well forget about nutation!</td><td> </td><td class="right"> * If you don't compute this, you may as well forget about nutation!</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0011" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"> <span class="insert">* 2015: Laskar's 1986 formula replaced by Vondrak 2011. c_ecliptic is now </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">epsilon_A, Vondrak's obliquity of date.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"> * TODO: replace this whole function with Nutation IAU2000A or compatible v</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">ersion.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"> * FUNCTION IS UNUSED, MAYBE DELETE?</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"> */</td><td> </td><td class="right"> */</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0012" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">void get_nutation (double <span class="delete">JD,</span> struct ln_nutation * nutation)</td><td> </td><td class="rblock"><span class="insert">/*</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">void get_nutation (double <span class="insert">JDE,</span> struct ln_nutation * nutation)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double D,M,MM,F,O,T;</td><td> </td><td class="right">       double D,M,MM,F,O,T;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double coeff_sine, coeff_cos;</td><td> </td><td class="right">       double coeff_sine, coeff_cos;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       int i;</td><td> </td><td class="right">       int i;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0013" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">/*</span> should we bother recalculating nutation <span class="delete">*/</span></td><td> </td><td class="rblock">       <span class="insert">//</span> should we bother recalculating nutation</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       if <span class="delete">(fabs(JD</span> - <span class="delete">c_JD)</span> &gt; LN_NUTATION_EPOCH_THRESHOLD)</td><td> </td><td class="rblock">       if <span class="insert">(fabs(JDE</span> - <span class="insert">c_JDE)</span> &gt; LN_NUTATION_EPOCH_THRESHOLD)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">         {</td><td> </td><td class="right">         {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0014" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               <span class="delete">/*</span> set the new epoch <span class="delete">*/</span></td><td> </td><td class="rblock">               <span class="insert">//</span> set the new epoch</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               c_JD</span> = <span class="delete">JD;</span></td><td> </td><td class="rblock">               <span class="insert">c_JDE</span> = <span class="insert">JDE;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0015" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               <span class="delete">/*</span> set ecliptic. GZ: This is constant only, J2000.0. WRONG! </td><td> </td><td class="rblock">               <span class="insert">//</span> set ecliptic. GZ: This is constant only, J2000.0. WRONG!</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">*/</span></td><td> </td><td class="rblock">               <span class="insert">//</span> c_ecliptic = 23.0 + 26.0 / 60.0 + 27.407 / 3600.0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               /*</span> c_ecliptic = 23.0 + 26.0 / 60.0 + 27.407 / 3600.0; <span class="delete">*/</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0016" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               <span class="delete">/*</span> calc T <span class="delete">*/</span></td><td> </td><td class="rblock">               <span class="insert">//</span> calc T</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               T = <span class="delete">(JD</span> - 2451545.0)/36525;</td><td> </td><td class="rblock">               T = <span class="insert">(JDE</span> - 2451545.0)/36525;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               <span class="delete">/*</span> GZotti: we don't need those. <span class="delete">* /</span></td><td> </td><td class="rblock">               <span class="insert">//</span> GZotti: we don't need those.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               T2 = T * T;</td><td> </td><td class="right">               T2 = T * T;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               T3 = T2 * T;</td><td> </td><td class="right">               T3 = T2 * T;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0017" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               <span class="delete">/ *</span> calculate D,M,M',F and Omega <span class="delete">* /</span></td><td> </td><td class="rblock">               <span class="insert">//</span> calculate D,M,M',F and Omega</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               D = 297.85036 + 445267.111480 * T - 0.0019142 * T2 + T3 / 18</td><td> </td><td class="rblock"><span class="insert">//</span>             D = 297.85036 + 445267.111480 * T - 0.0019142 * T2 + T3 / 18</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">9474.0;</td><td> </td><td class="rblock">9474.0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               M = 357.52772 + 35999.050340 * T - 0.0001603 * T2 - T3 / 300</td><td> </td><td class="rblock"><span class="insert">//</span>             M = 357.52772 + 35999.050340 * T - 0.0001603 * T2 - T3 / 300</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">000.0;</td><td> </td><td class="rblock">000.0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               MM = 134.96298 + 477198.867398 * T + 0.0086972 * T2 + T3 / 5</td><td> </td><td class="rblock"><span class="insert">//</span>             MM = 134.96298 + 477198.867398 * T + 0.0086972 * T2 + T3 / 5</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">6250.0;</td><td> </td><td class="rblock">6250.0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               F = 93.2719100 + 483202.017538 * T - 0.0036825 * T2 + T3 / 3</td><td> </td><td class="rblock"><span class="insert">//</span>             F = 93.2719100 + 483202.017538 * T - 0.0036825 * T2 + T3 / 3</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">27270.0;</td><td> </td><td class="rblock">27270.0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               O = 125.04452 - 1934.136261 * T + 0.0020708 * T2 + T3 / 4500</td><td> </td><td class="rblock"><span class="insert">//</span>             O = 125.04452 - 1934.136261 * T + 0.0020708 * T2 + T3 / 4500</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">00.0;</td><td> </td><td class="rblock">00.0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">               <span class="insert">// GZ: I prefer Horner's Scheme and its better numerical acc</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">uracy.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               D = ((T / 189474.0 - 0.0019142)*T + 445267.111480)*T + 297.8</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">5036;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               M = ((T / 300000.0 - 0.0001603)*T +  35999.050340)*T + 357.5</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">2772;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               MM= ((T /  56250.0 + 0.0086972)*T + 477198.867398)*T + 134.9</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">6298;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               F = ((T / 327270.0 - 0.0036825)*T + 483202.017538)*T +  93.2</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">7191;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               O = ((T / 450000.0 + 0.0020708)*T -   1934.136261)*T + 125.0</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">4452;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0018" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               /<span class="delete"> * GZotti: Laskar's formula, only valid for J2000+/-10000 y
ears! */</span></td><td> </td><td class="rblock">               /<span class="insert">/ GZotti: Laskar's formula (1986), only valid for J2000+/-1
0000 years!</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               if (fabs(T)&lt;100)</td><td> </td><td class="right">               if (fabs(T)&lt;100)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                 {</td><td> </td><td class="right">                 {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                   double U=T/100.0;</td><td> </td><td class="right">                   double U=T/100.0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                   c_ecliptic=((((((((((2.45*U+ 5.79)*U +27.87)*U +7.12)*U 
-39.05)*U -249.67)*U</td><td> </td><td class="right">                   c_ecliptic=((((((((((2.45*U+ 5.79)*U +27.87)*U +7.12)*U 
-39.05)*U -249.67)*U</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                   -51.38)*U +1999.25)*U -1.55)*U)-4680.93)
*U +21.448;</td><td> </td><td class="right">                                   -51.38)*U +1999.25)*U -1.55)*U)-4680.93)
*U +21.448;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                 }</td><td> </td><td class="right">                 }</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0019" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               else /<span class="delete">* Use IAU formula. This might be more stable in farawa
y times, but is less accurate in any case for |U|&lt;1. */</span></td><td> </td><td class="rblock">               else /<span class="insert">/ Use IAU-1980 formula. This might be more stable in f
araway times, but is less accurate in any case for |U|&lt;1.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                 {</td><td> </td><td class="right">                 {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                   c_ecliptic=((0.001813*T-0.00059)*T-46.8150)*T+21.448;</td><td> </td><td class="right">                   c_ecliptic=((0.001813*T-0.00059)*T-46.8150)*T+21.448;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                 }</td><td> </td><td class="right">                 }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               c_ecliptic/=60.0;</td><td> </td><td class="right">               c_ecliptic/=60.0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               c_ecliptic+=26.0;</td><td> </td><td class="right">               c_ecliptic+=26.0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               c_ecliptic/=60.0;</td><td> </td><td class="right">               c_ecliptic/=60.0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               c_ecliptic+=23.0;</td><td> </td><td class="right">               c_ecliptic+=23.0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0020" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               <span class="delete">/* GZotti: I prefer Horner's Scheme and its better numerical</span></td><td> </td><td class="rblock">               <span class="insert">//</span> convert to radians</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"> accuracy. */</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               D = ((T / 189474.0 - 0.0019142)*T + 445267.111480)*T + 297.8</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">5036;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               M = ((T / 300000.0 - 0.0001603)*T +  35999.050340)*T + 357.5</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">2772;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               MM= ((T /  56250.0 + 0.0086972)*T + 477198.867398)*T + 134.9</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">6298;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               F = ((T / 327270.0 - 0.0036825)*T + 483202.017538)*T +  93.2</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">7191;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               O = ((T / 450000.0 + 0.0020708)*T -   1934.136261)*T + 125.0</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">4452;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               /*</span> convert to radians <span class="delete">*/</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               D *= M_PI/180.;</td><td> </td><td class="right">               D *= M_PI/180.;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               M *= M_PI/180.;</td><td> </td><td class="right">               M *= M_PI/180.;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               MM *= M_PI/180.;</td><td> </td><td class="right">               MM *= M_PI/180.;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               F *= M_PI/180.;</td><td> </td><td class="right">               F *= M_PI/180.;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               O *= M_PI/180.;</td><td> </td><td class="right">               O *= M_PI/180.;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0021" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               /<span class="delete">* calc sum of terms in table 21A */</span></td><td> </td><td class="rblock">               /<span class="insert">/ calc sum of terms in table 21A</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               for (i=0; i&lt; TERMS; i++)</td><td> </td><td class="right">               for (i=0; i&lt; TERMS; i++)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0022" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       /<span class="delete">* calc coefficients of sine and cosine */</span></td><td> </td><td class="rblock">                       /<span class="insert">/ calc coefficients of sine and cosine</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       coeff_sine = coefficients[i].longitude1 + (coefficie
nts[i].longitude2 * T);</td><td> </td><td class="right">                       coeff_sine = coefficients[i].longitude1 + (coefficie
nts[i].longitude2 * T);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       coeff_cos = coefficients[i].obliquity1 + (coefficien
ts[i].obliquity2 * T);</td><td> </td><td class="right">                       coeff_cos = coefficients[i].obliquity1 + (coefficien
ts[i].obliquity2 * T);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0023" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       /<span class="delete">* sum the arguments */</span></td><td> </td><td class="rblock">                       /<span class="insert">/ sum the arguments</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       if (arguments[i].D != 0)</td><td> </td><td class="right">                       if (arguments[i].D != 0)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       {</td><td> </td><td class="right">                       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               c_longitude += coeff_sine * (sin (arguments[
i].D * D));</td><td> </td><td class="right">                               c_longitude += coeff_sine * (sin (arguments[
i].D * D));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               c_obliquity += coeff_cos * (cos (arguments[i
].D * D));</td><td> </td><td class="right">                               c_obliquity += coeff_cos * (cos (arguments[i
].D * D));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       }</td><td> </td><td class="right">                       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       if (arguments[i].M != 0)</td><td> </td><td class="right">                       if (arguments[i].M != 0)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       {</td><td> </td><td class="right">                       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               c_longitude += coeff_sine * (sin (arguments[
i].M * M));</td><td> </td><td class="right">                               c_longitude += coeff_sine * (sin (arguments[
i].M * M));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               c_obliquity += coeff_cos * (cos (arguments[i
].M * M));</td><td> </td><td class="right">                               c_obliquity += coeff_cos * (cos (arguments[i
].M * M));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       }</td><td> </td><td class="right">                       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l4" /><small>skipping to change at</small><em> line 312</em></th><th> </th><th><a name="part-r4" /><small>skipping to change at</small><em> line 323</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               c_longitude += coeff_sine * (sin (arguments[
i].F * F));</td><td> </td><td class="right">                               c_longitude += coeff_sine * (sin (arguments[
i].F * F));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               c_obliquity += coeff_cos * (cos (arguments[i
].F * F));</td><td> </td><td class="right">                               c_obliquity += coeff_cos * (cos (arguments[i
].F * F));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       }</td><td> </td><td class="right">                       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       if (arguments[i].O != 0)</td><td> </td><td class="right">                       if (arguments[i].O != 0)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       {</td><td> </td><td class="right">                       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               c_longitude += coeff_sine * (sin (arguments[
i].O * O));</td><td> </td><td class="right">                               c_longitude += coeff_sine * (sin (arguments[
i].O * O));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               c_obliquity += coeff_cos * (cos (arguments[i
].O * O));</td><td> </td><td class="right">                               c_obliquity += coeff_cos * (cos (arguments[i
].O * O));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       }</td><td> </td><td class="right">                       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0024" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               /<span class="delete">* change to degrees */</span></td><td> </td><td class="rblock">               /<span class="insert">/ change to degrees</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               c_longitude /= 36000000.;</td><td> </td><td class="right">               c_longitude /= 36000000.;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               c_obliquity /= 36000000.;</td><td> </td><td class="right">               c_obliquity /= 36000000.;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0025" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               <span class="delete">/*</span> GZ: mean ecliptic should be still available! Addition mus</td><td> </td><td class="rblock">               <span class="insert">//</span> GZ: mean ecliptic should be still available! Addition mus</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">t be done where needed. <span class="delete">*/</span></td><td> </td><td class="rblock">t be done where needed.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               /*</span> c_ecliptic += c_obliquity; <span class="delete">*/</span></td><td> </td><td class="rblock">               <span class="insert">//</span> c_ecliptic += c_obliquity;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">         }</td><td> </td><td class="right">         }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0026" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">/*</span> return results <span class="delete">*/</span></td><td> </td><td class="rblock">       <span class="insert">//</span> return results</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       nutation-&gt;longitude</span> = c_longitude;</td><td> </td><td class="rblock">       <span class="insert">nutation-&gt;deltaPsi</span> = c_longitude;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">nutation-&gt;obliquity</span> = c_obliquity;</td><td> </td><td class="rblock">       <span class="insert">nutation-&gt;deltaEps</span> = c_obliquity;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       nutation-&gt;ecliptic = c_ecliptic;</td><td> </td><td class="right">       nutation-&gt;ecliptic = c_ecliptic;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0027" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">*/</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0028" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">/* Calculate the mean sidereal time at the meridian of Greenwich of a given</td><td> </td><td class="rblock">/* Calculate the mean sidereal time at the meridian of Greenwich <span class="insert">(GMST)</span> of </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"> date.</td><td> </td><td class="rblock">a given date.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"> * returns <span class="delete">apparent</span> sidereal time <span class="delete">(degree).</span></td><td> </td><td class="rblock"> * returns <span class="insert">mean</span> sidereal time <span class="insert">(degrees).</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"> * Formula 11.1, 11.4 pg 83 */</td><td> </td><td class="rblock"> * Formula 11.1, 11.4 pg 83</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">double get_mean_sidereal_time (double <span class="delete">JD)</span></td><td> </td><td class="rblock"> <span class="insert">* MAKE SURE argument JD is UT, not TT!</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"> * GZfix for V0.14: Replace by expression (43) given in:</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"> * N. Capitaine, P.T.Wallace, J. Chapront: Expressions for IAU 2000 precess</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">ion quantities.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"> * A&amp;A412, 567-586 (2003)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"> * DOI: 10.1051/0004-6361:20031539</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"> */</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">double get_mean_sidereal_time (double <span class="insert">JD, double JDE)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0029" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       double sidereal;</td><td> </td><td class="rblock"><span class="insert">//</span>     double sidereal;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       double <span class="delete">T;</span></td><td> </td><td class="rblock"><span class="insert">//</span>     double <span class="insert">T, T1;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"><span class="insert">//     T1</span> = (JD - <span class="insert">2451545.0);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       T</span> = (JD - <span class="delete">2451545.0)</span> / <span class="delete">36525.0;</span></td><td> </td><td class="rblock"><span class="insert">//     T= T1 * (1.0/ 36525.0);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">//</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">//     // calc mean angle. This is Meeus 11.4 (IAU 1982)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">//      sidereal = 280.46061837 + (360.98564736629 * (JD - 2451545.0)) + (0</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">.000387933 * T * T) - (T * T * T</span> / <span class="insert">38710000.0);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       // TODO GZ: verify that GMST1980 is still OK</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       //</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       double sidereal, UT1, t, tu;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       UT1=(JD-floor(JD) +0.5) * 86400.; // time in seconds</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       t=(JDE-2451545.)/36525.;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       tu=(JD-2451545.)/36525.;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       sidereal= (((-0.000000002454*t-0.00000199708)*t-0.0000002926)*t+0.09</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">2772110)*t*t;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       sidereal += (t-tu)*307.4771013;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       sidereal += 8640184.79447825*tu + 24110.5493771;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       sidereal += UT1;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       // this is expressed in seconds. We need degrees.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       // 1deg=4tempMin=240tempSec</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       sidereal *= 1./240.;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0030" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       /* <span class="delete">calc mean angle */</span></td><td> </td><td class="rblock">       /* add <span class="insert">again</span> a convenient multiple of 360 degrees */</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       sidereal = 280.46061837 + (360.98564736629 * (JD - 2451545.0)) + (0.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">000387933 * T * T) - (T * T * T / 38710000.0);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       /*</span> add a convenient multiple of 360 degrees */</td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       sidereal = range_degrees (sidereal);</td><td> </td><td class="right">       sidereal = range_degrees (sidereal);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return sidereal;</td><td> </td><td class="right">       return sidereal;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">/* Calculate the apparent sidereal time at the meridian of Greenwich of a g
iven date.</td><td> </td><td class="right">/* Calculate the apparent sidereal time at the meridian of Greenwich of a g
iven date.</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0031" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"> * returns apparent sidereal time <span class="delete">(degree).</span></td><td> </td><td class="rblock"> * returns apparent sidereal time <span class="insert">(degrees).</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"> * Formula 11.1, 11.4 pg 83 */</td><td> </td><td class="rblock"> * Formula 11.1, 11.4 pg 83</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">double get_apparent_sidereal_time (double <span class="delete">JD)</span></td><td> </td><td class="rblock"> <span class="insert">* GZ modified for V0.14 to use nutation IAU-2000B</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"> */</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">double get_apparent_sidereal_time (double <span class="insert">JD, double JDE)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0032" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       double <span class="delete">correction, sidereal;</span></td><td> </td><td class="rblock">       double <span class="insert">meanSidereal</span> = get_mean_sidereal_time <span class="insert">(JD, JDE);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       struct ln_nutation nutation;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       /* get the mean sidereal time */</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       sidereal</span> = get_mean_sidereal_time <span class="delete">(JD);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0033" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">/*</span> add corrections for nutation in longitude and for the true obliqu</td><td> </td><td class="rblock">       <span class="insert">//</span> add corrections for nutation in longitude and for the true obliqu</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">ity of</td><td> </td><td class="rblock">ity of the ecliptic</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       the ecliptic <span class="delete">*/</span></td><td> </td><td class="rblock">       <span class="insert">double deltaPsi, deltaEps;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       get_nutation (JD, &amp;nutation);</span></td><td> </td><td class="rblock"><span class="insert">       getNutationAngles(JDE, &amp;deltaPsi, &amp;deltaEps);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0034" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">/* GZ: This was the only place where this was used. I added the summ</span></td><td> </td><td class="rblock">       return <span class="insert">meanSidereal+ (deltaPsi*cos(getPrecessionAngleVondrakEpsilon(</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">ation here. */</span></td><td> </td><td class="rblock"><span class="insert">JDE) + deltaEps))*180./M_PI;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       correction = (nutation.longitude * cos ((nutation.ecliptic+nutation.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">obliquity)*M_PI/180.));</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       sidereal += correction;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                           </td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       return <span class="delete">(sidereal);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0035" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">double</span> get_mean_ecliptical_obliquity(double JDE)</td><td> </td><td class="rblock"><span class="insert">//// return value in degrees</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">{</span></td><td> </td><td class="rblock"><span class="insert">//double</span> get_mean_ecliptical_obliquity(double JDE)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       struct ln_nutation nutation;</td><td> </td><td class="rblock"><span class="insert">//{</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       get_nutation(JDE, &amp;nutation);</td><td> </td><td class="rblock"><span class="insert">////</span>   struct ln_nutation nutation;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       return nutation.ecliptic;</td><td> </td><td class="rblock"><span class="insert">////</span>   get_nutation(JDE, &amp;nutation);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">}</span></td><td> </td><td class="rblock"><span class="insert">////</span>   return nutation.ecliptic;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"><span class="insert">//     return getPrecessionAngleVondrakEpsilon(JDE)*180.0/M_PI;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">double</span> get_nutation_longitude(double JDE)</td><td> </td><td class="rblock"><span class="insert">//}</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">{</span></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       struct ln_nutation nutation;</td><td> </td><td class="rblock"><span class="insert">//double</span> get_nutation_longitude(double JDE)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       get_nutation(JDE, &amp;nutation);</td><td> </td><td class="rblock"><span class="insert">//{</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       return <span class="delete">nutation.longitude;</span></td><td> </td><td class="rblock"><span class="insert">//</span>     struct ln_nutation nutation;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">}</span></td><td> </td><td class="rblock"><span class="insert">//</span>     get_nutation(JDE, &amp;nutation);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">//</span>     return <span class="insert">nutation.deltaPsi;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">//}</span></td><td class="lineno" valign="top"></td></tr>

     <tr><td></td><td class="left"></td><td> </td><td class="right"></td><td></td></tr>
     <tr bgcolor="gray"><th colspan="5" align="center"><a name="end">&nbsp;End of changes. 35 change blocks.&nbsp;</a></th></tr>
     <tr class="stats"><td></td><th><i>90 lines changed or deleted</i></th><th><i> </i></th><th><i>121 lines changed or added</i></th><td></td></tr>
     <tr><td colspan="5" align="center" class="small"><br/>This html diff was produced by rfcdiff 1.41. The latest version is available from <a href="http://www.tools.ietf.org/tools/rfcdiff/" >http://tools.ietf.org/tools/rfcdiff/</a> </td></tr>
   </table>
   </body>
   </html>
