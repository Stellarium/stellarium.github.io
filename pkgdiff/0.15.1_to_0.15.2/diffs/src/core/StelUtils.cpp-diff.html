<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
<!-- Generated by rfcdiff 1.41: rfcdiff  --> 
<!-- <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional" > -->
<!-- System: Linux fomalhaut.home 4.4.0-67-generic #88-Ubuntu SMP Wed Mar 8 16:34:45 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux --> 
<!-- Using awk: /usr/bin/gawk: GNU Awk 4.1.3, API: 1.1 (GNU MPFR 3.1.4, GNU MP 6.1.0) --> 
<!-- Using diff: /usr/bin/diff: diff (GNU diffutils) 3.3 --> 
<!-- Using wdiff: /usr/bin/wdiff: wdiff (GNU wdiff) 1.2.2 --> 
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"> 
<head> 
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 
  <meta http-equiv="Content-Style-Type" content="text/css" /> 
  <title>Diff: StelUtils.cpp - StelUtils.cpp</title> 
  <style type="text/css"> 
    body    { font-size:16px; margin: 0.4ex; margin-right: auto; } 
    tr      { } 
    td      { white-space: pre; font-family: Consolas, "DejaVu Sans Mono", "Droid Sans Mono", Monaco, Monospace; vertical-align: top; font-size: 0.86em;} 
    th      { font-size: 0.86em; } 
    .small  { font-size: 0.6em; font-style: italic; font-family: Verdana, Helvetica, sans-serif; } 
    .left   { background-color: #EEE; } 
    .right  { background-color: #FFF; } 
    .diff   { background-color: #CCF; } 
    .lblock { background-color: #BFB; } 
    .rblock { background-color: #FF8; } 
    .insert { background-color: #8FF; } 
    .delete { background-color: #ACF; } 
    .void   { background-color: #FFB; } 
    .cont   { background-color: #EEE; } 
    .linebr { background-color: #AAA; } 
    .lineno { color: red; background-color: #FFF; font-size: 0.7em; text-align: right; padding: 0 2px; } 
    .elipsis{ background-color: #AAA; } 
    .left .cont { background-color: #DDD; } 
    .right .cont { background-color: #EEE; } 
    .lblock .cont { background-color: #9D9; } 
    .rblock .cont { background-color: #DD6; } 
    .insert .cont { background-color: #0DD; } 
    .delete .cont { background-color: #8AD; } 
    .stats, .stats td, .stats th { background-color: #EEE; padding: 2px 0; } 
  </style> 
</head> 
<body > 
  <table border="0" cellpadding="0" cellspacing="0"> 
  <tr bgcolor="orange"><th></th><th>&nbsp;StelUtils.cpp&nbsp;</th><th> </th><th>&nbsp;StelUtils.cpp&nbsp;</th><th></th></tr> 
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l1" /><small>skipping to change at</small><em> line 72</em></th><th> </th><th><a name="part-r1" /><small>skipping to change at</small><em> line 72</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       QString platform = StelUtils::getOperatingSystemInfo();</td><td> </td><td class="right">       QString platform = StelUtils::getOperatingSystemInfo();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (platform.contains("Linux"))</td><td> </td><td class="right">       if (platform.contains("Linux"))</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               platform = "Linux";</td><td> </td><td class="right">               platform = "Linux";</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (platform.contains("FreeBSD"))</td><td> </td><td class="right">       if (platform.contains("FreeBSD"))</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               platform = "FreeBSD";</td><td> </td><td class="right">               platform = "FreeBSD";</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (platform.contains("NetBSD"))</td><td> </td><td class="right">       if (platform.contains("NetBSD"))</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               platform = "NetBSD";</td><td> </td><td class="right">               platform = "NetBSD";</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (platform.contains("OpenBSD"))</td><td> </td><td class="right">       if (platform.contains("OpenBSD"))</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               platform = "OpenBSD";</td><td> </td><td class="right">               platform = "OpenBSD";</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0001" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       // Set user agent as "Stellarium/$version$ <span class="delete">($platform$)"</span></td><td> </td><td class="rblock">       // Set user agent as "Stellarium/$version$ <span class="insert">($platform$; $CPU archite</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">cture$)"</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       #if QT_VERSION &gt;= 0x050400</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       // TODO: Remove #ifdef when Qt 5.4 will set as minimal</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       platform.append("; " + QSysInfo::currentCpuArchitecture());</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       #endif</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                           </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return QString("Stellarium/%1 (%2)").arg(StelUtils::getApplicationVe
rsion()).arg(platform);</td><td> </td><td class="right">       return QString("Stellarium/%1 (%2)").arg(StelUtils::getApplicationVe
rsion()).arg(platform);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">QString getOperatingSystemInfo()</td><td> </td><td class="right">QString getOperatingSystemInfo()</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       QString OS = "Unknown operating system";</td><td> </td><td class="right">       QString OS = "Unknown operating system";</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       #ifdef Q_OS_WIN</td><td> </td><td class="right">       #ifdef Q_OS_WIN</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       switch(QSysInfo::WindowsVersion)</td><td> </td><td class="right">       switch(QSysInfo::WindowsVersion)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l2" /><small>skipping to change at</small><em> line 161</em></th><th> </th><th><a name="part-r2" /><small>skipping to change at</small><em> line 166</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       OS = "Mac OS X 10.9 series";</td><td> </td><td class="right">                       OS = "Mac OS X 10.9 series";</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       break;</td><td> </td><td class="right">                       break;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               case QSysInfo::MV_YOSEMITE:</td><td> </td><td class="right">               case QSysInfo::MV_YOSEMITE:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       OS = "Mac OS X 10.10 series";</td><td> </td><td class="right">                       OS = "Mac OS X 10.10 series";</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       break;</td><td> </td><td class="right">                       break;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               #if QT_VERSION &gt;= 0x050500</td><td> </td><td class="right">               #if QT_VERSION &gt;= 0x050500</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               case QSysInfo::MV_ELCAPITAN:</td><td> </td><td class="right">               case QSysInfo::MV_ELCAPITAN:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       OS = "Mac OS X 10.11 series";</td><td> </td><td class="right">                       OS = "Mac OS X 10.11 series";</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       break;</td><td> </td><td class="right">                       break;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               #endif</td><td> </td><td class="right">               #endif</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0002" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">               <span class="insert">#if QT_VERSION &gt;= 0x050600</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               case QSysInfo::MV_SIERRA:</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       OS = "Mac OS X 10.12 series";</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       break;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               #endif</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               default:</td><td> </td><td class="right">               default:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       OS = "Unsupported Mac version";</td><td> </td><td class="right">                       OS = "Unsupported Mac version";</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       break;</td><td> </td><td class="right">                       break;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       #elif defined Q_OS_LINUX</td><td> </td><td class="right">       #elif defined Q_OS_LINUX</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       QFile procVersion("/proc/version");</td><td> </td><td class="right">       QFile procVersion("/proc/version");</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if(!procVersion.open(QIODevice::ReadOnly | QIODevice::Text))</td><td> </td><td class="right">       if(!procVersion.open(QIODevice::ReadOnly | QIODevice::Text))</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               OS = "Unknown Linux version";</td><td> </td><td class="right">               OS = "Unknown Linux version";</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       else</td><td> </td><td class="right">       else</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l3" /><small>skipping to change at</small><em> line 684</em></th><th> </th><th><a name="part-r3" /><small>skipping to change at</small><em> line 694</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double returned;</td><td> </td><td class="right">       double returned;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if(z&gt;0)</td><td> </td><td class="right">       if(z&gt;0)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          returned = std::log(z + std::sqrt(z*z+1));</td><td> </td><td class="right">          returned = std::log(z + std::sqrt(z*z+1));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       else</td><td> </td><td class="right">       else</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          returned = -std::log(-z + std::sqrt(z*z+1));</td><td> </td><td class="right">          returned = -std::log(-z + std::sqrt(z*z+1));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return returned;</td><td> </td><td class="right">       return returned;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0003" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">// Simple integer modulo where the result is always positive.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">int imod(const int a, const int b)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">{</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   int ret = a % b;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   if(ret &lt; 0)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     ret+=b;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   return ret;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">}</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                           </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">/*************************************************************************</td><td> </td><td class="right">/*************************************************************************</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"> Convert a QT QDateTime class to julian day</td><td> </td><td class="right"> Convert a QT QDateTime class to julian day</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">*************************************************************************/</td><td> </td><td class="right">*************************************************************************/</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">double qDateTimeToJd(const QDateTime&amp; dateTime)</td><td> </td><td class="right">double qDateTimeToJd(const QDateTime&amp; dateTime)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return (double)(dateTime.date().toJulianDay())+(double)1./(24*60*60*
1000)*QTime(0, 0, 0, 0).msecsTo(dateTime.time())-0.5;</td><td> </td><td class="right">       return (double)(dateTime.date().toJulianDay())+(double)1./(24*60*60*
1000)*QTime(0, 0, 0, 0).msecsTo(dateTime.time())-0.5;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">QDateTime jdToQDateTime(const double&amp; jd)</td><td> </td><td class="right">QDateTime jdToQDateTime(const double&amp; jd)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l4" /><small>skipping to change at</small><em> line 1110</em></th><th> </th><th><a name="part-r4" /><small>skipping to change at</small><em> line 1129</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               case 13:</td><td> </td><td class="right">               case 13:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       return numberOfDaysInMonthInYear(1, year+1);</td><td> </td><td class="right">                       return numberOfDaysInMonthInYear(1, year+1);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       break;</td><td> </td><td class="right">                       break;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               default:</td><td> </td><td class="right">               default:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       break;</td><td> </td><td class="right">                       break;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return 0;</td><td> </td><td class="right">       return 0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0004" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">// return true if year is a leap year. Observes 1582 switch from Julian to </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">Gregorian Calendar.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">bool isLeapYear(const int year)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">{</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       if (year&gt;1582){</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               if (year % 400 == 0)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       return true;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               else if (year % 100 == 0)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       return false;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               else return (year % 4 == 0);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       else</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               return (year % 4 == 0);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">}</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">// Find day number for date in year.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">// Meeus, AA 2nd, 1998, ch.7 p.65</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">int dayInYear(const int year, const int month, const int day)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">{</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       // set k to 1 (leap) or 2.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       int k=(isLeapYear(year) ? 1:2);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       return (int)(275*month/9) - k*(int)((month+9)/12) + day -30;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">}</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">// Return a fractional year like YYYY.ddddd. For negative years, the year n</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">umber is of course decrease. E.g. -500.5 occurs in -501.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">double yearFraction(const int year, const int month, const double day)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">{</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       double d=dayInYear(year, month, 0)+day;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       double daysInYear=( isLeapYear(year) ? 366.0 : 365.0);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       return year+d/daysInYear;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">}</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                           </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//! given the submitted year/month/day hour:minute:second, try to</td><td> </td><td class="right">//! given the submitted year/month/day hour:minute:second, try to</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//! normalize into an actual year/month/day.  values can be positive, 0,</td><td> </td><td class="right">//! normalize into an actual year/month/day.  values can be positive, 0,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//! or negative.  start assessing from seconds to larger increments.</td><td> </td><td class="right">//! or negative.  start assessing from seconds to larger increments.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">bool changeDateTimeForRollover(int oy, int om, int od, int oh, int omin, in
t os,</td><td> </td><td class="right">bool changeDateTimeForRollover(int oy, int om, int od, int oh, int omin, in
t os,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                              int* ry, int* rm, int* rd, int* rh, int* rmin
, int* rs)</td><td> </td><td class="right">                              int* ry, int* rm, int* rd, int* rh, int* rmin
, int* rs)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       bool change = false;</td><td> </td><td class="right">       bool change = false;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       while ( os &gt; 59 ) {</td><td> </td><td class="right">       while ( os &gt; 59 ) {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               os -= 60;</td><td> </td><td class="right">               os -= 60;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l5" /><small>skipping to change at</small><em> line 1296</em></th><th> </th><th><a name="part-r5" /><small>skipping to change at</small><em> line 1347</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">/* /////////////////// DELTA T VARIANTS</td><td> </td><td class="right">/* /////////////////// DELTA T VARIANTS</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// For the standard epochs for many formulae, we use</td><td> </td><td class="right">// For the standard epochs for many formulae, we use</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// J2000.0=2000-jan-1.5=2451545.0,</td><td> </td><td class="right">// J2000.0=2000-jan-1.5=2451545.0,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//  1900.0=1900-jan-0.5=2415020.0</td><td> </td><td class="right">//  1900.0=1900-jan-0.5=2415020.0</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//  1820.0=1820-jan-0.5=2385800.0</td><td> </td><td class="right">//  1820.0=1820-jan-0.5=2385800.0</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//  1810.0=1810-jan-0.5=2382148.0</td><td> </td><td class="right">//  1810.0=1810-jan-0.5=2382148.0</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//  1800.0=1800-jan-0.5=2378496.0</td><td> </td><td class="right">//  1800.0=1800-jan-0.5=2378496.0</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//  1735.0=1735-jan-0.5=2354755.0</td><td> </td><td class="right">//  1735.0=1735-jan-0.5=2354755.0</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//  1625.0=1625-jan-0.5=2314579.0</td><td> </td><td class="right">//  1625.0=1625-jan-0.5=2314579.0</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0005" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">//</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">// Up to V0.15.1, if the requested year was outside validity range, we retu</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">rned zero or some useless value.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">// Starting with V0.15.2 the value from the edge of the range is returned i</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">nstead.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">*/</td><td> </td><td class="right">*/</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0006" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">double getDeltaTwithoutCorrection(const double jDay)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">{</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       Q_UNUSED(jDay)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       return 0.;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">}</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                           </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Implementation of algorithm by Espenak &amp; Meeus (2006) for DeltaT computa
tion</td><td> </td><td class="right">// Implementation of algorithm by Espenak &amp; Meeus (2006) for DeltaT computa
tion</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">double getDeltaTByEspenakMeeus(const double jDay)</td><td> </td><td class="right">double getDeltaTByEspenakMeeus(const double jDay)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       int year, month, day;</td><td> </td><td class="right">       int year, month, day;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       getDateFromJulianDay(jDay, &amp;year, &amp;month, &amp;day);</td><td> </td><td class="right">       getDateFromJulianDay(jDay, &amp;year, &amp;month, &amp;day);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // Note: the method here is adapted from</td><td> </td><td class="right">       // Note: the method here is adapted from</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // "Five Millennium Canon of Solar Eclipses" [Espenak and Meeus, 200
6]</td><td> </td><td class="right">       // "Five Millennium Canon of Solar Eclipses" [Espenak and Meeus, 200
6]</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // A summary is described here:</td><td> </td><td class="right">       // A summary is described here:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // http://eclipse.gsfc.nasa.gov/SEhelp/deltatpoly2004.html</td><td> </td><td class="right">       // http://eclipse.gsfc.nasa.gov/SEhelp/deltatpoly2004.html</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l6" /><small>skipping to change at</small><em> line 1465</em></th><th> </th><th><a name="part-r6" /><small>skipping to change at</small><em> line 1525</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return (38.30*u +114.0)*u +20.0;</td><td> </td><td class="right">       return (38.30*u +114.0)*u +20.0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Implementation of algorithm by Stephenson (1997) for DeltaT computation</td><td> </td><td class="right">// Implementation of algorithm by Stephenson (1997) for DeltaT computation</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">double getDeltaTByStephenson1997(const double jDay)</td><td> </td><td class="right">double getDeltaTByStephenson1997(const double jDay)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double u=(jDay-2354755.0)/36525.0; // (1735-jan-0.5)</td><td> </td><td class="right">       double u=(jDay-2354755.0)/36525.0; // (1735-jan-0.5)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return -20.0 + 35.0*u*u;</td><td> </td><td class="right">       return -20.0 + 35.0*u*u;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0007" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">// Implementation of algorithm by Schmadel &amp; Zech (1979) for DeltaT computa
tion</td><td> </td><td class="rblock">// Implementation of algorithm by Schmadel &amp; Zech (1979) for DeltaT computa
tion<span class="insert">. STRICTLY 1800...1975 ONLY!! Now delivers values for the edges.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">double getDeltaTBySchmadelZech1979(const double jDay)</td><td> </td><td class="right">double getDeltaTBySchmadelZech1979(const double jDay)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double u=(jDay-2415020.0)/36525.0; // (1900-jan-0.5)</td><td> </td><td class="right">       double u=(jDay-2415020.0)/36525.0; // (1900-jan-0.5)</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0008" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       u=qMax(-1.0, qMin(u, 0.76));  // Limit range to 1800...1975. Else we
 have crazy values which cause strange artefacts.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double deltaT=(((((((((((-0.089491*u -0.117389)*u + 0.185489)*u + 0.
247433)*u - 0.159732)*u - 0.200097)*u + 0.075456)*u</td><td> </td><td class="right">       double deltaT=(((((((((((-0.089491*u -0.117389)*u + 0.185489)*u + 0.
247433)*u - 0.159732)*u - 0.200097)*u + 0.075456)*u</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       + 0.076929)*u - 0.020446)*u - 0.013867)*u + 0.003081
)*u + 0.001233)*u -0.000029;</td><td> </td><td class="right">                       + 0.076929)*u - 0.020446)*u - 0.013867)*u + 0.003081
)*u + 0.001233)*u -0.000029;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return deltaT * 86400.0;</td><td> </td><td class="right">       return deltaT * 86400.0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Implementation of algorithm by Morrison &amp; Stephenson (1982) for DeltaT c
omputation</td><td> </td><td class="right">// Implementation of algorithm by Morrison &amp; Stephenson (1982) for DeltaT c
omputation</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">double getDeltaTByMorrisonStephenson1982(const double jDay)</td><td> </td><td class="right">double getDeltaTByMorrisonStephenson1982(const double jDay)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double u=(jDay-2382148.0)/36525.0; // (1810-jan-0.5)</td><td> </td><td class="right">       double u=(jDay-2382148.0)/36525.0; // (1810-jan-0.5)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return -15.0+32.50*u*u;</td><td> </td><td class="right">       return -15.0+32.50*u*u;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Implementation of algorithm by Stephenson &amp; Morrison (1984) for DeltaT c
omputation</td><td> </td><td class="right">// Implementation of algorithm by Stephenson &amp; Morrison (1984) for DeltaT c
omputation</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">double getDeltaTByStephensonMorrison1984(const double jDay)</td><td> </td><td class="right">double getDeltaTByStephensonMorrison1984(const double jDay)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       int year, month, day;</td><td> </td><td class="right">       int year, month, day;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double deltaT = 0.;</td><td> </td><td class="right">       double deltaT = 0.;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       getDateFromJulianDay(jDay, &amp;year, &amp;month, &amp;day);</td><td> </td><td class="right">       getDateFromJulianDay(jDay, &amp;year, &amp;month, &amp;day);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0009" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       <span class="insert">// Limited years!</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       year=qMax(-391, qMin(year, 1600));</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                           </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double u = (getDecYear(year, month, day)-1800)/100;</td><td> </td><td class="right">       double u = (getDecYear(year, month, day)-1800)/100;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (-391 &lt; year &amp;&amp; year &lt;= 948)</td><td> </td><td class="right">       if (-391 &lt; year &amp;&amp; year &lt;= 948)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               deltaT = (44.3*u +320.0)*u +1360.0;</td><td> </td><td class="right">               deltaT = (44.3*u +320.0)*u +1360.0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (948 &lt; year &amp;&amp; year &lt;= 1600)</td><td> </td><td class="right">       if (948 &lt; year &amp;&amp; year &lt;= 1600)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               deltaT = 25.5*u*u;</td><td> </td><td class="right">               deltaT = 25.5*u*u;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return deltaT;</td><td> </td><td class="right">       return deltaT;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Implementation of algorithm by Stephenson &amp; Morrison (1995) for DeltaT c
omputation</td><td> </td><td class="right">// Implementation of algorithm by Stephenson &amp; Morrison (1995) for DeltaT c
omputation</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">double getDeltaTByStephensonMorrison1995(const double jDay)</td><td> </td><td class="right">double getDeltaTByStephensonMorrison1995(const double jDay)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double u=(jDay-2385800.0)/36525.0; // (1820-jan-0.5)</td><td> </td><td class="right">       double u=(jDay-2385800.0)/36525.0; // (1820-jan-0.5)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return -20.0 + 31.0*u*u;</td><td> </td><td class="right">       return -20.0 + 31.0*u*u;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Implementation of algorithm by Stephenson &amp; Houlden (1986) for DeltaT co
mputation</td><td> </td><td class="right">// Implementation of algorithm by Stephenson &amp; Houlden (1986) for DeltaT co
mputation</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">double getDeltaTByStephensonHoulden(const double jDay)</td><td> </td><td class="right">double getDeltaTByStephensonHoulden(const double jDay)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0010" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       int year, month, day;</td><td> </td><td class="rblock">       <span class="insert">// TODO FIXME: GZ 2016-12: WHAT IS THIS?? Stephenson-Houlden 1986 ha</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       double u;</td><td> </td><td class="rblock"><span class="insert">s a different Formula!!</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       double deltaT = 0.;</td><td> </td><td class="rblock"><span class="insert">//</span>     int year, month, day;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       getDateFromJulianDay(jDay, &amp;year, &amp;month, &amp;day);</td><td> </td><td class="rblock"><span class="insert">//</span>     double u;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                           </td><td> </td><td class="rblock"><span class="insert">//</span>     double deltaT = 0.;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       double yeardec=getDecYear(year, month, day);</td><td> </td><td class="rblock"><span class="insert">//</span>     getDateFromJulianDay(jDay, &amp;year, &amp;month, &amp;day);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                           </td><td> </td><td class="rblock">                                                                           </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       if (year &lt;= 948)</td><td> </td><td class="rblock"><span class="insert">//</span>     double yeardec=getDecYear(year, month, day);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       {</td><td> </td><td class="rblock"><span class="insert">//     // Limited years!?</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               u = (yeardec-948)/100;</td><td> </td><td class="rblock"><span class="insert">//     year=qMax(-600, qMin(year, 1600));</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               deltaT = (46.5*u -405.0)*u + 1830.0;</td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       }</td><td> </td><td class="rblock"><span class="insert">//</span>     if (year &lt;= 948)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       if (948 &lt; year &amp;&amp; year &lt;= 1600)</td><td> </td><td class="rblock"><span class="insert">//</span>     {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       {</td><td> </td><td class="rblock"><span class="insert">//</span>             u = (yeardec-948)/100;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               u = (yeardec-1850)/100;</td><td> </td><td class="rblock"><span class="insert">//</span>             deltaT = (46.5*u -405.0)*u + 1830.0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               deltaT = 22.5*u*u;</td><td> </td><td class="rblock"><span class="insert">//</span>     }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       }</td><td> </td><td class="rblock"><span class="insert">//</span>     if (948 &lt; year &amp;&amp; year &lt;= 1600)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">//</span>     {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">//</span>             u = (yeardec-1850)/100;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">//</span>             deltaT = 22.5*u*u;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">//</span>     }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">//     return deltaT;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">// This formula found in the cited book, page (ii), formula (1).</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       double T=(jDay-2415020.0)/36525; // centuries from J1900.0</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0011" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       return <span class="delete">deltaT</span>;</td><td> </td><td class="rblock">       return <span class="insert">(36.79*T+35.06)*T+4.87</span>;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Implementation of algorithm by Espenak (1987, 1989) for DeltaT computati
on</td><td> </td><td class="right">// Implementation of algorithm by Espenak (1987, 1989) for DeltaT computati
on</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">double getDeltaTByEspenak(const double jDay)</td><td> </td><td class="right">double getDeltaTByEspenak(const double jDay)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double u=(jDay-2451545.0)/36525.0; // (2000-jan-1.5)</td><td> </td><td class="right">       double u=(jDay-2451545.0)/36525.0; // (2000-jan-1.5)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return (64.3*u +61.0)*u +67.0;</td><td> </td><td class="right">       return (64.3*u +61.0)*u +67.0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Implementation of algorithm by Borkowski (1988) for DeltaT computation</td><td> </td><td class="right">// Implementation of algorithm by Borkowski (1988) for DeltaT computation</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// This is explicitly compatible with ELP2000-85.</td><td> </td><td class="right">// This is explicitly compatible with ELP2000-85.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">double getDeltaTByBorkowski(const double jDay)</td><td> </td><td class="right">double getDeltaTByBorkowski(const double jDay)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double u=(jDay-2451545.0)/36525.0 + 3.75; // (2000-jan-1.5), deviati
on from 1625 as given in the paper.</td><td> </td><td class="right">       double u=(jDay-2451545.0)/36525.0 + 3.75; // (2000-jan-1.5), deviati
on from 1625 as given in the paper.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return 40.0 + 35.0*u*u;</td><td> </td><td class="right">       return 40.0 + 35.0*u*u;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0012" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">// Implementation of algorithm by Schmadel &amp; Zech (1988) for DeltaT computa
tion</td><td> </td><td class="rblock">// Implementation of algorithm by Schmadel &amp; Zech (1988) for DeltaT computa
tion<span class="insert">. STRICTLY 1800...1988 ONLY!! Now delivers values for the edges.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">double getDeltaTBySchmadelZech1988(const double jDay)</td><td> </td><td class="right">double getDeltaTBySchmadelZech1988(const double jDay)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double u=(jDay-2415020.0)/36525.0; // (1900-jan-0.5)</td><td> </td><td class="right">       double u=(jDay-2415020.0)/36525.0; // (1900-jan-0.5)</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0013" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       u=qMax(-1.0, qMin(u, 0.89));  // Limit range to 1800...1988. Else we
 have crazy values which cause strange artefacts.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double deltaT = (((((((((((-0.058091*u -0.067471)*u +.145932)*u +.16
1416)*u -.149279)*u -.146960)*u +.079441)*u +.062971)*u -.022542)*u -.01246
2)*u +.003357)*u +.001148)*u-.000014;</td><td> </td><td class="right">       double deltaT = (((((((((((-0.058091*u -0.067471)*u +.145932)*u +.16
1416)*u -.149279)*u -.146960)*u +.079441)*u +.062971)*u -.022542)*u -.01246
2)*u +.003357)*u +.001148)*u-.000014;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return deltaT * 86400.0;</td><td> </td><td class="right">       return deltaT * 86400.0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Implementation of algorithm by Chapront-Touz &amp; Chapront (1991) for Delt
aT computation</td><td> </td><td class="right">// Implementation of algorithm by Chapront-Touz &amp; Chapront (1991) for Delt
aT computation</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">double getDeltaTByChaprontTouze(const double jDay)</td><td> </td><td class="right">double getDeltaTByChaprontTouze(const double jDay)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       int year, month, day;</td><td> </td><td class="right">       int year, month, day;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double deltaT = 0.;</td><td> </td><td class="right">       double deltaT = 0.;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       getDateFromJulianDay(jDay, &amp;year, &amp;month, &amp;day);</td><td> </td><td class="right">       getDateFromJulianDay(jDay, &amp;year, &amp;month, &amp;day);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0014" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       <span class="insert">// Limited years!</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       year=qMax(-391, qMin(year, 1600));</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                           </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double u=(jDay-2451545.0)/36525.0; // (2000-jan-1.5)</td><td> </td><td class="right">       double u=(jDay-2451545.0)/36525.0; // (2000-jan-1.5)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (-391 &lt; year &amp;&amp; year &lt;= 948)</td><td> </td><td class="right">       if (-391 &lt; year &amp;&amp; year &lt;= 948)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               deltaT = (42.4*u +495.0)*u + 2177.0;</td><td> </td><td class="right">               deltaT = (42.4*u +495.0)*u + 2177.0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (948 &lt; year &amp;&amp; year &lt;= 1600)</td><td> </td><td class="right">       if (948 &lt; year &amp;&amp; year &lt;= 1600)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               deltaT = (23.6*u +100.0)*u + 102.0;</td><td> </td><td class="right">               deltaT = (23.6*u +100.0)*u + 102.0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return deltaT;</td><td> </td><td class="right">       return deltaT;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Implementation of algorithm by JPL Horizons for DeltaT computation</td><td> </td><td class="right">// Implementation of algorithm by JPL Horizons for DeltaT computation</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">double getDeltaTByJPLHorizons(const double jDay)</td><td> </td><td class="right">double getDeltaTByJPLHorizons(const double jDay)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{ // FIXME: It does not make sense to have zeros after 1620 in a JPL Horizo
ns compatible implementation!</td><td> </td><td class="right">{ // FIXME: It does not make sense to have zeros after 1620 in a JPL Horizo
ns compatible implementation!</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       int year, month, day;</td><td> </td><td class="right">       int year, month, day;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double u;</td><td> </td><td class="right">       double u;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double deltaT = 0.;</td><td> </td><td class="right">       double deltaT = 0.;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       getDateFromJulianDay(jDay, &amp;year, &amp;month, &amp;day);</td><td> </td><td class="right">       getDateFromJulianDay(jDay, &amp;year, &amp;month, &amp;day);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0015" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       <span class="insert">// Limited years!</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       year=qMax(-2999, qMin(year, 1620));</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                           </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (-2999 &lt; year &amp;&amp; year &lt; 948)</td><td> </td><td class="right">       if (-2999 &lt; year &amp;&amp; year &lt; 948)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               u=(jDay-2385800.0)/36525.0; // (1820-jan-1.5)</td><td> </td><td class="right">               u=(jDay-2385800.0)/36525.0; // (1820-jan-1.5)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               deltaT = 31.0*u*u;</td><td> </td><td class="right">               deltaT = 31.0*u*u;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (948 &lt; year &amp;&amp; year &lt;= 1620)</td><td> </td><td class="right">       if (948 &lt; year &amp;&amp; year &lt;= 1620)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               u=(jDay-2451545.0)/36525.0; // (2000-jan-1.5)</td><td> </td><td class="right">               u=(jDay-2451545.0)/36525.0; // (2000-jan-1.5)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               deltaT = (22.5*u +67.5)*u + 50.6;</td><td> </td><td class="right">               deltaT = (22.5*u +67.5)*u + 50.6;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l7" /><small>skipping to change at</small><em> line 1705</em></th><th> </th><th><a name="part-r7" /><small>skipping to change at</small><em> line 1782</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       //double yeardec=year+((month-1)*30.5+day/31*30.5)/366;</td><td> </td><td class="right">       //double yeardec=year+((month-1)*30.5+day/31*30.5)/366;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       //double ub = (yeardec-2000)/100;</td><td> </td><td class="right">       //double ub = (yeardec-2000)/100;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       const double ub=(jDay-2451545.0)/36525.0; // (2000-jan-1.5)</td><td> </td><td class="right">       const double ub=(jDay-2451545.0)/36525.0; // (2000-jan-1.5)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (year &lt;1620)</td><td> </td><td class="right">       if (year &lt;1620)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               deltaT=0.0;</td><td> </td><td class="right">               deltaT=0.0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       else if (year &lt; 1690)</td><td> </td><td class="right">       else if (year &lt; 1690)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               u = 3.45 + ub;</td><td> </td><td class="right">               u = 3.45 + ub;</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0016" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               //deltaT = +40.3 - 107.0*u + 50.0*std::pow(u,2) - 454.0*std:
:pow(u,3) + 1244.0*std::pow(u,4);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               deltaT = (((1244.0*u -454.0)*u + 50.0)*u -107.0)*u +40.3;</td><td> </td><td class="right">               deltaT = (((1244.0*u -454.0)*u + 50.0)*u -107.0)*u +40.3;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       else if (year &lt; 1770)</td><td> </td><td class="right">       else if (year &lt; 1770)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               u = 2.70 + ub;</td><td> </td><td class="right">               u = 2.70 + ub;</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0017" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               //deltaT = +10.2 + 11.3*u - std::pow(u,2) - 16.0*std::pow(u,
3) + 70.0*std::pow(u,4);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               deltaT = (((70.0*u -16.0)*u -1.0)*u +11.3)*u +10.2;</td><td> </td><td class="right">               deltaT = (((70.0*u -16.0)*u -1.0)*u +11.3)*u +10.2;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       else if (year &lt; 1820)</td><td> </td><td class="right">       else if (year &lt; 1820)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               u = 2.05 + ub;</td><td> </td><td class="right">               u = 2.05 + ub;</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0018" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               //deltaT = +14.7 - 18.8*u - 22.0*std::pow(u,2) + 173.0*std::
pow(u,3) + 6.0*std::pow(u,4);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               deltaT = (((6.0*u +173.0)*u -22.0)*u -18.8)*u +14.7;</td><td> </td><td class="right">               deltaT = (((6.0*u +173.0)*u -22.0)*u -18.8)*u +14.7;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       else if (year &lt; 1870)</td><td> </td><td class="right">       else if (year &lt; 1870)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               u = 1.55 + ub;</td><td> </td><td class="right">               u = 1.55 + ub;</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0019" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               //deltaT = +5.7 + 12.7*u + 111.0*std::pow(u,2) - 534.0*std::
pow(u,3) - 1654.0*std::pow(u,4);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               deltaT = (((-1654.0*u -534.0)*u +111)*u +12.7)*u +5.7;</td><td> </td><td class="right">               deltaT = (((-1654.0*u -534.0)*u +111)*u +12.7)*u +5.7;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       else if (year &lt; 1900)</td><td> </td><td class="right">       else if (year &lt; 1900)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               u = 1.15 + ub;</td><td> </td><td class="right">               u = 1.15 + ub;</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0020" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               //deltaT = -5.8 - 14.6*u + 27.0*std::pow(u,2) + 101.0*std::p
ow(u,3) + 8234.0*std::pow(u,4);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               deltaT = (((8234.0*u +101.0)*u +27.0)*u - 14.6)*u -5.8;</td><td> </td><td class="right">               deltaT = (((8234.0*u +101.0)*u +27.0)*u - 14.6)*u -5.8;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       else if (year &lt; 1940)</td><td> </td><td class="right">       else if (year &lt; 1940)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               u = 0.80 + ub;</td><td> </td><td class="right">               u = 0.80 + ub;</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0021" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               //deltaT = +21.4 + 67.0*u - 443.0*std::pow(u,2) + 19.0*std::
pow(u,3) + 4441.0*std::pow(u,4);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               deltaT = (((4441.0*u + 19.0)*u -443.0)*u +67.0)*u +21.4;</td><td> </td><td class="right">               deltaT = (((4441.0*u + 19.0)*u -443.0)*u +67.0)*u +21.4;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       else if (year &lt; 1990)</td><td> </td><td class="right">       else if (year &lt; 1990)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               u = 0.35 + ub;</td><td> </td><td class="right">               u = 0.35 + ub;</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0022" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               //deltaT = +36.2 + 74.0*u + 189.0*std::pow(u,2) - 140.0*std:
:pow(u,3) - 1883.0*std::pow(u,4);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               deltaT = (((-1883.0*u -140.0)*u +189.0)*u +74.0)*u +36.2;</td><td> </td><td class="right">               deltaT = (((-1883.0*u -140.0)*u +189.0)*u +74.0)*u +36.2;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       else if (year &lt;= 2000)</td><td> </td><td class="right">       else if (year &lt;= 2000)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               u = 0.05 + ub;</td><td> </td><td class="right">               u = 0.05 + ub;</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0023" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               //deltaT = +60.8 + 82.0*u - 188.0*std::pow(u,2) - 5034.0*std
::pow(u,3);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               deltaT = ((-5034.0*u -188.0)*u +82.0)*u +60.8;</td><td> </td><td class="right">               deltaT = ((-5034.0*u -188.0)*u +82.0)*u +60.8;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return deltaT;</td><td> </td><td class="right">       return deltaT;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Implementation of algorithm by Reingold &amp; Dershowitz (Cal. Calc. 1997, 2
001, 2007, Cal. Tab. 2002) for DeltaT computation.</td><td> </td><td class="right">// Implementation of algorithm by Reingold &amp; Dershowitz (Cal. Calc. 1997, 2
001, 2007, Cal. Tab. 2002) for DeltaT computation.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Created as yet another multi-segment polynomial fit through the table in
 Meeus: Astronomical Algorithms (1991).</td><td> </td><td class="right">// Created as yet another multi-segment polynomial fit through the table in
 Meeus: Astronomical Algorithms (1991).</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Note that only the Third edition (2007) adds the 1700-1799 term.</td><td> </td><td class="right">// Note that only the Third edition (2007) adds the 1700-1799 term.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// More efficient reimplementation with stricter adherence to the source.</td><td> </td><td class="right">// More efficient reimplementation with stricter adherence to the source.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l8" /><small>skipping to change at</small><em> line 1813</em></th><th> </th><th><a name="part-r8" /><small>skipping to change at</small><em> line 1882</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Implementation of algorithm by Banjevic (2006) for DeltaT computation.</td><td> </td><td class="right">// Implementation of algorithm by Banjevic (2006) for DeltaT computation.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">double getDeltaTByBanjevic(const double jDay)</td><td> </td><td class="right">double getDeltaTByBanjevic(const double jDay)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       int year, month, day;</td><td> </td><td class="right">       int year, month, day;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       getDateFromJulianDay(jDay, &amp;year, &amp;month, &amp;day);</td><td> </td><td class="right">       getDateFromJulianDay(jDay, &amp;year, &amp;month, &amp;day);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double u, c;</td><td> </td><td class="right">       double u, c;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0024" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       if <span class="delete">(year&gt;=-2020 &amp;&amp; year&lt;=-700)</span></td><td> </td><td class="rblock">       <span class="insert">// Limited years!</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       year=qMax(-2020, qMin(year, 1620));</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                           </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       if <span class="insert">(year&lt;=-700)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               u = (jDay-2378496.0)/36525.0; // 1800.0=1800-jan-0.5=2378496
.0</td><td> </td><td class="right">               u = (jDay-2378496.0)/36525.0; // 1800.0=1800-jan-0.5=2378496
.0</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               c = 30.86;</td><td> </td><td class="right">               c = 30.86;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0025" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       else if (year&gt;-700 &amp;&amp; year&lt;=1620)</td><td> </td><td class="rblock">       else <span class="insert">//  </span>if (year&gt;-700 &amp;&amp; year&lt;=1620)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               u = (jDay-2385800.0)/36525.0; // 1820.0=1820-jan-0.5=2385800
.0</td><td> </td><td class="right">               u = (jDay-2385800.0)/36525.0; // 1820.0=1820-jan-0.5=2385800
.0</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               c = 31;</td><td> </td><td class="right">               c = 31;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0026" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">else</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       {</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               u = 0.;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               c = 0.;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       }</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return c*u*u;</td><td> </td><td class="right">       return c*u*u;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Implementation of algorithm by Islam, Sadiq &amp; Qureshi (2008 + revisited 
2013) for DeltaT computation.</td><td> </td><td class="right">// Implementation of algorithm by Islam, Sadiq &amp; Qureshi (2008 + revisited 
2013) for DeltaT computation.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">double getDeltaTByIslamSadiqQureshi(const double jDay)</td><td> </td><td class="right">double getDeltaTByIslamSadiqQureshi(const double jDay)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       int year, month, day;</td><td> </td><td class="right">       int year, month, day;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       getDateFromJulianDay(jDay, &amp;year, &amp;month, &amp;day);</td><td> </td><td class="right">       getDateFromJulianDay(jDay, &amp;year, &amp;month, &amp;day);</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0027" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       double deltaT<span class="delete"> = 0.0; // Return deltaT = 0 outside valid rang</span>e.</td><td> </td><td class="rblock">       double deltaT<span class="insert">; // Return deltaT for the edge year outside valid rang
</span>e.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double u;</td><td> </td><td class="right">       double u;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       const double ub=(jDay-2454101.0)/36525.0; // (2007-jan-0.5)</td><td> </td><td class="right">       const double ub=(jDay-2454101.0)/36525.0; // (2007-jan-0.5)</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0028" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       if (year <span class="delete">&gt;= 1620 &amp;&amp; year</span> &lt;= 1698)</td><td> </td><td class="rblock">                                                                           </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       <span class="insert">// Limited years!</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       year=qMax(1620, qMin(year, 2007));</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                           </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       if (year &lt;= 1698)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               u = 3.48 + ub;</td><td> </td><td class="right">               u = 3.48 + ub;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               deltaT = (((1162.805 * u - 273.116) * u + 14.523) * u - 105.
262) * u + 38.067;</td><td> </td><td class="right">               deltaT = (((1162.805 * u - 273.116) * u + 14.523) * u - 105.
262) * u + 38.067;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       else if (year &lt;= 1806)</td><td> </td><td class="right">       else if (year &lt;= 1806)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               u = 2.545 + ub;</td><td> </td><td class="right">               u = 2.545 + ub;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               deltaT = (((-71.724 * u - 39.048) * u + 7.591) * u + 13.893)
 * u + 13.759;</td><td> </td><td class="right">               deltaT = (((-71.724 * u - 39.048) * u + 7.591) * u + 13.893)
 * u + 13.759;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       else if (year &lt;= 1872)</td><td> </td><td class="right">       else if (year &lt;= 1872)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l9" /><small>skipping to change at</small><em> line 1866</em></th><th> </th><th><a name="part-r9" /><small>skipping to change at</small><em> line 1937</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               u = 1.175 + ub;</td><td> </td><td class="right">               u = 1.175 + ub;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               deltaT = (((6250.501 * u + 1006.463) * u + 139.921) * u - 2.
732) * u - 6.203;</td><td> </td><td class="right">               deltaT = (((6250.501 * u + 1006.463) * u + 139.921) * u - 2.
732) * u - 6.203;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       else if (year &lt;= 1953)</td><td> </td><td class="right">       else if (year &lt;= 1953)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               // revised 2013 per email</td><td> </td><td class="right">               // revised 2013 per email</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               u = 0.77 + ub;</td><td> </td><td class="right">               u = 0.77 + ub;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               deltaT = (((-390.785 * u + 901.514) * u - 88.044) * u + 8.99
7) * u + 24.006;</td><td> </td><td class="right">               deltaT = (((-390.785 * u + 901.514) * u - 88.044) * u + 8.99
7) * u + 24.006;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0029" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       else if (year &lt;= 2007)</td><td> </td><td class="rblock">       else <span class="insert">//</span>if (year &lt;= 2007)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               // revised 2013 per email</td><td> </td><td class="right">               // revised 2013 per email</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               u = 0.265 + ub;</td><td> </td><td class="right">               u = 0.265 + ub;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               deltaT = (((1314.759 * u - 296.018) * u - 101.898) * u + 88.
659) * u + 49.997;</td><td> </td><td class="right">               deltaT = (((1314.759 * u - 296.018) * u - 101.898) * u + 88.
659) * u + 49.997;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return deltaT;</td><td> </td><td class="right">       return deltaT;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Implementation of polinomial approximation of time period 1620-2013 for 
DeltaT by M. Khalid, Mariam Sultana and Faheem Zaidi (2014).</td><td> </td><td class="right">// Implementation of polinomial approximation of time period 1620-2013 for 
DeltaT by M. Khalid, Mariam Sultana and Faheem Zaidi (2014).</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">double getDeltaTByKhalidSultanaZaidi(const double jDay)</td><td> </td><td class="right">double getDeltaTByKhalidSultanaZaidi(const double jDay)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       int year, month, day;</td><td> </td><td class="right">       int year, month, day;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       getDateFromJulianDay(jDay, &amp;year, &amp;month, &amp;day);</td><td> </td><td class="right">       getDateFromJulianDay(jDay, &amp;year, &amp;month, &amp;day);</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0030" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">double k,</span> a0, a1, a2, a3, a4;</td><td> </td><td class="rblock">       <span class="insert">//double</span> a0, a1, a2, a3, a4;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       if <span class="delete">(year&gt;=1620 &amp;&amp; year&lt;=1672)</span></td><td> </td><td class="rblock">       <span class="insert">const float k[9] ={     3.670f,    3.120f,    2.495f,     1.925f,   </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       {</span></td><td> </td><td class="rblock"><span class="insert">  1.525f,    1.220f,     0.880f,     0.455f,      0.115f};</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               k = 3.670; a0 = 76.541; a1 = -253.532; a2 = 695.901; a3 = -1</span></td><td> </td><td class="rblock"><span class="insert">       const float a0[9]={    76.541f,   10.872f,   13.480f,    12.584f,   </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">256.982; a4 = 627.152;</span></td><td> </td><td class="rblock"><span class="insert">  6.364f,   -5.058f,    13.392f,    30.782f,     55.281f};</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       }</span></td><td> </td><td class="rblock"><span class="insert">       const float a1[9]={  -253.532f,  -40.744f,   13.075f,     1.929f,   </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       else if <span class="delete">(year&gt;=1673 &amp;&amp; year&lt;=1729)</span></td><td> </td><td class="rblock"><span class="insert"> 11.004f,   -1.701f,   128.592f,    34.348f,     91.248f};</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       {</span></td><td> </td><td class="rblock"><span class="insert">       const float a2[9]={   695.901f,  236.890f,    8.635f,    60.896f,   </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               k = 3.120; a0 = 10.872; a1 = -40.744; a2 = 236.890; a3 = -35</span></td><td> </td><td class="rblock"><span class="insert">407.776f,  -46.403f,  -279.165f,    46.452f,     87.202f};</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">1.537; a4 = 36.612;</span></td><td> </td><td class="rblock"><span class="insert">       const float a3[9]={ -1256.982f, -351.537f,   -3.307f, -1432.216f, -4</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       }</span></td><td> </td><td class="rblock"><span class="insert">168.394f, -866.171f, -1282.050f,  1295.550f,  -3092.565f};</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       else if <span class="delete">(year&gt;=1730 &amp;&amp; year&lt;=1797)</span></td><td> </td><td class="rblock"><span class="insert">       const float a4[9]={   627.152f,   36.612f, -128.294f,  3129.071f,  7</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       {</span></td><td> </td><td class="rblock"><span class="insert">561.686f, 5917.585f,  4039.490f, -3210.913f,   8255.422f};</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               k = 2.495; a0 = 13.480; a1 = 13.075; a2 = 8.635; a3 = -3.307</span></td><td> </td><td class="rblock"><span class="insert">       int i;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">; a4 = -128.294;</span></td><td> </td><td class="rblock"><span class="insert">       // Limited years! Deliver border values.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       }</span></td><td> </td><td class="rblock"><span class="insert">       year=qMax(1620, qMin(year, 2013));</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       else if <span class="delete">(year&gt;=1798 &amp;&amp; year&lt;=1843)</span></td><td> </td><td class="rblock">                                                                           </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       {</span></td><td> </td><td class="rblock">       if <span class="insert">(year&lt;=1672)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               k = 1.925; a0 = 12.584; a1 = 1.929; a2 = 60.896; a3 = -1432.</span></td><td> </td><td class="rblock"><span class="insert">               i=0;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">216; a4 = 3129.071;</span></td><td> </td><td class="rblock">       else if <span class="insert">(year&lt;=1729)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       }</span></td><td> </td><td class="rblock"><span class="insert">               i=1;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       else if <span class="delete">(year&gt;=1844 &amp;&amp; year&lt;=1877)</span></td><td> </td><td class="rblock">       else if <span class="insert">(year&lt;=1797)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       {</span></td><td> </td><td class="rblock"><span class="insert">               i=2;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               k = 1.525; a0 = 6.364; a1 = 11.004; a2 = 407.776; a3 = -4168</span></td><td> </td><td class="rblock">       else if <span class="insert">(year&lt;=1843)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">.394; a4 = 7561.686;</span></td><td> </td><td class="rblock"><span class="insert">               i=3;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       }</span></td><td> </td><td class="rblock">       else if <span class="insert">(year&lt;=1877)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       else if <span class="delete">(year&gt;=1878 &amp;&amp; year&lt;=1904)</span></td><td> </td><td class="rblock"><span class="insert">               i=4;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       {</span></td><td> </td><td class="rblock">       else if <span class="insert">(year&lt;=1904)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               k = 1.220; a0 = -5.058; a1 = -1.701; a2 = -46.403; a3 = -866</span></td><td> </td><td class="rblock"><span class="insert">               i=5;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">.171; a4 = 5917.585;</span></td><td> </td><td class="rblock">       else if <span class="insert">(year&lt;=1945)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       }</span></td><td> </td><td class="rblock"><span class="insert">               i=6;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       else if <span class="delete">(year&gt;=1905 &amp;&amp; year&lt;=1945)</span></td><td> </td><td class="rblock">       else if <span class="insert">(year&lt;=1989)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       {</span></td><td> </td><td class="rblock"><span class="insert">               i=7;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               k = 0.880; a0 = 13.392; a1 = 128.592; a2 = -279.165; a3 = -1</span></td><td> </td><td class="rblock">       else <span class="insert">//</span> if <span class="insert">(year&lt;=2013)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">282.050; a4 = 4039.490;</span></td><td> </td><td class="rblock"><span class="insert">               i=8;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       }</span></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       else if <span class="delete">(year&gt;=1946 &amp;&amp; year&lt;=1989)</span></td><td> </td><td class="rblock"><span class="insert">       double u</span> = <span class="insert">k[i] + (year - 2000)/100;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       {</span></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               k = 0.455; a0 = 30.782; a1 = 34.348; a2 = 46.452; a3 = 1295.</span></td><td> </td><td class="rblock"><span class="insert">       return (((a4[i]*u + a3[i])*u + a2[i])*u + a1[i])*u + a0[i];</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">550; a4 = -3210.913;</span></td><td> </td><td class="rblock">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       }</span></td><td> </td><td class="rblock">                                                                           </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       else if <span class="delete">(year&gt;=1990 &amp;&amp; year&lt;=2013)</span></td><td> </td><td class="rblock"><span class="insert">static const double StephensonMorrisonHohenkerk2016DeltaTtableS15[54][6]={</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       {</span></td><td> </td><td class="rblock"><span class="insert">//     Row         Years                  Polynomial Coefficients</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               k = 0.115; a0 = 55.281; a1 = 91.248; a2 = 87.202; a3 = -3092</span></td><td> </td><td class="rblock"><span class="insert">//       i      K_i    K_{i+1}        a_0         a_1         a_2         a</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">.565; a4</span> = <span class="delete">8255.422;</span></td><td> </td><td class="rblock"><span class="insert">_3</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       }</td><td> </td><td class="rblock"><span class="insert">//     - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">else</span></td><td> </td><td class="rblock"><span class="insert">- - -</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">/*       1 */   -720.0,     400.0,   20550.593,  -21268.478,   11863.418,  </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"> -4541.129,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">/*       2 */    400.0,    1000.0,    6604.404,   -5981.266,    -505.093,  </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">  1349.609,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">/*       3 */   1000.0,    1500.0,    1467.654,   -2452.187,    2460.927,  </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"> -1183.759,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">/*       4 */   1500.0,    1600.0,     292.635,    -216.322,     -43.614,  </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">    56.681,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">/*       5 */   1600.0,    1650.0,      89.380,     -66.754,      31.607,  </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   -10.497,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">/*       6 */   1650.0,    1720.0,      43.736,     -49.043,       0.227,  </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">    15.811,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">/*       7 */   1720.0,    1800.0,      10.730,      -1.321,      62.250,  </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   -52.946,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">/*       8 */   1800.0,    1810.0,      18.714,      -4.457,      -1.509,  </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     2.507,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">/*       9 */   1810.0,    1820.0,      15.255,       0.046,       6.012,  </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">    -4.634,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">/*      10 */   1820.0,    1830.0,      16.679,      -1.831,      -7.889,  </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     3.799,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">/*      11 */   1830.0,    1840.0,      10.758,      -6.211,       3.509,  </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">    -0.388,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">/*      12 */   1840.0,    1850.0,       7.668,      -0.357,       2.345,  </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">    -0.338,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">/*      13 */   1850.0,    1855.0,       9.317,       1.659,       0.332,  </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">    -0.932,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">/*      14 */   1855.0,    1860.0,      10.376,      -0.472,      -2.463,  </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     1.596,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">/*      15 */   1860.0,    1865.0,       9.038,      -0.610,       2.325,  </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">    -2.497,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">/*      16 */   1865.0,    1870.0,       8.256,      -3.450,      -5.166,  </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     2.729,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">/*      17 */   1870.0,    1875.0,       2.369,      -5.596,       3.020,  </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">    -0.919,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">/*      18 */   1875.0,    1880.0,      -1.126,      -2.312,       0.264,  </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">    -0.037,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">/*      19 */   1880.0,    1885.0,      -3.211,      -1.894,       0.154,  </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     0.562,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">/*      20 */   1885.0,    1890.0,      -4.388,       0.101,       1.841,  </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">    -1.438,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">/*      21 */   1890.0,    1895.0,      -3.884,      -0.531,      -2.473,  </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     1.870,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">/*      22 */   1895.0,    1900.0,      -5.017,       0.134,       3.138,  </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">    -0.232,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">/*      23 */   1900.0,    1905.0,      -1.977,       5.715,       2.443,  </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">    -1.257,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">/*      24 */   1905.0,    1910.0,       4.923,       6.828,      -1.329,  </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     0.720,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">/*      25 */   1910.0,    1915.0,      11.142,       6.330,       0.831,  </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">    -0.825,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">/*      26 */   1915.0,    1920.0,      17.479,       5.518,      -1.643,  </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     0.262,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">/*      27 */   1920.0,    1925.0,      21.617,       3.020,      -0.856,  </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     0.008,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">/*      28 */   1925.0,    1930.0,      23.789,       1.333,      -0.831,  </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     0.127,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">/*      29 */   1930.0,    1935.0,      24.418,       0.052,      -0.449,  </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     0.142,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">/*      30 */   1935.0,    1940.0,      24.164,      -0.419,      -0.022,  </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     0.702,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">/*      31 */   1940.0,    1945.0,      24.426,       1.645,       2.086,  </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">    -1.106,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">/*      32 */   1945.0,    1950.0,      27.050,       2.499,      -1.232,  </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     0.614,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">/*      33 */   1950.0,    1953.0,      28.932,       1.127,       0.220,  </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">    -0.277,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">/*      34 */   1953.0,    1956.0,      30.002,       0.737,      -0.610,  </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     0.631,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">/*      35 */   1956.0,    1959.0,      30.760,       1.409,       1.282,  </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">    -0.799,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">/*      36 */   1959.0,    1962.0,      32.652,       1.577,      -1.115,  </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     0.507,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">/*      37 */   1962.0,    1965.0,      33.621,       0.868,       0.406,  </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     0.199,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">/*      38 */   1965.0,    1968.0,      35.093,       2.275,       1.002,  </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">    -0.414,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">/*      39 */   1968.0,    1971.0,      37.956,       3.035,      -0.242,  </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     0.202,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">/*      40 */   1971.0,    1974.0,      40.951,       3.157,       0.364,  </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">    -0.229,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">/*      41 */   1974.0,    1977.0,      44.244,       3.198,      -0.323,  </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     0.172,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">/*      42 */   1977.0,    1980.0,      47.291,       3.069,       0.193,  </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">    -0.192,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">/*      43 */   1980.0,    1983.0,      50.361,       2.878,      -0.384,  </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     0.081,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">/*      44 */   1983.0,    1986.0,      52.936,       2.354,      -0.140,  </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">    -0.166,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">/*      45 */   1986.0,    1989.0,      54.984,       1.577,      -0.637,  </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     0.448,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">/*      46 */   1989.0,    1992.0,      56.373,       1.649,       0.709,  </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">    -0.277,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">/*      47 */   1992.0,    1995.0,      58.453,       2.235,      -0.122,  </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     0.111,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">/*      48 */   1995.0,    1998.0,      60.677,       2.324,       0.212,  </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">    -0.315,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">/*      49 */   1998.0,    2001.0,      62.899,       1.804,      -0.732,  </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     0.112,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">/*      50 */   2001.0,    2004.0,      64.082,       0.675,      -0.396,  </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     0.193,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">/*      51 */   2004.0,    2007.0,      64.555,       0.463,       0.184,  </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">    -0.008,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">/*      52 */   2007.0,    2010.0,      65.194,       0.809,       0.161,  </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">    -0.101,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">/*      53 */   2010.0,    2013.0,      66.063,       0.828,      -0.142,  </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     0.168,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">/*      54 */   2013.0,    2016.0,      66.917,       1.046,       0.360,  </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">    -0.282</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">};</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">double getDeltaTByStephensonMorrisonHohenkerk2016(const double jDay)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">{</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       int year, month, day;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       getDateFromJulianDay(jDay, &amp;year, &amp;month, &amp;day);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       double y=yearFraction(year, month, day);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       if ((y&lt;-720.) || (y&gt;2016.))</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0031" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               <span class="delete">k = 0.0; a0 = 0.0; a1 = 0.0; a2 = 0.0; a3 = 0.0; a4 = 0.0;</span></td><td> </td><td class="rblock">               <span class="insert">double fact=(y-1825.0)/100.;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               return -320.0+32.5*fact*fact;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0032" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                           </td><td> </td><td class="rblock">       <span class="insert">int i=0;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       double <span class="delete">u = k + (year - 2000)/100;</span></td><td> </td><td class="rblock"><span class="insert">       while (StephensonMorrisonHohenkerk2016DeltaTtableS15[i][1]&lt;y) i++;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                           </td><td> </td><td class="rblock"><span class="insert">       Q_ASSERT(i&lt;54);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       return <span class="delete">(((a4*u + a3)*u</span> + <span class="delete">a2)*u</span> + <span class="delete">a1)*u</span> + <span class="delete">a0;</span></td><td> </td><td class="rblock">       double <span class="insert">t=(y-StephensonMorrisonHohenkerk2016DeltaTtableS15[i][0]) / (</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">StephensonMorrisonHohenkerk2016DeltaTtableS15[i][1]-StephensonMorrisonHohen</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">kerk2016DeltaTtableS15[i][0]);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       return <span class="insert">((StephensonMorrisonHohenkerk2016DeltaTtableS15[i][5]*t</span> + <span class="insert">Ste</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">phensonMorrisonHohenkerk2016DeltaTtableS15[i][4])*t</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">               + <span class="insert">StephensonMorrisonHohenkerk2016DeltaTtableS15[i][3])*t</span> + <span class="insert">S</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">tephensonMorrisonHohenkerk2016DeltaTtableS15[i][2];</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">double getMoonSecularAcceleration(const double jDay, const double nd, const
 bool useDE43x)</td><td> </td><td class="right">double getMoonSecularAcceleration(const double jDay, const double nd, const
 bool useDE43x)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       int year, month, day;</td><td> </td><td class="right">       int year, month, day;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       getDateFromJulianDay(jDay, &amp;year, &amp;month, &amp;day);</td><td> </td><td class="right">       getDateFromJulianDay(jDay, &amp;year, &amp;month, &amp;day);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double t = (getDecYear(year, month, day)-1955.5)/100.0;</td><td> </td><td class="right">       double t = (getDecYear(year, month, day)-1955.5)/100.0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // n.dot for secular acceleration of the Moon in ELP2000-82B</td><td> </td><td class="right">       // n.dot for secular acceleration of the Moon in ELP2000-82B</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // have value -23.8946 "/cy/cy (or -25.8 for DE43x usage)</td><td> </td><td class="right">       // have value -23.8946 "/cy/cy (or -25.8 for DE43x usage)</td><td class="lineno" valign="top"></td></tr>

     <tr><td></td><td class="left"></td><td> </td><td class="right"></td><td></td></tr>
     <tr bgcolor="gray"><th colspan="5" align="center"><a name="end">&nbsp;End of changes. 32 change blocks.&nbsp;</a></th></tr>
     <tr class="stats"><td></td><th><i>91 lines changed or deleted</i></th><th><i> </i></th><th><i>290 lines changed or added</i></th><td></td></tr>
     <tr><td colspan="5" align="center" class="small"><br/>This html diff was produced by rfcdiff 1.41. The latest version is available from <a href="http://www.tools.ietf.org/tools/rfcdiff/" >http://tools.ietf.org/tools/rfcdiff/</a> </td></tr>
   </table>
   </body>
   </html>
