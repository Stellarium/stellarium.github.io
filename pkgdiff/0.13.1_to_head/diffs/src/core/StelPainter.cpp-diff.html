<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
<!-- Generated by rfcdiff 1.41: rfcdiff  --> 
<!-- <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional" > -->
<!-- System: Linux fomalhaut.local 3.13.0-38-generic #65-Ubuntu SMP Thu Oct 9 11:36:50 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux --> 
<!-- Using awk: /usr/bin/gawk: GNU Awk 4.0.1 --> 
<!-- Using diff: /usr/bin/diff: diff (GNU diffutils) 3.3 --> 
<!-- Using wdiff: /usr/bin/wdiff: wdiff (GNU wdiff) 1.2.1 --> 
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"> 
<head> 
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /> 
  <meta http-equiv="Content-Style-Type" content="text/css" /> 
  <title>Diff: StelPainter.cpp - StelPainter.cpp</title> 
  <style type="text/css"> 
    body    { font-size:16px; margin: 0.4ex; margin-right: auto; } 
    tr      { } 
    td      { white-space: pre; font-family: Consolas, "DejaVu Sans Mono", "Droid Sans Mono", Monaco, Monospace; vertical-align: top; font-size: 0.86em;} 
    th      { font-size: 0.86em; } 
    .small  { font-size: 0.6em; font-style: italic; font-family: Verdana, Helvetica, sans-serif; } 
    .left   { background-color: #EEE; } 
    .right  { background-color: #FFF; } 
    .diff   { background-color: #CCF; } 
    .lblock { background-color: #BFB; } 
    .rblock { background-color: #FF8; } 
    .insert { background-color: #8FF; } 
    .delete { background-color: #ACF; } 
    .void   { background-color: #FFB; } 
    .cont   { background-color: #EEE; } 
    .linebr { background-color: #AAA; } 
    .lineno { color: red; background-color: #FFF; font-size: 0.7em; text-align: right; padding: 0 2px; } 
    .elipsis{ background-color: #AAA; } 
    .left .cont { background-color: #DDD; } 
    .right .cont { background-color: #EEE; } 
    .lblock .cont { background-color: #9D9; } 
    .rblock .cont { background-color: #DD6; } 
    .insert .cont { background-color: #0DD; } 
    .delete .cont { background-color: #8AD; } 
    .stats, .stats td, .stats th { background-color: #EEE; padding: 2px 0; } 
  </style> 
</head> 
<body > 
  <table border="0" cellpadding="0" cellspacing="0"> 
  <tr bgcolor="orange"><th></th><th>&nbsp;StelPainter.cpp&nbsp;</th><th> </th><th>&nbsp;StelPainter.cpp&nbsp;</th><th></th></tr> 
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l1" /><small>skipping to change at</small><em> line 695</em></th><th> </th><th><a name="part-r1" /><small>skipping to change at</small><em> line 695</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               smallCircleVertexArray.append(Vec2f(p1[0], p
1[1]));</td><td> </td><td class="right">                               smallCircleVertexArray.append(Vec2f(p1[0], p
1[1]));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       drawSmallCircleVertexArray();</td><td> </td><td class="right">                       drawSmallCircleVertexArray();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       Q_ASSERT(smallCircleVertexArray.isEmpty());</td><td> </td><td class="right">       Q_ASSERT(smallCircleVertexArray.isEmpty());</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Project the passed triangle on the screen ensuring that it will look smo
oth, even for non linear distortion</td><td> </td><td class="right">// Project the passed triangle on the screen ensuring that it will look smo
oth, even for non linear distortion</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// by splitting it into subtriangles.</td><td> </td><td class="right">// by splitting it into subtriangles.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void StelPainter::projectSphericalTriangle(const SphericalCap* clippingCap,
 const Vec3d* vertices, QVarLengthArray&lt;Vec3f, 4096&gt;* outVertices,</td><td> </td><td class="right">void StelPainter::projectSphericalTriangle(const SphericalCap* clippingCap,
 const Vec3d* vertices, QVarLengthArray&lt;Vec3f, 4096&gt;* outVertices,</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0001" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               const Vec2f* texturePos, QVarLengthArray&lt;Vec2f, 4096&gt;* outTe
xturePos,</td><td> </td><td class="rblock">               const Vec2f* texturePos, QVarLengthArray&lt;Vec2f, 4096&gt;* outTe
xturePos,<span class="insert"> const Vec3f *colors, QVarLengthArray&lt;Vec3f, 4096&gt; *outColors,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               const double maxSqDistortion, const int nbI, const bool chec
kDisc1, const bool checkDisc2, const bool checkDisc3) const</td><td> </td><td class="right">               const double maxSqDistortion, const int nbI, const bool chec
kDisc1, const bool checkDisc2, const bool checkDisc3) const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       Q_ASSERT(fabs(vertices[0].length()-1.)&lt;0.00001);</td><td> </td><td class="right">       Q_ASSERT(fabs(vertices[0].length()-1.)&lt;0.00001);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       Q_ASSERT(fabs(vertices[1].length()-1.)&lt;0.00001);</td><td> </td><td class="right">       Q_ASSERT(fabs(vertices[1].length()-1.)&lt;0.00001);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       Q_ASSERT(fabs(vertices[2].length()-1.)&lt;0.00001);</td><td> </td><td class="right">       Q_ASSERT(fabs(vertices[2].length()-1.)&lt;0.00001);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (clippingCap &amp;&amp; clippingCap-&gt;containsTriangle(vertices))</td><td> </td><td class="right">       if (clippingCap &amp;&amp; clippingCap-&gt;containsTriangle(vertices))</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               clippingCap = NULL;</td><td> </td><td class="right">               clippingCap = NULL;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (clippingCap &amp;&amp; !clippingCap-&gt;intersectsTriangle(vertices))</td><td> </td><td class="right">       if (clippingCap &amp;&amp; !clippingCap-&gt;intersectsTriangle(vertices))</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               return;</td><td> </td><td class="right">               return;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       bool cDiscontinuity1 = checkDisc1 &amp;&amp; prj-&gt;intersectViewportDiscontin
uity(vertices[0], vertices[1]);</td><td> </td><td class="right">       bool cDiscontinuity1 = checkDisc1 &amp;&amp; prj-&gt;intersectViewportDiscontin
uity(vertices[0], vertices[1]);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l2" /><small>skipping to change at</small><em> line 754</em></th><th> </th><th><a name="part-r2" /><small>skipping to change at</small><em> line 754</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               win3[1] -= (e0[1]+e2[1])*0.5;</td><td> </td><td class="right">               win3[1] -= (e0[1]+e2[1])*0.5;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               cDiscontinuity3 = (win3[0]*win3[0]+win3[1]*win3[1])&gt;maxSqDis
tortion;</td><td> </td><td class="right">               cDiscontinuity3 = (win3[0]*win3[0]+win3[1]*win3[1])&gt;maxSqDis
tortion;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (!cDiscontinuity1 &amp;&amp; !cDiscontinuity2 &amp;&amp; !cDiscontinuity3)</td><td> </td><td class="right">       if (!cDiscontinuity1 &amp;&amp; !cDiscontinuity2 &amp;&amp; !cDiscontinuity3)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               // The triangle is clean, appends it</td><td> </td><td class="right">               // The triangle is clean, appends it</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               outVertices-&gt;append(Vec3f(e0[0], e0[1], e0[2])); outVertices
-&gt;append(Vec3f(e1[0], e1[1], e1[2])); outVertices-&gt;append(Vec3f(e2[0], e2[1
], e2[2]));</td><td> </td><td class="right">               outVertices-&gt;append(Vec3f(e0[0], e0[1], e0[2])); outVertices
-&gt;append(Vec3f(e1[0], e1[1], e1[2])); outVertices-&gt;append(Vec3f(e2[0], e2[1
], e2[2]));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               if (outTexturePos)</td><td> </td><td class="right">               if (outTexturePos)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       outTexturePos-&gt;append(texturePos,3);</td><td> </td><td class="right">                       outTexturePos-&gt;append(texturePos,3);</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0002" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">               <span class="insert">if (outColors)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       outColors-&gt;append(colors,3);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               return;</td><td> </td><td class="right">               return;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (nbI &gt; 4)</td><td> </td><td class="right">       if (nbI &gt; 4)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               // If we reached the limit number of iterations and still ha
ve a discontinuity,</td><td> </td><td class="right">               // If we reached the limit number of iterations and still ha
ve a discontinuity,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               // discards the triangle.</td><td> </td><td class="right">               // discards the triangle.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               if (cd1 || cd2 || cd3)</td><td> </td><td class="right">               if (cd1 || cd2 || cd3)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       return;</td><td> </td><td class="right">                       return;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               // Else display it, it will be suboptimal though.</td><td> </td><td class="right">               // Else display it, it will be suboptimal though.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               outVertices-&gt;append(Vec3f(e0[0], e0[1], e0[2])); outVertices
-&gt;append(Vec3f(e1[0], e1[1], e2[2])); outVertices-&gt;append(Vec3f(e2[0], e2[1
], e2[2]));</td><td> </td><td class="right">               outVertices-&gt;append(Vec3f(e0[0], e0[1], e0[2])); outVertices
-&gt;append(Vec3f(e1[0], e1[1], e2[2])); outVertices-&gt;append(Vec3f(e2[0], e2[1
], e2[2]));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               if (outTexturePos)</td><td> </td><td class="right">               if (outTexturePos)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       outTexturePos-&gt;append(texturePos,3);</td><td> </td><td class="right">                       outTexturePos-&gt;append(texturePos,3);</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0003" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">               <span class="insert">if (outColors)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       outColors-&gt;append(colors,3);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               return;</td><td> </td><td class="right">               return;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // Recursively splits the triangle into sub triangles.</td><td> </td><td class="right">       // Recursively splits the triangle into sub triangles.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // Depending on which combination of sides of the triangle has to be
 split a different strategy is used.</td><td> </td><td class="right">       // Depending on which combination of sides of the triangle has to be
 split a different strategy is used.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       Vec3d va[3];</td><td> </td><td class="right">       Vec3d va[3];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       Vec2f ta[3];</td><td> </td><td class="right">       Vec2f ta[3];</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0004" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       Vec3f ca[3];</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // Only 1 side has to be split: split the triangle in 2</td><td> </td><td class="right">       // Only 1 side has to be split: split the triangle in 2</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (cDiscontinuity1 &amp;&amp; !cDiscontinuity2 &amp;&amp; !cDiscontinuity3)</td><td> </td><td class="right">       if (cDiscontinuity1 &amp;&amp; !cDiscontinuity2 &amp;&amp; !cDiscontinuity3)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               va[0]=vertices[0];</td><td> </td><td class="right">               va[0]=vertices[0];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               va[1]=vertices[0];va[1]+=vertices[1];</td><td> </td><td class="right">               va[1]=vertices[0];va[1]+=vertices[1];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               va[1].normalize();</td><td> </td><td class="right">               va[1].normalize();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               va[2]=vertices[2];</td><td> </td><td class="right">               va[2]=vertices[2];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               if (outTexturePos)</td><td> </td><td class="right">               if (outTexturePos)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       ta[0]=texturePos[0];</td><td> </td><td class="right">                       ta[0]=texturePos[0];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       ta[1]=(texturePos[0]+texturePos[1])*0.5;</td><td> </td><td class="right">                       ta[1]=(texturePos[0]+texturePos[1])*0.5;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       ta[2]=texturePos[2];</td><td> </td><td class="right">                       ta[2]=texturePos[2];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0005" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               projectSphericalTriangle(clippingCap, va, outVertices, ta, o</td><td> </td><td class="rblock">               <span class="insert">if (outColors)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">utTexturePos, maxSqDistortion, nbI+1, true, true, false);</td><td> </td><td class="rblock"><span class="insert">               {</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       ca[0]=colors[0];</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       ca[1]=(colors[0]+colors[1])*0.5;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       ca[2]=colors[2];</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">               projectSphericalTriangle(clippingCap, va, outVertices, ta, o</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">utTexturePos, <span class="insert">ca, outColors,</span> maxSqDistortion, nbI+1, true, true, false);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               //va[0]=vertices[0]+vertices[1];</td><td> </td><td class="right">               //va[0]=vertices[0]+vertices[1];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               //va[0].normalize();</td><td> </td><td class="right">               //va[0].normalize();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               va[0]=va[1];</td><td> </td><td class="right">               va[0]=va[1];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               va[1]=vertices[1];</td><td> </td><td class="right">               va[1]=vertices[1];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               va[2]=vertices[2];</td><td> </td><td class="right">               va[2]=vertices[2];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               if (outTexturePos)</td><td> </td><td class="right">               if (outTexturePos)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       ta[0]=(texturePos[0]+texturePos[1])*0.5;</td><td> </td><td class="right">                       ta[0]=(texturePos[0]+texturePos[1])*0.5;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       ta[1]=texturePos[1];</td><td> </td><td class="right">                       ta[1]=texturePos[1];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       ta[2]=texturePos[2];</td><td> </td><td class="right">                       ta[2]=texturePos[2];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0006" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               projectSphericalTriangle(clippingCap, va, outVertices, ta, o</td><td> </td><td class="rblock">               <span class="insert">if (outColors)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">utTexturePos, maxSqDistortion, nbI+1, true, false, true);</td><td> </td><td class="rblock"><span class="insert">               {</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       ca[0]=(colors[0]+colors[1])*0.5;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       ca[1]=colors[1];</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       ca[2]=colors[2];</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">               projectSphericalTriangle(clippingCap, va, outVertices, ta, o</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">utTexturePos, <span class="insert">ca, outColors,</span> maxSqDistortion, nbI+1, true, false, true);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               return;</td><td> </td><td class="right">               return;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (!cDiscontinuity1 &amp;&amp; cDiscontinuity2 &amp;&amp; !cDiscontinuity3)</td><td> </td><td class="right">       if (!cDiscontinuity1 &amp;&amp; cDiscontinuity2 &amp;&amp; !cDiscontinuity3)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               va[0]=vertices[0];</td><td> </td><td class="right">               va[0]=vertices[0];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               va[1]=vertices[1];</td><td> </td><td class="right">               va[1]=vertices[1];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               va[2]=vertices[1];va[2]+=vertices[2];</td><td> </td><td class="right">               va[2]=vertices[1];va[2]+=vertices[2];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               va[2].normalize();</td><td> </td><td class="right">               va[2].normalize();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               if (outTexturePos)</td><td> </td><td class="right">               if (outTexturePos)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       ta[0]=texturePos[0];</td><td> </td><td class="right">                       ta[0]=texturePos[0];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       ta[1]=texturePos[1];</td><td> </td><td class="right">                       ta[1]=texturePos[1];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       ta[2]=(texturePos[1]+texturePos[2])*0.5;</td><td> </td><td class="right">                       ta[2]=(texturePos[1]+texturePos[2])*0.5;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0007" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               projectSphericalTriangle(clippingCap, va, outVertices, ta, o</td><td> </td><td class="rblock">               <span class="insert">if (outColors)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">utTexturePos, maxSqDistortion, nbI+1, false, true, true);</td><td> </td><td class="rblock"><span class="insert">               {</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       ca[0]=colors[0];</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       ca[1]=colors[1];</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       ca[2]=(colors[1]+colors[2])*0.5;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">               projectSphericalTriangle(clippingCap, va, outVertices, ta, o</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">utTexturePos, <span class="insert">ca, outColors,</span> maxSqDistortion, nbI+1, false, true, true);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               va[0]=vertices[0];</td><td> </td><td class="right">               va[0]=vertices[0];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               //va[1]=vertices[1]+vertices[2];</td><td> </td><td class="right">               //va[1]=vertices[1]+vertices[2];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               //va[1].normalize();</td><td> </td><td class="right">               //va[1].normalize();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               va[1]=va[2];</td><td> </td><td class="right">               va[1]=va[2];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               va[2]=vertices[2];</td><td> </td><td class="right">               va[2]=vertices[2];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               if (outTexturePos)</td><td> </td><td class="right">               if (outTexturePos)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       ta[0]=texturePos[0];</td><td> </td><td class="right">                       ta[0]=texturePos[0];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       ta[1]=(texturePos[1]+texturePos[2])*0.5;</td><td> </td><td class="right">                       ta[1]=(texturePos[1]+texturePos[2])*0.5;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       ta[2]=texturePos[2];</td><td> </td><td class="right">                       ta[2]=texturePos[2];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0008" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               projectSphericalTriangle(clippingCap, va, outVertices, ta, o</td><td> </td><td class="rblock">               <span class="insert">if (outColors)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">utTexturePos, maxSqDistortion, nbI+1, true, true, false);</td><td> </td><td class="rblock"><span class="insert">               {</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       ca[0]=colors[0];</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       ca[1]=(colors[1]+colors[2])*0.5;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       ca[2]=colors[2];</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">               projectSphericalTriangle(clippingCap, va, outVertices, ta, o</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">utTexturePos, <span class="insert">ca, outColors,</span> maxSqDistortion, nbI+1, true, true, false);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               return;</td><td> </td><td class="right">               return;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (!cDiscontinuity1 &amp;&amp; !cDiscontinuity2 &amp;&amp; cDiscontinuity3)</td><td> </td><td class="right">       if (!cDiscontinuity1 &amp;&amp; !cDiscontinuity2 &amp;&amp; cDiscontinuity3)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               va[0]=vertices[0];</td><td> </td><td class="right">               va[0]=vertices[0];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               va[1]=vertices[1];</td><td> </td><td class="right">               va[1]=vertices[1];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               va[2]=vertices[0];va[2]+=vertices[2];</td><td> </td><td class="right">               va[2]=vertices[0];va[2]+=vertices[2];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               va[2].normalize();</td><td> </td><td class="right">               va[2].normalize();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               if (outTexturePos)</td><td> </td><td class="right">               if (outTexturePos)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       ta[0]=texturePos[0];</td><td> </td><td class="right">                       ta[0]=texturePos[0];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       ta[1]=texturePos[1];</td><td> </td><td class="right">                       ta[1]=texturePos[1];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       ta[2]=(texturePos[0]+texturePos[2])*0.5;</td><td> </td><td class="right">                       ta[2]=(texturePos[0]+texturePos[2])*0.5;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0009" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               projectSphericalTriangle(clippingCap, va, outVertices, ta, o</td><td> </td><td class="rblock">               <span class="insert">if (outColors)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">utTexturePos, maxSqDistortion, nbI+1, false, true, true);</td><td> </td><td class="rblock"><span class="insert">               {</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       ca[0]=colors[0];</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       ca[1]=colors[1];</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       ca[2]=(colors[0]+colors[2])*0.5;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">               projectSphericalTriangle(clippingCap, va, outVertices, ta, o</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">utTexturePos, <span class="insert">ca, outColors,</span> maxSqDistortion, nbI+1, false, true, true);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               //va[0]=vertices[0]+vertices[2];</td><td> </td><td class="right">               //va[0]=vertices[0]+vertices[2];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               //va[0].normalize();</td><td> </td><td class="right">               //va[0].normalize();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               va[0]=va[2];</td><td> </td><td class="right">               va[0]=va[2];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               va[1]=vertices[1];</td><td> </td><td class="right">               va[1]=vertices[1];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               va[2]=vertices[2];</td><td> </td><td class="right">               va[2]=vertices[2];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               if (outTexturePos)</td><td> </td><td class="right">               if (outTexturePos)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       ta[0]=(texturePos[0]+texturePos[2])*0.5;</td><td> </td><td class="right">                       ta[0]=(texturePos[0]+texturePos[2])*0.5;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       ta[1]=texturePos[1];</td><td> </td><td class="right">                       ta[1]=texturePos[1];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       ta[2]=texturePos[2];</td><td> </td><td class="right">                       ta[2]=texturePos[2];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0010" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               projectSphericalTriangle(clippingCap, va, outVertices, ta, o</td><td> </td><td class="rblock">               <span class="insert">if (outColors)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">utTexturePos, maxSqDistortion, nbI+1, true, false, true);</td><td> </td><td class="rblock"><span class="insert">               {</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       ca[0]=(colors[0]+colors[2])*0.5;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       ca[1]=colors[1];</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       ca[2]=colors[2];</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">               projectSphericalTriangle(clippingCap, va, outVertices, ta, o</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">utTexturePos, <span class="insert">ca, outColors,</span> maxSqDistortion, nbI+1, true, false, true);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               return;</td><td> </td><td class="right">               return;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // 2 sides have to be split: split the triangle in 3</td><td> </td><td class="right">       // 2 sides have to be split: split the triangle in 3</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (cDiscontinuity1 &amp;&amp; cDiscontinuity2 &amp;&amp; !cDiscontinuity3)</td><td> </td><td class="right">       if (cDiscontinuity1 &amp;&amp; cDiscontinuity2 &amp;&amp; !cDiscontinuity3)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               va[0]=vertices[0];</td><td> </td><td class="right">               va[0]=vertices[0];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               va[1]=vertices[0];va[1]+=vertices[1];</td><td> </td><td class="right">               va[1]=vertices[0];va[1]+=vertices[1];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               va[1].normalize();</td><td> </td><td class="right">               va[1].normalize();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               va[2]=vertices[1];va[2]+=vertices[2];</td><td> </td><td class="right">               va[2]=vertices[1];va[2]+=vertices[2];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               va[2].normalize();</td><td> </td><td class="right">               va[2].normalize();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               if (outTexturePos)</td><td> </td><td class="right">               if (outTexturePos)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       ta[0]=texturePos[0];</td><td> </td><td class="right">                       ta[0]=texturePos[0];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       ta[1]=(texturePos[0]+texturePos[1])*0.5;</td><td> </td><td class="right">                       ta[1]=(texturePos[0]+texturePos[1])*0.5;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       ta[2]=(texturePos[1]+texturePos[2])*0.5;</td><td> </td><td class="right">                       ta[2]=(texturePos[1]+texturePos[2])*0.5;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0011" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               projectSphericalTriangle(clippingCap, va, outVertices, ta, o</td><td> </td><td class="rblock">               <span class="insert">if (outColors)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">utTexturePos, maxSqDistortion, nbI+1);</td><td> </td><td class="rblock"><span class="insert">               {</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       ca[0]=colors[0];</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       ca[1]=(colors[0]+colors[1])*0.5;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       ca[2]=(colors[1]+colors[2])*0.5;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">               projectSphericalTriangle(clippingCap, va, outVertices, ta, o</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">utTexturePos, <span class="insert">ca, outColors,</span> maxSqDistortion, nbI+1);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               //va[0]=vertices[0]+vertices[1];</td><td> </td><td class="right">               //va[0]=vertices[0]+vertices[1];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               //va[0].normalize();</td><td> </td><td class="right">               //va[0].normalize();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               va[0]=va[1];</td><td> </td><td class="right">               va[0]=va[1];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               va[1]=vertices[1];</td><td> </td><td class="right">               va[1]=vertices[1];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               //va[2]=vertices[1]+vertices[2];</td><td> </td><td class="right">               //va[2]=vertices[1]+vertices[2];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               //va[2].normalize();</td><td> </td><td class="right">               //va[2].normalize();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               if (outTexturePos)</td><td> </td><td class="right">               if (outTexturePos)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       ta[0]=(texturePos[0]+texturePos[1])*0.5;</td><td> </td><td class="right">                       ta[0]=(texturePos[0]+texturePos[1])*0.5;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       ta[1]=texturePos[1];</td><td> </td><td class="right">                       ta[1]=texturePos[1];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       ta[2]=(texturePos[1]+texturePos[2])*0.5;</td><td> </td><td class="right">                       ta[2]=(texturePos[1]+texturePos[2])*0.5;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0012" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               projectSphericalTriangle(clippingCap, va, outVertices, ta, o</td><td> </td><td class="rblock">               <span class="insert">if (outColors)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">utTexturePos, maxSqDistortion, nbI+1);</td><td> </td><td class="rblock"><span class="insert">               {</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       ca[0]=(colors[0]+colors[1])*0.5;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       ca[1]=colors[1];</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       ca[2]=(colors[1]+colors[2])*0.5;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">               projectSphericalTriangle(clippingCap, va, outVertices, ta, o</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">utTexturePos, <span class="insert">ca, outColors,</span> maxSqDistortion, nbI+1);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               va[0]=vertices[0];</td><td> </td><td class="right">               va[0]=vertices[0];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               //va[1]=vertices[1]+vertices[2];</td><td> </td><td class="right">               //va[1]=vertices[1]+vertices[2];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               //va[1].normalize();</td><td> </td><td class="right">               //va[1].normalize();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               va[1]=va[2];</td><td> </td><td class="right">               va[1]=va[2];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               va[2]=vertices[2];</td><td> </td><td class="right">               va[2]=vertices[2];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               if (outTexturePos)</td><td> </td><td class="right">               if (outTexturePos)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       ta[0]=texturePos[0];</td><td> </td><td class="right">                       ta[0]=texturePos[0];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       ta[1]=(texturePos[1]+texturePos[2])*0.5;</td><td> </td><td class="right">                       ta[1]=(texturePos[1]+texturePos[2])*0.5;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       ta[2]=texturePos[2];</td><td> </td><td class="right">                       ta[2]=texturePos[2];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0013" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               projectSphericalTriangle(clippingCap, va, outVertices, ta, o</td><td> </td><td class="rblock">               <span class="insert">if (outColors)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">utTexturePos, maxSqDistortion, nbI+1, true, true, false);</td><td> </td><td class="rblock"><span class="insert">               {</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       ca[0]=colors[0];</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       ca[1]=(colors[1]+colors[2])*0.5;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       ca[2]=colors[2];</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">               projectSphericalTriangle(clippingCap, va, outVertices, ta, o</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">utTexturePos, <span class="insert">ca, outColors,</span> maxSqDistortion, nbI+1, true, true, false);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               return;</td><td> </td><td class="right">               return;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (cDiscontinuity1 &amp;&amp; !cDiscontinuity2 &amp;&amp; cDiscontinuity3)</td><td> </td><td class="right">       if (cDiscontinuity1 &amp;&amp; !cDiscontinuity2 &amp;&amp; cDiscontinuity3)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               va[0]=vertices[0];</td><td> </td><td class="right">               va[0]=vertices[0];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               va[1]=vertices[0];va[1]+=vertices[1];</td><td> </td><td class="right">               va[1]=vertices[0];va[1]+=vertices[1];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               va[1].normalize();</td><td> </td><td class="right">               va[1].normalize();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               va[2]=vertices[0];va[2]+=vertices[2];</td><td> </td><td class="right">               va[2]=vertices[0];va[2]+=vertices[2];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               va[2].normalize();</td><td> </td><td class="right">               va[2].normalize();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               if (outTexturePos)</td><td> </td><td class="right">               if (outTexturePos)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       ta[0]=texturePos[0];</td><td> </td><td class="right">                       ta[0]=texturePos[0];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       ta[1]=(texturePos[0]+texturePos[1])*0.5;</td><td> </td><td class="right">                       ta[1]=(texturePos[0]+texturePos[1])*0.5;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       ta[2]=(texturePos[0]+texturePos[2])*0.5;</td><td> </td><td class="right">                       ta[2]=(texturePos[0]+texturePos[2])*0.5;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0014" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               projectSphericalTriangle(clippingCap, va, outVertices, ta, o</td><td> </td><td class="rblock">               <span class="insert">if (outColors)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">utTexturePos, maxSqDistortion, nbI+1);</td><td> </td><td class="rblock"><span class="insert">               {</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       ca[0]=colors[0];</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       ca[1]=(colors[0]+colors[1])*0.5;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       ca[2]=(colors[0]+colors[2])*0.5;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">               projectSphericalTriangle(clippingCap, va, outVertices, ta, o</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">utTexturePos, <span class="insert">ca, outColors,</span> maxSqDistortion, nbI+1);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               //va[0]=vertices[0]+vertices[1];</td><td> </td><td class="right">               //va[0]=vertices[0]+vertices[1];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               //va[0].normalize();</td><td> </td><td class="right">               //va[0].normalize();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               va[0]=va[1];</td><td> </td><td class="right">               va[0]=va[1];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               va[1]=vertices[2];</td><td> </td><td class="right">               va[1]=vertices[2];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               //va[2]=vertices[0]+vertices[2];</td><td> </td><td class="right">               //va[2]=vertices[0]+vertices[2];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               //va[2].normalize();</td><td> </td><td class="right">               //va[2].normalize();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               if (outTexturePos)</td><td> </td><td class="right">               if (outTexturePos)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       ta[0]=(texturePos[0]+texturePos[1])*0.5;</td><td> </td><td class="right">                       ta[0]=(texturePos[0]+texturePos[1])*0.5;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       ta[1]=texturePos[2];</td><td> </td><td class="right">                       ta[1]=texturePos[2];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       ta[2]=(texturePos[0]+texturePos[2])*0.5;</td><td> </td><td class="right">                       ta[2]=(texturePos[0]+texturePos[2])*0.5;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0015" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               projectSphericalTriangle(clippingCap, va, outVertices, ta, o</td><td> </td><td class="rblock">               <span class="insert">if (outColors)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">utTexturePos, maxSqDistortion, nbI+1);</td><td> </td><td class="rblock"><span class="insert">               {</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       ca[0]=(colors[0]+colors[1])*0.5;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       ca[1]=colors[2];</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       ca[2]=(colors[0]+colors[2])*0.5;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">               projectSphericalTriangle(clippingCap, va, outVertices, ta, o</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">utTexturePos, <span class="insert">ca, outColors,</span> maxSqDistortion, nbI+1);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               //va[0]=vertices[0]+vertices[1];</td><td> </td><td class="right">               //va[0]=vertices[0]+vertices[1];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               //va[0].normalize();</td><td> </td><td class="right">               //va[0].normalize();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               va[1]=vertices[1];</td><td> </td><td class="right">               va[1]=vertices[1];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               va[2]=vertices[2];</td><td> </td><td class="right">               va[2]=vertices[2];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               if (outTexturePos)</td><td> </td><td class="right">               if (outTexturePos)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       ta[0]=(texturePos[0]+texturePos[1])*0.5;</td><td> </td><td class="right">                       ta[0]=(texturePos[0]+texturePos[1])*0.5;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       ta[1]=texturePos[1];</td><td> </td><td class="right">                       ta[1]=texturePos[1];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       ta[2]=texturePos[2];</td><td> </td><td class="right">                       ta[2]=texturePos[2];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0016" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               projectSphericalTriangle(clippingCap, va, outVertices, ta, o</td><td> </td><td class="rblock">               <span class="insert">if (outColors)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">utTexturePos, maxSqDistortion, nbI+1, true, false, true);</td><td> </td><td class="rblock"><span class="insert">               {</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       ca[0]=(colors[0]+colors[1])*0.5;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       ca[1]=colors[1];</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       ca[2]=colors[2];</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">               projectSphericalTriangle(clippingCap, va, outVertices, ta, o</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">utTexturePos, <span class="insert">ca, outColors,</span> maxSqDistortion, nbI+1, true, false, true);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               return;</td><td> </td><td class="right">               return;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (!cDiscontinuity1 &amp;&amp; cDiscontinuity2 &amp;&amp; cDiscontinuity3)</td><td> </td><td class="right">       if (!cDiscontinuity1 &amp;&amp; cDiscontinuity2 &amp;&amp; cDiscontinuity3)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               va[0]=vertices[0];</td><td> </td><td class="right">               va[0]=vertices[0];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               va[1]=vertices[1];</td><td> </td><td class="right">               va[1]=vertices[1];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               va[2]=vertices[1];va[2]+=vertices[2];</td><td> </td><td class="right">               va[2]=vertices[1];va[2]+=vertices[2];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               va[2].normalize();</td><td> </td><td class="right">               va[2].normalize();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               if (outTexturePos)</td><td> </td><td class="right">               if (outTexturePos)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       ta[0]=texturePos[0];</td><td> </td><td class="right">                       ta[0]=texturePos[0];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       ta[1]=texturePos[1];</td><td> </td><td class="right">                       ta[1]=texturePos[1];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       ta[2]=(texturePos[1]+texturePos[2])*0.5;</td><td> </td><td class="right">                       ta[2]=(texturePos[1]+texturePos[2])*0.5;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0017" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               projectSphericalTriangle(clippingCap, va, outVertices, ta, o</td><td> </td><td class="rblock">               <span class="insert">if (outColors)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">utTexturePos, maxSqDistortion, nbI+1, false, true, true);</td><td> </td><td class="rblock"><span class="insert">               {</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       ca[0]=colors[0];</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       ca[1]=colors[1];</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       ca[2]=(colors[1]+colors[2])*0.5;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">               projectSphericalTriangle(clippingCap, va, outVertices, ta, o</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">utTexturePos, <span class="insert">ca, outColors,</span> maxSqDistortion, nbI+1, false, true, true);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               //va[0]=vertices[1]+vertices[2];</td><td> </td><td class="right">               //va[0]=vertices[1]+vertices[2];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               //va[0].normalize();</td><td> </td><td class="right">               //va[0].normalize();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               va[0]=va[2];</td><td> </td><td class="right">               va[0]=va[2];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               va[1]=vertices[2];</td><td> </td><td class="right">               va[1]=vertices[2];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               va[2]=vertices[0];va[2]+=vertices[2];</td><td> </td><td class="right">               va[2]=vertices[0];va[2]+=vertices[2];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               va[2].normalize();</td><td> </td><td class="right">               va[2].normalize();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               if (outTexturePos)</td><td> </td><td class="right">               if (outTexturePos)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       ta[0]=(texturePos[1]+texturePos[2])*0.5;</td><td> </td><td class="right">                       ta[0]=(texturePos[1]+texturePos[2])*0.5;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       ta[1]=texturePos[2];</td><td> </td><td class="right">                       ta[1]=texturePos[2];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       ta[2]=(texturePos[0]+texturePos[2])*0.5;</td><td> </td><td class="right">                       ta[2]=(texturePos[0]+texturePos[2])*0.5;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0018" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               projectSphericalTriangle(clippingCap, va, outVertices, ta, o</td><td> </td><td class="rblock">               <span class="insert">if (outColors)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">utTexturePos, maxSqDistortion, nbI+1);</td><td> </td><td class="rblock"><span class="insert">               {</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       ca[0]=(colors[1]+colors[2])*0.5;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       ca[1]=colors[2];</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       ca[2]=(colors[0]+colors[2])*0.5;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">               projectSphericalTriangle(clippingCap, va, outVertices, ta, o</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">utTexturePos, <span class="insert">ca, outColors,</span> maxSqDistortion, nbI+1);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               va[1]=va[0];</td><td> </td><td class="right">               va[1]=va[0];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               va[0]=vertices[0];</td><td> </td><td class="right">               va[0]=vertices[0];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               //va[1]=vertices[1]+vertices[2];</td><td> </td><td class="right">               //va[1]=vertices[1]+vertices[2];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               //va[1].normalize();</td><td> </td><td class="right">               //va[1].normalize();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               //va[2]=vertices[0]+vertices[2];</td><td> </td><td class="right">               //va[2]=vertices[0]+vertices[2];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               //va[2].normalize();</td><td> </td><td class="right">               //va[2].normalize();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               if (outTexturePos)</td><td> </td><td class="right">               if (outTexturePos)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       ta[0]=texturePos[0];</td><td> </td><td class="right">                       ta[0]=texturePos[0];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       ta[1]=(texturePos[1]+texturePos[2])*0.5;</td><td> </td><td class="right">                       ta[1]=(texturePos[1]+texturePos[2])*0.5;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       ta[2]=(texturePos[0]+texturePos[2])*0.5;</td><td> </td><td class="right">                       ta[2]=(texturePos[0]+texturePos[2])*0.5;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0019" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               projectSphericalTriangle(clippingCap, va, outVertices, ta, o</td><td> </td><td class="rblock">               <span class="insert">if (outColors)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">utTexturePos, maxSqDistortion, nbI+1);</td><td> </td><td class="rblock"><span class="insert">               {</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       ca[0]=colors[0];</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       ca[1]=(colors[1]+colors[2])*0.5;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       ca[2]=(colors[0]+colors[2])*0.5;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">               projectSphericalTriangle(clippingCap, va, outVertices, ta, o</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">utTexturePos, <span class="insert">ca, outColors,</span> maxSqDistortion, nbI+1);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               return;</td><td> </td><td class="right">               return;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // Last case: the 3 sides have to be split: cut in 4 triangles a' la
 HTM</td><td> </td><td class="right">       // Last case: the 3 sides have to be split: cut in 4 triangles a' la
 HTM</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       va[0]=vertices[0];va[0]+=vertices[1];</td><td> </td><td class="right">       va[0]=vertices[0];va[0]+=vertices[1];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       va[0].normalize();</td><td> </td><td class="right">       va[0].normalize();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       va[1]=vertices[1];va[1]+=vertices[2];</td><td> </td><td class="right">       va[1]=vertices[1];va[1]+=vertices[2];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       va[1].normalize();</td><td> </td><td class="right">       va[1].normalize();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       va[2]=vertices[0];va[2]+=vertices[2];</td><td> </td><td class="right">       va[2]=vertices[0];va[2]+=vertices[2];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       va[2].normalize();</td><td> </td><td class="right">       va[2].normalize();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (outTexturePos)</td><td> </td><td class="right">       if (outTexturePos)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               ta[0]=(texturePos[0]+texturePos[1])*0.5;</td><td> </td><td class="right">               ta[0]=(texturePos[0]+texturePos[1])*0.5;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               ta[1]=(texturePos[1]+texturePos[2])*0.5;</td><td> </td><td class="right">               ta[1]=(texturePos[1]+texturePos[2])*0.5;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               ta[2]=(texturePos[0]+texturePos[2])*0.5;</td><td> </td><td class="right">               ta[2]=(texturePos[0]+texturePos[2])*0.5;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0020" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       projectSphericalTriangle(clippingCap, va, outVertices, ta, outTextur</td><td> </td><td class="rblock">       <span class="insert">if (outColors)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">ePos, maxSqDistortion, nbI+1);</td><td> </td><td class="rblock"><span class="insert">       {</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               ca[0]=(colors[0]+colors[1])*0.5;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               ca[1]=(colors[1]+colors[2])*0.5;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               ca[2]=(colors[0]+colors[2])*0.5;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       projectSphericalTriangle(clippingCap, va, outVertices, ta, outTextur</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">ePos, <span class="insert">ca, outColors,</span> maxSqDistortion, nbI+1);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       va[1]=va[0];</td><td> </td><td class="right">       va[1]=va[0];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       va[0]=vertices[0];</td><td> </td><td class="right">       va[0]=vertices[0];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       //va[1]=vertices[0]+vertices[1];</td><td> </td><td class="right">       //va[1]=vertices[0]+vertices[1];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       //va[1].normalize();</td><td> </td><td class="right">       //va[1].normalize();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       //va[2]=vertices[0]+vertices[2];</td><td> </td><td class="right">       //va[2]=vertices[0]+vertices[2];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       //va[2].normalize();</td><td> </td><td class="right">       //va[2].normalize();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (outTexturePos)</td><td> </td><td class="right">       if (outTexturePos)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               ta[0]=texturePos[0];</td><td> </td><td class="right">               ta[0]=texturePos[0];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               ta[1]=(texturePos[0]+texturePos[1])*0.5;</td><td> </td><td class="right">               ta[1]=(texturePos[0]+texturePos[1])*0.5;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               ta[2]=(texturePos[0]+texturePos[2])*0.5;</td><td> </td><td class="right">               ta[2]=(texturePos[0]+texturePos[2])*0.5;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0021" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       projectSphericalTriangle(clippingCap, va, outVertices, ta, outTextur</td><td> </td><td class="rblock">       <span class="insert">if (outColors)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">ePos, maxSqDistortion, nbI+1);</td><td> </td><td class="rblock"><span class="insert">       {</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               ca[0]=colors[0];</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               ca[1]=(colors[0]+colors[1])*0.5;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               ca[2]=(colors[0]+colors[2])*0.5;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       projectSphericalTriangle(clippingCap, va, outVertices, ta, outTextur</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">ePos, <span class="insert">ca, outColors,</span> maxSqDistortion, nbI+1);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       //va[0]=vertices[0]+vertices[1];</td><td> </td><td class="right">       //va[0]=vertices[0]+vertices[1];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       //va[0].normalize();</td><td> </td><td class="right">       //va[0].normalize();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       va[0]=va[1];</td><td> </td><td class="right">       va[0]=va[1];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       va[1]=vertices[1];</td><td> </td><td class="right">       va[1]=vertices[1];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       va[2]=vertices[1];va[2]+=vertices[2];</td><td> </td><td class="right">       va[2]=vertices[1];va[2]+=vertices[2];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       va[2].normalize();</td><td> </td><td class="right">       va[2].normalize();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (outTexturePos)</td><td> </td><td class="right">       if (outTexturePos)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               ta[0]=(texturePos[0]+texturePos[1])*0.5;</td><td> </td><td class="right">               ta[0]=(texturePos[0]+texturePos[1])*0.5;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               ta[1]=texturePos[1];</td><td> </td><td class="right">               ta[1]=texturePos[1];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               ta[2]=(texturePos[1]+texturePos[2])*0.5;</td><td> </td><td class="right">               ta[2]=(texturePos[1]+texturePos[2])*0.5;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0022" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       projectSphericalTriangle(clippingCap, va, outVertices, ta, outTextur</td><td> </td><td class="rblock">       <span class="insert">if (outColors)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">ePos, maxSqDistortion, nbI+1);</td><td> </td><td class="rblock"><span class="insert">       {</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               ca[0]=(colors[0]+colors[1])*0.5;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               ca[1]=colors[1];</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               ca[2]=(colors[1]+colors[2])*0.5;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       projectSphericalTriangle(clippingCap, va, outVertices, ta, outTextur</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">ePos, <span class="insert">ca, outColors,</span> maxSqDistortion, nbI+1);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       va[0]=vertices[0];va[0]+=vertices[2];</td><td> </td><td class="right">       va[0]=vertices[0];va[0]+=vertices[2];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       va[0].normalize();</td><td> </td><td class="right">       va[0].normalize();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       //va[1]=vertices[1]+vertices[2];</td><td> </td><td class="right">       //va[1]=vertices[1]+vertices[2];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       //va[1].normalize();</td><td> </td><td class="right">       //va[1].normalize();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       va[1]=va[2];</td><td> </td><td class="right">       va[1]=va[2];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       va[2]=vertices[2];</td><td> </td><td class="right">       va[2]=vertices[2];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (outTexturePos)</td><td> </td><td class="right">       if (outTexturePos)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               ta[0]=(texturePos[0]+texturePos[2])*0.5;</td><td> </td><td class="right">               ta[0]=(texturePos[0]+texturePos[2])*0.5;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               ta[1]=(texturePos[1]+texturePos[2])*0.5;</td><td> </td><td class="right">               ta[1]=(texturePos[1]+texturePos[2])*0.5;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               ta[2]=texturePos[2];</td><td> </td><td class="right">               ta[2]=texturePos[2];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0023" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       projectSphericalTriangle(clippingCap, va, outVertices, ta, outTextur</td><td> </td><td class="rblock">       <span class="insert">if (outColors)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">ePos, maxSqDistortion, nbI+1);</td><td> </td><td class="rblock"><span class="insert">       {</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               ca[0]=(colors[0]+colors[2])*0.5;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               ca[1]=(colors[1]+colors[2])*0.5;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               ca[2]=colors[2];</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       projectSphericalTriangle(clippingCap, va, outVertices, ta, outTextur</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">ePos, <span class="insert">ca, outColors,</span> maxSqDistortion, nbI+1);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return;</td><td> </td><td class="right">       return;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">static QVarLengthArray&lt;Vec3f, 4096&gt; polygonVertexArray;</td><td> </td><td class="right">static QVarLengthArray&lt;Vec3f, 4096&gt; polygonVertexArray;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">static QVarLengthArray&lt;Vec2f, 4096&gt; polygonTextureCoordArray;</td><td> </td><td class="right">static QVarLengthArray&lt;Vec2f, 4096&gt; polygonTextureCoordArray;</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0024" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">static QVarLengthArray&lt;Vec3f, 4096&gt; polygonColorArray;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">static QVarLengthArray&lt;unsigned int, 4096&gt; indexArray;</td><td> </td><td class="right">static QVarLengthArray&lt;unsigned int, 4096&gt; indexArray;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void StelPainter::drawGreatCircleArcs(const StelVertexArray&amp; va, const Sphe
ricalCap* clippingCap)</td><td> </td><td class="right">void StelPainter::drawGreatCircleArcs(const StelVertexArray&amp; va, const Sphe
ricalCap* clippingCap)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       Q_ASSERT(va.vertex.size()!=1);</td><td> </td><td class="right">       Q_ASSERT(va.vertex.size()!=1);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       Q_ASSERT(!va.isIndexed());      // Indexed unsupported yet</td><td> </td><td class="right">       Q_ASSERT(!va.isIndexed());      // Indexed unsupported yet</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       switch (va.primitiveType)</td><td> </td><td class="right">       switch (va.primitiveType)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               case StelVertexArray::Lines:</td><td> </td><td class="right">               case StelVertexArray::Lines:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       Q_ASSERT(va.vertex.size()%2==0);</td><td> </td><td class="right">                       Q_ASSERT(va.vertex.size()%2==0);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l3" /><small>skipping to change at</small><em> line 1092</em></th><th> </th><th><a name="part-r3" /><small>skipping to change at</small><em> line 1212</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// The function object that we use as an interface between VertexArray::for
eachTriangle and</td><td> </td><td class="right">// The function object that we use as an interface between VertexArray::for
eachTriangle and</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// StelPainter::projectSphericalTriangle.</td><td> </td><td class="right">// StelPainter::projectSphericalTriangle.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//</td><td> </td><td class="right">//</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// This is used by drawSphericalTriangles to project all the triangles coor
dinates in a StelVertexArray into our global</td><td> </td><td class="right">// This is used by drawSphericalTriangles to project all the triangles coor
dinates in a StelVertexArray into our global</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// vertex array buffer.</td><td> </td><td class="right">// vertex array buffer.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">class VertexArrayProjector</td><td> </td><td class="right">class VertexArrayProjector</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">public:</td><td> </td><td class="right">public:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       VertexArrayProjector(const StelVertexArray&amp; ar, StelPainter* apainte
r, const SphericalCap* aclippingCap,</td><td> </td><td class="right">       VertexArrayProjector(const StelVertexArray&amp; ar, StelPainter* apainte
r, const SphericalCap* aclippingCap,</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0025" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                QVarLengthArray&lt;Vec3f, 4096
&gt;* aoutVertices, QVarLengthArray&lt;Vec2f, 4096&gt;* aoutTexturePos=NULL, <span class="delete">double 
</span>amaxSqDistortion=5.)</td><td> </td><td class="rblock">                                                QVarLengthArray&lt;Vec3f, 4096
&gt;* aoutVertices, QVarLengthArray&lt;Vec2f, 4096&gt;* aoutTexturePos=NULL, <span class="insert">QVarLen
gthArray&lt;Vec3f, 4096&gt;* aoutColors=NULL, double </span>amaxSqDistortion=5.)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                  : vertexArray(ar), painter(apainter), clippingCap(aclippi
ngCap), outVertices(aoutVertices),</td><td> </td><td class="right">                  : vertexArray(ar), painter(apainter), clippingCap(aclippi
ngCap), outVertices(aoutVertices),</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0026" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                        out<span class="delete">TexturePos(aoutTexturePos), maxSqDistortion(amax
</span>SqDistortion)</td><td> </td><td class="rblock">                        out<span class="insert">Colors(aoutColors), outTexturePos(aoutTexturePos
), maxSqDistortion(amax</span>SqDistortion)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // Project a single triangle and add it into the output arrays</td><td> </td><td class="right">       // Project a single triangle and add it into the output arrays</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       inline void operator()(const Vec3d* v0, const Vec3d* v1, const Vec3d
* v2,</td><td> </td><td class="right">       inline void operator()(const Vec3d* v0, const Vec3d* v1, const Vec3d
* v2,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                                  const Vec2f* t0, const Ve
c2f* t1, const Vec2f* t2,</td><td> </td><td class="right">                                                  const Vec2f* t0, const Ve
c2f* t1, const Vec2f* t2,</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0027" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                                                  const Vec3f* c0, const Ve
c3f* c1, const Vec3f* c2,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                                  unsigned int, unsigned in
t, unsigned)</td><td> </td><td class="right">                                                  unsigned int, unsigned in
t, unsigned)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               // XXX: we may optimize more by putting the declaration and 
the test outside of this method.</td><td> </td><td class="right">               // XXX: we may optimize more by putting the declaration and 
the test outside of this method.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               const Vec3d tmpVertex[3] = {*v0, *v1, *v2};</td><td> </td><td class="right">               const Vec3d tmpVertex[3] = {*v0, *v1, *v2};</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0028" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               if (outTexturePos)</td><td> </td><td class="rblock">               if <span class="insert">( (outTexturePos) &amp;&amp; (outColors))</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               {</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       const Vec2f tmpTexture[3] = {*t0, *t1, *t2};</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       const Vec3f tmpColor[3] = {*c0, *c1, *c2};</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       painter-&gt;projectSphericalTriangle(clippingCap, tmpVe</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">rtex, outVertices, tmpTexture, outTexturePos, tmpColor, outColors, maxSqDis</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">tortion);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               else if</span> (outTexturePos)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       const Vec2f tmpTexture[3] = {*t0, *t1, *t2};</td><td> </td><td class="right">                       const Vec2f tmpTexture[3] = {*t0, *t1, *t2};</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0029" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       painter-&gt;projectSphericalTriangle(clippingCap, tmpVe</td><td> </td><td class="rblock">                       painter-&gt;projectSphericalTriangle(clippingCap, tmpVe</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">rtex, outVertices, tmpTexture, outTexturePos, maxSqDistortion);</td><td> </td><td class="rblock">rtex, outVertices, tmpTexture, outTexturePos, <span class="insert">NULL, NULL, maxSqDistortion);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               else if (outColors)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               {</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       const Vec3f tmpColor[3] = {*c0, *c1, *c2};</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       painter-&gt;projectSphericalTriangle(clippingCap, tmpVe</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">rtex, outVertices, NULL, NULL, tmpColor, outColors,</span> maxSqDistortion);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               else</td><td> </td><td class="right">               else</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0030" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       painter-&gt;projectSphericalTriangle(clippingCap, tmpVe
rtex, outVertices, NULL, NULL, maxSqDistortion);</td><td> </td><td class="rblock">                       painter-&gt;projectSphericalTriangle(clippingCap, tmpVe
rtex, outVertices, NULL, NULL, <span class="insert">NULL, NULL, </span>maxSqDistortion);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // Draw the resulting arrays</td><td> </td><td class="right">       // Draw the resulting arrays</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       void drawResult()</td><td> </td><td class="right">       void drawResult()</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               painter-&gt;setVertexPointer(3, GL_FLOAT, outVertices-&gt;constDat
a());</td><td> </td><td class="right">               painter-&gt;setVertexPointer(3, GL_FLOAT, outVertices-&gt;constDat
a());</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               if (outTexturePos)</td><td> </td><td class="right">               if (outTexturePos)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       painter-&gt;setTexCoordPointer(2, GL_FLOAT, outTextureP
os-&gt;constData());</td><td> </td><td class="right">                       painter-&gt;setTexCoordPointer(2, GL_FLOAT, outTextureP
os-&gt;constData());</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0031" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               painter-&gt;enableClientStates(true, outTexturePos != NULL);</td><td> </td><td class="rblock">               <span class="insert">if (outColors)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       painter-&gt;setColorPointer(3, GL_FLOAT, outColors-&gt;con</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">stData());</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                           </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">               painter-&gt;enableClientStates(true, outTexturePos <span class="insert">!= NULL, out</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">Colors</span> != NULL);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               painter-&gt;drawFromArray(StelPainter::Triangles, outVertices-&gt;
size(), 0, false);</td><td> </td><td class="right">               painter-&gt;drawFromArray(StelPainter::Triangles, outVertices-&gt;
size(), 0, false);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               painter-&gt;enableClientStates(false);</td><td> </td><td class="right">               painter-&gt;enableClientStates(false);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">private:</td><td> </td><td class="right">private:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       const StelVertexArray&amp; vertexArray;</td><td> </td><td class="right">       const StelVertexArray&amp; vertexArray;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       StelPainter* painter;</td><td> </td><td class="right">       StelPainter* painter;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       const SphericalCap* clippingCap;</td><td> </td><td class="right">       const SphericalCap* clippingCap;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       QVarLengthArray&lt;Vec3f, 4096&gt;* outVertices;</td><td> </td><td class="right">       QVarLengthArray&lt;Vec3f, 4096&gt;* outVertices;</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0032" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       QVarLengthArray&lt;Vec3f, 4096&gt;* outColors;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       QVarLengthArray&lt;Vec2f, 4096&gt;* outTexturePos;</td><td> </td><td class="right">       QVarLengthArray&lt;Vec2f, 4096&gt;* outTexturePos;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double maxSqDistortion;</td><td> </td><td class="right">       double maxSqDistortion;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">};</td><td> </td><td class="right">};</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void StelPainter::drawStelVertexArray(const StelVertexArray&amp; arr, const boo
l checkDiscontinuity)</td><td> </td><td class="right">void StelPainter::drawStelVertexArray(const StelVertexArray&amp; arr, const boo
l checkDiscontinuity)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (checkDiscontinuity &amp;&amp; prj-&gt;hasDiscontinuity())</td><td> </td><td class="right">       if (checkDiscontinuity &amp;&amp; prj-&gt;hasDiscontinuity())</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               // The projection has discontinuities, so we need to make su
re that no triangle is crossing them.</td><td> </td><td class="right">               // The projection has discontinuities, so we need to make su
re that no triangle is crossing them.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               drawStelVertexArray(arr.removeDiscontinuousTriangles(this-&gt;g
etProjector().data()), false);</td><td> </td><td class="right">               drawStelVertexArray(arr.removeDiscontinuousTriangles(this-&gt;g
etProjector().data()), false);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               return;</td><td> </td><td class="right">               return;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       setVertexPointer(3, GL_DOUBLE, arr.vertex.constData());</td><td> </td><td class="right">       setVertexPointer(3, GL_DOUBLE, arr.vertex.constData());</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (arr.isTextured())</td><td> </td><td class="right">       if (arr.isTextured())</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               setTexCoordPointer(2, GL_FLOAT, arr.texCoords.constData());</td><td> </td><td class="right">               setTexCoordPointer(2, GL_FLOAT, arr.texCoords.constData());</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0033" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               enableClientStates(true, true);</td><td> </td><td class="rblock">               <span class="insert">if (arr.isColored())</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               {</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       setColorPointer(3, GL_FLOAT, arr.colors.constData())</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                       enableClientStates(true, <span class="insert">true,</span> true);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">               <span class="insert">}</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               else</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       enableClientStates(true, true, false);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       else</td><td> </td><td class="right">       else</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0034" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               enableClientStates(true, false);</td><td> </td><td class="rblock">               <span class="insert">if (arr.isColored())</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               {</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       setColorPointer(3, GL_FLOAT, arr.colors.constData())</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                       enableClientStates(true, <span class="insert">false, true);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               else</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       enableClientStates(true, false,</span> false);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (arr.isIndexed())</td><td> </td><td class="right">       if (arr.isIndexed())</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               drawFromArray((StelPainter::DrawingMode)arr.primitiveType, a
rr.indices.size(), 0, true, arr.indices.constData());</td><td> </td><td class="right">               drawFromArray((StelPainter::DrawingMode)arr.primitiveType, a
rr.indices.size(), 0, true, arr.indices.constData());</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       else</td><td> </td><td class="right">       else</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               drawFromArray((StelPainter::DrawingMode)arr.primitiveType, a
rr.vertex.size());</td><td> </td><td class="right">               drawFromArray((StelPainter::DrawingMode)arr.primitiveType, a
rr.vertex.size());</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       enableClientStates(false);</td><td> </td><td class="right">       enableClientStates(false);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0035" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">void StelPainter::drawSphericalTriangles(const StelVertexArray&amp; va, const b
ool textured, const <span class="delete">SphericalCap* clippingCap, const bool doSubDivide, cons
</span>t double maxSqDistortion)</td><td> </td><td class="rblock">void StelPainter::drawSphericalTriangles(const StelVertexArray&amp; va, const b
ool textured, const <span class="insert">bool colored, const SphericalCap* clippingCap, const bo
ol doSubDivide, cons</span>t double maxSqDistortion)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (va.vertex.isEmpty())</td><td> </td><td class="right">       if (va.vertex.isEmpty())</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               return;</td><td> </td><td class="right">               return;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       Q_ASSERT(va.vertex.size()&gt;2);</td><td> </td><td class="right">       Q_ASSERT(va.vertex.size()&gt;2);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       polygonVertexArray.clear();</td><td> </td><td class="right">       polygonVertexArray.clear();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       polygonTextureCoordArray.clear();</td><td> </td><td class="right">       polygonTextureCoordArray.clear();</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0036" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                                                                           </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       indexArray.clear();</td><td> </td><td class="right">       indexArray.clear();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (!doSubDivide)</td><td> </td><td class="right">       if (!doSubDivide)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               // The simplest case, we don't need to iterate through the t
riangles at all.</td><td> </td><td class="right">               // The simplest case, we don't need to iterate through the t
riangles at all.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               drawStelVertexArray(va);</td><td> </td><td class="right">               drawStelVertexArray(va);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               return;</td><td> </td><td class="right">               return;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // the last case.  It is the slowest, it process the triangles one b
y one.</td><td> </td><td class="right">       // the last case.  It is the slowest, it process the triangles one b
y one.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               // Project all the triangles of the VertexArray into our buf
fer arrays.</td><td> </td><td class="right">               // Project all the triangles of the VertexArray into our buf
fer arrays.</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0037" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               VertexArrayProjector result = va.foreachTriangle(VertexArray
Projector(va, this, clippingCap, &amp;polygonVertexArray, textured ? &amp;polygonTe
xtureCoordArray : NULL, <span class="delete">maxSqDistortio</span>n));</td><td> </td><td class="rblock">               VertexArrayProjector result = va.foreachTriangle(VertexArray
Projector(va, this, clippingCap, &amp;polygonVertexArray, textured ? &amp;polygonTe
xtureCoordArray : NULL, <span class="insert">colored ? &amp;polygonColorArray : NULL, maxSqDistortio
</span>n));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               result.drawResult();</td><td> </td><td class="right">               result.drawResult();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               return;</td><td> </td><td class="right">               return;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Draw the given SphericalPolygon.</td><td> </td><td class="right">// Draw the given SphericalPolygon.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void StelPainter::drawSphericalRegion(const SphericalRegion* poly, Spherica
lPolygonDrawMode drawMode, const SphericalCap* clippingCap, const bool doSu
bDivise, const double maxSqDistortion)</td><td> </td><td class="right">void StelPainter::drawSphericalRegion(const SphericalRegion* poly, Spherica
lPolygonDrawMode drawMode, const SphericalCap* clippingCap, const bool doSu
bDivise, const double maxSqDistortion)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (!prj-&gt;getBoundingCap().intersects(poly-&gt;getBoundingCap()))</td><td> </td><td class="right">       if (!prj-&gt;getBoundingCap().intersects(poly-&gt;getBoundingCap()))</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               return;</td><td> </td><td class="right">               return;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l4" /><small>skipping to change at</small><em> line 1206</em></th><th> </th><th><a name="part-r4" /><small>skipping to change at</small><em> line 1355</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       if (doSubDivise || prj-&gt;intersectViewportDiscontinui
ty(poly-&gt;getBoundingCap()))</td><td> </td><td class="right">                       if (doSubDivise || prj-&gt;intersectViewportDiscontinui
ty(poly-&gt;getBoundingCap()))</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               drawGreatCircleArcs(poly-&gt;getOutlineVertexAr
ray(), clippingCap);</td><td> </td><td class="right">                               drawGreatCircleArcs(poly-&gt;getOutlineVertexAr
ray(), clippingCap);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       else</td><td> </td><td class="right">                       else</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               drawStelVertexArray(poly-&gt;getOutlineVertexAr
ray(), false);</td><td> </td><td class="right">                               drawStelVertexArray(poly-&gt;getOutlineVertexAr
ray(), false);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       break;</td><td> </td><td class="right">                       break;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               case SphericalPolygonDrawModeFill:</td><td> </td><td class="right">               case SphericalPolygonDrawModeFill:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               case SphericalPolygonDrawModeTextureFill:</td><td> </td><td class="right">               case SphericalPolygonDrawModeTextureFill:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       glEnable(GL_CULL_FACE);</td><td> </td><td class="right">                       glEnable(GL_CULL_FACE);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       // The polygon is already tesselated as triangles</td><td> </td><td class="right">                       // The polygon is already tesselated as triangles</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       if (doSubDivise || prj-&gt;intersectViewportDiscontinui
ty(poly-&gt;getBoundingCap()))</td><td> </td><td class="right">                       if (doSubDivise || prj-&gt;intersectViewportDiscontinui
ty(poly-&gt;getBoundingCap()))</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0038" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                               drawSphericalTriangles(poly-&gt;getFillVertexAr</td><td> </td><td class="rblock">                               <span class="insert">// flag for color-modulated textured mode (e</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">ray(), <span class="delete">drawMode==SphericalPolygonDrawModeTextureFill,</span> clippingCap, <span class="delete">doSubDiv</span></td><td> </td><td class="rblock"><span class="insert">.g. for Milky Way/extincted)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">ise, maxSqDistortion);</span></td><td> </td><td class="rblock">                               drawSphericalTriangles(poly-&gt;getFillVertexAr</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">ray(), <span class="insert">drawMode&gt;=SphericalPolygonDrawModeTextureFill, drawMode==SphericalPo</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">lygonDrawModeTextureFillColormodulated,</span> clippingCap, <span class="insert">doSubDivise, maxSqDist</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">ortion);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       else</td><td> </td><td class="right">                       else</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               drawStelVertexArray(poly-&gt;getFillVertexArray
(), false);</td><td> </td><td class="right">                               drawStelVertexArray(poly-&gt;getFillVertexArray
(), false);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       glDisable(GL_CULL_FACE);</td><td> </td><td class="right">                       glDisable(GL_CULL_FACE);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       break;</td><td> </td><td class="right">                       break;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               default:</td><td> </td><td class="right">               default:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       Q_ASSERT(0);</td><td> </td><td class="right">                       Q_ASSERT(0);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l5" /><small>skipping to change at</small><em> line 1365</em></th><th> </th><th><a name="part-r5" /><small>skipping to change at</small><em> line 1515</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       vertexData[3]=y2;</td><td> </td><td class="right">       vertexData[3]=y2;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       enableClientStates(true);</td><td> </td><td class="right">       enableClientStates(true);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       setVertexPointer(2, GL_FLOAT, vertexData);</td><td> </td><td class="right">       setVertexPointer(2, GL_FLOAT, vertexData);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       drawFromArray(Lines, 2, 0, false);</td><td> </td><td class="right">       drawFromArray(Lines, 2, 0, false);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       enableClientStates(false);</td><td> </td><td class="right">       enableClientStates(false);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">///////////////////////////////////////////////////////////////////////////</td><td> </td><td class="right">///////////////////////////////////////////////////////////////////////////</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Drawing methods for general (non-linear) mode.</td><td> </td><td class="right">// Drawing methods for general (non-linear) mode.</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0039" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">// <span class="delete">GZ This used to draw a full sphere. Now it's possible to have a spherica
</span>l zone only.</td><td> </td><td class="rblock">// <span class="insert">This used to draw a full sphere. Since 0.13 it's possible to have a sphe
rica</span>l zone only.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void StelPainter::sSphere(const float radius, const float oneMinusOblatenes
s, const int slices, const int stacks, const int orientInside, const bool f
lipTexture, const float topAngle, const float bottomAngle)</td><td> </td><td class="right">void StelPainter::sSphere(const float radius, const float oneMinusOblatenes
s, const int slices, const int stacks, const int orientInside, const bool f
lipTexture, const float topAngle, const float bottomAngle)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       GLfloat x, y, z;</td><td> </td><td class="right">       GLfloat x, y, z;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       GLfloat s=0.f, t=0.f;</td><td> </td><td class="right">       GLfloat s=0.f, t=0.f;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       GLint i, j;</td><td> </td><td class="right">       GLint i, j;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       GLfloat nsign;</td><td> </td><td class="right">       GLfloat nsign;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (orientInside)</td><td> </td><td class="right">       if (orientInside)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               nsign = -1.f;</td><td> </td><td class="right">               nsign = -1.f;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               t=0.f; // from inside texture is reversed</td><td> </td><td class="right">               t=0.f; // from inside texture is reversed</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       else</td><td> </td><td class="right">       else</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               nsign = 1.f;</td><td> </td><td class="right">               nsign = 1.f;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               t=1.f;</td><td> </td><td class="right">               t=1.f;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       const float* cos_sin_rho = NULL;</td><td> </td><td class="right">       const float* cos_sin_rho = NULL;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       Q_ASSERT(topAngle&lt;bottomAngle); // don't forget: These are opening a
ngles counted from top.</td><td> </td><td class="right">       Q_ASSERT(topAngle&lt;bottomAngle); // don't forget: These are opening a
ngles counted from top.</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0040" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       if ((bottomAngle&gt;3.1415<span class="delete">) &amp;&amp; (topAngle&lt;0.0001</span>)) // safety margin.</td><td> </td><td class="rblock">       if ((bottomAngle&gt;3.1415<span class="insert">f) &amp;&amp; (topAngle&lt;0.0001f</span>)) // safety margin.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               cos_sin_rho = StelUtils::ComputeCosSinRho(stacks);</td><td> </td><td class="right">               cos_sin_rho = StelUtils::ComputeCosSinRho(stacks);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       else</td><td> </td><td class="right">       else</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               const float drho = (bottomAngle-topAngle) / stacks; // delta
Rho:  originally just 180degrees/stacks, now the range clamped.</td><td> </td><td class="right">               const float drho = (bottomAngle-topAngle) / stacks; // delta
Rho:  originally just 180degrees/stacks, now the range clamped.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               cos_sin_rho = StelUtils::ComputeCosSinRhoZone(drho, stacks, 
M_PI-bottomAngle);</td><td> </td><td class="right">               cos_sin_rho = StelUtils::ComputeCosSinRhoZone(drho, stacks, 
M_PI-bottomAngle);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0041" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       // <span class="delete">GZ: </span>Allow parameters so that pole regions may remain free.</td><td> </td><td class="rblock">       // Allow parameters so that pole regions may remain free.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       const float* cos_sin_rho_p;</td><td> </td><td class="right">       const float* cos_sin_rho_p;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       const float* cos_sin_theta = StelUtils::ComputeCosSinTheta(slices);</td><td> </td><td class="right">       const float* cos_sin_theta = StelUtils::ComputeCosSinTheta(slices);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       const float *cos_sin_theta_p;</td><td> </td><td class="right">       const float *cos_sin_theta_p;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // texturing: s goes from 0.0/0.25/0.5/0.75/1.0 at +y/+x/-y/-x/+y ax
is</td><td> </td><td class="right">       // texturing: s goes from 0.0/0.25/0.5/0.75/1.0 at +y/+x/-y/-x/+y ax
is</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // t goes from -1.0/+1.0 at z = -radius/+radius (linear along longit
udes)</td><td> </td><td class="right">       // t goes from -1.0/+1.0 at z = -radius/+radius (linear along longit
udes)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // cannot use triangle fan on texturing (s coord. at top/bottom tip 
varies)</td><td> </td><td class="right">       // cannot use triangle fan on texturing (s coord. at top/bottom tip 
varies)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // If the texture is flipped, we iterate the coordinates backward.</td><td> </td><td class="right">       // If the texture is flipped, we iterate the coordinates backward.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       const GLfloat ds = (flipTexture ? -1.f : 1.f) / slices;</td><td> </td><td class="right">       const GLfloat ds = (flipTexture ? -1.f : 1.f) / slices;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       const GLfloat dt = nsign / stacks; // from inside texture is reverse
d</td><td> </td><td class="right">       const GLfloat dt = nsign / stacks; // from inside texture is reverse
d</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0042" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       // draw intermediate <span class="delete"> </span>as quad strips</td><td> </td><td class="rblock">       // draw intermediate as quad strips</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       static QVector&lt;double&gt; vertexArr;</td><td> </td><td class="right">       static QVector&lt;double&gt; vertexArr;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       static QVector&lt;float&gt; texCoordArr;</td><td> </td><td class="right">       static QVector&lt;float&gt; texCoordArr;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       static QVector&lt;float&gt; colorArr;</td><td> </td><td class="right">       static QVector&lt;float&gt; colorArr;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       static QVector&lt;unsigned short&gt; indiceArr;</td><td> </td><td class="right">       static QVector&lt;unsigned short&gt; indiceArr;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       texCoordArr.resize(0);</td><td> </td><td class="right">       texCoordArr.resize(0);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       vertexArr.resize(0);</td><td> </td><td class="right">       vertexArr.resize(0);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       colorArr.resize(0);</td><td> </td><td class="right">       colorArr.resize(0);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       indiceArr.resize(0);</td><td> </td><td class="right">       indiceArr.resize(0);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l6" /><small>skipping to change at</small><em> line 1448</em></th><th> </th><th><a name="part-r6" /><small>skipping to change at</small><em> line 1598</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       indiceArr &lt;&lt; offset+j &lt;&lt; offset+j-1 &lt;&lt; offset+j+1;</td><td> </td><td class="right">                       indiceArr &lt;&lt; offset+j &lt;&lt; offset+j-1 &lt;&lt; offset+j+1;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               t -= dt;</td><td> </td><td class="right">               t -= dt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // Draw the array now</td><td> </td><td class="right">       // Draw the array now</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       setArrays((Vec3d*)vertexArr.constData(), (Vec2f*)texCoordArr.constDa
ta());</td><td> </td><td class="right">       setArrays((Vec3d*)vertexArr.constData(), (Vec2f*)texCoordArr.constDa
ta());</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       drawFromArray(Triangles, indiceArr.size(), 0, true, indiceArr.constD
ata());</td><td> </td><td class="right">       drawFromArray(Triangles, indiceArr.size(), 0, true, indiceArr.constD
ata());</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0043" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">StelVertexArray StelPainter::computeSphereNoLight(const float radius, const</td><td> </td><td class="rblock">StelVertexArray StelPainter::computeSphereNoLight(const float radius, const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"> float oneMinusOblateness, const int slices, const int stacks, const int <span class="delete">or</span></td><td> </td><td class="rblock"> float oneMinusOblateness, const int slices, const int stacks,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">ientInside, const</span> bool <span class="delete">flipTexture)</span></td><td> </td><td class="rblock">                                                 const int <span class="insert">orientInside, co</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">nst</span> bool <span class="insert">flipTexture, const float topAngle, const float bottomAngle)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       StelVertexArray result(StelVertexArray::Triangles);</td><td> </td><td class="right">       StelVertexArray result(StelVertexArray::Triangles);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       GLfloat x, y, z;</td><td> </td><td class="right">       GLfloat x, y, z;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       GLfloat s=0.f, t=0.f;</td><td> </td><td class="right">       GLfloat s=0.f, t=0.f;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       GLint i, j;</td><td> </td><td class="right">       GLint i, j;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       GLfloat nsign;</td><td> </td><td class="right">       GLfloat nsign;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (orientInside)</td><td> </td><td class="right">       if (orientInside)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               nsign = -1.f;</td><td> </td><td class="right">               nsign = -1.f;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               t=0.f; // from inside texture is reversed</td><td> </td><td class="right">               t=0.f; // from inside texture is reversed</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       else</td><td> </td><td class="right">       else</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               nsign = 1.f;</td><td> </td><td class="right">               nsign = 1.f;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               t=1.f;</td><td> </td><td class="right">               t=1.f;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0044" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       const float* cos_sin_rho = StelUtils::ComputeCosSinRho(stacks);</td><td> </td><td class="rblock">       const float* cos_sin_rho = <span class="insert">NULL; //StelUtils::ComputeCosSinRho(stack</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">s);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       Q_ASSERT(topAngle&lt;bottomAngle); // don't forget: These are opening a</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">ngles counted from top.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       if ((bottomAngle&gt;3.1415f) &amp;&amp; (topAngle&lt;0.0001f)) // safety margin.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               cos_sin_rho =</span> StelUtils::ComputeCosSinRho(stacks);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       <span class="insert">else</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       {</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               const float drho = (bottomAngle-topAngle) / stacks; // delta</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">Rho:  originally just 180degrees/stacks, now the range clamped.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               cos_sin_rho = StelUtils::ComputeCosSinRhoZone(drho, stacks, </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">M_PI-bottomAngle);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       // Allow parameters so that pole regions may remain free.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       const float* cos_sin_rho_p;</td><td> </td><td class="right">       const float* cos_sin_rho_p;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       const float* cos_sin_theta = StelUtils::ComputeCosSinTheta(slices);</td><td> </td><td class="right">       const float* cos_sin_theta = StelUtils::ComputeCosSinTheta(slices);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       const float *cos_sin_theta_p;</td><td> </td><td class="right">       const float *cos_sin_theta_p;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // texturing: s goes from 0.0/0.25/0.5/0.75/1.0 at +y/+x/-y/-x/+y ax
is</td><td> </td><td class="right">       // texturing: s goes from 0.0/0.25/0.5/0.75/1.0 at +y/+x/-y/-x/+y ax
is</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // t goes from -1.0/+1.0 at z = -radius/+radius (linear along longit
udes)</td><td> </td><td class="right">       // t goes from -1.0/+1.0 at z = -radius/+radius (linear along longit
udes)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // cannot use triangle fan on texturing (s coord. at top/bottom tip 
varies)</td><td> </td><td class="right">       // cannot use triangle fan on texturing (s coord. at top/bottom tip 
varies)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // If the texture is flipped, we iterate the coordinates backward.</td><td> </td><td class="right">       // If the texture is flipped, we iterate the coordinates backward.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       const GLfloat ds = (flipTexture ? -1.f : 1.f) / slices;</td><td> </td><td class="right">       const GLfloat ds = (flipTexture ? -1.f : 1.f) / slices;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       const GLfloat dt = nsign / stacks; // from inside texture is reverse
d</td><td> </td><td class="right">       const GLfloat dt = nsign / stacks; // from inside texture is reverse
d</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0045" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       // draw intermediate <span class="delete"> </span>as quad strips</td><td> </td><td class="rblock">       // draw intermediate as quad strips</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       for (i = 0,cos_sin_rho_p = cos_sin_rho; i &lt; stacks; ++i,cos_sin_rho_
p+=2)</td><td> </td><td class="right">       for (i = 0,cos_sin_rho_p = cos_sin_rho; i &lt; stacks; ++i,cos_sin_rho_
p+=2)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               s = !flipTexture ? 0.f : 1.f;</td><td> </td><td class="right">               s = !flipTexture ? 0.f : 1.f;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               for (j = 0,cos_sin_theta_p = cos_sin_theta; j&lt;=slices;++j,co
s_sin_theta_p+=2)</td><td> </td><td class="right">               for (j = 0,cos_sin_theta_p = cos_sin_theta; j&lt;=slices;++j,co
s_sin_theta_p+=2)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       x = -cos_sin_theta_p[1] * cos_sin_rho_p[1];</td><td> </td><td class="right">                       x = -cos_sin_theta_p[1] * cos_sin_rho_p[1];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       y = cos_sin_theta_p[0] * cos_sin_rho_p[1];</td><td> </td><td class="right">                       y = cos_sin_theta_p[0] * cos_sin_rho_p[1];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       z = nsign * cos_sin_rho_p[0];</td><td> </td><td class="right">                       z = nsign * cos_sin_rho_p[0];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       result.texCoords &lt;&lt; Vec2f(s,t);</td><td> </td><td class="right">                       result.texCoords &lt;&lt; Vec2f(s,t);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       result.vertex &lt;&lt; Vec3d(x*radius, y*radius, z*oneMinu
sOblateness*radius);</td><td> </td><td class="right">                       result.vertex &lt;&lt; Vec3d(x*radius, y*radius, z*oneMinu
sOblateness*radius);</td><td class="lineno" valign="top"></td></tr>

     <tr><td></td><td class="left"></td><td> </td><td class="right"></td><td></td></tr>
     <tr bgcolor="gray"><th colspan="5" align="center"><a name="end">&nbsp;End of changes. 45 change blocks.&nbsp;</a></th></tr>
     <tr class="stats"><td></td><th><i>62 lines changed or deleted</i></th><th><i> </i></th><th><i>235 lines changed or added</i></th><td></td></tr>
     <tr><td colspan="5" align="center" class="small"><br/>This html diff was produced by rfcdiff 1.41. The latest version is available from <a href="http://www.tools.ietf.org/tools/rfcdiff/" >http://tools.ietf.org/tools/rfcdiff/</a> </td></tr>
   </table>
   </body>
   </html>
