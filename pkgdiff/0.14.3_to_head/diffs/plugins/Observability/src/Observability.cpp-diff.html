<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
<!-- Generated by rfcdiff 1.41: rfcdiff  --> 
<!-- <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional" > -->
<!-- System: Linux fomalhaut.local 3.13.0-81-generic #125-Ubuntu SMP Wed Mar 2 17:31:01 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux --> 
<!-- Using awk: /usr/bin/gawk: GNU Awk 4.0.1 --> 
<!-- Using diff: /usr/bin/diff: diff (GNU diffutils) 3.3 --> 
<!-- Using wdiff: /usr/bin/wdiff: wdiff (GNU wdiff) 1.2.1 --> 
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"> 
<head> 
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 
  <meta http-equiv="Content-Style-Type" content="text/css" /> 
  <title>Diff: Observability.cpp - Observability.cpp</title> 
  <style type="text/css"> 
    body    { font-size:16px; margin: 0.4ex; margin-right: auto; } 
    tr      { } 
    td      { white-space: pre; font-family: Consolas, "DejaVu Sans Mono", "Droid Sans Mono", Monaco, Monospace; vertical-align: top; font-size: 0.86em;} 
    th      { font-size: 0.86em; } 
    .small  { font-size: 0.6em; font-style: italic; font-family: Verdana, Helvetica, sans-serif; } 
    .left   { background-color: #EEE; } 
    .right  { background-color: #FFF; } 
    .diff   { background-color: #CCF; } 
    .lblock { background-color: #BFB; } 
    .rblock { background-color: #FF8; } 
    .insert { background-color: #8FF; } 
    .delete { background-color: #ACF; } 
    .void   { background-color: #FFB; } 
    .cont   { background-color: #EEE; } 
    .linebr { background-color: #AAA; } 
    .lineno { color: red; background-color: #FFF; font-size: 0.7em; text-align: right; padding: 0 2px; } 
    .elipsis{ background-color: #AAA; } 
    .left .cont { background-color: #DDD; } 
    .right .cont { background-color: #EEE; } 
    .lblock .cont { background-color: #9D9; } 
    .rblock .cont { background-color: #DD6; } 
    .insert .cont { background-color: #0DD; } 
    .delete .cont { background-color: #8AD; } 
    .stats, .stats td, .stats th { background-color: #EEE; padding: 2px 0; } 
  </style> 
</head> 
<body > 
  <table border="0" cellpadding="0" cellspacing="0"> 
  <tr bgcolor="orange"><th></th><th>&nbsp;Observability.cpp&nbsp;</th><th> </th><th>&nbsp;Observability.cpp&nbsp;</th><th></th></tr> 
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l1" /><small>skipping to change at</small><em> line 278</em></th><th> </th><th><a name="part-r1" /><small>skipping to change at</small><em> line 278</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       bool locChanged, yearChanged;</td><td> </td><td class="right">       bool locChanged, yearChanged;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       StelObjectP selectedObject;</td><td> </td><td class="right">       StelObjectP selectedObject;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       PlanetP ssObject, parentPlanet;</td><td> </td><td class="right">       PlanetP ssObject, parentPlanet;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Only execute plugin if we are on Earth.</td><td> </td><td class="right">// Only execute plugin if we are on Earth.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (core-&gt;getCurrentLocation().planetName != "Earth")</td><td> </td><td class="right">       if (core-&gt;getCurrentLocation().planetName != "Earth")</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               return;</td><td> </td><td class="right">               return;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Set the painter:</td><td> </td><td class="right">// Set the painter:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       StelPainter painter(core-&gt;getProjection2d());</td><td> </td><td class="right">       StelPainter painter(core-&gt;getProjection2d());</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0001" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       painter.setColor(fontColor[0],fontColor[1],fontColor[2],1);</td><td> </td><td class="rblock">       painter.setColor(fontColor[0],fontColor[1],fontColor[2],1<span class="insert">.f</span>);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       font.setPixelSize(fontSize);</td><td> </td><td class="right">       font.setPixelSize(fontSize);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       painter.setFont(font);</td><td> </td><td class="right">       painter.setFont(font);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Get current date, location, and check if there is something selected.</td><td> </td><td class="right">// Get current date, location, and check if there is something selected.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double currlat = (core-&gt;getCurrentLocation().latitude)/Rad2Deg;</td><td> </td><td class="right">       double currlat = (core-&gt;getCurrentLocation().latitude)/Rad2Deg;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double currlon = (core-&gt;getCurrentLocation().longitude)/Rad2Deg;</td><td> </td><td class="right">       double currlon = (core-&gt;getCurrentLocation().longitude)/Rad2Deg;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double currheight = (6371.+(core-&gt;getCurrentLocation().altitude)/100
0.)/UA;</td><td> </td><td class="right">       double currheight = (6371.+(core-&gt;getCurrentLocation().altitude)/100
0.)/UA;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double currJD = core-&gt;getJD();</td><td> </td><td class="right">       double currJD = core-&gt;getJD();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double currJDint;</td><td> </td><td class="right">       double currJDint;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//     GMTShift = StelUtils::getGMTShiftFromQT(currJD)/24.0;</td><td> </td><td class="right">//     GMTShift = StelUtils::getGMTShiftFromQT(currJD)/24.0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       GMTShift = StelApp::getInstance().getLocaleMgr().getGMTShift(currJD)
/24.0;</td><td> </td><td class="right">       GMTShift = StelApp::getInstance().getLocaleMgr().getGMTShift(currJD)
/24.0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0002" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">//     qDebug() &lt;&lt; QString("%1%2 ").arg(GMTShift);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                           </td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double currLocalT = 24.*modf(currJD + GMTShift,&amp;currJDint);</td><td> </td><td class="right">       double currLocalT = 24.*modf(currJD + GMTShift,&amp;currJDint);</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0003" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                                                                           </span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       int auxm, auxd, auxy;</td><td> </td><td class="right">       int auxm, auxd, auxy;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       StelUtils::getDateFromJulianDay(currJD, &amp;auxy, &amp;auxm, &amp;auxd);</td><td> </td><td class="right">       StelUtils::getDateFromJulianDay(currJD, &amp;auxy, &amp;auxm, &amp;auxd);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       bool isSource = StelApp::getInstance().getStelObjectMgr().getWasSele
cted();</td><td> </td><td class="right">       bool isSource = StelApp::getInstance().getStelObjectMgr().getWasSele
cted();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       bool show_Year = show_Best_Night || show_Good_Nights || show_AcroCos
;</td><td> </td><td class="right">       bool show_Year = show_Best_Night || show_Good_Nights || show_AcroCos
;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//////////////////////////////////////////////////////////////////</td><td> </td><td class="right">//////////////////////////////////////////////////////////////////</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//////////////////////////////////////////////////////////////////</td><td> </td><td class="right">//////////////////////////////////////////////////////////////////</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// NOW WE CHECK THE CHANGED PARAMETERS W.R.T. THE PREVIOUS FRAME:</td><td> </td><td class="right">// NOW WE CHECK THE CHANGED PARAMETERS W.R.T. THE PREVIOUS FRAME:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l2" /><small>skipping to change at</small><em> line 360</em></th><th> </th><th><a name="part-r2" /><small>skipping to change at</small><em> line 357</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               configChanged = true;</td><td> </td><td class="right">               configChanged = true;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               souChanged = true;</td><td> </td><td class="right">               souChanged = true;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       };</td><td> </td><td class="right">       };</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// If we have changed latitude (or year), we update the vector of Sun's hou
r</td><td> </td><td class="right">// If we have changed latitude (or year), we update the vector of Sun's hou
r</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// angles at twilight, and re-compute Sun/Moon ephemeris (if selected):</td><td> </td><td class="right">// angles at twilight, and re-compute Sun/Moon ephemeris (if selected):</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (locChanged || yearChanged || configChanged)</td><td> </td><td class="right">       if (locChanged || yearChanged || configChanged)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               updateSunH();</td><td> </td><td class="right">               updateSunH();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               lastJDMoon = 0.0;</td><td> </td><td class="right">               lastJDMoon = 0.0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0004" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                                                                           </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       };</td><td> </td><td class="right">       };</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//////////////////////////////////////////////////////////////////</td><td> </td><td class="right">//////////////////////////////////////////////////////////////////</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//////////////////////////////////////////////////////////////////</td><td> </td><td class="right">//////////////////////////////////////////////////////////////////</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// NOW WE DEAL WITH THE SOURCE (OR SCREEN-CENTER) POSITION:</td><td> </td><td class="right">// NOW WE DEAL WITH THE SOURCE (OR SCREEN-CENTER) POSITION:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (isScreen) // Always re-compute everything for the screen center.</td><td> </td><td class="right">       if (isScreen) // Always re-compute everything for the screen center.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               souChanged = true;</td><td> </td><td class="right">               souChanged = true;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l3" /><small>skipping to change at</small><em> line 459</em></th><th> </th><th><a name="part-r3" /><small>skipping to change at</small><em> line 457</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               LocPos = core-&gt;j2000ToAltAz(currentPos, StelCore::Refraction
Off);</td><td> </td><td class="right">               LocPos = core-&gt;j2000ToAltAz(currentPos, StelCore::Refraction
Off);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Convert EquPos to RA/Dec:</td><td> </td><td class="right">// Convert EquPos to RA/Dec:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       toRADec(EquPos, selRA, selDec);</td><td> </td><td class="right">       toRADec(EquPos, selRA, selDec);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Compute source's altitude (in radians):</td><td> </td><td class="right">// Compute source's altitude (in radians):</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       alti = std::asin(LocPos[2]);</td><td> </td><td class="right">       alti = std::asin(LocPos[2]);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Force re-computation of ephemeris if the location changes or the user ch
anges the configuration:</td><td> </td><td class="right">// Force re-computation of ephemeris if the location changes or the user ch
anges the configuration:</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0005" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       if (locChanged || configChanged)</td><td> </td><td class="rblock">       if (locChanged || configChanged<span class="insert"> || yearChanged</span>)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               souChanged=true;</td><td> </td><td class="right">               souChanged=true;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               configChanged=false;</td><td> </td><td class="right">               configChanged=false;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       };</td><td> </td><td class="right">       };</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">/////////////////////////////////////////////////////////////////</td><td> </td><td class="right">/////////////////////////////////////////////////////////////////</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">/////////////////////////////////////////////////////////////////</td><td> </td><td class="right">/////////////////////////////////////////////////////////////////</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// NOW WE COMPUTE RISE/SET/TRANSIT TIMES FOR THE CURRENT DAY:</td><td> </td><td class="right">// NOW WE COMPUTE RISE/SET/TRANSIT TIMES FOR THE CURRENT DAY:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double currH = calculateHourAngle(mylat,alti,selDec);</td><td> </td><td class="right">       double currH = calculateHourAngle(mylat,alti,selDec);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l4" /><small>skipping to change at</small><em> line 1372</em></th><th> </th><th><a name="part-r4" /><small>skipping to change at</small><em> line 1370</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       //Vec3d Observer;</td><td> </td><td class="right">       //Vec3d Observer;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       hHoriz = calculateHourAngle(mylat, refractedHorizonAlt, selDec);</td><td> </td><td class="right">       hHoriz = calculateHourAngle(mylat, refractedHorizonAlt, selDec);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       bool raises = hHoriz &gt; 0.0;</td><td> </td><td class="right">       bool raises = hHoriz &gt; 0.0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Only recompute ephemeris from second to second (at least)</td><td> </td><td class="right">// Only recompute ephemeris from second to second (at least)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// or if the source has changed (i.e., Sun &lt;-&gt; Moon). This saves resources:</td><td> </td><td class="right">// or if the source has changed (i.e., Sun &lt;-&gt; Moon). This saves resources:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (qAbs(myJD.first-lastJDMoon)&gt;StelCore::JD_SECOND || lastType!=bod
yType || souChanged)</td><td> </td><td class="right">       if (qAbs(myJD.first-lastJDMoon)&gt;StelCore::JD_SECOND || lastType!=bod
yType || souChanged)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0006" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">//             qDebug() &lt;&lt; q_("%1  %2   %3   %4").arg(Kind).arg(LastObject)</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">.arg(myJD,0,'f',5).arg(lastJDMoon,0,'f',5);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                           </td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               lastType = bodyType;</td><td> </td><td class="right">               lastType = bodyType;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               myEarth-&gt;computePosition(myJD.second);</td><td> </td><td class="right">               myEarth-&gt;computePosition(myJD.second);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               myEarth-&gt;computeTransMatrix(myJD.first, myJD.second);</td><td> </td><td class="right">               myEarth-&gt;computeTransMatrix(myJD.first, myJD.second);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               Vec3d earthPos = myEarth-&gt;getHeliocentricEclipticPos();</td><td> </td><td class="right">               Vec3d earthPos = myEarth-&gt;getHeliocentricEclipticPos();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               if (bodyType == 1) // Sun position</td><td> </td><td class="right">               if (bodyType == 1) // Sun position</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       Pos2 = core-&gt;j2000ToEquinoxEqu((core-&gt;matVsop87ToJ20
00)*(-earthPos));</td><td> </td><td class="right">                       Pos2 = core-&gt;j2000ToEquinoxEqu((core-&gt;matVsop87ToJ20
00)*(-earthPos));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l5" /><small>skipping to change at</small><em> line 1541</em></th><th> </th><th><a name="part-r5" /><small>skipping to change at</small><em> line 1537</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // Compute eph. times for mod. coordinates:</td><td> </td><td class="right">       // Compute eph. times for mod. coordinates:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       tempH = -Hcurr*TFrac;</td><td> </td><td class="right">                       tempH = -Hcurr*TFrac;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // Check convergence:</td><td> </td><td class="right">       // Check convergence:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       if (qAbs(tempH-tempEphH)&lt;StelCore::JD_SECOND) break;</td><td> </td><td class="right">                       if (qAbs(tempH-tempEphH)&lt;StelCore::JD_SECOND) break;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       tempEphH = tempH;</td><td> </td><td class="right">                       tempEphH = tempH;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       MoonCulm = myJD.first + (tempEphH/24.);</td><td> </td><td class="right">                       MoonCulm = myJD.first + (tempEphH/24.);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       culmAlt = qAbs(mylat-dec); // 90 - altitude at trans
it.</td><td> </td><td class="right">                       culmAlt = qAbs(mylat-dec); // 90 - altitude at trans
it.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               };</td><td> </td><td class="right">               };</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0007" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">//             qDebug() &lt;&lt; q_("%1").arg(MoonCulm,0,'f',5);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                           </td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       lastJDMoon = myJD.first;</td><td> </td><td class="right">       lastJDMoon = myJD.first;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }; // Comes from if (qAbs(myJD.first-lastJDMoon)&gt;JDsec || LastObject
!=Kind)</td><td> </td><td class="right">       }; // Comes from if (qAbs(myJD.first-lastJDMoon)&gt;JDsec || LastObject
!=Kind)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Find out the days of Full Moon:</td><td> </td><td class="right">// Find out the days of Full Moon:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (bodyType==2 &amp;&amp; show_FullMoon) // || show_SuperMoon))</td><td> </td><td class="right">       if (bodyType==2 &amp;&amp; show_FullMoon) // || show_SuperMoon))</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // Only estimate date of Full Moon if we have changed Lunar month:</td><td> </td><td class="right">       // Only estimate date of Full Moon if we have changed Lunar month:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               if (myJD.first &gt; nextFullMoon || myJD.first &lt; prevFullMoon)</td><td> </td><td class="right">               if (myJD.first &gt; nextFullMoon || myJD.first &lt; prevFullMoon)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l6" /><small>skipping to change at</small><em> line 1605</em></th><th> </th><th><a name="part-r6" /><small>skipping to change at</small><em> line 1599</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       if (Temp1*eclLon &lt; 0.0)</td><td> </td><td class="right">                                       if (Temp1*eclLon &lt; 0.0)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       {</td><td> </td><td class="right">                                       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                               Sec2.first = Phase1;</td><td> </td><td class="right">                                               Sec2.first = Phase1;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                               Temp2 = eclLon;</td><td> </td><td class="right">                                               Temp2 = eclLon;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       } else {</td><td> </td><td class="right">                                       } else {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                               Sec1.first = Phase1;</td><td> </td><td class="right">                                               Sec1.first = Phase1;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                               Temp1 = eclLon;</td><td> </td><td class="right">                                               Temp1 = eclLon;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       };</td><td> </td><td class="right">                                       };</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0008" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                               <span class="delete">//      qDebug() &lt;&lt; QString("%1 %2 %3 %4 ").</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">arg(Sec1).arg(Sec2).arg(Temp1).arg(Temp2);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                           </td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       if (qAbs(Sec2.first-Sec1.first) &lt; 10
.*dT)  // 1 minute accuracy; convergence.</td><td> </td><td class="right">                                       if (qAbs(Sec2.first-Sec1.first) &lt; 10
.*dT)  // 1 minute accuracy; convergence.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       {</td><td> </td><td class="right">                                       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                               TempFullMoon = (Sec1.first+S
ec2.first)/2.;</td><td> </td><td class="right">                                               TempFullMoon = (Sec1.first+S
ec2.first)/2.;</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0009" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                               //              qDebug() &lt;&lt; QString("%1%2 ")
.arg(TempFullMoon);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                               break;</td><td> </td><td class="right">                                               break;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       };</td><td> </td><td class="right">                                       };</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               };</td><td> </td><td class="right">                               };</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               if (TempFullMoon &gt; myJD.first)</td><td> </td><td class="right">                               if (TempFullMoon &gt; myJD.first)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               {</td><td> </td><td class="right">                               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       nextFullMoon = TempFullMoon;</td><td> </td><td class="right">                                       nextFullMoon = TempFullMoon;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       TempFullMoon -= MoonT;</td><td> </td><td class="right">                                       TempFullMoon -= MoonT;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               } else</td><td> </td><td class="right">                               } else</td><td class="lineno" valign="top"></td></tr>

     <tr><td></td><td class="left"></td><td> </td><td class="right"></td><td></td></tr>
     <tr bgcolor="gray"><th colspan="5" align="center"><a name="end">&nbsp;End of changes. 9 change blocks.&nbsp;</a></th></tr>
     <tr class="stats"><td></td><th><i>14 lines changed or deleted</i></th><th><i> </i></th><th><i>3 lines changed or added</i></th><td></td></tr>
     <tr><td colspan="5" align="center" class="small"><br/>This html diff was produced by rfcdiff 1.41. The latest version is available from <a href="http://www.tools.ietf.org/tools/rfcdiff/" >http://tools.ietf.org/tools/rfcdiff/</a> </td></tr>
   </table>
   </body>
   </html>
