<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
<!-- Generated by rfcdiff 1.41: rfcdiff  --> 
<!-- <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional" > -->
<!-- System: Linux fomalhaut.local 3.13.0-49-generic #81-Ubuntu SMP Tue Mar 24 19:29:48 UTC 2015 x86_64 x86_64 x86_64 GNU/Linux --> 
<!-- Using awk: /usr/bin/gawk: GNU Awk 4.0.1 --> 
<!-- Using diff: /usr/bin/diff: diff (GNU diffutils) 3.3 --> 
<!-- Using wdiff: /usr/bin/wdiff: wdiff (GNU wdiff) 1.2.1 --> 
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"> 
<head> 
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 
  <meta http-equiv="Content-Style-Type" content="text/css" /> 
  <title>Diff: Meteor.cpp - Meteor.cpp</title> 
  <style type="text/css"> 
    body    { font-size:16px; margin: 0.4ex; margin-right: auto; } 
    tr      { } 
    td      { white-space: pre; font-family: Consolas, "DejaVu Sans Mono", "Droid Sans Mono", Monaco, Monospace; vertical-align: top; font-size: 0.86em;} 
    th      { font-size: 0.86em; } 
    .small  { font-size: 0.6em; font-style: italic; font-family: Verdana, Helvetica, sans-serif; } 
    .left   { background-color: #EEE; } 
    .right  { background-color: #FFF; } 
    .diff   { background-color: #CCF; } 
    .lblock { background-color: #BFB; } 
    .rblock { background-color: #FF8; } 
    .insert { background-color: #8FF; } 
    .delete { background-color: #ACF; } 
    .void   { background-color: #FFB; } 
    .cont   { background-color: #EEE; } 
    .linebr { background-color: #AAA; } 
    .lineno { color: red; background-color: #FFF; font-size: 0.7em; text-align: right; padding: 0 2px; } 
    .elipsis{ background-color: #AAA; } 
    .left .cont { background-color: #DDD; } 
    .right .cont { background-color: #EEE; } 
    .lblock .cont { background-color: #9D9; } 
    .rblock .cont { background-color: #DD6; } 
    .insert .cont { background-color: #0DD; } 
    .delete .cont { background-color: #8AD; } 
    .stats, .stats td, .stats th { background-color: #EEE; padding: 2px 0; } 
  </style> 
</head> 
<body > 
  <table border="0" cellpadding="0" cellspacing="0"> 
  <tr bgcolor="orange"><th></th><th>&nbsp;Meteor.cpp&nbsp;</th><th> </th><th>&nbsp;Meteor.cpp&nbsp;</th><th></th></tr> 
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l1" /><small>skipping to change at</small><em> line 33</em></th><th> </th><th><a name="part-r1" /><small>skipping to change at</small><em> line 33</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#include "StelMovementMgr.hpp"</td><td> </td><td class="right">#include "StelMovementMgr.hpp"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#include "StelPainter.hpp"</td><td> </td><td class="right">#include "StelPainter.hpp"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#include "StelTexture.hpp"</td><td> </td><td class="right">#include "StelTexture.hpp"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">StelTextureSP Meteor::bolideTexture;</td><td> </td><td class="right">StelTextureSP Meteor::bolideTexture;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">Meteor::Meteor(const StelCore* core, float v)</td><td> </td><td class="right">Meteor::Meteor(const StelCore* core, float v)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       : m_distMultiplier(0.)</td><td> </td><td class="right">       : m_distMultiplier(0.)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       , m_segments(10)</td><td> </td><td class="right">       , m_segments(10)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0001" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       qsrand (QDateTime::currentMSecsSinceEpoch());</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // determine meteor velocity</td><td> </td><td class="right">       // determine meteor velocity</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // abs range 11-72 km/s by default (see line 427 in StelApp.cpp)</td><td> </td><td class="right">       // abs range 11-72 km/s by default (see line 427 in StelApp.cpp)</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0002" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       m_speed = 11+(float)rand()/((float)RAND_MAX+1)*(v-11);</td><td> </td><td class="rblock">       m_speed = 11+(float)<span class="insert">q</span>rand()/((float)RAND_MAX+1)*(v-11);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // view matrix of sporadic meteors model</td><td> </td><td class="right">       // view matrix of sporadic meteors model</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0003" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       float alpha = <span class="delete">(double)rand()/((double)RAND_MAX+1)*2*M_PI;</span></td><td> </td><td class="rblock">       float alpha = <span class="insert">(double)qrand()/((double)RAND_MAX+1)*2*M_PI;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       float delta = M_PI_2 - <span class="delete">(double)rand()/((double)RAND_MAX+1)*M_PI;</span></td><td> </td><td class="rblock">       float delta = M_PI_2 - <span class="insert">(double)qrand()/((double)RAND_MAX+1)*M_PI;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       m_viewMatrix = Mat4d::zrotation(alpha) * Mat4d::yrotation(delta);</td><td> </td><td class="right">       m_viewMatrix = Mat4d::zrotation(alpha) * Mat4d::yrotation(delta);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // building meteor model</td><td> </td><td class="right">       // building meteor model</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       m_alive = initMeteorModel(core, m_segments, m_viewMatrix, meteor);</td><td> </td><td class="right">       m_alive = initMeteorModel(core, m_segments, m_viewMatrix, meteor);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (!m_alive)</td><td> </td><td class="right">       if (!m_alive)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               return;</td><td> </td><td class="right">               return;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // building lineColorArray and trainColorArray</td><td> </td><td class="right">       // building lineColorArray and trainColorArray</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l2" /><small>skipping to change at</small><em> line 68</em></th><th> </th><th><a name="part-r2" /><small>skipping to change at</small><em> line 69</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">bool Meteor::initMeteorModel(const StelCore* core, const int segments, cons
t Mat4d viewMatrix, MeteorModel &amp;mm)</td><td> </td><td class="right">bool Meteor::initMeteorModel(const StelCore* core, const int segments, cons
t Mat4d viewMatrix, MeteorModel &amp;mm)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       float high_range = EARTH_RADIUS + HIGH_ALTITUDE;</td><td> </td><td class="right">       float high_range = EARTH_RADIUS + HIGH_ALTITUDE;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       float low_range = EARTH_RADIUS + LOW_ALTITUDE;</td><td> </td><td class="right">       float low_range = EARTH_RADIUS + LOW_ALTITUDE;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // find observer position in meteor coordinate system</td><td> </td><td class="right">       // find observer position in meteor coordinate system</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       mm.obs = core-&gt;altAzToJ2000(Vec3d(0,0,EARTH_RADIUS));</td><td> </td><td class="right">       mm.obs = core-&gt;altAzToJ2000(Vec3d(0,0,EARTH_RADIUS));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       mm.obs.transfo4d(viewMatrix.transpose());</td><td> </td><td class="right">       mm.obs.transfo4d(viewMatrix.transpose());</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // select random trajectory using polar coordinates in XY plane, cen
tered on observer</td><td> </td><td class="right">       // select random trajectory using polar coordinates in XY plane, cen
tered on observer</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0004" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       mm.xydistance = <span class="delete">(double)rand()</span> / <span class="delete">((double)RAND_MAX+1)*(VISIBLE_RADIU</span></td><td> </td><td class="rblock">       mm.xydistance = <span class="insert">(double)qrand()</span> / <span class="insert">((double)RAND_MAX+1)*(VISIBLE_RADI</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">S);</span></td><td> </td><td class="rblock"><span class="insert">US);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       float angle = <span class="delete">(double)rand()</span> / ((double)RAND_MAX+1)*2*M_PI;</td><td> </td><td class="rblock">       float angle = <span class="insert">(double)qrand()</span> / ((double)RAND_MAX+1)*2*M_PI;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // set meteor start x,y</td><td> </td><td class="right">       // set meteor start x,y</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       mm.position[0] = mm.posTrain[0] = mm.xydistance*cos(angle) + mm.obs[
0];</td><td> </td><td class="right">       mm.position[0] = mm.posTrain[0] = mm.xydistance*cos(angle) + mm.obs[
0];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       mm.position[1] = mm.posTrain[1] = mm.xydistance*sin(angle) + mm.obs[
1];</td><td> </td><td class="right">       mm.position[1] = mm.posTrain[1] = mm.xydistance*sin(angle) + mm.obs[
1];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // D is distance from center of earth</td><td> </td><td class="right">       // D is distance from center of earth</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0005" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       float D = s<span class="delete">qrt(mm.position[0]*mm.position[0] + mm.position[1]*mm.pos
</span>ition[1]);</td><td> </td><td class="rblock">       float D = s<span class="insert">td::sqrt(mm.position[0]*mm.position[0] + mm.position[1]*m
m.pos</span>ition[1]);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (D &gt; high_range)     // won't be visible, meteor still dead</td><td> </td><td class="right">       if (D &gt; high_range)     // won't be visible, meteor still dead</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               return false;</td><td> </td><td class="right">               return false;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0006" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       mm.posTrain[2] = mm.position[2] = mm.startH = s<span class="delete">qrt(high_range*high_r
</span>ange - D*D);</td><td> </td><td class="rblock">       mm.posTrain[2] = mm.position[2] = mm.startH = s<span class="insert">td::sqrt(high_range*h
igh_r</span>ange - D*D);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // determine end of burn point, and nearest point to observer for di
stance mag calculation</td><td> </td><td class="right">       // determine end of burn point, and nearest point to observer for di
stance mag calculation</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // mag should be max at nearest point still burning</td><td> </td><td class="right">       // mag should be max at nearest point still burning</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (D &gt; low_range)</td><td> </td><td class="right">       if (D &gt; low_range)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               mm.endH = -mm.startH;  // earth grazing</td><td> </td><td class="right">               mm.endH = -mm.startH;  // earth grazing</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               mm.minDist = mm.xydistance;</td><td> </td><td class="right">               mm.minDist = mm.xydistance;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       else</td><td> </td><td class="right">       else</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0007" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               mm.endH = <span class="delete">sqrt(low_range*low_range</span> - D*D);</td><td> </td><td class="rblock">               mm.endH = <span class="insert">std::sqrt(low_range*low_range</span> - D*D);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               mm.minDist = <span class="delete">sqrt(mm.xydistance*mm.xydistance</span> + <span class="delete">pow(mm.endH</span> </td><td> </td><td class="rblock">               mm.minDist = <span class="insert">std::sqrt(mm.xydistance*mm.xydistance</span> + <span class="insert">pow(mm.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">- mm.obs[2], 2));</td><td> </td><td class="rblock"><span class="insert">endH</span> - mm.obs[2], 2));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (mm.minDist &gt; VISIBLE_RADIUS)</td><td> </td><td class="right">       if (mm.minDist &gt; VISIBLE_RADIUS)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               // on average, not visible (although if were zoomed ...)</td><td> </td><td class="right">               // on average, not visible (although if were zoomed ...)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               return false; //meteor still dead</td><td> </td><td class="right">               return false; //meteor still dead</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // determine intensity [-3; 4.5]</td><td> </td><td class="right">       // determine intensity [-3; 4.5]</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0008" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       float Mag1 = <span class="delete">(double)rand()/((double)RAND_MAX+1)*7.5f</span> - 3;</td><td> </td><td class="rblock">       float Mag1 = <span class="insert">(double)qrand()/((double)RAND_MAX+1)*7.5f</span> - 3;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       float Mag2 = <span class="delete">(double)rand()/((double)RAND_MAX+1)*7.5f</span> - 3;</td><td> </td><td class="rblock">       float Mag2 = <span class="insert">(double)qrand()/((double)RAND_MAX+1)*7.5f</span> - 3;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       float Mag = (Mag1 + Mag2)/2.0f;</td><td> </td><td class="right">       float Mag = (Mag1 + Mag2)/2.0f;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // compute RMag and CMag</td><td> </td><td class="right">       // compute RMag and CMag</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       RCMag rcMag;</td><td> </td><td class="right">       RCMag rcMag;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       core-&gt;getSkyDrawer()-&gt;computeRCMag(Mag, &amp;rcMag);</td><td> </td><td class="right">       core-&gt;getSkyDrawer()-&gt;computeRCMag(Mag, &amp;rcMag);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       mm.mag = rcMag.luminance;</td><td> </td><td class="right">       mm.mag = rcMag.luminance;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // most visible meteors are under about 180km distant</td><td> </td><td class="right">       // most visible meteors are under about 180km distant</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // scale max mag down if outside this range</td><td> </td><td class="right">       // scale max mag down if outside this range</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       float scale = 1;</td><td> </td><td class="right">       float scale = 1;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (mm.minDist)</td><td> </td><td class="right">       if (mm.minDist)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               scale = 180*180 / (mm.minDist*mm.minDist);</td><td> </td><td class="right">               scale = 180*180 / (mm.minDist*mm.minDist);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (scale &lt; 1)</td><td> </td><td class="right">       if (scale &lt; 1)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               mm.mag *= scale;</td><td> </td><td class="right">               mm.mag *= scale;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0009" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       mm.firstBrightSegment = (double)<span class="delete">rand()/((double)RAND_MAX+1)*segments
</span>;</td><td> </td><td class="rblock">       mm.firstBrightSegment = (double)<span class="insert">qrand()/((double)RAND_MAX+1)*segment
s</span>;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // If everything is ok until here,</td><td> </td><td class="right">       // If everything is ok until here,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return true;  //the meteor is alive</td><td> </td><td class="right">       return true;  //the meteor is alive</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">Vec4f Meteor::getColorFromName(QString colorName) {</td><td> </td><td class="right">Vec4f Meteor::getColorFromName(QString colorName) {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       int R, G, B; // 0-255</td><td> </td><td class="right">       int R, G, B; // 0-255</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (colorName == "violet") { // Calcium</td><td> </td><td class="right">       if (colorName == "violet") { // Calcium</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               R = 176;</td><td> </td><td class="right">               R = 176;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               G = 67;</td><td> </td><td class="right">               G = 67;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l3" /><small>skipping to change at</small><em> line 165</em></th><th> </th><th><a name="part-r3" /><small>skipping to change at</small><em> line 166</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               R = 255;</td><td> </td><td class="right">               R = 255;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               G = 255;</td><td> </td><td class="right">               G = 255;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               B = 255;</td><td> </td><td class="right">               B = 255;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return Vec4f(R/255.f, G/255.f, B/255.f, 1);</td><td> </td><td class="right">       return Vec4f(R/255.f, G/255.f, B/255.f, 1);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">QList&lt;Meteor::colorPair&gt; Meteor::getRandColor() {</td><td> </td><td class="right">QList&lt;Meteor::colorPair&gt; Meteor::getRandColor() {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       QList&lt;colorPair&gt; colors;</td><td> </td><td class="right">       QList&lt;colorPair&gt; colors;</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0010" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       float prob = (double)rand()/((double)RAND_MAX+1);</td><td> </td><td class="rblock">       float prob = (double)<span class="insert">q</span>rand()/((double)RAND_MAX+1);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (prob &gt; 0.9) {</td><td> </td><td class="right">       if (prob &gt; 0.9) {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               colors.push_back(Meteor::colorPair("white", 70));</td><td> </td><td class="right">               colors.push_back(Meteor::colorPair("white", 70));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               colors.push_back(Meteor::colorPair("orangeYellow", 10));</td><td> </td><td class="right">               colors.push_back(Meteor::colorPair("orangeYellow", 10));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               colors.push_back(Meteor::colorPair("yellow", 10));</td><td> </td><td class="right">               colors.push_back(Meteor::colorPair("yellow", 10));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               colors.push_back(Meteor::colorPair("blueGreen", 10));</td><td> </td><td class="right">               colors.push_back(Meteor::colorPair("blueGreen", 10));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       } else if (prob &gt; 0.85)  {</td><td> </td><td class="right">       } else if (prob &gt; 0.85)  {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               colors.push_back(Meteor::colorPair("white", 80));</td><td> </td><td class="right">               colors.push_back(Meteor::colorPair("white", 80));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               colors.push_back(Meteor::colorPair("violet", 20));</td><td> </td><td class="right">               colors.push_back(Meteor::colorPair("violet", 20));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       } else if (prob &gt; 0.80)  {</td><td> </td><td class="right">       } else if (prob &gt; 0.80)  {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               colors.push_back(Meteor::colorPair("white", 80));</td><td> </td><td class="right">               colors.push_back(Meteor::colorPair("white", 80));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l4" /><small>skipping to change at</small><em> line 191</em></th><th> </th><th><a name="part-r4" /><small>skipping to change at</small><em> line 192</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return colors;</td><td> </td><td class="right">       return colors;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void Meteor::buildColorArrays(const int segments,</td><td> </td><td class="right">void Meteor::buildColorArrays(const int segments,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                             const QList&lt;colorPair&gt; colors,</td><td> </td><td class="right">                             const QList&lt;colorPair&gt; colors,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                             QList&lt;Vec4f&gt; &amp;lineColorArray,</td><td> </td><td class="right">                             QList&lt;Vec4f&gt; &amp;lineColorArray,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                             QList&lt;Vec4f&gt; &amp;trainColorArray)</td><td> </td><td class="right">                             QList&lt;Vec4f&gt; &amp;trainColorArray)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // building color arrays (line and prism)</td><td> </td><td class="right">       // building color arrays (line and prism)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       int totalOfSegments = 0;</td><td> </td><td class="right">       int totalOfSegments = 0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0011" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       int currentSegment = 1+(double)<span class="delete">rand()/((double)RAND_MAX+1)*(segments
</span>-1);</td><td> </td><td class="rblock">       int currentSegment = 1+(double)<span class="insert">qrand()/((double)RAND_MAX+1)*(segment
s</span>-1);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       for (int colorIndex=0; colorIndex&lt;colors.size(); colorIndex++) {</td><td> </td><td class="right">       for (int colorIndex=0; colorIndex&lt;colors.size(); colorIndex++) {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               colorPair currentColor = colors[colorIndex];</td><td> </td><td class="right">               colorPair currentColor = colors[colorIndex];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               // segments which we'll paint with the current color</td><td> </td><td class="right">               // segments which we'll paint with the current color</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               int numOfSegments = segments*(currentColor.second / 100.f) +
 0.4f; // +0.4 affect approximation</td><td> </td><td class="right">               int numOfSegments = segments*(currentColor.second / 100.f) +
 0.4f; // +0.4 affect approximation</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               if (colorIndex == colors.size()-1) {</td><td> </td><td class="right">               if (colorIndex == colors.size()-1) {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       numOfSegments = segments - totalOfSegments;</td><td> </td><td class="right">                       numOfSegments = segments - totalOfSegments;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               totalOfSegments += numOfSegments;</td><td> </td><td class="right">               totalOfSegments += numOfSegments;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l5" /><small>skipping to change at</small><em> line 229</em></th><th> </th><th><a name="part-r5" /><small>skipping to change at</small><em> line 230</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               // burning has stopped so magnitude fades out</td><td> </td><td class="right">               // burning has stopped so magnitude fades out</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               // assume linear fade out</td><td> </td><td class="right">               // assume linear fade out</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               mm.mag -= deltaTime/500.0f;</td><td> </td><td class="right">               mm.mag -= deltaTime/500.0f;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               if(mm.mag &lt; 0)</td><td> </td><td class="right">               if(mm.mag &lt; 0)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       return false;    // no longer visible</td><td> </td><td class="right">                       return false;    // no longer visible</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // *** would need time direction multiplier to allow reverse time re
play</td><td> </td><td class="right">       // *** would need time direction multiplier to allow reverse time re
play</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0012" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       float dt = 820+(double)<span class="delete">rand()/((double)RAND_MAX+1)*185; // range 820
</span>-1005</td><td> </td><td class="rblock">       float dt = 820+(double)<span class="insert">qrand()/((double)RAND_MAX+1)*185; // range 82
0</span>-1005</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       mm.position[2] -= speed*deltaTime/dt;</td><td> </td><td class="right">       mm.position[2] -= speed*deltaTime/dt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // train doesn't extend beyond start of burn</td><td> </td><td class="right">       // train doesn't extend beyond start of burn</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (mm.position[2] + speed*0.5f &gt; mm.startH)</td><td> </td><td class="right">       if (mm.position[2] + speed*0.5f &gt; mm.startH)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               mm.posTrain[2] = mm.startH;</td><td> </td><td class="right">               mm.posTrain[2] = mm.startH;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       else</td><td> </td><td class="right">       else</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               mm.posTrain[2] -= speed*deltaTime/dt;</td><td> </td><td class="right">               mm.posTrain[2] -= speed*deltaTime/dt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l6" /><small>skipping to change at</small><em> line 256</em></th><th> </th><th><a name="part-r6" /><small>skipping to change at</small><em> line 257</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">bool Meteor::update(double deltaTime)</td><td> </td><td class="right">bool Meteor::update(double deltaTime)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (!m_alive)</td><td> </td><td class="right">       if (!m_alive)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               return false;</td><td> </td><td class="right">               return false;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       m_alive = updateMeteorModel(deltaTime, m_speed, meteor);</td><td> </td><td class="right">       m_alive = updateMeteorModel(deltaTime, m_speed, meteor);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // determine visual magnitude based on distance to observer</td><td> </td><td class="right">       // determine visual magnitude based on distance to observer</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0013" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       double dist = s<span class="delete">qrt(meteor.xydistance*meteor.xydistance + pow(meteor.
</span>position[2]-meteor.obs[2], 2));</td><td> </td><td class="rblock">       double dist = s<span class="insert">td::sqrt(meteor.xydistance*meteor.xydistance + pow(me
teor.</span>position[2]-meteor.obs[2], 2));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (dist == 0)</td><td> </td><td class="right">       if (dist == 0)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               dist = .01;    // just to be cautious (meteor hits observer!
)</td><td> </td><td class="right">               dist = .01;    // just to be cautious (meteor hits observer!
)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       m_distMultiplier = meteor.minDist*meteor.minDist / (dist*dist);</td><td> </td><td class="right">       m_distMultiplier = meteor.minDist*meteor.minDist / (dist*dist);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return m_alive;</td><td> </td><td class="right">       return m_alive;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void Meteor::insertVertex(const StelCore* core, const Mat4d&amp; viewMatrix, QV
ector&lt;Vec3d&gt; &amp;vertexArray, Vec3d vertex)</td><td> </td><td class="right">void Meteor::insertVertex(const StelCore* core, const Mat4d&amp; viewMatrix, QV
ector&lt;Vec3d&gt; &amp;vertexArray, Vec3d vertex)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l7" /><small>skipping to change at</small><em> line 364</em></th><th> </th><th><a name="part-r7" /><small>skipping to change at</small><em> line 365</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       posTrainB[0] += thickness*0.7;</td><td> </td><td class="right">       posTrainB[0] += thickness*0.7;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       posTrainB[1] += thickness*0.7;</td><td> </td><td class="right">       posTrainB[1] += thickness*0.7;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       Vec3d posTrainL = mm.posTrain;</td><td> </td><td class="right">       Vec3d posTrainL = mm.posTrain;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       posTrainL[1] -= thickness;</td><td> </td><td class="right">       posTrainL[1] -= thickness;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       Vec3d posTrainR = mm.posTrain;</td><td> </td><td class="right">       Vec3d posTrainR = mm.posTrain;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       posTrainR[0] -= thickness;</td><td> </td><td class="right">       posTrainR[0] -= thickness;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       for (int i=0; i&lt;segments; i++) {</td><td> </td><td class="right">       for (int i=0; i&lt;segments; i++) {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               float mag = mm.mag * i/(3* (segments-1));</td><td> </td><td class="right">               float mag = mm.mag * i/(3* (segments-1));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               if (i &gt; mm.firstBrightSegment) {</td><td> </td><td class="right">               if (i &gt; mm.firstBrightSegment) {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0014" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       mag *= 12<span class="delete">/5</span>;</td><td> </td><td class="rblock">                       mag *= 12<span class="insert">./5.</span>;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               double height = mm.posTrain[2] + i*(mm.position[2] - mm.posT
rain[2])/(segments-1);</td><td> </td><td class="right">               double height = mm.posTrain[2] + i*(mm.position[2] - mm.posT
rain[2])/(segments-1);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               Vec3d posi;</td><td> </td><td class="right">               Vec3d posi;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               posi = mm.posTrain;</td><td> </td><td class="right">               posi = mm.posTrain;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               posi[2] = height;</td><td> </td><td class="right">               posi[2] = height;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               insertVertex(core, viewMatrix, vertexArrayLine, posi);</td><td> </td><td class="right">               insertVertex(core, viewMatrix, vertexArrayLine, posi);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               posi = posTrainB;</td><td> </td><td class="right">               posi = posTrainB;</td><td class="lineno" valign="top"></td></tr>

     <tr><td></td><td class="left"></td><td> </td><td class="right"></td><td></td></tr>
     <tr bgcolor="gray"><th colspan="5" align="center"><a name="end">&nbsp;End of changes. 14 change blocks.&nbsp;</a></th></tr>
     <tr class="stats"><td></td><th><i>19 lines changed or deleted</i></th><th><i> </i></th><th><i>20 lines changed or added</i></th><td></td></tr>
     <tr><td colspan="5" align="center" class="small"><br/>This html diff was produced by rfcdiff 1.41. The latest version is available from <a href="http://www.tools.ietf.org/tools/rfcdiff/" >http://tools.ietf.org/tools/rfcdiff/</a> </td></tr>
   </table>
   </body>
   </html>
