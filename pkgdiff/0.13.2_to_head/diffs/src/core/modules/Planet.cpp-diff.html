<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
<!-- Generated by rfcdiff 1.41: rfcdiff  --> 
<!-- <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional" > -->
<!-- System: Linux fomalhaut.local 3.13.0-46-generic #76-Ubuntu SMP Thu Feb 26 18:52:13 UTC 2015 x86_64 x86_64 x86_64 GNU/Linux --> 
<!-- Using awk: /usr/bin/gawk: GNU Awk 4.0.1 --> 
<!-- Using diff: /usr/bin/diff: diff (GNU diffutils) 3.3 --> 
<!-- Using wdiff: /usr/bin/wdiff: wdiff (GNU wdiff) 1.2.1 --> 
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"> 
<head> 
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 
  <meta http-equiv="Content-Style-Type" content="text/css" /> 
  <title>Diff: Planet.cpp - Planet.cpp</title> 
  <style type="text/css"> 
    body    { font-size:16px; margin: 0.4ex; margin-right: auto; } 
    tr      { } 
    td      { white-space: pre; font-family: Consolas, "DejaVu Sans Mono", "Droid Sans Mono", Monaco, Monospace; vertical-align: top; font-size: 0.86em;} 
    th      { font-size: 0.86em; } 
    .small  { font-size: 0.6em; font-style: italic; font-family: Verdana, Helvetica, sans-serif; } 
    .left   { background-color: #EEE; } 
    .right  { background-color: #FFF; } 
    .diff   { background-color: #CCF; } 
    .lblock { background-color: #BFB; } 
    .rblock { background-color: #FF8; } 
    .insert { background-color: #8FF; } 
    .delete { background-color: #ACF; } 
    .void   { background-color: #FFB; } 
    .cont   { background-color: #EEE; } 
    .linebr { background-color: #AAA; } 
    .lineno { color: red; background-color: #FFF; font-size: 0.7em; text-align: right; padding: 0 2px; } 
    .elipsis{ background-color: #AAA; } 
    .left .cont { background-color: #DDD; } 
    .right .cont { background-color: #EEE; } 
    .lblock .cont { background-color: #9D9; } 
    .rblock .cont { background-color: #DD6; } 
    .insert .cont { background-color: #0DD; } 
    .delete .cont { background-color: #8AD; } 
    .stats, .stats td, .stats th { background-color: #EEE; padding: 2px 0; } 
  </style> 
</head> 
<body > 
  <table border="0" cellpadding="0" cellspacing="0"> 
  <tr bgcolor="orange"><th></th><th>&nbsp;Planet.cpp&nbsp;</th><th> </th><th>&nbsp;Planet.cpp&nbsp;</th><th></th></tr> 
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l1" /><small>skipping to change at</small><em> line 734</em></th><th> </th><th><a name="part-r1" /><small>skipping to change at</small><em> line 734</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return distance;</td><td> </td><td class="right">       return distance;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Get the phase angle (radians) for an observer at pos obsPos in heliocent
ric coordinates (dist in AU)</td><td> </td><td class="right">// Get the phase angle (radians) for an observer at pos obsPos in heliocent
ric coordinates (dist in AU)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">double Planet::getPhaseAngle(const Vec3d&amp; obsPos) const</td><td> </td><td class="right">double Planet::getPhaseAngle(const Vec3d&amp; obsPos) const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       const double observerRq = obsPos.lengthSquared();</td><td> </td><td class="right">       const double observerRq = obsPos.lengthSquared();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       const Vec3d&amp; planetHelioPos = getHeliocentricEclipticPos();</td><td> </td><td class="right">       const Vec3d&amp; planetHelioPos = getHeliocentricEclipticPos();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       const double planetRq = planetHelioPos.lengthSquared();</td><td> </td><td class="right">       const double planetRq = planetHelioPos.lengthSquared();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       const double observerPlanetRq = (obsPos - planetHelioPos).lengthSqua
red();</td><td> </td><td class="right">       const double observerPlanetRq = (obsPos - planetHelioPos).lengthSqua
red();</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0001" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       return std::acos((observerPlanetRq + planetRq - observerRq)/(2.0*s<span class="delete">qr
</span>t(observerPlanetRq*planetRq)));</td><td> </td><td class="rblock">       return std::acos((observerPlanetRq + planetRq - observerRq)/(2.0*s<span class="insert">td
::sqr</span>t(observerPlanetRq*planetRq)));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Get the planet phase for an observer at pos obsPos in heliocentric coord
inates (in AU)</td><td> </td><td class="right">// Get the planet phase for an observer at pos obsPos in heliocentric coord
inates (in AU)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">float Planet::getPhase(const Vec3d&amp; obsPos) const</td><td> </td><td class="right">float Planet::getPhase(const Vec3d&amp; obsPos) const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       const double observerRq = obsPos.lengthSquared();</td><td> </td><td class="right">       const double observerRq = obsPos.lengthSquared();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       const Vec3d&amp; planetHelioPos = getHeliocentricEclipticPos();</td><td> </td><td class="right">       const Vec3d&amp; planetHelioPos = getHeliocentricEclipticPos();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       const double planetRq = planetHelioPos.lengthSquared();</td><td> </td><td class="right">       const double planetRq = planetHelioPos.lengthSquared();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       const double observerPlanetRq = (obsPos - planetHelioPos).lengthSqua
red();</td><td> </td><td class="right">       const double observerPlanetRq = (obsPos - planetHelioPos).lengthSqua
red();</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0002" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       const double cos_chi = (observerPlanetRq + planetRq - observerRq)/(2
.0*sqrt(observerPlanetRq*planetRq));</td><td> </td><td class="rblock">       const double cos_chi = (observerPlanetRq + planetRq - observerRq)/(2
.0*s<span class="insert">td::s</span>qrt(observerPlanetRq*planetRq));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return 0.5f * qAbs(1.f + cos_chi);</td><td> </td><td class="right">       return 0.5f * qAbs(1.f + cos_chi);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Get the elongation angle (radians) for an observer at pos obsPos in heli
ocentric coordinates (dist in AU)</td><td> </td><td class="right">// Get the elongation angle (radians) for an observer at pos obsPos in heli
ocentric coordinates (dist in AU)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">double Planet::getElongation(const Vec3d&amp; obsPos) const</td><td> </td><td class="right">double Planet::getElongation(const Vec3d&amp; obsPos) const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       const double observerRq = obsPos.lengthSquared();</td><td> </td><td class="right">       const double observerRq = obsPos.lengthSquared();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       const Vec3d&amp; planetHelioPos = getHeliocentricEclipticPos();</td><td> </td><td class="right">       const Vec3d&amp; planetHelioPos = getHeliocentricEclipticPos();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       const double planetRq = planetHelioPos.lengthSquared();</td><td> </td><td class="right">       const double planetRq = planetHelioPos.lengthSquared();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       const double observerPlanetRq = (obsPos - planetHelioPos).lengthSqua
red();</td><td> </td><td class="right">       const double observerPlanetRq = (obsPos - planetHelioPos).lengthSqua
red();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l2" /><small>skipping to change at</small><em> line 793</em></th><th> </th><th><a name="part-r2" /><small>skipping to change at</small><em> line 793</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               const double pos_times_parent_pos = planetHelioPos * parentH
eliopos;</td><td> </td><td class="right">               const double pos_times_parent_pos = planetHelioPos * parentH
eliopos;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               if (pos_times_parent_pos &gt; parent_Rq)</td><td> </td><td class="right">               if (pos_times_parent_pos &gt; parent_Rq)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       // The satellite is farther away from the sun than t
he parent planet.</td><td> </td><td class="right">                       // The satellite is farther away from the sun than t
he parent planet.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       const double sun_radius = parent-&gt;parent-&gt;radius;</td><td> </td><td class="right">                       const double sun_radius = parent-&gt;parent-&gt;radius;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       const double sun_minus_parent_radius = sun_radius - 
parent-&gt;radius;</td><td> </td><td class="right">                       const double sun_minus_parent_radius = sun_radius - 
parent-&gt;radius;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       const double quot = pos_times_parent_pos/parent_Rq;</td><td> </td><td class="right">                       const double quot = pos_times_parent_pos/parent_Rq;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       // Compute d = distance from satellite center to bor
der of inner shadow.</td><td> </td><td class="right">                       // Compute d = distance from satellite center to bor
der of inner shadow.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       // d&gt;0 means inside the shadow cone.</td><td> </td><td class="right">                       // d&gt;0 means inside the shadow cone.</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0003" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       double d = sun_radius - sun_minus_parent_radius*quot
 - std::sqrt((1.-sun_minus_parent_radius/s<span class="delete">qrt(parent_Rq)) * (planetRq-pos_t
</span>imes_parent_pos*quot));</td><td> </td><td class="rblock">                       double d = sun_radius - sun_minus_parent_radius*quot
 - std::sqrt((1.-sun_minus_parent_radius/s<span class="insert">td::sqrt(parent_Rq)) * (planetRq-
pos_t</span>imes_parent_pos*quot));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       if (d&gt;=radius)</td><td> </td><td class="right">                       if (d&gt;=radius)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       {</td><td> </td><td class="right">                       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               // The satellite is totally inside the inner
 shadow.</td><td> </td><td class="right">                               // The satellite is totally inside the inner
 shadow.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               if (englishName=="Moon")</td><td> </td><td class="right">                               if (englishName=="Moon")</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               {</td><td> </td><td class="right">                               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       // Fit a more realistic magnitude fo
r the Moon case.</td><td> </td><td class="right">                                       // Fit a more realistic magnitude fo
r the Moon case.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       // I used some empirical data for fi
tting. --AW</td><td> </td><td class="right">                                       // I used some empirical data for fi
tting. --AW</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       // TODO: This factor should be impro
ved!</td><td> </td><td class="right">                                       // TODO: This factor should be impro
ved!</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       shadowFactor = 2.718e-5;</td><td> </td><td class="right">                                       shadowFactor = 2.718e-5;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               }</td><td> </td><td class="right">                               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l3" /><small>skipping to change at</small><em> line 821</em></th><th> </th><th><a name="part-r3" /><small>skipping to change at</small><em> line 821</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               d /= radius;</td><td> </td><td class="right">                               d /= radius;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               shadowFactor = (0.5 - (std::asin(d)+d*std::s
qrt(1.0-d*d))/M_PI);</td><td> </td><td class="right">                               shadowFactor = (0.5 - (std::asin(d)+d*std::s
qrt(1.0-d*d))/M_PI);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       }</td><td> </td><td class="right">                       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // Use empirical formulae for main planets when seen from earth</td><td> </td><td class="right">       // Use empirical formulae for main planets when seen from earth</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (core-&gt;getCurrentLocation().planetName=="Earth")</td><td> </td><td class="right">       if (core-&gt;getCurrentLocation().planetName=="Earth")</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               const double phaseDeg=phase*180./M_PI;</td><td> </td><td class="right">               const double phaseDeg=phase*180./M_PI;</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0004" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               const double d = 5. * log10(s<span class="delete">qrt(observerPlanetRq*planetRq))
</span>;</td><td> </td><td class="rblock">               const double d = 5. * log10(s<span class="insert">td::sqrt(observerPlanetRq*plane
tRq))</span>;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               // GZ: I prefer the values given by Meeus, Astronomical Algo
rithms (1992).</td><td> </td><td class="right">               // GZ: I prefer the values given by Meeus, Astronomical Algo
rithms (1992).</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               // There are two solutions:</td><td> </td><td class="right">               // There are two solutions:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               // (1) G. Mueller, based on visual observations 1877-91. [Ex
pl.Suppl.1961]</td><td> </td><td class="right">               // (1) G. Mueller, based on visual observations 1877-91. [Ex
pl.Suppl.1961]</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               // (2) Astronomical Almanac 1984 and later. These give V (in
strumental) magnitudes.</td><td> </td><td class="right">               // (2) Astronomical Almanac 1984 and later. These give V (in
strumental) magnitudes.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               // The structure is almost identical, just the numbers are d
ifferent!</td><td> </td><td class="right">               // The structure is almost identical, just the numbers are d
ifferent!</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               // I activate (1) for now, because we want to simulate the e
ye's impression. (Esp. Venus!)</td><td> </td><td class="right">               // I activate (1) for now, because we want to simulate the e
ye's impression. (Esp. Venus!)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               // AW: (2) activated by default</td><td> </td><td class="right">               // AW: (2) activated by default</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               switch (core-&gt;getCurrentPlanet()-&gt;getApparentMagnitudeAlgori
thm())</td><td> </td><td class="right">               switch (core-&gt;getCurrentPlanet()-&gt;getApparentMagnitudeAlgori
thm())</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l4" /><small>skipping to change at</small><em> line 860</em></th><th> </th><th><a name="part-r4" /><small>skipping to change at</small><em> line 860</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               {</td><td> </td><td class="right">                               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       // add rings computation</td><td> </td><td class="right">                                       // add rings computation</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       // implemented from Meeus, Astr.Alg.
1992</td><td> </td><td class="right">                                       // implemented from Meeus, Astr.Alg.
1992</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       const double jd=core-&gt;getJDay();</td><td> </td><td class="right">                                       const double jd=core-&gt;getJDay();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       const double T=(jd-2451545.0)/36525.
0;</td><td> </td><td class="right">                                       const double T=(jd-2451545.0)/36525.
0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       const double i=((0.000004*T-0.012998
)*T+28.075216)*M_PI/180.0;</td><td> </td><td class="right">                                       const double i=((0.000004*T-0.012998
)*T+28.075216)*M_PI/180.0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       const double Omega=((0.000412*T+1.39
4681)*T+169.508470)*M_PI/180.0;</td><td> </td><td class="right">                                       const double Omega=((0.000412*T+1.39
4681)*T+169.508470)*M_PI/180.0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       static SolarSystem *ssystem=GETSTELM
ODULE(SolarSystem);</td><td> </td><td class="right">                                       static SolarSystem *ssystem=GETSTELM
ODULE(SolarSystem);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       const Vec3d saturnEarth=getHeliocent
ricEclipticPos() - ssystem-&gt;getEarth()-&gt;getHeliocentricEclipticPos();</td><td> </td><td class="right">                                       const Vec3d saturnEarth=getHeliocent
ricEclipticPos() - ssystem-&gt;getEarth()-&gt;getHeliocentricEclipticPos();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       double lambda=atan2(saturnEarth[1], 
saturnEarth[0]);</td><td> </td><td class="right">                                       double lambda=atan2(saturnEarth[1], 
saturnEarth[0]);</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0005" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                       double beta=atan2(saturnEarth[2], s<span class="delete">q
</span>rt(saturnEarth[0]*saturnEarth[0]+saturnEarth[1]*saturnEarth[1]));</td><td> </td><td class="rblock">                                       double beta=atan2(saturnEarth[2], s<span class="insert">t
d::sq</span>rt(saturnEarth[0]*saturnEarth[0]+saturnEarth[1]*saturnEarth[1]));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       const double sinx=sin(i)*cos(beta)*s
in(lambda-Omega)-cos(i)*sin(beta);</td><td> </td><td class="right">                                       const double sinx=sin(i)*cos(beta)*s
in(lambda-Omega)-cos(i)*sin(beta);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       double rings = -2.6*sinx + 1.25*sinx
*sinx;</td><td> </td><td class="right">                                       double rings = -2.6*sinx + 1.25*sinx
*sinx;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       return -8.88 + d + 0.044*phaseDeg + 
rings;</td><td> </td><td class="right">                                       return -8.88 + d + 0.044*phaseDeg + 
rings;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               }</td><td> </td><td class="right">                               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               if (englishName=="Uranus")</td><td> </td><td class="right">                               if (englishName=="Uranus")</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       return -7.19 + d + 0.0028*phaseDeg;</td><td> </td><td class="right">                                       return -7.19 + d + 0.0028*phaseDeg;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               if (englishName=="Neptune")</td><td> </td><td class="right">                               if (englishName=="Neptune")</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       return -6.87 + d;</td><td> </td><td class="right">                                       return -6.87 + d;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               if (englishName=="Pluto")</td><td> </td><td class="right">                               if (englishName=="Pluto")</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       return -1.01 + d + 0.041*phaseDeg;</td><td> </td><td class="right">                                       return -1.01 + d + 0.041*phaseDeg;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l5" /><small>skipping to change at</small><em> line 899</em></th><th> </th><th><a name="part-r5" /><small>skipping to change at</small><em> line 899</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               {</td><td> </td><td class="right">                               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       // add rings computation</td><td> </td><td class="right">                                       // add rings computation</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       // implemented from Meeus, Astr.Alg.
1992</td><td> </td><td class="right">                                       // implemented from Meeus, Astr.Alg.
1992</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       const double jd=core-&gt;getJDay();</td><td> </td><td class="right">                                       const double jd=core-&gt;getJDay();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       const double T=(jd-2451545.0)/36525.
0;</td><td> </td><td class="right">                                       const double T=(jd-2451545.0)/36525.
0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       const double i=((0.000004*T-0.012998
)*T+28.075216)*M_PI/180.0;</td><td> </td><td class="right">                                       const double i=((0.000004*T-0.012998
)*T+28.075216)*M_PI/180.0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       const double Omega=((0.000412*T+1.39
4681)*T+169.508470)*M_PI/180.0;</td><td> </td><td class="right">                                       const double Omega=((0.000412*T+1.39
4681)*T+169.508470)*M_PI/180.0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       SolarSystem *ssystem=GETSTELMODULE(S
olarSystem);</td><td> </td><td class="right">                                       SolarSystem *ssystem=GETSTELMODULE(S
olarSystem);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       const Vec3d saturnEarth=getHeliocent
ricEclipticPos() - ssystem-&gt;getEarth()-&gt;getHeliocentricEclipticPos();</td><td> </td><td class="right">                                       const Vec3d saturnEarth=getHeliocent
ricEclipticPos() - ssystem-&gt;getEarth()-&gt;getHeliocentricEclipticPos();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       double lambda=atan2(saturnEarth[1], 
saturnEarth[0]);</td><td> </td><td class="right">                                       double lambda=atan2(saturnEarth[1], 
saturnEarth[0]);</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0006" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                       double beta=atan2(saturnEarth[2], s<span class="delete">q
</span>rt(saturnEarth[0]*saturnEarth[0]+saturnEarth[1]*saturnEarth[1]));</td><td> </td><td class="rblock">                                       double beta=atan2(saturnEarth[2], s<span class="insert">t
d::sq</span>rt(saturnEarth[0]*saturnEarth[0]+saturnEarth[1]*saturnEarth[1]));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       const double sinB=sin(i)*cos(beta)*s
in(lambda-Omega)-cos(i)*sin(beta);</td><td> </td><td class="right">                                       const double sinB=sin(i)*cos(beta)*s
in(lambda-Omega)-cos(i)*sin(beta);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       double rings = -2.6*fabs(sinB) + 1.2
5*sinB*sinB; // sinx=sinB, saturnicentric latitude of earth. longish, see M
eeus.</td><td> </td><td class="right">                                       double rings = -2.6*fabs(sinB) + 1.2
5*sinB*sinB; // sinx=sinB, saturnicentric latitude of earth. longish, see M
eeus.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       return -8.68 + d + 0.044*phaseDeg + 
rings;</td><td> </td><td class="right">                                       return -8.68 + d + 0.044*phaseDeg + 
rings;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               }</td><td> </td><td class="right">                               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               if (englishName=="Uranus")</td><td> </td><td class="right">                               if (englishName=="Uranus")</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       return -6.85 + d;</td><td> </td><td class="right">                                       return -6.85 + d;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               if (englishName=="Neptune")</td><td> </td><td class="right">                               if (englishName=="Neptune")</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       return -7.05 + d;</td><td> </td><td class="right">                                       return -7.05 + d;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               if (englishName=="Pluto")</td><td> </td><td class="right">                               if (englishName=="Pluto")</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       return -1.0 + d;</td><td> </td><td class="right">                                       return -1.0 + d;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l6" /><small>skipping to change at</small><em> line 936</em></th><th> </th><th><a name="part-r6" /><small>skipping to change at</small><em> line 936</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               {</td><td> </td><td class="right">                               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       // add rings computation</td><td> </td><td class="right">                                       // add rings computation</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       // implemented from Meeus, Astr.Alg.
1992</td><td> </td><td class="right">                                       // implemented from Meeus, Astr.Alg.
1992</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       const double jd=core-&gt;getJDay();</td><td> </td><td class="right">                                       const double jd=core-&gt;getJDay();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       const double T=(jd-2451545.0)/36525.
0;</td><td> </td><td class="right">                                       const double T=(jd-2451545.0)/36525.
0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       const double i=((0.000004*T-0.012998
)*T+28.075216)*M_PI/180.0;</td><td> </td><td class="right">                                       const double i=((0.000004*T-0.012998
)*T+28.075216)*M_PI/180.0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       const double Omega=((0.000412*T+1.39
4681)*T+169.508470)*M_PI/180.0;</td><td> </td><td class="right">                                       const double Omega=((0.000412*T+1.39
4681)*T+169.508470)*M_PI/180.0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       static SolarSystem *ssystem=GETSTELM
ODULE(SolarSystem);</td><td> </td><td class="right">                                       static SolarSystem *ssystem=GETSTELM
ODULE(SolarSystem);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       const Vec3d saturnEarth=getHeliocent
ricEclipticPos() - ssystem-&gt;getEarth()-&gt;getHeliocentricEclipticPos();</td><td> </td><td class="right">                                       const Vec3d saturnEarth=getHeliocent
ricEclipticPos() - ssystem-&gt;getEarth()-&gt;getHeliocentricEclipticPos();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       double lambda=atan2(saturnEarth[1], 
saturnEarth[0]);</td><td> </td><td class="right">                                       double lambda=atan2(saturnEarth[1], 
saturnEarth[0]);</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0007" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                       double beta=atan2(saturnEarth[2], s<span class="delete">q
</span>rt(saturnEarth[0]*saturnEarth[0]+saturnEarth[1]*saturnEarth[1]));</td><td> </td><td class="rblock">                                       double beta=atan2(saturnEarth[2], s<span class="insert">t
d::sq</span>rt(saturnEarth[0]*saturnEarth[0]+saturnEarth[1]*saturnEarth[1]));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       const double sinB=sin(i)*cos(beta)*s
in(lambda-Omega)-cos(i)*sin(beta);</td><td> </td><td class="right">                                       const double sinB=sin(i)*cos(beta)*s
in(lambda-Omega)-cos(i)*sin(beta);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       double rings = -2.6*fabs(sinB) + 1.2
5*sinB*sinB; // sinx=sinB, saturnicentric latitude of earth. longish, see M
eeus.</td><td> </td><td class="right">                                       double rings = -2.6*fabs(sinB) + 1.2
5*sinB*sinB; // sinx=sinB, saturnicentric latitude of earth. longish, see M
eeus.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       return -8.88 + d + 0.044*phaseDeg + 
rings;</td><td> </td><td class="right">                                       return -8.88 + d + 0.044*phaseDeg + 
rings;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               }</td><td> </td><td class="right">                               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               if (englishName=="Uranus")</td><td> </td><td class="right">                               if (englishName=="Uranus")</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       return -7.19f + d;</td><td> </td><td class="right">                                       return -7.19f + d;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               if (englishName=="Neptune")</td><td> </td><td class="right">                               if (englishName=="Neptune")</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       return -6.87f + d;</td><td> </td><td class="right">                                       return -6.87f + d;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               if (englishName=="Pluto")</td><td> </td><td class="right">                               if (englishName=="Pluto")</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       return -1.00f + d;</td><td> </td><td class="right">                                       return -1.00f + d;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l7" /><small>skipping to change at</small><em> line 984</em></th><th> </th><th><a name="part-r7" /><small>skipping to change at</small><em> line 984</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (hidden)</td><td> </td><td class="right">       if (hidden)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               return;</td><td> </td><td class="right">               return;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // Try to improve speed for minor planets: test if visible at all.</td><td> </td><td class="right">       // Try to improve speed for minor planets: test if visible at all.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // For a full catalog of NEAs (11000 objects), with this and resetti
ng deltaJD according to distance, rendering time went 4.5fps-&gt;12fps.</td><td> </td><td class="right">       // For a full catalog of NEAs (11000 objects), with this and resetti
ng deltaJD according to distance, rendering time went 4.5fps-&gt;12fps.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // TBD: Note that taking away the asteroids at this stage breaks dim
-asteroid occultation of stars!</td><td> </td><td class="right">       // TBD: Note that taking away the asteroids at this stage breaks dim
-asteroid occultation of stars!</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       //      Maybe make another configurable flag for those interested?</td><td> </td><td class="right">       //      Maybe make another configurable flag for those interested?</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // Problematic: Early-out here of course disables the wanted hint ci
rcles for dim asteroids.</td><td> </td><td class="right">       // Problematic: Early-out here of course disables the wanted hint ci
rcles for dim asteroids.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // The line makes hints for asteroids 5 magnitudes below sky limitin
g magnitude visible.</td><td> </td><td class="right">       // The line makes hints for asteroids 5 magnitudes below sky limitin
g magnitude visible.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // If asteroid is too faint to be seen, don't bother rendering. (Mas
sive speedup if people have hundreds of orbital elements!)</td><td> </td><td class="right">       // If asteroid is too faint to be seen, don't bother rendering. (Mas
sive speedup if people have hundreds of orbital elements!)</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0008" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       if (((getVMagnitude(core)-5.0f) &gt; core-&gt;getSkyDrawer()-&gt;getLimitMagn
itude()) &amp;&amp; pType<span class="delete">=</span>=Planet::isAsteroid)</td><td> </td><td class="rblock">       if (((getVMagnitude(core)-5.0f) &gt; core-&gt;getSkyDrawer()-&gt;getLimitMagn
itude()) &amp;&amp; pType<span class="insert">&gt;</span>=Planet::isAsteroid)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               return;</td><td> </td><td class="right">               return;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       Mat4d mat = Mat4d::translation(eclipticPos) * rotLocalToParent;</td><td> </td><td class="right">       Mat4d mat = Mat4d::translation(eclipticPos) * rotLocalToParent;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       PlanetP p = parent;</td><td> </td><td class="right">       PlanetP p = parent;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       while (p &amp;&amp; p-&gt;parent)</td><td> </td><td class="right">       while (p &amp;&amp; p-&gt;parent)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               mat = Mat4d::translation(p-&gt;eclipticPos) * mat * p-&gt;rotLocal
ToParent;</td><td> </td><td class="right">               mat = Mat4d::translation(p-&gt;eclipticPos) * mat * p-&gt;rotLocal
ToParent;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               p = p-&gt;parent;</td><td> </td><td class="right">               p = p-&gt;parent;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l8" /><small>skipping to change at</small><em> line 1178</em></th><th> </th><th><a name="part-r8" /><small>skipping to change at</small><em> line 1178</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               "        }\n"</td><td> </td><td class="right">               "        }\n"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               "#endif\n"</td><td> </td><td class="right">               "#endif\n"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               "\n"</td><td> </td><td class="right">               "\n"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               "        highp float sunRadius = sunInfo.w;\n"</td><td> </td><td class="right">               "        highp float sunRadius = sunInfo.w;\n"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               "        highp float L = length(sunPosition - P);\n"</td><td> </td><td class="right">               "        highp float L = length(sunPosition - P);\n"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               "        highp float R = asin(sunRadius / L);\n"</td><td> </td><td class="right">               "        highp float R = asin(sunRadius / L);\n"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               "        for (int i = 0; i &lt; 4; ++i)\n"</td><td> </td><td class="right">               "        for (int i = 0; i &lt; 4; ++i)\n"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               "        {\n"</td><td> </td><td class="right">               "        {\n"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               "            if (shadowCount&gt;i)\n"</td><td> </td><td class="right">               "            if (shadowCount&gt;i)\n"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               "            {\n"</td><td> </td><td class="right">               "            {\n"</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0009" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               "                highp vec3 satellitePosition = <span class="delete">shadowData[0</span></td><td> </td><td class="rblock">               "                highp vec3 satellitePosition = <span class="insert">shadowData[i</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">].xyz;\n"</td><td> </td><td class="rblock">].xyz;\n"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               "                highp float satelliteRadius = <span class="delete">shadowData[0]</span></td><td> </td><td class="rblock">               "                highp float satelliteRadius = <span class="insert">shadowData[i]</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">.w;\n"</td><td> </td><td class="rblock">.w;\n"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               "                highp float l = length(satellitePosition - 
P);\n"</td><td> </td><td class="right">               "                highp float l = length(satellitePosition - 
P);\n"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               "                highp float r = asin(satelliteRadius / l);\
n"</td><td> </td><td class="right">               "                highp float r = asin(satelliteRadius / l);\
n"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               "                highp float d = acos(min(1.0, dot(normalize
(sunPosition - P), normalize(satellitePosition - P))));\n"</td><td> </td><td class="right">               "                highp float d = acos(min(1.0, dot(normalize
(sunPosition - P), normalize(satellitePosition - P))));\n"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               "\n"</td><td> </td><td class="right">               "\n"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               "                mediump float illumination = 1.0;\n"</td><td> </td><td class="right">               "                mediump float illumination = 1.0;\n"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               "                if(d &gt;= R + r)\n"</td><td> </td><td class="right">               "                if(d &gt;= R + r)\n"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               "                {\n"</td><td> </td><td class="right">               "                {\n"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               "                    // distance too far\n"</td><td> </td><td class="right">               "                    // distance too far\n"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               "                    illumination = 1.0;\n"</td><td> </td><td class="right">               "                    illumination = 1.0;\n"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               "                }\n"</td><td> </td><td class="right">               "                }\n"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l9" /><small>skipping to change at</small><em> line 1225</em></th><th> </th><th><a name="part-r9" /><small>skipping to change at</small><em> line 1225</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               "                    mediump float AS = R * R * 2.0 * 1.5707
9633;\n"</td><td> </td><td class="right">               "                    mediump float AS = R * R * 2.0 * 1.5707
9633;\n"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               "                    illumination = 1.0 - (AR + Ar) / AS;\n"</td><td> </td><td class="right">               "                    illumination = 1.0 - (AR + Ar) / AS;\n"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               "#endif\n"</td><td> </td><td class="right">               "#endif\n"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               "                }\n"</td><td> </td><td class="right">               "                }\n"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               "                final_illumination = min(illumination, fina
l_illumination);\n"</td><td> </td><td class="right">               "                final_illumination = min(illumination, fina
l_illumination);\n"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               "            }\n"</td><td> </td><td class="right">               "            }\n"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               "        }\n"</td><td> </td><td class="right">               "        }\n"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               "    }\n"</td><td> </td><td class="right">               "    }\n"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               "\n"</td><td> </td><td class="right">               "\n"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               "#ifdef IS_MOON\n"</td><td> </td><td class="right">               "#ifdef IS_MOON\n"</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0010" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               "    <span class="delete">highp vec3 normal = texture2D(normalMap, texc).rgb-vec3
</span>(0.5, 0.5, 0);\n"</td><td> </td><td class="rblock">               "    <span class="insert">mediump vec3 normal = texture2D(normalMap, texc).rgb-ve
c3</span>(0.5, 0.5, 0);\n"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               "    normal = normalize(normalX*normal.x+normalY*normal.y+no
rmalZ*normal.z);\n"</td><td> </td><td class="right">               "    normal = normalize(normalX*normal.x+normalY*normal.y+no
rmalZ*normal.z);\n"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               "    // normal now contains the real surface normal taking n
ormal map into account\n"</td><td> </td><td class="right">               "    // normal now contains the real surface normal taking n
ormal map into account\n"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               "    // Use an Oren-Nayar model for rough surfaces\n"</td><td> </td><td class="right">               "    // Use an Oren-Nayar model for rough surfaces\n"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               "    // Ref: http://content.gpwiki.org/index.php/D3DBook:(Li
ghting)_Oren-Nayar\n"</td><td> </td><td class="right">               "    // Ref: http://content.gpwiki.org/index.php/D3DBook:(Li
ghting)_Oren-Nayar\n"</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0011" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               <span class="delete">"</span>    highp float cosAngleLightNormal = dot(normal, <span class="delete">lightDire</span></td><td> </td><td class="rblock">               <span class="insert">// GZ next 2 don't require</span> highp <span class="insert">IMHO</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">ction);\n"</span></td><td> </td><td class="rblock"><span class="insert">               "    mediump</span> float cosAngleLightNormal = dot(normal, <span class="insert">lightDi</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               "    <span class="delete">highp</span> float cosAngleEyeNormal = dot(normal, <span class="delete">eyeDirectio</span></td><td> </td><td class="rblock"><span class="insert">rection);\n"</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">n);\n"</span></td><td> </td><td class="rblock">               "    <span class="insert">mediump</span> float cosAngleEyeNormal = dot(normal, <span class="insert">eyeDirect</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">ion);\n"</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               "    mediump float angleLightNormal = acos(cosAngleLightNorm
al);\n"</td><td> </td><td class="right">               "    mediump float angleLightNormal = acos(cosAngleLightNorm
al);\n"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               "    mediump float angleEyeNormal = acos(cosAngleEyeNormal);
\n"</td><td> </td><td class="right">               "    mediump float angleEyeNormal = acos(cosAngleEyeNormal);
\n"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               "    mediump float alpha = max(angleEyeNormal, angleLightNor
mal);\n"</td><td> </td><td class="right">               "    mediump float alpha = max(angleEyeNormal, angleLightNor
mal);\n"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               "    mediump float beta = min(angleEyeNormal, angleLightNorm
al);\n"</td><td> </td><td class="right">               "    mediump float beta = min(angleEyeNormal, angleLightNorm
al);\n"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               "    mediump float gamma = dot(eyeDirection - normal * cosAn
gleEyeNormal, lightDirection - normal * cosAngleLightNormal);\n"</td><td> </td><td class="right">               "    mediump float gamma = dot(eyeDirection - normal * cosAn
gleEyeNormal, lightDirection - normal * cosAngleLightNormal);\n"</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0012" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               <span class="delete">"</span>    mediump float roughness = 1.0;\n"</td><td> </td><td class="rblock">               <span class="insert">// GZ next 5 can be lowp instead of</span> mediump</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               "    <span class="delete">mediump</span> float roughnessSquared = roughness * <span class="delete">roughness;</span></td><td> </td><td class="rblock">               <span class="insert">"    lowp</span> float roughness = 1.0;\n"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">\n"</span></td><td> </td><td class="rblock">               "    <span class="insert">lowp</span> float roughnessSquared = roughness * <span class="insert">roughness;\n"</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               "    <span class="delete">mediump</span> float A = 1.0 - 0.5 * (roughnessSquared / <span class="delete">(roug</span></td><td> </td><td class="rblock">               "    <span class="insert">lowp</span> float A = 1.0 - 0.5 * (roughnessSquared / <span class="insert">(roughne</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">hnessSquared</span> + 0.57));\n"</td><td> </td><td class="rblock"><span class="insert">ssSquared</span> + 0.57));\n"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               "    <span class="delete">mediump</span> float B = 0.45 * (roughnessSquared / <span class="delete">(roughness</span></td><td> </td><td class="rblock">               "    <span class="insert">lowp</span> float B = 0.45 * (roughnessSquared / <span class="insert">(roughnessSqu</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">Squared</span> + 0.09));\n"</td><td> </td><td class="rblock"><span class="insert">ared</span> + 0.09));\n"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               "    <span class="delete">mediump</span> float C = sin(alpha) * tan(beta);\n"</td><td> </td><td class="rblock">               "    <span class="insert">lowp</span> float C = sin(alpha) * tan(beta);\n"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               "    lum = max(0.0, cosAngleLightNormal) * (A + B * max(0.0,</td><td> </td><td class="rblock">               "    lum = max(0.0, cosAngleLightNormal) * (A + B * max(0.0,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"> gamma) * C) * <span class="delete">1.5;\n"</span></td><td> </td><td class="rblock"> gamma) * C) * <span class="insert">2.0;\n"</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               "#endif\n"</td><td> </td><td class="right">               "#endif\n"</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0013" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               "    mediump vec4 litColor = vec4(lum * final_illumination *
 diffuseLight + ambientLight, <span class="delete">2</span>.0);\n"</td><td> </td><td class="rblock">               "    mediump vec4 litColor = vec4(lum * final_illumination *
 diffuseLight + ambientLight, <span class="insert">1</span>.0);\n"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               "#ifdef IS_MOON\n"</td><td> </td><td class="right">               "#ifdef IS_MOON\n"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               "    if(final_illumination &lt; 0.99)\n"</td><td> </td><td class="right">               "    if(final_illumination &lt; 0.99)\n"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               "    {\n"</td><td> </td><td class="right">               "    {\n"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               "        lowp vec4 shadowColor = texture2D(earthShadow, vec2
(final_illumination, 0.5));\n"</td><td> </td><td class="right">               "        lowp vec4 shadowColor = texture2D(earthShadow, vec2
(final_illumination, 0.5));\n"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               "        gl_FragColor = mix(texture2D(tex, texc) * litColor,
 shadowColor, shadowColor.a);\n"</td><td> </td><td class="right">               "        gl_FragColor = mix(texture2D(tex, texc) * litColor,
 shadowColor, shadowColor.a);\n"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               "    }\n"</td><td> </td><td class="right">               "    }\n"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               "    else\n"</td><td> </td><td class="right">               "    else\n"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               "#endif\n"</td><td> </td><td class="right">               "#endif\n"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               "    {\n"</td><td> </td><td class="right">               "    {\n"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               "        gl_FragColor = texture2D(tex, texc) * litColor;\n"</td><td> </td><td class="right">               "        gl_FragColor = texture2D(tex, texc) * litColor;\n"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l10" /><small>skipping to change at</small><em> line 1606</em></th><th> </th><th><a name="part-r10" /><small>skipping to change at</small><em> line 1608</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               shadowCandidatesData(3, i) = shadowCandidates.at(i)-&gt;getRadi
us();</td><td> </td><td class="right">               shadowCandidatesData(3, i) = shadowCandidates.at(i)-&gt;getRadi
us();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       const StelProjectorP&amp; projector = painter-&gt;getProjector();</td><td> </td><td class="right">       const StelProjectorP&amp; projector = painter-&gt;getProjector();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       Vec3f lightPos3(light.position[0], light.position[1], light.position
[2]);</td><td> </td><td class="right">       Vec3f lightPos3(light.position[0], light.position[1], light.position
[2]);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       projector-&gt;getModelViewTransform()-&gt;backward(lightPos3);</td><td> </td><td class="right">       projector-&gt;getModelViewTransform()-&gt;backward(lightPos3);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       lightPos3.normalize();</td><td> </td><td class="right">       lightPos3.normalize();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       Vec3d eyePos = StelApp::getInstance().getCore()-&gt;getObserverHeliocen
tricEclipticPos();</td><td> </td><td class="right">       Vec3d eyePos = StelApp::getInstance().getCore()-&gt;getObserverHeliocen
tricEclipticPos();</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0014" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       StelApp::getInstance().getCore()-&gt;getHeliocentricEclipticModelViewTr</td><td> </td><td class="rblock">       <span class="insert">//qDebug() &lt;&lt; eyePos[0] &lt;&lt; " " &lt;&lt; eyePos[1] &lt;&lt; " " &lt;&lt; eyePos[2] &lt;&lt; "</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">ansform()-&gt;forward(eyePos);</span></td><td> </td><td class="rblock"><span class="insert"> --&gt; ";</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       // Use refractionOff for avoiding flickering Moon. (Bug #1411958)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       StelApp::getInstance().getCore()-&gt;getHeliocentricEclipticModelViewTr</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">ansform(StelCore::RefractionOff)-&gt;forward(eyePos);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       //qDebug() &lt;&lt; "--&gt;" &lt;&lt; eyePos[0] &lt;&lt; " " &lt;&lt; eyePos[1] &lt;&lt; " " &lt;&lt; eyePo</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">s[2];</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       projector-&gt;getModelViewTransform()-&gt;backward(eyePos);</td><td> </td><td class="right">       projector-&gt;getModelViewTransform()-&gt;backward(eyePos);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       eyePos.normalize();</td><td> </td><td class="right">       eyePos.normalize();</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0015" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       //qDebug() &lt;&lt; " --&gt;" &lt;&lt; eyePos[0] &lt;&lt; " " &lt;&lt; eyePos[1] &lt;&lt; " " &lt;&lt; eyeP
os[2];</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       GL(shader-&gt;setUniformValue(shaderVars-&gt;projectionMatrix, qMat));</td><td> </td><td class="right">       GL(shader-&gt;setUniformValue(shaderVars-&gt;projectionMatrix, qMat));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       GL(shader-&gt;setUniformValue(shaderVars-&gt;lightDirection, lightPos3[0],
 lightPos3[1], lightPos3[2]));</td><td> </td><td class="right">       GL(shader-&gt;setUniformValue(shaderVars-&gt;lightDirection, lightPos3[0],
 lightPos3[1], lightPos3[2]));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       GL(shader-&gt;setUniformValue(shaderVars-&gt;eyeDirection, eyePos[0], eyeP
os[1], eyePos[2]));</td><td> </td><td class="right">       GL(shader-&gt;setUniformValue(shaderVars-&gt;eyeDirection, eyePos[0], eyeP
os[1], eyePos[2]));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       GL(shader-&gt;setUniformValue(shaderVars-&gt;diffuseLight, light.diffuse[0
], light.diffuse[1], light.diffuse[2]));</td><td> </td><td class="right">       GL(shader-&gt;setUniformValue(shaderVars-&gt;diffuseLight, light.diffuse[0
], light.diffuse[1], light.diffuse[2]));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       GL(shader-&gt;setUniformValue(shaderVars-&gt;ambientLight, light.ambient[0
], light.ambient[1], light.ambient[2]));</td><td> </td><td class="right">       GL(shader-&gt;setUniformValue(shaderVars-&gt;ambientLight, light.ambient[0
], light.ambient[1], light.ambient[2]));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       GL(shader-&gt;setUniformValue(shaderVars-&gt;texture, 0));</td><td> </td><td class="right">       GL(shader-&gt;setUniformValue(shaderVars-&gt;texture, 0));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       GL(shader-&gt;setUniformValue(shaderVars-&gt;shadowCount, shadowCandidates
.size()));</td><td> </td><td class="right">       GL(shader-&gt;setUniformValue(shaderVars-&gt;shadowCount, shadowCandidates
.size()));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       GL(shader-&gt;setUniformValue(shaderVars-&gt;shadowData, shadowCandidatesD
ata));</td><td> </td><td class="right">       GL(shader-&gt;setUniformValue(shaderVars-&gt;shadowData, shadowCandidatesD
ata));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       GL(shader-&gt;setUniformValue(shaderVars-&gt;sunInfo, mTarget[12], mTarget
[13], mTarget[14], ssm-&gt;getSun()-&gt;getRadius()));</td><td> </td><td class="right">       GL(shader-&gt;setUniformValue(shaderVars-&gt;sunInfo, mTarget[12], mTarget
[13], mTarget[14], ssm-&gt;getSun()-&gt;getRadius()));</td><td class="lineno" valign="top"></td></tr>

     <tr><td></td><td class="left"></td><td> </td><td class="right"></td><td></td></tr>
     <tr bgcolor="gray"><th colspan="5" align="center"><a name="end">&nbsp;End of changes. 15 change blocks.&nbsp;</a></th></tr>
     <tr class="stats"><td></td><th><i>30 lines changed or deleted</i></th><th><i> </i></th><th><i>37 lines changed or added</i></th><td></td></tr>
     <tr><td colspan="5" align="center" class="small"><br/>This html diff was produced by rfcdiff 1.41. The latest version is available from <a href="http://www.tools.ietf.org/tools/rfcdiff/" >http://tools.ietf.org/tools/rfcdiff/</a> </td></tr>
   </table>
   </body>
   </html>
