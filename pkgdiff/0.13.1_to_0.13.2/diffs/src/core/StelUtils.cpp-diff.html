<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
<!-- Generated by rfcdiff 1.41: rfcdiff  --> 
<!-- <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional" > -->
<!-- System: Linux fomalhaut.local 3.13.0-45-generic #74-Ubuntu SMP Tue Jan 13 19:36:28 UTC 2015 x86_64 x86_64 x86_64 GNU/Linux --> 
<!-- Using awk: /usr/bin/gawk: GNU Awk 4.0.1 --> 
<!-- Using diff: /usr/bin/diff: diff (GNU diffutils) 3.3 --> 
<!-- Using wdiff: /usr/bin/wdiff: wdiff (GNU wdiff) 1.2.1 --> 
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"> 
<head> 
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 
  <meta http-equiv="Content-Style-Type" content="text/css" /> 
  <title>Diff: StelUtils.cpp - StelUtils.cpp</title> 
  <style type="text/css"> 
    body    { font-size:16px; margin: 0.4ex; margin-right: auto; } 
    tr      { } 
    td      { white-space: pre; font-family: Consolas, "DejaVu Sans Mono", "Droid Sans Mono", Monaco, Monospace; vertical-align: top; font-size: 0.86em;} 
    th      { font-size: 0.86em; } 
    .small  { font-size: 0.6em; font-style: italic; font-family: Verdana, Helvetica, sans-serif; } 
    .left   { background-color: #EEE; } 
    .right  { background-color: #FFF; } 
    .diff   { background-color: #CCF; } 
    .lblock { background-color: #BFB; } 
    .rblock { background-color: #FF8; } 
    .insert { background-color: #8FF; } 
    .delete { background-color: #ACF; } 
    .void   { background-color: #FFB; } 
    .cont   { background-color: #EEE; } 
    .linebr { background-color: #AAA; } 
    .lineno { color: red; background-color: #FFF; font-size: 0.7em; text-align: right; padding: 0 2px; } 
    .elipsis{ background-color: #AAA; } 
    .left .cont { background-color: #DDD; } 
    .right .cont { background-color: #EEE; } 
    .lblock .cont { background-color: #9D9; } 
    .rblock .cont { background-color: #DD6; } 
    .insert .cont { background-color: #0DD; } 
    .delete .cont { background-color: #8AD; } 
    .stats, .stats td, .stats th { background-color: #EEE; padding: 2px 0; } 
  </style> 
</head> 
<body > 
  <table border="0" cellpadding="0" cellspacing="0"> 
  <tr bgcolor="orange"><th></th><th>&nbsp;StelUtils.cpp&nbsp;</th><th> </th><th>&nbsp;StelUtils.cpp&nbsp;</th><th></th></tr> 
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l1" /><small>skipping to change at</small><em> line 242</em></th><th> </th><th><a name="part-r1" /><small>skipping to change at</small><em> line 242</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       rad = std::fmod(rad,2.0*M_PI);</td><td> </td><td class="right">       rad = std::fmod(rad,2.0*M_PI);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       sign=true;</td><td> </td><td class="right">       sign=true;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (rad&lt;0)</td><td> </td><td class="right">       if (rad&lt;0)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               rad *= -1;</td><td> </td><td class="right">               rad *= -1;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               sign = false;</td><td> </td><td class="right">               sign = false;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       deg = rad*180./M_PI;</td><td> </td><td class="right">       deg = rad*180./M_PI;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0001" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">QString radToDecDegStr(const double angle, const <span class="delete">bool useD, const bool useC
</span>)</td><td> </td><td class="rblock">QString radToDecDegStr(const double angle, const <span class="insert">int precision, const bool 
useD, const bool useC</span>)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       QChar degsign('d');</td><td> </td><td class="right">       QChar degsign('d');</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       QString str;</td><td> </td><td class="right">       QString str;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (!useD)</td><td> </td><td class="right">       if (!useD)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               degsign = 0x00B0;</td><td> </td><td class="right">               degsign = 0x00B0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       bool sign;</td><td> </td><td class="right">       bool sign;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double deg;</td><td> </td><td class="right">       double deg;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       StelUtils::radToDecDeg(angle, sign, deg);</td><td> </td><td class="right">       StelUtils::radToDecDeg(angle, sign, deg);</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0002" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       str = QString("%1%2%3").arg((sign?"+":"-"), QString::number(deg, 'f'
, <span class="delete">4</span>), degsign);</td><td> </td><td class="rblock">       str = QString("%1%2%3").arg((sign?"+":"-"), QString::number(deg, 'f'
, <span class="insert">precision</span>), degsign);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (useC)</td><td> </td><td class="right">       if (useC)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               if (!sign)</td><td> </td><td class="right">               if (!sign)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       deg = 360. - deg;</td><td> </td><td class="right">                       deg = 360. - deg;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0003" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               str = QString("+%1%2").arg(QString::number(deg, 'f', <span class="delete">4), deg
</span>sign);</td><td> </td><td class="rblock">               str = QString("+%1%2").arg(QString::number(deg, 'f', <span class="insert">precisi
on), deg</span>sign);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return str;</td><td> </td><td class="right">       return str;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">/*************************************************************************</td><td> </td><td class="right">/*************************************************************************</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"> Convert an angle in radian to a hms formatted string</td><td> </td><td class="right"> Convert an angle in radian to a hms formatted string</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"> If the minute and second part are null are too small, don't print them</td><td> </td><td class="right"> If the minute and second part are null are too small, don't print them</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">*************************************************************************/</td><td> </td><td class="right">*************************************************************************/</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">QString radToHmsStrAdapt(const double angle)</td><td> </td><td class="right">QString radToHmsStrAdapt(const double angle)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l2" /><small>skipping to change at</small><em> line 314</em></th><th> </th><th><a name="part-r2" /><small>skipping to change at</small><em> line 314</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">*************************************************************************/</td><td> </td><td class="right">*************************************************************************/</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">QString radToHmsStr(const double angle, const bool decimal)</td><td> </td><td class="right">QString radToHmsStr(const double angle, const bool decimal)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       unsigned int h,m;</td><td> </td><td class="right">       unsigned int h,m;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double s;</td><td> </td><td class="right">       double s;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       StelUtils::radToHms(angle+0.005*M_PI/12/(60*60), h, m, s);</td><td> </td><td class="right">       StelUtils::radToHms(angle+0.005*M_PI/12/(60*60), h, m, s);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       int width, precision;</td><td> </td><td class="right">       int width, precision;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       QString carry;</td><td> </td><td class="right">       QString carry;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (decimal)</td><td> </td><td class="right">       if (decimal)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0004" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               <span class="delete">width=4;</span></td><td> </td><td class="rblock">               <span class="insert">width=5;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               precision=1;</span></td><td> </td><td class="rblock"><span class="insert">               precision=2;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               carry="60.0";</span></td><td> </td><td class="rblock"><span class="insert">               carry="60.00";</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       else</td><td> </td><td class="right">       else</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0005" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               <span class="delete">width=2;</span></td><td> </td><td class="rblock">               <span class="insert">width=4;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               precision=0;</span></td><td> </td><td class="rblock"><span class="insert">               precision=1;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               carry="60";</span></td><td> </td><td class="rblock"><span class="insert">               carry="60.0";</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // handle carry case (when seconds are rounded up)</td><td> </td><td class="right">       // handle carry case (when seconds are rounded up)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (QString("%1").arg(s, 0, 'f', precision) == carry)</td><td> </td><td class="right">       if (QString("%1").arg(s, 0, 'f', precision) == carry)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               s=0;</td><td> </td><td class="right">               s=0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               m+=1;</td><td> </td><td class="right">               m+=1;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (m==60)</td><td> </td><td class="right">       if (m==60)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l3" /><small>skipping to change at</small><em> line 548</em></th><th> </th><th><a name="part-r3" /><small>skipping to change at</small><em> line 548</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       *lng = atan2(v[1],v[0]);</td><td> </td><td class="right">       *lng = atan2(v[1],v[0]);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void rectToSphe(double *lng, double *lat, const Vec3f&amp; v)</td><td> </td><td class="right">void rectToSphe(double *lng, double *lat, const Vec3f&amp; v)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double r = v.length();</td><td> </td><td class="right">       double r = v.length();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       *lat = asin(v[2]/r);</td><td> </td><td class="right">       *lat = asin(v[2]/r);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       *lng = atan2(v[1],v[0]);</td><td> </td><td class="right">       *lng = atan2(v[1],v[0]);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0006" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">// GZ: some additions. I need those just for quick conversions for text dis
play.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void ctRadec2Ecl(const double raRad, const double decRad, const double eclR
ad, double *lambdaRad, double *betaRad)</td><td> </td><td class="right">void ctRadec2Ecl(const double raRad, const double decRad, const double eclR
ad, double *lambdaRad, double *betaRad)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       *lambdaRad=std::atan2(std::sin(raRad)*std::cos(eclRad)+std::tan(decR
ad)*std::sin(eclRad), std::cos(raRad));</td><td> </td><td class="right">       *lambdaRad=std::atan2(std::sin(raRad)*std::cos(eclRad)+std::tan(decR
ad)*std::sin(eclRad), std::cos(raRad));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       *betaRad=std::asin(std::sin(decRad)*std::cos(eclRad)-std::cos(decRad
)*std::sin(eclRad)*std::sin(raRad));</td><td> </td><td class="right">       *betaRad=std::asin(std::sin(decRad)*std::cos(eclRad)-std::cos(decRad
)*std::sin(eclRad)*std::sin(raRad));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0007" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">// GZ: done</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">double getDecAngle(const QString&amp; str)</td><td> </td><td class="right">double getDecAngle(const QString&amp; str)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       QRegExp re1("^\\s*([\\+\\-])?\\s*(\\d+)\\s*([hHDd\xBA])\\s*(\\d+)\\s
*['Mm]\\s*(\\d+(\\.\\d+)?)\\s*[\"Ss]\\s*([NSEWnsew])?\\s*$"); // DMS/HMS</td><td> </td><td class="right">       QRegExp re1("^\\s*([\\+\\-])?\\s*(\\d+)\\s*([hHDd\xBA])\\s*(\\d+)\\s
*['Mm]\\s*(\\d+(\\.\\d+)?)\\s*[\"Ss]\\s*([NSEWnsew])?\\s*$"); // DMS/HMS</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       QRegExp re2("^\\s*([\\+\\-])?\\s*(\\d+(\\.\\d+)?).?([NSEWnsew])?\\s*
$"); // Decimal</td><td> </td><td class="right">       QRegExp re2("^\\s*([\\+\\-])?\\s*(\\d+(\\.\\d+)?).?([NSEWnsew])?\\s*
$"); // Decimal</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0008" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       QRegExp re3("([+-]?[\\d.]+)°(?:([\\d.]+)')?(?:([\\d.]+)\")?"); // DM
S like +121°33'38.28"</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (re1.exactMatch(str))</td><td> </td><td class="right">       if (re1.exactMatch(str))</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               bool neg = (re1.capturedTexts().at(1) == "-");</td><td> </td><td class="right">               bool neg = (re1.capturedTexts().at(1) == "-");</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               float d = re1.capturedTexts().at(2).toFloat();</td><td> </td><td class="right">               float d = re1.capturedTexts().at(2).toFloat();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               float m = re1.capturedTexts().at(4).toFloat();</td><td> </td><td class="right">               float m = re1.capturedTexts().at(4).toFloat();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               double s = re1.capturedTexts().at(5).toDouble();</td><td> </td><td class="right">               double s = re1.capturedTexts().at(5).toDouble();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               if (re1.capturedTexts().at(3).toUpper() == "H")</td><td> </td><td class="right">               if (re1.capturedTexts().at(3).toUpper() == "H")</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       d *= 15;</td><td> </td><td class="right">                       d *= 15;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l4" /><small>skipping to change at</small><em> line 588</em></th><th> </th><th><a name="part-r4" /><small>skipping to change at</small><em> line 587</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       else if (re2.exactMatch(str))</td><td> </td><td class="right">       else if (re2.exactMatch(str))</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               bool neg = (re2.capturedTexts().at(1) == "-");</td><td> </td><td class="right">               bool neg = (re2.capturedTexts().at(1) == "-");</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               double deg = re2.capturedTexts().at(2).toDouble();</td><td> </td><td class="right">               double deg = re2.capturedTexts().at(2).toDouble();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               QString cardinal = re2.capturedTexts().at(4);</td><td> </td><td class="right">               QString cardinal = re2.capturedTexts().at(4);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               if (cardinal.toLower() == "s" || cardinal.toLower() == "w" |
| neg)</td><td> </td><td class="right">               if (cardinal.toLower() == "s" || cardinal.toLower() == "w" |
| neg)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       deg *= -1.;</td><td> </td><td class="right">                       deg *= -1.;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               return (deg * 2 * M_PI / 360.);</td><td> </td><td class="right">               return (deg * 2 * M_PI / 360.);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0009" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       <span class="insert">else if (re3.exactMatch(str))</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       {</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               float deg = re3.capturedTexts()[1].toFloat();</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               float min = re3.capturedTexts()[2].isEmpty()? 0 : re3.captur</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">edTexts()[2].toFloat();</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               float sec = re3.capturedTexts()[3].isEmpty()? 0 : re3.captur</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">edTexts()[3].toFloat();</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               float r = qAbs(deg) + min / 60 + sec / 3600;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               if (deg&lt;0)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       r *= -1.;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               return (r * 2 * M_PI / 360.);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       qDebug() &lt;&lt; "getDecAngle failed to parse angle string:" &lt;&lt; str;</td><td> </td><td class="right">       qDebug() &lt;&lt; "getDecAngle failed to parse angle string:" &lt;&lt; str;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return -0.0;</td><td> </td><td class="right">       return -0.0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Check if a number is a power of 2</td><td> </td><td class="right">// Check if a number is a power of 2</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">bool isPowerOfTwo(const int value)</td><td> </td><td class="right">bool isPowerOfTwo(const int value)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return (value &amp; -value) == value;</td><td> </td><td class="right">       return (value &amp; -value) == value;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l5" /><small>skipping to change at</small><em> line 1236</em></th><th> </th><th><a name="part-r5" /><small>skipping to change at</small><em> line 1245</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double a = AU*1000*SemiMajorAxis;</td><td> </td><td class="right">       double a = AU*1000*SemiMajorAxis;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // Calculate orbital period in seconds</td><td> </td><td class="right">       // Calculate orbital period in seconds</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // Here 1.32712440018e20 is heliocentric gravitational constant</td><td> </td><td class="right">       // Here 1.32712440018e20 is heliocentric gravitational constant</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double period = 2*M_PI*std::sqrt(a*a*a/1.32712440018e20);</td><td> </td><td class="right">       double period = 2*M_PI*std::sqrt(a*a*a/1.32712440018e20);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return period/86400; // return period in days</td><td> </td><td class="right">       return period/86400; // return period in days</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">QString hoursToHmsStr(const double hours)</td><td> </td><td class="right">QString hoursToHmsStr(const double hours)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       int h = (int)hours;</td><td> </td><td class="right">       int h = (int)hours;</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0010" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       int m = <span class="delete">(int)((std::abs(hours)-std::abs(double(h)))*60);</span></td><td> </td><td class="rblock">       int m = <span class="insert">(int)((qAbs(hours)-qAbs(double(h)))*60);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       float s = <span class="delete">(((std::abs(hours)-std::abs(double(h)))*60)-m)*60;</span></td><td> </td><td class="rblock">       float s = <span class="insert">(((qAbs(hours)-qAbs(double(h)))*60)-m)*60;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return QString("%1h%2m%3s").arg(h).arg(m).arg(QString::number(s, 'f'
, 1));</td><td> </td><td class="right">       return QString("%1h%2m%3s").arg(h).arg(m).arg(QString::number(s, 'f'
, 1));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">/* /////////////////// DELTA T VARIANTS</td><td> </td><td class="right">/* /////////////////// DELTA T VARIANTS</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// For the standard epochs for many formulae, we use</td><td> </td><td class="right">// For the standard epochs for many formulae, we use</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// J2000.0=2000-jan-1.5=2451545.0,</td><td> </td><td class="right">// J2000.0=2000-jan-1.5=2451545.0,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//  1900.0=1900-jan-0.5=2415020.0</td><td> </td><td class="right">//  1900.0=1900-jan-0.5=2415020.0</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//  1820.0=1820-jan-0.5=2385800.0</td><td> </td><td class="right">//  1820.0=1820-jan-0.5=2385800.0</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//  1810.0=1810-jan-0.5=2382148.0</td><td> </td><td class="right">//  1810.0=1810-jan-0.5=2382148.0</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l6" /><small>skipping to change at</small><em> line 1263</em></th><th> </th><th><a name="part-r6" /><small>skipping to change at</small><em> line 1272</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Implementation of algorithm by Espenak &amp; Meeus (2006) for DeltaT computa
tion</td><td> </td><td class="right">// Implementation of algorithm by Espenak &amp; Meeus (2006) for DeltaT computa
tion</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">double getDeltaTByEspenakMeeus(const double jDay)</td><td> </td><td class="right">double getDeltaTByEspenakMeeus(const double jDay)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       int year, month, day;</td><td> </td><td class="right">       int year, month, day;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       getDateFromJulianDay(jDay, &amp;year, &amp;month, &amp;day);</td><td> </td><td class="right">       getDateFromJulianDay(jDay, &amp;year, &amp;month, &amp;day);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // Note: the method here is adapted from</td><td> </td><td class="right">       // Note: the method here is adapted from</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // "Five Millennium Canon of Solar Eclipses" [Espenak and Meeus, 200
6]</td><td> </td><td class="right">       // "Five Millennium Canon of Solar Eclipses" [Espenak and Meeus, 200
6]</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // A summary is described here:</td><td> </td><td class="right">       // A summary is described here:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // http://eclipse.gsfc.nasa.gov/SEhelp/deltatpoly2004.html</td><td> </td><td class="right">       // http://eclipse.gsfc.nasa.gov/SEhelp/deltatpoly2004.html</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0011" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">// GZ: I replaced the std::pow() calls by Horner's scheme with rever</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">sed factors, it's more accurate and efficient.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       //     Old code left for readability, but can also be deleted.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double y = year+((month-1)*30.5+day/31*30.5)/366;</td><td> </td><td class="right">       double y = year+((month-1)*30.5+day/31*30.5)/366;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // set the default value for Delta T</td><td> </td><td class="right">       // set the default value for Delta T</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double u = (y-1820)/100.;</td><td> </td><td class="right">       double u = (y-1820)/100.;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double r = (-20 + 32 * u * u);</td><td> </td><td class="right">       double r = (-20 + 32 * u * u);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (y &lt; -500)</td><td> </td><td class="right">       if (y &lt; -500)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               // values are equal to defaults!</td><td> </td><td class="right">               // values are equal to defaults!</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l7" /><small>skipping to change at</small><em> line 1530</em></th><th> </th><th><a name="part-r7" /><small>skipping to change at</small><em> line 1537</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (-391 &lt; year &amp;&amp; year &lt;= 948)</td><td> </td><td class="right">       if (-391 &lt; year &amp;&amp; year &lt;= 948)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               deltaT = (42.4*u +495.0)*u + 2177.0;</td><td> </td><td class="right">               deltaT = (42.4*u +495.0)*u + 2177.0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (948 &lt; year &amp;&amp; year &lt;= 1600)</td><td> </td><td class="right">       if (948 &lt; year &amp;&amp; year &lt;= 1600)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               deltaT = (23.6*u +100.0)*u + 102.0;</td><td> </td><td class="right">               deltaT = (23.6*u +100.0)*u + 102.0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return deltaT;</td><td> </td><td class="right">       return deltaT;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Implementation of algorithm by JPL Horizons for DeltaT computation</td><td> </td><td class="right">// Implementation of algorithm by JPL Horizons for DeltaT computation</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">double getDeltaTByJPLHorizons(const double jDay)</td><td> </td><td class="right">double getDeltaTByJPLHorizons(const double jDay)</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0012" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">{ // <span class="delete">GZ: TODO: FIXME! It does not make sense to have zeros after 1620 in a 
JPL Horizo</span>ns compatible implementation!</td><td> </td><td class="rblock">{ // <span class="insert">FIXME: It does not make sense to have zeros after 1620 in a JPL Horizo
</span>ns compatible implementation!</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       int year, month, day;</td><td> </td><td class="right">       int year, month, day;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double u;</td><td> </td><td class="right">       double u;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double deltaT = 0.;</td><td> </td><td class="right">       double deltaT = 0.;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       getDateFromJulianDay(jDay, &amp;year, &amp;month, &amp;day);</td><td> </td><td class="right">       getDateFromJulianDay(jDay, &amp;year, &amp;month, &amp;day);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (-2999 &lt; year &amp;&amp; year &lt; 948)</td><td> </td><td class="right">       if (-2999 &lt; year &amp;&amp; year &lt; 948)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               u=(jDay-2385800.0)/36525.0; // (1820-jan-1.5)</td><td> </td><td class="right">               u=(jDay-2385800.0)/36525.0; // (1820-jan-1.5)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               deltaT = 31.0*u*u;</td><td> </td><td class="right">               deltaT = 31.0*u*u;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l8" /><small>skipping to change at</small><em> line 1714</em></th><th> </th><th><a name="part-r8" /><small>skipping to change at</small><em> line 1721</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               u = 0.05 + ub;</td><td> </td><td class="right">               u = 0.05 + ub;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               //deltaT = +60.8 + 82.0*u - 188.0*std::pow(u,2) - 5034.0*std
::pow(u,3);</td><td> </td><td class="right">               //deltaT = +60.8 + 82.0*u - 188.0*std::pow(u,2) - 5034.0*std
::pow(u,3);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               deltaT = ((-5034.0*u -188.0)*u +82.0)*u +60.8;</td><td> </td><td class="right">               deltaT = ((-5034.0*u -188.0)*u +82.0)*u +60.8;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return deltaT;</td><td> </td><td class="right">       return deltaT;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Implementation of algorithm by Reingold &amp; Dershowitz (Cal. Calc. 1997, 2
001, 2007, Cal. Tab. 2002) for DeltaT computation.</td><td> </td><td class="right">// Implementation of algorithm by Reingold &amp; Dershowitz (Cal. Calc. 1997, 2
001, 2007, Cal. Tab. 2002) for DeltaT computation.</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0013" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">// <span class="delete">GZ:</span> Created as yet another multi-segment polynomial fit through the <span class="delete">tabl</span></td><td> </td><td class="rblock">// Created as yet another multi-segment polynomial fit through the <span class="insert">table</span> in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">e</span> in Meeus: Astronomical Algorithms (1991).</td><td> </td><td class="rblock"> Meeus: Astronomical Algorithms (1991).</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">// <span class="delete">GZ:</span> Note that only the Third edition (2007) adds the 1700-1799 term.</td><td> </td><td class="rblock">// Note that only the Third edition (2007) adds the 1700-1799 term.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">// <span class="delete">GZ:</span> More efficient reimplementation with stricter adherence to the <span class="delete">sourc</span></td><td> </td><td class="rblock">// More efficient reimplementation with stricter adherence to the <span class="insert">source.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">e.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">double getDeltaTByReingoldDershowitz(const double jDay)</td><td> </td><td class="right">double getDeltaTByReingoldDershowitz(const double jDay)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       int year, month, day;</td><td> </td><td class="right">       int year, month, day;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       getDateFromJulianDay(jDay, &amp;year, &amp;month, &amp;day);</td><td> </td><td class="right">       getDateFromJulianDay(jDay, &amp;year, &amp;month, &amp;day);</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0014" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       // <span class="delete">GZ:</span> R&amp;D don't use a float-fraction year, but explicitly only the </td><td> </td><td class="rblock">       // R&amp;D don't use a float-fraction year, but explicitly only the <span class="insert">inte</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">integer</span> year! And R&amp;D use a proleptic Gregorian year before 1582.</td><td> </td><td class="rblock"><span class="insert">ger</span> year! And R&amp;D use a proleptic Gregorian year before 1582.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       // <span class="delete">GZ:</span> We cannot do that, but the difference is negligible.</td><td> </td><td class="rblock">       // We cannot do that, but the difference is negligible.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       // <span class="delete">GZ:</span> FIXME: why are displayed values so far off the computed <span class="delete">value</span></td><td> </td><td class="rblock">       // FIXME: why are displayed values so far off the computed <span class="insert">values? I</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">s? It</span> seems currently broken!</td><td> </td><td class="rblock"><span class="insert">t</span> seems currently broken!</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double deltaT=0.0; // If it returns 0, there is a bug!</td><td> </td><td class="right">       double deltaT=0.0; // If it returns 0, there is a bug!</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if ((year &gt;= 2019) || (year &lt; 1620))</td><td> </td><td class="right">       if ((year &gt;= 2019) || (year &lt; 1620))</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               double jdYear_0; getJDFromDate(&amp;jdYear_0, year, 1, 1, 0, 0, 
0);</td><td> </td><td class="right">               double jdYear_0; getJDFromDate(&amp;jdYear_0, year, 1, 1, 0, 0, 
0);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               double jd1810_0; getJDFromDate(&amp;jd1810_0, 1810, 1, 1, 0, 0, 
0);</td><td> </td><td class="right">               double jd1810_0; getJDFromDate(&amp;jd1810_0, 1810, 1, 1, 0, 0, 
0);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               double x = (jdYear_0-jd1810_0+0.5);</td><td> </td><td class="right">               double x = (jdYear_0-jd1810_0+0.5);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               deltaT = x*x/41048480.0 - 15.0;</td><td> </td><td class="right">               deltaT = x*x/41048480.0 - 15.0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       else if (year &gt;= 1988)</td><td> </td><td class="right">       else if (year &gt;= 1988)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l9" /><small>skipping to change at</small><em> line 1844</em></th><th> </th><th><a name="part-r9" /><small>skipping to change at</small><em> line 1851</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">double getMoonSecularAcceleration(const double jDay, const double nd)</td><td> </td><td class="right">double getMoonSecularAcceleration(const double jDay, const double nd)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       int year, month, day;</td><td> </td><td class="right">       int year, month, day;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       getDateFromJulianDay(jDay, &amp;year, &amp;month, &amp;day);</td><td> </td><td class="right">       getDateFromJulianDay(jDay, &amp;year, &amp;month, &amp;day);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double yeardec=year+((month-1)*30.5+day/31*30.5)/366.0;</td><td> </td><td class="right">       double yeardec=year+((month-1)*30.5+day/31*30.5)/366.0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double t = (yeardec-1955.5)/100.0;</td><td> </td><td class="right">       double t = (yeardec-1955.5)/100.0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // n.dot for secular acceleration of the Moon in ELP2000-82B</td><td> </td><td class="right">       // n.dot for secular acceleration of the Moon in ELP2000-82B</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // have value -23.8946 "/cy/cy</td><td> </td><td class="right">       // have value -23.8946 "/cy/cy</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0015" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       return -0.91072 * (-23.8946 + <span class="delete">std::a</span>bs(nd))*t*t;</td><td> </td><td class="rblock">       return -0.91072 * (-23.8946 + <span class="insert">qA</span>bs(nd))*t*t;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">double getDeltaTStandardError(const double jDay)</td><td> </td><td class="right">double getDeltaTStandardError(const double jDay)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       int year, month, day;</td><td> </td><td class="right">       int year, month, day;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       getDateFromJulianDay(jDay, &amp;year, &amp;month, &amp;day);</td><td> </td><td class="right">       getDateFromJulianDay(jDay, &amp;year, &amp;month, &amp;day);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       //double yeardec=year+((month-1)*30.5+day/31*30.5)/366;</td><td> </td><td class="right">       //double yeardec=year+((month-1)*30.5+day/31*30.5)/366;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double sigma = -1.;</td><td> </td><td class="right">       double sigma = -1.;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l10" /><small>skipping to change at</small><em> line 1942</em></th><th> </th><th><a name="part-r10" /><small>skipping to change at</small><em> line 1949</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               *--cos_sin_rev =  cos_sin[-1];</td><td> </td><td class="right">               *--cos_sin_rev =  cos_sin[-1];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               *--cos_sin_rev = -cos_sin[-2];</td><td> </td><td class="right">               *--cos_sin_rev = -cos_sin[-2];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return cos_sin_rho;</td><td> </td><td class="right">       return cos_sin_rho;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//! Compute cosines and sines around part of a circle (from top to bottom) 
which is split in "segments" parts.</td><td> </td><td class="right">//! Compute cosines and sines around part of a circle (from top to bottom) 
which is split in "segments" parts.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//! Values are stored in the global static array cos_sin_rho.</td><td> </td><td class="right">//! Values are stored in the global static array cos_sin_rho.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//! Used for the sin/cos values along a meridian.</td><td> </td><td class="right">//! Used for the sin/cos values along a meridian.</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0016" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">//! <span class="delete">GZ: allow leaving away pole caps. The array now contains values for the
</span> region minAngle+segments*phi</td><td> </td><td class="rblock">//! <span class="insert">This allows leaving away pole caps. The array now contains values for t
he</span> region minAngle+segments*phi</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//! @param dRho a difference angle between the stops</td><td> </td><td class="right">//! @param dRho a difference angle between the stops</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//! @param segments number of segments</td><td> </td><td class="right">//! @param segments number of segments</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//! @param minAngle start angle inside the half-circle. maxAngle=minAngle+s
egments*phi</td><td> </td><td class="right">//! @param minAngle start angle inside the half-circle. maxAngle=minAngle+s
egments*phi</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">float *ComputeCosSinRhoZone(const float dRho, const int segments, const flo
at minAngle)</td><td> </td><td class="right">float *ComputeCosSinRhoZone(const float dRho, const int segments, const flo
at minAngle)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       float *cos_sin = cos_sin_rho;</td><td> </td><td class="right">       float *cos_sin = cos_sin_rho;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       const float c = cos(dRho);</td><td> </td><td class="right">       const float c = cos(dRho);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       const float s = sin(dRho);</td><td> </td><td class="right">       const float s = sin(dRho);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       *cos_sin++ = cos(minAngle);</td><td> </td><td class="right">       *cos_sin++ = cos(minAngle);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       *cos_sin++ = sin(minAngle);</td><td> </td><td class="right">       *cos_sin++ = sin(minAngle);</td><td class="lineno" valign="top"></td></tr>

     <tr><td></td><td class="left"></td><td> </td><td class="right"></td><td></td></tr>
     <tr bgcolor="gray"><th colspan="5" align="center"><a name="end">&nbsp;End of changes. 16 change blocks.&nbsp;</a></th></tr>
     <tr class="stats"><td></td><th><i>29 lines changed or deleted</i></th><th><i> </i></th><th><i>36 lines changed or added</i></th><td></td></tr>
     <tr><td colspan="5" align="center" class="small"><br/>This html diff was produced by rfcdiff 1.41. The latest version is available from <a href="http://www.tools.ietf.org/tools/rfcdiff/" >http://tools.ietf.org/tools/rfcdiff/</a> </td></tr>
   </table>
   </body>
   </html>
