<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
<!-- Generated by rfcdiff 1.41: rfcdiff  --> 
<!-- <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional" > -->
<!-- System: Linux fomalhaut.local 3.13.0-73-generic #116-Ubuntu SMP Fri Dec 4 15:31:30 UTC 2015 x86_64 x86_64 x86_64 GNU/Linux --> 
<!-- Using awk: /usr/bin/gawk: GNU Awk 4.0.1 --> 
<!-- Using diff: /usr/bin/diff: diff (GNU diffutils) 3.3 --> 
<!-- Using wdiff: /usr/bin/wdiff: wdiff (GNU wdiff) 1.2.1 --> 
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"> 
<head> 
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 
  <meta http-equiv="Content-Style-Type" content="text/css" /> 
  <title>Diff: StelMovementMgr.cpp - StelMovementMgr.cpp</title> 
  <style type="text/css"> 
    body    { font-size:16px; margin: 0.4ex; margin-right: auto; } 
    tr      { } 
    td      { white-space: pre; font-family: Consolas, "DejaVu Sans Mono", "Droid Sans Mono", Monaco, Monospace; vertical-align: top; font-size: 0.86em;} 
    th      { font-size: 0.86em; } 
    .small  { font-size: 0.6em; font-style: italic; font-family: Verdana, Helvetica, sans-serif; } 
    .left   { background-color: #EEE; } 
    .right  { background-color: #FFF; } 
    .diff   { background-color: #CCF; } 
    .lblock { background-color: #BFB; } 
    .rblock { background-color: #FF8; } 
    .insert { background-color: #8FF; } 
    .delete { background-color: #ACF; } 
    .void   { background-color: #FFB; } 
    .cont   { background-color: #EEE; } 
    .linebr { background-color: #AAA; } 
    .lineno { color: red; background-color: #FFF; font-size: 0.7em; text-align: right; padding: 0 2px; } 
    .elipsis{ background-color: #AAA; } 
    .left .cont { background-color: #DDD; } 
    .right .cont { background-color: #EEE; } 
    .lblock .cont { background-color: #9D9; } 
    .rblock .cont { background-color: #DD6; } 
    .insert .cont { background-color: #0DD; } 
    .delete .cont { background-color: #8AD; } 
    .stats, .stats td, .stats th { background-color: #EEE; padding: 2px 0; } 
  </style> 
</head> 
<body > 
  <table border="0" cellpadding="0" cellspacing="0"> 
  <tr bgcolor="orange"><th></th><th>&nbsp;StelMovementMgr.cpp&nbsp;</th><th> </th><th>&nbsp;StelMovementMgr.cpp&nbsp;</th><th></th></tr> 
      <tr><td class="lineno" valign="top"></td><td class="left">/*</td><td> </td><td class="right">/*</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"> * Stellarium</td><td> </td><td class="right"> * Stellarium</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"> * Copyright (C) 2007 Fabien Chereau</td><td> </td><td class="right"> * Copyright (C) 2007 Fabien Chereau</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0001" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"> * Copyright (C) 2015 Georg Zotti (offset view adaptations)</td><td> </td><td class="rblock"> * Copyright (C) 2015 Georg Zotti (offset view adaptations<span class="insert">, Up vector fixes
</span>)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"> *</td><td> </td><td class="right"> *</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"> * This program is free software; you can redistribute it and/or</td><td> </td><td class="right"> * This program is free software; you can redistribute it and/or</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"> * modify it under the terms of the GNU General Public License</td><td> </td><td class="right"> * modify it under the terms of the GNU General Public License</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"> * as published by the Free Software Foundation; either version 2</td><td> </td><td class="right"> * as published by the Free Software Foundation; either version 2</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"> * of the License, or (at your option) any later version.</td><td> </td><td class="right"> * of the License, or (at your option) any later version.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"> *</td><td> </td><td class="right"> *</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"> * This program is distributed in the hope that it will be useful,</td><td> </td><td class="right"> * This program is distributed in the hope that it will be useful,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</td><td> </td><td class="right"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</td><td> </td><td class="right"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"> * GNU General Public License for more details.</td><td> </td><td class="right"> * GNU General Public License for more details.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l2" /><small>skipping to change at</small><em> line 47</em></th><th> </th><th><a name="part-r2" /><small>skipping to change at</small><em> line 47</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">StelMovementMgr::StelMovementMgr(StelCore* acore)</td><td> </td><td class="right">StelMovementMgr::StelMovementMgr(StelCore* acore)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       : currentFov(60.)</td><td> </td><td class="right">       : currentFov(60.)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       , initFov(60.)</td><td> </td><td class="right">       , initFov(60.)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       , minFov(0.001389)</td><td> </td><td class="right">       , minFov(0.001389)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       , maxFov(100.)</td><td> </td><td class="right">       , maxFov(100.)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       , initConstellationIntensity(0.45)</td><td> </td><td class="right">       , initConstellationIntensity(0.45)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       , core(acore)</td><td> </td><td class="right">       , core(acore)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       , objectMgr(NULL)</td><td> </td><td class="right">       , objectMgr(NULL)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       , flagLockEquPos(false)</td><td> </td><td class="right">       , flagLockEquPos(false)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       , flagTracking(false)</td><td> </td><td class="right">       , flagTracking(false)</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0002" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       , flagInhibitAllAutomoves(false)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       , isMouseMovingHoriz(false)</td><td> </td><td class="right">       , isMouseMovingHoriz(false)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       , isMouseMovingVert(false)</td><td> </td><td class="right">       , isMouseMovingVert(false)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       , flagEnableMoveAtScreenEdge(false)</td><td> </td><td class="right">       , flagEnableMoveAtScreenEdge(false)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       , flagEnableMouseNavigation(true)</td><td> </td><td class="right">       , flagEnableMouseNavigation(true)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       , mouseZoomSpeed(30)</td><td> </td><td class="right">       , mouseZoomSpeed(30)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       , flagEnableZoomKeys(true)</td><td> </td><td class="right">       , flagEnableZoomKeys(true)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       , flagEnableMoveKeys(true)</td><td> </td><td class="right">       , flagEnableMoveKeys(true)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       , keyMoveSpeed(0.00025)</td><td> </td><td class="right">       , keyMoveSpeed(0.00025)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       , keyZoomSpeed(0.00025)</td><td> </td><td class="right">       , keyZoomSpeed(0.00025)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       , flagMoveSlow(false)</td><td> </td><td class="right">       , flagMoveSlow(false)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       , movementsSpeedFactor(1.5)</td><td> </td><td class="right">       , movementsSpeedFactor(1.5)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       , flagAutoMove(false)</td><td> </td><td class="right">       , flagAutoMove(false)</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0003" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       , zoomingMode(<span class="delete">0</span>)</td><td> </td><td class="rblock">       , zoomingMode(<span class="insert">ZoomNone</span>)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       , deltaFov(0.)</td><td> </td><td class="right">       , deltaFov(0.)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       , deltaAlt(0.)</td><td> </td><td class="right">       , deltaAlt(0.)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       , deltaAz(0.)</td><td> </td><td class="right">       , deltaAz(0.)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       , flagManualZoom(false)</td><td> </td><td class="right">       , flagManualZoom(false)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       , autoMoveDuration(1.5)</td><td> </td><td class="right">       , autoMoveDuration(1.5)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       , hasDragged(false)</td><td> </td><td class="right">       , hasDragged(false)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       , previousX(0)</td><td> </td><td class="right">       , previousX(0)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       , previousY(0)</td><td> </td><td class="right">       , previousY(0)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       , beforeTimeDragTimeRate(0.)</td><td> </td><td class="right">       , beforeTimeDragTimeRate(0.)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       , dragTimeMode(false)</td><td> </td><td class="right">       , dragTimeMode(false)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       , zoomMove()</td><td> </td><td class="right">       , zoomMove()</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       , flagAutoZoom(0)</td><td> </td><td class="right">       , flagAutoZoom(0)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       , flagAutoZoomOutResetsDirection(0)</td><td> </td><td class="right">       , flagAutoZoomOutResetsDirection(0)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       , dragTriggerDistance(4.f)</td><td> </td><td class="right">       , dragTriggerDistance(4.f)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       setObjectName("StelMovementMgr");</td><td> </td><td class="right">       setObjectName("StelMovementMgr");</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       isDragging = false;</td><td> </td><td class="right">       isDragging = false;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       mountMode = MountAltAzimuthal;  // default</td><td> </td><td class="right">       mountMode = MountAltAzimuthal;  // default</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0004" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       upVectorMountFrame.set(0<span class="delete">,0,1</span>);</td><td> </td><td class="rblock">       upVectorMountFrame.set(0<span class="insert">.,0.,1.</span>);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">StelMovementMgr::~StelMovementMgr()</td><td> </td><td class="right">StelMovementMgr::~StelMovementMgr()</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void StelMovementMgr::init()</td><td> </td><td class="right">void StelMovementMgr::init()</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       QSettings* conf = StelApp::getInstance().getSettings();</td><td> </td><td class="right">       QSettings* conf = StelApp::getInstance().getSettings();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       objectMgr = GETSTELMODULE(StelObjectMgr);</td><td> </td><td class="right">       objectMgr = GETSTELMODULE(StelObjectMgr);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l3" /><small>skipping to change at</small><em> line 112</em></th><th> </th><th><a name="part-r3" /><small>skipping to change at</small><em> line 113</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       flagManualZoom = conf-&gt;value("navigation/flag_manual_zoom").toBool()
;</td><td> </td><td class="right">       flagManualZoom = conf-&gt;value("navigation/flag_manual_zoom").toBool()
;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       flagAutoZoomOutResetsDirection = conf-&gt;value("navigation/auto_zoom_o
ut_resets_direction", true).toBool();</td><td> </td><td class="right">       flagAutoZoomOutResetsDirection = conf-&gt;value("navigation/auto_zoom_o
ut_resets_direction", true).toBool();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       flagEnableMouseNavigation = conf-&gt;value("navigation/flag_enable_mous
e_navigation",true).toBool();</td><td> </td><td class="right">       flagEnableMouseNavigation = conf-&gt;value("navigation/flag_enable_mous
e_navigation",true).toBool();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       minFov = conf-&gt;value("navigation/min_fov",0.001389).toDouble(); // d
efault: minimal FOV = 5"</td><td> </td><td class="right">       minFov = conf-&gt;value("navigation/min_fov",0.001389).toDouble(); // d
efault: minimal FOV = 5"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       maxFov = 100.;</td><td> </td><td class="right">       maxFov = 100.;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       initFov = conf-&gt;value("navigation/init_fov",60.f).toFloat();</td><td> </td><td class="right">       initFov = conf-&gt;value("navigation/init_fov",60.f).toFloat();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       currentFov = initFov;</td><td> </td><td class="right">       currentFov = initFov;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       setInitConstellationIntensity(conf-&gt;value("viewing/constellation_art
_intensity", 0.5f).toFloat());</td><td> </td><td class="right">       setInitConstellationIntensity(conf-&gt;value("viewing/constellation_art
_intensity", 0.5f).toFloat());</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0005" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       <span class="insert">// With a special code of init_view_position=x/y/2 you can set zenit</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">h into the center and atan2(x/y) to bottom of screen.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       // examples: 1/0-&gt;0             (-1/0)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       //           -1/0 -&gt;180         (1/0)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       //            0/-1 --&gt; 90       (0/-1)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       //            0/1  -&gt;270        (0/1)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       Vec3f tmp = StelUtils::strToVec3f(conf-&gt;value("navigation/init_view_
pos").toString());</td><td> </td><td class="right">       Vec3f tmp = StelUtils::strToVec3f(conf-&gt;value("navigation/init_view_
pos").toString());</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0006" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       initViewPos.set(tmp[0], tmp[1], tmp[2]);</td><td> </td><td class="rblock">       <span class="insert">if (tmp[2]==2)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       viewDirectionJ2000 = core-&gt;altAzToJ2000(initViewPos, <span class="delete">StelCore::Refra</span></td><td> </td><td class="rblock"><span class="insert">       {</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">ctionOff);</span></td><td> </td><td class="rblock"><span class="insert">               initViewPos.set(0., 0., 1.);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               setViewUpVector(Vec3d(tmp[0], tmp[1], 0.));</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               setViewDirectionJ2000(core-&gt;altAzToJ2000(Vec3d(0., 0., 1.), </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">StelCore::RefractionOff));</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       else</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       {</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">               initViewPos.set(tmp[0], tmp[1], tmp[2]);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">               viewDirectionJ2000 = core-&gt;altAzToJ2000(initViewPos, <span class="insert">StelCor</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">e::RefractionOff);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       QString tmpstr = conf-&gt;value("navigation/viewing_mode", "horizon").t
oString();</td><td> </td><td class="right">       QString tmpstr = conf-&gt;value("navigation/viewing_mode", "horizon").t
oString();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (tmpstr=="equator")</td><td> </td><td class="right">       if (tmpstr=="equator")</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               setMountMode(StelMovementMgr::MountEquinoxEquatorial);</td><td> </td><td class="right">               setMountMode(StelMovementMgr::MountEquinoxEquatorial);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       else</td><td> </td><td class="right">       else</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               if (tmpstr=="horizon")</td><td> </td><td class="right">               if (tmpstr=="horizon")</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       setMountMode(StelMovementMgr::MountAltAzimuthal);</td><td> </td><td class="right">                       setMountMode(StelMovementMgr::MountAltAzimuthal);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               else</td><td> </td><td class="right">               else</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0007" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       qWarning() &lt;&lt; "ERROR<span class="delete"> : Unknown viewing mode type : "
 &lt;</span>&lt; tmpstr;</td><td> </td><td class="rblock">                       qWarning() &lt;&lt; "ERROR<span class="insert">: Unknown viewing mode type: " &lt;
</span>&lt; tmpstr;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       setMountMode(StelMovementMgr::MountEquinoxEquatorial
);</td><td> </td><td class="right">                       setMountMode(StelMovementMgr::MountEquinoxEquatorial
);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       QString movementGroup = N_("Movement and Selection");</td><td> </td><td class="right">       QString movementGroup = N_("Movement and Selection");</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       addAction("actionSwitch_Equatorial_Mount", N_("Miscellaneous"), N_("
Switch between equatorial and azimuthal mount"), "equatorialMount", "Ctrl+M
");</td><td> </td><td class="right">       addAction("actionSwitch_Equatorial_Mount", N_("Miscellaneous"), N_("
Switch between equatorial and azimuthal mount"), "equatorialMount", "Ctrl+M
");</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       addAction("actionGoto_Selected_Object", movementGroup, N_("Center on
 selected object"), "setFlagTracking()", "Space");</td><td> </td><td class="right">       addAction("actionGoto_Selected_Object", movementGroup, N_("Center on
 selected object"), "setFlagTracking()", "Space");</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       addAction("actionZoom_In_Auto", movementGroup, N_("Zoom in on select
ed object"), "autoZoomIn()", "/");</td><td> </td><td class="right">       addAction("actionZoom_In_Auto", movementGroup, N_("Zoom in on select
ed object"), "autoZoomIn()", "/");</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       addAction("actionZoom_Out_Auto", movementGroup, N_("Zoom out"), "aut
oZoomOut()", "\\");</td><td> </td><td class="right">       addAction("actionZoom_Out_Auto", movementGroup, N_("Zoom out"), "aut
oZoomOut()", "\\");</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       addAction("actionSet_Tracking", movementGroup, N_("Track object"), "
tracking", "T");</td><td> </td><td class="right">       addAction("actionSet_Tracking", movementGroup, N_("Track object"), "
tracking", "T");</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void StelMovementMgr::setMountMode(MountMode m)</td><td> </td><td class="right">void StelMovementMgr::setMountMode(MountMode m)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       mountMode = m;</td><td> </td><td class="right">       mountMode = m;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       setViewDirectionJ2000(viewDirectionJ2000);</td><td> </td><td class="right">       setViewDirectionJ2000(viewDirectionJ2000);</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0008" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       <span class="insert">// TODO: Decide whether re-setting Up-vector is required here.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       // setViewUpVector(Vec3d(0., 0., 1.));</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void StelMovementMgr::setFlagLockEquPos(bool b)</td><td> </td><td class="right">void StelMovementMgr::setFlagLockEquPos(bool b)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       flagLockEquPos=b;</td><td> </td><td class="right">       flagLockEquPos=b;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void StelMovementMgr::setViewUpVectorJ2000(const Vec3d&amp; up)</td><td> </td><td class="right">void StelMovementMgr::setViewUpVectorJ2000(const Vec3d&amp; up)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       upVectorMountFrame = j2000ToMountFrame(up);</td><td> </td><td class="right">       upVectorMountFrame = j2000ToMountFrame(up);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0009" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">// For simplicity you can set this directly. Take care when looking into po</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">les like zenith in altaz mode:</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">// We have a problem if alt=+/-90degrees: view and up angles are ill-define</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">d (actually, angle between them=0 and therefore we saw shaky rounding effec</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">ts), therefore Bug LP:1068529</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">void StelMovementMgr::setViewUpVector(const Vec3d&amp; up)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">{</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       upVectorMountFrame = up;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">}</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                           </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">Vec3d StelMovementMgr::getViewUpVectorJ2000() const</td><td> </td><td class="right">Vec3d StelMovementMgr::getViewUpVectorJ2000() const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return mountFrameToJ2000(upVectorMountFrame);</td><td> </td><td class="right">       return mountFrameToJ2000(upVectorMountFrame);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">bool StelMovementMgr::handleMouseMoves(int x, int y, Qt::MouseButtons)</td><td> </td><td class="right">bool StelMovementMgr::handleMouseMoves(int x, int y, Qt::MouseButtons)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // Turn if the mouse is at the edge of the screen unless config asks
 otherwise</td><td> </td><td class="right">       // Turn if the mouse is at the edge of the screen unless config asks
 otherwise</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (flagEnableMoveAtScreenEdge)</td><td> </td><td class="right">       if (flagEnableMoveAtScreenEdge)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l4" /><small>skipping to change at</small><em> line 197</em></th><th> </th><th><a name="part-r4" /><small>skipping to change at</small><em> line 221</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       turnDown(1);</td><td> </td><td class="right">                       turnDown(1);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       isMouseMovingVert = true;</td><td> </td><td class="right">                       isMouseMovingVert = true;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               else if (isMouseMovingVert)</td><td> </td><td class="right">               else if (isMouseMovingVert)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       turnUp(0);</td><td> </td><td class="right">                       turnUp(0);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       isMouseMovingVert = false;</td><td> </td><td class="right">                       isMouseMovingVert = false;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0010" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       <span class="insert">// We can hardly use the mouse exactly enough to go to the zenith/po</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">le. Any mouse motion can safely reset the simplified up vector.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       setViewUpVector(Vec3d(0., 0., 1.));</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                           </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (isDragging &amp;&amp; flagEnableMouseNavigation)</td><td> </td><td class="right">       if (isDragging &amp;&amp; flagEnableMouseNavigation)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               if (hasDragged || (std::sqrt((float)((x-previousX)*(x-previo
usX) +(y-previousY)*(y-previousY)))&gt;dragTriggerDistance))</td><td> </td><td class="right">               if (hasDragged || (std::sqrt((float)((x-previousX)*(x-previo
usX) +(y-previousY)*(y-previousY)))&gt;dragTriggerDistance))</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       hasDragged = true;</td><td> </td><td class="right">                       hasDragged = true;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       setFlagTracking(false);</td><td> </td><td class="right">                       setFlagTracking(false);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       dragView(previousX, previousY, x, y);</td><td> </td><td class="right">                       dragView(previousX, previousY, x, y);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       previousX = x;</td><td> </td><td class="right">                       previousX = x;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       previousY = y;</td><td> </td><td class="right">                       previousY = y;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       return true;</td><td> </td><td class="right">                       return true;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l5" /><small>skipping to change at</small><em> line 261</em></th><th> </th><th><a name="part-r5" /><small>skipping to change at</small><em> line 288</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       case Qt::Key_Space:</td><td> </td><td class="right">                       case Qt::Key_Space:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               if (event-&gt;modifiers().testFlag(Qt::ControlM
odifier))</td><td> </td><td class="right">                               if (event-&gt;modifiers().testFlag(Qt::ControlM
odifier))</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       setDragTimeMode(true);</td><td> </td><td class="right">                                       setDragTimeMode(true);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               break;</td><td> </td><td class="right">                               break;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       default:</td><td> </td><td class="right">                       default:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               return;</td><td> </td><td class="right">                               return;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       else</td><td> </td><td class="right">       else</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0011" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               // When a deplacement key is released stop mo<span class="delete">o</span>ving</td><td> </td><td class="rblock">               // When a deplacement key is released stop moving</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               switch (event-&gt;key())</td><td> </td><td class="right">               switch (event-&gt;key())</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       case Qt::Key_Left:</td><td> </td><td class="right">                       case Qt::Key_Left:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               turnLeft(false); break;</td><td> </td><td class="right">                               turnLeft(false); break;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       case Qt::Key_Right:</td><td> </td><td class="right">                       case Qt::Key_Right:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               turnRight(false); break;</td><td> </td><td class="right">                               turnRight(false); break;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       case Qt::Key_Up:</td><td> </td><td class="right">                       case Qt::Key_Up:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               zoomIn(false);</td><td> </td><td class="right">                               zoomIn(false);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               turnUp(false);</td><td> </td><td class="right">                               turnUp(false);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               break;</td><td> </td><td class="right">                               break;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l6" /><small>skipping to change at</small><em> line 283</em></th><th> </th><th><a name="part-r6" /><small>skipping to change at</small><em> line 310</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               zoomOut(false);</td><td> </td><td class="right">                               zoomOut(false);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               turnDown(false);</td><td> </td><td class="right">                               turnDown(false);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               break;</td><td> </td><td class="right">                               break;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       case Qt::Key_PageUp:</td><td> </td><td class="right">                       case Qt::Key_PageUp:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               zoomIn(false); break;</td><td> </td><td class="right">                               zoomIn(false); break;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       case Qt::Key_PageDown:</td><td> </td><td class="right">                       case Qt::Key_PageDown:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               zoomOut(false); break;</td><td> </td><td class="right">                               zoomOut(false); break;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       case Qt::Key_Shift:</td><td> </td><td class="right">                       case Qt::Key_Shift:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               moveSlow(false); break;</td><td> </td><td class="right">                               moveSlow(false); break;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       case Qt::Key_Control:</td><td> </td><td class="right">                       case Qt::Key_Control:</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0012" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                               // This <span class="delete">an be all that is seen for anything 
</span>with control, so stop them all.</td><td> </td><td class="rblock">                               // This <span class="insert">can be all that is seen for anything
 </span>with control, so stop them all.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               // This is true for 4.8.1</td><td> </td><td class="right">                               // This is true for 4.8.1</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               turnRight(false);</td><td> </td><td class="right">                               turnRight(false);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               turnLeft(false);</td><td> </td><td class="right">                               turnLeft(false);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               zoomIn(false);</td><td> </td><td class="right">                               zoomIn(false);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               zoomOut(false);</td><td> </td><td class="right">                               zoomOut(false);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               turnDown(false);</td><td> </td><td class="right">                               turnDown(false);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               turnUp(false);</td><td> </td><td class="right">                               turnUp(false);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               setDragTimeMode(false);</td><td> </td><td class="right">                               setDragTimeMode(false);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               break;</td><td> </td><td class="right">                               break;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       default:</td><td> </td><td class="right">                       default:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l7" /><small>skipping to change at</small><em> line 602</em></th><th> </th><th><a name="part-r7" /><small>skipping to change at</small><em> line 629</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (deltaFov != 0 )</td><td> </td><td class="right">       if (deltaFov != 0 )</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               changeFov(deltaFov);</td><td> </td><td class="right">               changeFov(deltaFov);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       panView(deltaAz, deltaAlt);</td><td> </td><td class="right">       panView(deltaAz, deltaAlt);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       updateAutoZoom(deltaTime);</td><td> </td><td class="right">       updateAutoZoom(deltaTime);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void StelMovementMgr::updateVisionVector(double deltaTime)</td><td> </td><td class="right">void StelMovementMgr::updateVisionVector(double deltaTime)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0013" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       <span class="insert">// Specialized setups cannot use this functionality!</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       if (flagInhibitAllAutomoves)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               return;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                           </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (flagAutoMove)</td><td> </td><td class="right">       if (flagAutoMove)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               if (!move.targetObject.isNull())</td><td> </td><td class="right">               if (!move.targetObject.isNull())</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       // if zooming in, object may be moving so be sure to
 zoom to latest position</td><td> </td><td class="right">                       // if zooming in, object may be moving so be sure to
 zoom to latest position</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       // In case we have offset center, we want object sti
ll visible in center.</td><td> </td><td class="right">                       // In case we have offset center, we want object sti
ll visible in center.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       // Note that if we do not center on an object, we se
t view direction of the potentially offset screen center!</td><td> </td><td class="right">                       // Note that if we do not center on an object, we se
t view direction of the potentially offset screen center!</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       // This is by design, to allow accurate setting of d
isplay coordinates.</td><td> </td><td class="right">                       // This is by design, to allow accurate setting of d
isplay coordinates.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       Vec3d v;</td><td> </td><td class="right">                       Vec3d v;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       switch (mountMode)</td><td> </td><td class="right">                       switch (mountMode)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l8" /><small>skipping to change at</small><em> line 625</em></th><th> </th><th><a name="part-r8" /><small>skipping to change at</small><em> line 656</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       break;</td><td> </td><td class="right">                                       break;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               case MountEquinoxEquatorial:</td><td> </td><td class="right">                               case MountEquinoxEquatorial:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       v = move.targetObject-&gt;getEquinoxEqu
atorialPos(core);</td><td> </td><td class="right">                                       v = move.targetObject-&gt;getEquinoxEqu
atorialPos(core);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       break;</td><td> </td><td class="right">                                       break;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               case MountGalactic:</td><td> </td><td class="right">                               case MountGalactic:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       v = move.targetObject-&gt;getGalacticPo
s(core);</td><td> </td><td class="right">                                       v = move.targetObject-&gt;getGalacticPo
s(core);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       break;</td><td> </td><td class="right">                                       break;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               default:</td><td> </td><td class="right">                               default:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       qWarning() &lt;&lt; "StelMovementMgr: unex
pected mountMode" &lt;&lt; mountMode;</td><td> </td><td class="right">                                       qWarning() &lt;&lt; "StelMovementMgr: unex
pected mountMode" &lt;&lt; mountMode;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       Q_ASSERT(0);</td><td> </td><td class="right">                                       Q_ASSERT(0);</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0014" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                                       v = move.targetObject-&gt;getAltAzPosAu
to(core); // still do something useful</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       }</td><td> </td><td class="right">                       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       double lat, lon;</td><td> </td><td class="right">                       double lat, lon;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       StelUtils::rectToSphe(&amp;lon, &amp;lat, v);</td><td> </td><td class="right">                       StelUtils::rectToSphe(&amp;lon, &amp;lat, v);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       float altOffset=core-&gt;getCurrentStelProjectorParams(
).viewportCenterOffset[1]*currentFov*M_PI/180.0f;</td><td> </td><td class="right">                       float altOffset=core-&gt;getCurrentStelProjectorParams(
).viewportCenterOffset[1]*currentFov*M_PI/180.0f;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       lat+=altOffset;</td><td> </td><td class="right">                       lat+=altOffset;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       StelUtils::spheToRect(lon, lat, v);</td><td> </td><td class="right">                       StelUtils::spheToRect(lon, lat, v);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       move.aim=mountFrameToJ2000(v);</td><td> </td><td class="right">                       move.aim=mountFrameToJ2000(v);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       move.aim.normalize();</td><td> </td><td class="right">                       move.aim.normalize();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       move.aim*=2.;</td><td> </td><td class="right">                       move.aim*=2.;</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0015" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                       <span class="insert">// For aiming at objects, we can assume simple up ve</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">ctor.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       move.startUp=getViewUpVectorJ2000();</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       move.aimUp=mountFrameToJ2000(Vec3d(0., 0., 1.));</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               move.coef+=move.speed*deltaTime*1000;</td><td> </td><td class="right">               move.coef+=move.speed*deltaTime*1000;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               if (move.coef&gt;=1.)</td><td> </td><td class="right">               if (move.coef&gt;=1.)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0016" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                       <span class="insert">setViewUpVectorJ2000(move.aimUp);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       //qDebug() &lt;&lt; "AutoMove finished. Setting Up vector </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">(in mount frame) to " &lt;&lt; upVectorMountFrame.v[0] &lt;&lt; "/" &lt;&lt; upVectorMountFra</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">me.v[1] &lt;&lt; "/" &lt;&lt; upVectorMountFrame.v[2];</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       flagAutoMove=false;</td><td> </td><td class="right">                       flagAutoMove=false;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       move.coef=1.;</td><td> </td><td class="right">                       move.coef=1.;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0017" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">               <span class="insert">else</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       setViewUpVectorJ2000(move.startUp*(1.-move.coef) + m</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">ove.aimUp*move.coef);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               // Use a smooth function</td><td> </td><td class="right">               // Use a smooth function</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               float smooth = 4.f;</td><td> </td><td class="right">               float smooth = 4.f;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               double c;</td><td> </td><td class="right">               double c;</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0018" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               if (zoomingMode==<span class="delete">1</span>)</td><td> </td><td class="rblock">               if (zoomingMode==<span class="insert">ZoomIn</span>)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       if (move.coef&gt;.9)</td><td> </td><td class="right">                       if (move.coef&gt;.9)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       {</td><td> </td><td class="right">                       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               c = 1.;</td><td> </td><td class="right">                               c = 1.;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       }</td><td> </td><td class="right">                       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       else</td><td> </td><td class="right">                       else</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       {</td><td> </td><td class="right">                       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               c = 1. - pow(1.-1.11*move.coef,3.);</td><td> </td><td class="right">                               c = 1. - pow(1.-1.11*move.coef,3.);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       }</td><td> </td><td class="right">                       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0019" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               else if (zoomingMode==<span class="delete">-1</span>)</td><td> </td><td class="rblock">               else if (zoomingMode==<span class="insert">ZoomOut</span>)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       if (move.coef&lt;0.1)</td><td> </td><td class="right">                       if (move.coef&lt;0.1)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       {</td><td> </td><td class="right">                       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               // keep in view at first as zoom out</td><td> </td><td class="right">                               // keep in view at first as zoom out</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               c = 0;</td><td> </td><td class="right">                               c = 0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       }</td><td> </td><td class="right">                       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       else</td><td> </td><td class="right">                       else</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       {</td><td> </td><td class="right">                       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               c =  pow(1.11*(move.coef-.1),3.);</td><td> </td><td class="right">                               c =  pow(1.11*(move.coef-.1),3.);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       }</td><td> </td><td class="right">                       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l9" /><small>skipping to change at</small><em> line 695</em></th><th> </th><th><a name="part-r9" /><small>skipping to change at</small><em> line 734</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               else if (ra_aim-ra_start &lt; -M_PI)</td><td> </td><td class="right">               else if (ra_aim-ra_start &lt; -M_PI)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       ra_aim += 2.*M_PI;</td><td> </td><td class="right">                       ra_aim += 2.*M_PI;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               const double de_now = de_aim*c + de_start*(1.-c);</td><td> </td><td class="right">               const double de_now = de_aim*c + de_start*(1.-c);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               const double ra_now = ra_aim*c + ra_start*(1.-c);</td><td> </td><td class="right">               const double ra_now = ra_aim*c + ra_start*(1.-c);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               Vec3d tmp;</td><td> </td><td class="right">               Vec3d tmp;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               StelUtils::spheToRect(ra_now, de_now, tmp);</td><td> </td><td class="right">               StelUtils::spheToRect(ra_now, de_now, tmp);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               setViewDirectionJ2000(mountFrameToJ2000(tmp));</td><td> </td><td class="right">               setViewDirectionJ2000(mountFrameToJ2000(tmp));</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0020" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               // qDebug() &lt;&lt; "setting view direction to " &lt;&lt; tmp.v[0] &lt;&lt; "
/" &lt;&lt; tmp.v[1] &lt;&lt; "/" &lt;&lt; tmp.v[2];</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       else</td><td> </td><td class="right">       else</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               if (flagTracking &amp;&amp; objectMgr-&gt;getWasSelected()) // Equatori
al vision vector locked on selected object</td><td> </td><td class="right">               if (flagTracking &amp;&amp; objectMgr-&gt;getWasSelected()) // Equatori
al vision vector locked on selected object</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       Vec3d v;</td><td> </td><td class="right">                       Vec3d v;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       switch (mountMode)</td><td> </td><td class="right">                       switch (mountMode)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       {</td><td> </td><td class="right">                       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               case MountAltAzimuthal:</td><td> </td><td class="right">                               case MountAltAzimuthal:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       v = objectMgr-&gt;getSelectedObject()[0
]-&gt;getAltAzPosAuto(core);</td><td> </td><td class="right">                                       v = objectMgr-&gt;getSelectedObject()[0
]-&gt;getAltAzPosAuto(core);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       break;</td><td> </td><td class="right">                                       break;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               case MountEquinoxEquatorial:</td><td> </td><td class="right">                               case MountEquinoxEquatorial:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       v = objectMgr-&gt;getSelectedObject()[0
]-&gt;getEquinoxEquatorialPos(core);</td><td> </td><td class="right">                                       v = objectMgr-&gt;getSelectedObject()[0
]-&gt;getEquinoxEquatorialPos(core);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       break;</td><td> </td><td class="right">                                       break;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               case MountGalactic:</td><td> </td><td class="right">                               case MountGalactic:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       v = objectMgr-&gt;getSelectedObject()[0
]-&gt;getGalacticPos(core);</td><td> </td><td class="right">                                       v = objectMgr-&gt;getSelectedObject()[0
]-&gt;getGalacticPos(core);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       break;</td><td> </td><td class="right">                                       break;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               default:</td><td> </td><td class="right">                               default:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       qWarning() &lt;&lt; "StelMovementMgr: unex
pected mountMode" &lt;&lt; mountMode;</td><td> </td><td class="right">                                       qWarning() &lt;&lt; "StelMovementMgr: unex
pected mountMode" &lt;&lt; mountMode;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       Q_ASSERT(0);</td><td> </td><td class="right">                                       Q_ASSERT(0);</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0021" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                                       v = move.targetObject-&gt;getAltAzPosAu
to(core); // still do something useful in release build</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       }</td><td> </td><td class="right">                       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       double lat, lon; // general: longitudinal, latitudin
al</td><td> </td><td class="right">                       double lat, lon; // general: longitudinal, latitudin
al</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       StelUtils::rectToSphe(&amp;lon, &amp;lat, v);</td><td> </td><td class="right">                       StelUtils::rectToSphe(&amp;lon, &amp;lat, v);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       float latOffset=core-&gt;getCurrentStelProjectorParams(
).viewportCenterOffset[1]*currentFov*M_PI/180.0f;</td><td> </td><td class="right">                       float latOffset=core-&gt;getCurrentStelProjectorParams(
).viewportCenterOffset[1]*currentFov*M_PI/180.0f;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       lat+=latOffset;</td><td> </td><td class="right">                       lat+=latOffset;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       StelUtils::spheToRect(lon, lat, v);</td><td> </td><td class="right">                       StelUtils::spheToRect(lon, lat, v);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       setViewDirectionJ2000(mountFrameToJ2000(v));</td><td> </td><td class="right">                       setViewDirectionJ2000(mountFrameToJ2000(v));</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0022" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       setViewUpVectorJ2000(mountFrameToJ2000(Vec3d(0., 0.,
 1.))); // Does not disturb to reassure this former default.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               else</td><td> </td><td class="right">               else</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       if (flagLockEquPos) // Equatorial vision vector lock
ed</td><td> </td><td class="right">                       if (flagLockEquPos) // Equatorial vision vector lock
ed</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       {</td><td> </td><td class="right">                       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               // Recalc local vision vector</td><td> </td><td class="right">                               // Recalc local vision vector</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               setViewDirectionJ2000(viewDirectionJ2000);</td><td> </td><td class="right">                               setViewDirectionJ2000(viewDirectionJ2000);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       }</td><td> </td><td class="right">                       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       else</td><td> </td><td class="right">                       else</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       {</td><td> </td><td class="right">                       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l10" /><small>skipping to change at</small><em> line 753</em></th><th> </th><th><a name="part-r10" /><small>skipping to change at</small><em> line 795</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (!objectMgr-&gt;getWasSelected())</td><td> </td><td class="right">       if (!objectMgr-&gt;getWasSelected())</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               return;</td><td> </td><td class="right">               return;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       moveDuration /= movementsSpeedFactor;</td><td> </td><td class="right">       moveDuration /= movementsSpeedFactor;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       float manualMoveDuration;</td><td> </td><td class="right">       float manualMoveDuration;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (!getFlagTracking())</td><td> </td><td class="right">       if (!getFlagTracking())</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               setFlagTracking(true); // includes a call to moveToObject(),
 but without zooming=1!</td><td> </td><td class="right">               setFlagTracking(true); // includes a call to moveToObject(),
 but without zooming=1!</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0023" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               moveToObject(objectMgr-&gt;getSelectedObject()[0], moveDuration
, <span class="delete">1</span>);</td><td> </td><td class="rblock">               moveToObject(objectMgr-&gt;getSelectedObject()[0], moveDuration
, <span class="insert">ZoomIn</span>);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               manualMoveDuration = moveDuration;</td><td> </td><td class="right">               manualMoveDuration = moveDuration;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       else</td><td> </td><td class="right">       else</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               // faster zoom in manual zoom mode once object is centered</td><td> </td><td class="right">               // faster zoom in manual zoom mode once object is centered</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               manualMoveDuration = moveDuration*.66f;</td><td> </td><td class="right">               manualMoveDuration = moveDuration*.66f;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if( allowManualZoom &amp;&amp; flagManualZoom )</td><td> </td><td class="right">       if( allowManualZoom &amp;&amp; flagManualZoom )</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l11" /><small>skipping to change at</small><em> line 836</em></th><th> </th><th><a name="part-r11" /><small>skipping to change at</small><em> line 878</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       else</td><td> </td><td class="right">       else</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               moveToObject(objectMgr-&gt;getSelectedObject()[0], getAutoMoveD
uration());</td><td> </td><td class="right">               moveToObject(objectMgr-&gt;getSelectedObject()[0], getAutoMoveD
uration());</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               flagTracking=true;</td><td> </td><td class="right">               flagTracking=true;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">///////////////////////////////////////////////////////////////////////////
/////</td><td> </td><td class="right">///////////////////////////////////////////////////////////////////////////
/////</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Move to the given J2000 equatorial position</td><td> </td><td class="right">// Move to the given J2000 equatorial position</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0024" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">void StelMovementMgr::moveToJ2000(const Vec3d&amp; aim, <span class="delete">float</span> moveDuration, <span class="delete">int</span></td><td> </td><td class="rblock"><span class="insert">// aim and aimUp must be in J2000 frame!</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"> zooming)</td><td> </td><td class="rblock">void StelMovementMgr::moveToJ2000(const Vec3d&amp; aim, <span class="insert">const Vec3d&amp; aimUp, flo</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">at</span> moveDuration, <span class="insert">ZoomingMode</span> zooming)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       moveDuration /= movementsSpeedFactor;</td><td> </td><td class="right">       moveDuration /= movementsSpeedFactor;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       zoomingMode = zooming;</td><td> </td><td class="right">       zoomingMode = zooming;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       move.aim=aim;</td><td> </td><td class="right">       move.aim=aim;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       move.aim.normalize();</td><td> </td><td class="right">       move.aim.normalize();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       move.aim*=2.;</td><td> </td><td class="right">       move.aim*=2.;</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0025" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       <span class="insert">move.aimUp=aimUp; // the new up vector. We cannot simply keep vertic</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">al axis, there may be the intention to look into the zenith or so.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       move.aimUp.normalize();</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       move.start=viewDirectionJ2000;</td><td> </td><td class="right">       move.start=viewDirectionJ2000;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       move.start.normalize();</td><td> </td><td class="right">       move.start.normalize();</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0026" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       <span class="insert">move.startUp=getViewUpVectorJ2000();</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       move.startUp.normalize();</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       move.speed=1.f/(moveDuration*1000);</td><td> </td><td class="right">       move.speed=1.f/(moveDuration*1000);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       move.coef=0.;</td><td> </td><td class="right">       move.coef=0.;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       move.targetObject.clear();</td><td> </td><td class="right">       move.targetObject.clear();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       flagAutoMove = true;</td><td> </td><td class="right">       flagAutoMove = true;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0027" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">void StelMovementMgr::moveToObject(const StelObjectP&amp; target, float moveDur
ation, <span class="delete">int</span> zooming)</td><td> </td><td class="rblock">void StelMovementMgr::moveToObject(const StelObjectP&amp; target, float moveDur
ation, <span class="insert">ZoomingMode</span> zooming)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       moveDuration /= movementsSpeedFactor;</td><td> </td><td class="right">       moveDuration /= movementsSpeedFactor;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       zoomingMode = zooming;</td><td> </td><td class="right">       zoomingMode = zooming;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       move.aim=Vec3d(0);</td><td> </td><td class="right">       move.aim=Vec3d(0);</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0028" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       <span class="insert">move.aimUp=mountFrameToJ2000(Vec3d(0., 0., 1.)); // the new up vecto</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">r. We try simply vertical axis here. (Should be same as pre-0.15)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       move.aimUp.normalize();</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       move.start=viewDirectionJ2000;</td><td> </td><td class="right">       move.start=viewDirectionJ2000;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       move.start.normalize();</td><td> </td><td class="right">       move.start.normalize();</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0029" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       <span class="insert">move.startUp=getViewUpVectorJ2000();</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       move.startUp.normalize();</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       move.speed=1.f/(moveDuration*1000);</td><td> </td><td class="right">       move.speed=1.f/(moveDuration*1000);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       move.coef=0.;</td><td> </td><td class="right">       move.coef=0.;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       move.targetObject = target;</td><td> </td><td class="right">       move.targetObject = target;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       flagAutoMove = true;</td><td> </td><td class="right">       flagAutoMove = true;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">Vec3d StelMovementMgr::j2000ToMountFrame(const Vec3d&amp; v) const</td><td> </td><td class="right">Vec3d StelMovementMgr::j2000ToMountFrame(const Vec3d&amp; v) const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       switch (mountMode)</td><td> </td><td class="right">       switch (mountMode)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l12" /><small>skipping to change at</small><em> line 905</em></th><th> </th><th><a name="part-r12" /><small>skipping to change at</small><em> line 956</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void StelMovementMgr::setViewDirectionJ2000(const Vec3d&amp; v)</td><td> </td><td class="right">void StelMovementMgr::setViewDirectionJ2000(const Vec3d&amp; v)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       core-&gt;lookAtJ2000(v, getViewUpVectorJ2000());</td><td> </td><td class="right">       core-&gt;lookAtJ2000(v, getViewUpVectorJ2000());</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       viewDirectionJ2000 = v;</td><td> </td><td class="right">       viewDirectionJ2000 = v;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       viewDirectionMountFrame = j2000ToMountFrame(v);</td><td> </td><td class="right">       viewDirectionMountFrame = j2000ToMountFrame(v);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void StelMovementMgr::panView(const double deltaAz, const double deltaAlt)</td><td> </td><td class="right">void StelMovementMgr::panView(const double deltaAz, const double deltaAlt)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0030" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       <span class="insert">// The function is called in update loops, so make a quick check for</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"> exit.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       if ((deltaAz==0.) &amp;&amp; (deltaAlt==0.))</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               return;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                           </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double azVision, altVision;</td><td> </td><td class="right">       double azVision, altVision;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       StelUtils::rectToSphe(&amp;azVision,&amp;altVision,j2000ToMountFrame(viewDir
ectionJ2000));</td><td> </td><td class="right">       StelUtils::rectToSphe(&amp;azVision,&amp;altVision,j2000ToMountFrame(viewDir
ectionJ2000));</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0031" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       <span class="insert">// Az is counted from South, eastward.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       // qDebug() &lt;&lt; "Azimuth:" &lt;&lt; azVision * 180./M_PI &lt;&lt; "Altitude:" &lt;&lt; </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">altVision * 180./M_PI &lt;&lt; "Up.X=" &lt;&lt; upVectorMountFrame.v[0] &lt;&lt; "Up.Y=" &lt;&lt; u</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">pVectorMountFrame.v[1] &lt;&lt; "Up.Z=" &lt;&lt; upVectorMountFrame.v[2];</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       // if we are just looking into the pole, azimuth can hopefully be re</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">covered from the customized up vector!</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       // When programmatically centering on a pole, we should have set a b</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">etter up vector for |alt|&gt;0.9*M_PI/2.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       if (fabs(altVision)&gt; 0.95* M_PI/2.)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       {</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               if (upVectorMountFrame.v[2] &lt; 0.9)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               {</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       // qDebug() &lt;&lt; "Recovering azimuth...";</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       azVision=atan2(-upVectorMountFrame.v[1], -upVectorMo</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">untFrame.v[0]);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       if (altVision &lt; 0.)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                               azVision+=M_PI;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">//             else</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">//             {</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">//                     // qDebug() &lt;&lt; "UpVector:" &lt;&lt; upVectorMountFrame.v[0</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">] &lt;&lt; "/" &lt;&lt; upVectorMountFrame.v[1] &lt;&lt; "/" &lt;&lt; upVectorMountFrame.v[2] &lt;&lt; "C</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">annot recover azimuth. Hope it's OK";</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">//             }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // if we are moving in the Azimuthal angle (left/right)</td><td> </td><td class="right">       // if we are moving in the Azimuthal angle (left/right)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (deltaAz)</td><td> </td><td class="right">       if (deltaAz)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               azVision-=deltaAz;</td><td> </td><td class="right">               azVision-=deltaAz;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (deltaAlt)</td><td> </td><td class="right">       if (deltaAlt)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               if (altVision+deltaAlt &lt;= M_PI_2 &amp;&amp; altVision+deltaAlt &gt;= -M
_PI_2) altVision+=deltaAlt;</td><td> </td><td class="right">               if (altVision+deltaAlt &lt;= M_PI_2 &amp;&amp; altVision+deltaAlt &gt;= -M
_PI_2) altVision+=deltaAlt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               if (altVision+deltaAlt &gt; M_PI_2) altVision = M_PI_2 - 0.0000
01;         // Prevent bug</td><td> </td><td class="right">               if (altVision+deltaAlt &gt; M_PI_2) altVision = M_PI_2 - 0.0000
01;         // Prevent bug</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               if (altVision+deltaAlt &lt; -M_PI_2) altVision = -M_PI_2 + 0.00
0001;       // Prevent bug</td><td> </td><td class="right">               if (altVision+deltaAlt &lt; -M_PI_2) altVision = -M_PI_2 + 0.00
0001;       // Prevent bug</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // recalc all the position variables</td><td> </td><td class="right">       // recalc all the position variables</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (deltaAz || deltaAlt)</td><td> </td><td class="right">       if (deltaAz || deltaAlt)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               setFlagTracking(false);</td><td> </td><td class="right">               setFlagTracking(false);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               Vec3d tmp;</td><td> </td><td class="right">               Vec3d tmp;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               StelUtils::spheToRect(azVision, altVision, tmp);</td><td> </td><td class="right">               StelUtils::spheToRect(azVision, altVision, tmp);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               setViewDirectionJ2000(mountFrameToJ2000(tmp));</td><td> </td><td class="right">               setViewDirectionJ2000(mountFrameToJ2000(tmp));</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0032" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               setViewUpVector(Vec3d(0., 0., 1.)); // We ensured above that
 view vector is never parallel to this simple up vector.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//! Make the first screen position correspond to the second (useful for mou
se dragging)</td><td> </td><td class="right">//! Make the first screen position correspond to the second (useful for mou
se dragging)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void StelMovementMgr::dragView(int x1, int y1, int x2, int y2)</td><td> </td><td class="right">void StelMovementMgr::dragView(int x1, int y1, int x2, int y2)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (dragTimeMode)</td><td> </td><td class="right">       if (dragTimeMode)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               core-&gt;setTimeRate(0);</td><td> </td><td class="right">               core-&gt;setTimeRate(0);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               Vec3d v1, v2;</td><td> </td><td class="right">               Vec3d v1, v2;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l13" /><small>skipping to change at</small><em> line 993</em></th><th> </th><th><a name="part-r13" /><small>skipping to change at</small><em> line 1069</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       flagAutoZoom = 0;</td><td> </td><td class="right">                       flagAutoZoom = 0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       newFov=zoomMove.aimFov;</td><td> </td><td class="right">                       newFov=zoomMove.aimFov;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               setFov(newFov); // updates currentFov-&gt;don't use newFov late
r!</td><td> </td><td class="right">               setFov(newFov); // updates currentFov-&gt;don't use newFov late
r!</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               // In case we have offset center, we want object still visib
le in center.</td><td> </td><td class="right">               // In case we have offset center, we want object still visib
le in center.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               if (flagTracking &amp;&amp; objectMgr-&gt;getWasSelected()) // vision v
ector locked on selected object</td><td> </td><td class="right">               if (flagTracking &amp;&amp; objectMgr-&gt;getWasSelected()) // vision v
ector locked on selected object</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0033" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       Vec3d v;</td><td> </td><td class="rblock">                       Vec3d v<span class="insert">, vUp</span>;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       switch (mountMode)</td><td> </td><td class="right">                       switch (mountMode)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       {</td><td> </td><td class="right">                       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               case MountAltAzimuthal:</td><td> </td><td class="right">                               case MountAltAzimuthal:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       v = objectMgr-&gt;getSelectedObject()[0
]-&gt;getAltAzPosAuto(core);</td><td> </td><td class="right">                                       v = objectMgr-&gt;getSelectedObject()[0
]-&gt;getAltAzPosAuto(core);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       break;</td><td> </td><td class="right">                                       break;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               case MountEquinoxEquatorial:</td><td> </td><td class="right">                               case MountEquinoxEquatorial:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       v = objectMgr-&gt;getSelectedObject()[0
]-&gt;getEquinoxEquatorialPos(core);</td><td> </td><td class="right">                                       v = objectMgr-&gt;getSelectedObject()[0
]-&gt;getEquinoxEquatorialPos(core);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       break;</td><td> </td><td class="right">                                       break;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               case MountGalactic:</td><td> </td><td class="right">                               case MountGalactic:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       v = objectMgr-&gt;getSelectedObject()[0
]-&gt;getGalacticPos(core);</td><td> </td><td class="right">                                       v = objectMgr-&gt;getSelectedObject()[0
]-&gt;getGalacticPos(core);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       break;</td><td> </td><td class="right">                                       break;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               default:</td><td> </td><td class="right">                               default:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       qWarning() &lt;&lt; "StelMovementMgr: unex
pected mountMode" &lt;&lt; mountMode;</td><td> </td><td class="right">                                       qWarning() &lt;&lt; "StelMovementMgr: unex
pected mountMode" &lt;&lt; mountMode;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       Q_ASSERT(0);</td><td> </td><td class="right">                                       Q_ASSERT(0);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       }</td><td> </td><td class="right">                       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       double lat, lon; // general: longitudinal, latitudin
al</td><td> </td><td class="right">                       double lat, lon; // general: longitudinal, latitudin
al</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0034" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       StelUtils::rectToSphe(&amp;lon, &amp;lat, v);</td><td> </td><td class="rblock">                       StelUtils::rectToSphe(&amp;lon, &amp;lat, v); <span class="insert">// guaranteed </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">to be normalized.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       // vUp could usually be (0/0/1) in most cases, unles</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">s |lat|==pi/2. We MUST build an adequate Up vector!</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       if (fabs(lat)&gt;0.9*M_PI/2.0)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       {</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                               vUp = Vec3d(-cos(lon), -sin(lon), 0.) * (lat</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">&gt;0. ? 1. : -1. );</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                       else</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                               vUp.set(0.,0.,1.);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       float latOffset=core-&gt;getCurrentStelProjectorParams(
).viewportCenterOffset[1]*currentFov*M_PI/180.0f;</td><td> </td><td class="right">                       float latOffset=core-&gt;getCurrentStelProjectorParams(
).viewportCenterOffset[1]*currentFov*M_PI/180.0f;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       lat+=latOffset;</td><td> </td><td class="right">                       lat+=latOffset;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       StelUtils::spheToRect(lon, lat, v);</td><td> </td><td class="right">                       StelUtils::spheToRect(lon, lat, v);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       if (flagAutoMove)</td><td> </td><td class="right">                       if (flagAutoMove)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       {</td><td> </td><td class="right">                       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               move.aim=mountFrameToJ2000(v);</td><td> </td><td class="right">                               move.aim=mountFrameToJ2000(v);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               move.aim.normalize();</td><td> </td><td class="right">                               move.aim.normalize();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               move.aim*=2.;</td><td> </td><td class="right">                               move.aim*=2.;</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0035" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                               <span class="insert">move.aimUp=mountFrameToJ2000(vUp);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                               move.aimUp.normalize();</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       }</td><td> </td><td class="right">                       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       else</td><td> </td><td class="right">                       else</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       {</td><td> </td><td class="right">                       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               setViewDirectionJ2000(mountFrameToJ2000(v));</td><td> </td><td class="right">                               setViewDirectionJ2000(mountFrameToJ2000(v));</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0036" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                               setViewUpVectorJ2000(mountFrameToJ2000(vUp))
;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       }</td><td> </td><td class="right">                       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Zoom to the given field of view</td><td> </td><td class="right">// Zoom to the given field of view</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void StelMovementMgr::zoomTo(double aim_fov, float moveDuration)</td><td> </td><td class="right">void StelMovementMgr::zoomTo(double aim_fov, float moveDuration)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       moveDuration /= movementsSpeedFactor;</td><td> </td><td class="right">       moveDuration /= movementsSpeedFactor;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l14" /><small>skipping to change at</small><em> line 1052</em></th><th> </th><th><a name="part-r14" /><small>skipping to change at</small><em> line 1138</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void StelMovementMgr::changeFov(double deltaFov)</td><td> </td><td class="right">void StelMovementMgr::changeFov(double deltaFov)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // if we are zooming in or out</td><td> </td><td class="right">       // if we are zooming in or out</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (deltaFov)</td><td> </td><td class="right">       if (deltaFov)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               setFov(currentFov + deltaFov);</td><td> </td><td class="right">               setFov(currentFov + deltaFov);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void StelMovementMgr::changeConstellationArtIntensity()</td><td> </td><td class="right">void StelMovementMgr::changeConstellationArtIntensity()</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       ConstellationMgr *cmgr = GETSTELMODULE(ConstellationMgr);</td><td> </td><td class="right">       ConstellationMgr *cmgr = GETSTELMODULE(ConstellationMgr);</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0037" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       <span class="insert">// During startup this may not have been initialized yet!</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       if (!cmgr)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               return;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                           </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (cmgr-&gt;getFlagArt())</td><td> </td><td class="right">       if (cmgr-&gt;getFlagArt())</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               double artInt = getInitConstellationIntensity();</td><td> </td><td class="right">               double artInt = getInitConstellationIntensity();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               // Fade out constellation art when FOV less 2 degrees</td><td> </td><td class="right">               // Fade out constellation art when FOV less 2 degrees</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               if (currentFov&lt;=2.)</td><td> </td><td class="right">               if (currentFov&lt;=2.)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       artInt *= currentFov&gt;1.? (currentFov-1.) : 0. ;</td><td> </td><td class="right">                       artInt *= currentFov&gt;1.? (currentFov-1.) : 0. ;</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0038" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                       cmgr-&gt;setArtIntensity(artInt);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0039" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               cmgr-&gt;setArtIntensity(artInt);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">double StelMovementMgr::getAimFov(void) const</td><td> </td><td class="right">double StelMovementMgr::getAimFov(void) const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return (flagAutoZoom ? zoomMove.aimFov : currentFov);</td><td> </td><td class="right">       return (flagAutoZoom ? zoomMove.aimFov : currentFov);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void StelMovementMgr::setMaxFov(double max)</td><td> </td><td class="right">void StelMovementMgr::setMaxFov(double max)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>

     <tr><td></td><td class="left"></td><td> </td><td class="right"></td><td></td></tr>
     <tr bgcolor="gray"><th colspan="5" align="center"><a name="end">&nbsp;End of changes. 39 change blocks.&nbsp;</a></th></tr>
     <tr class="stats"><td></td><th><i>18 lines changed or deleted</i></th><th><i> </i></th><th><i>131 lines changed or added</i></th><td></td></tr>
     <tr><td colspan="5" align="center" class="small"><br/>This html diff was produced by rfcdiff 1.41. The latest version is available from <a href="http://www.tools.ietf.org/tools/rfcdiff/" >http://tools.ietf.org/tools/rfcdiff/</a> </td></tr>
   </table>
   </body>
   </html>
