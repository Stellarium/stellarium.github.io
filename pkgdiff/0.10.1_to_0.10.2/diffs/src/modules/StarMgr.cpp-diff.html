<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
<!-- Generated by rfcdiff 1.41: rfcdiff  --> 
<!-- <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional" > -->
<!-- System: Linux fomalhaut.local 3.13.0-38-generic #65-Ubuntu SMP Thu Oct 9 11:36:50 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux --> 
<!-- Using awk: /usr/bin/gawk: GNU Awk 4.0.1 --> 
<!-- Using diff: /usr/bin/diff: diff (GNU diffutils) 3.3 --> 
<!-- Using wdiff: /usr/bin/wdiff: wdiff (GNU wdiff) 1.2.1 --> 
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"> 
<head> 
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /> 
  <meta http-equiv="Content-Style-Type" content="text/css" /> 
  <title>Diff: StarMgr.cpp - StarMgr.cpp</title> 
  <style type="text/css"> 
    body    { font-size:16px; margin: 0.4ex; margin-right: auto; } 
    tr      { } 
    td      { white-space: pre; font-family: Consolas, "DejaVu Sans Mono", "Droid Sans Mono", Monaco, Monospace; vertical-align: top; font-size: 0.86em;} 
    th      { font-size: 0.86em; } 
    .small  { font-size: 0.6em; font-style: italic; font-family: Verdana, Helvetica, sans-serif; } 
    .left   { background-color: #EEE; } 
    .right  { background-color: #FFF; } 
    .diff   { background-color: #CCF; } 
    .lblock { background-color: #BFB; } 
    .rblock { background-color: #FF8; } 
    .insert { background-color: #8FF; } 
    .delete { background-color: #ACF; } 
    .void   { background-color: #FFB; } 
    .cont   { background-color: #EEE; } 
    .linebr { background-color: #AAA; } 
    .lineno { color: red; background-color: #FFF; font-size: 0.7em; text-align: right; padding: 0 2px; } 
    .elipsis{ background-color: #AAA; } 
    .left .cont { background-color: #DDD; } 
    .right .cont { background-color: #EEE; } 
    .lblock .cont { background-color: #9D9; } 
    .rblock .cont { background-color: #DD6; } 
    .insert .cont { background-color: #0DD; } 
    .delete .cont { background-color: #8AD; } 
    .stats, .stats td, .stats th { background-color: #EEE; padding: 2px 0; } 
  </style> 
</head> 
<body > 
  <table border="0" cellpadding="0" cellspacing="0"> 
  <tr bgcolor="orange"><th></th><th>&nbsp;StarMgr.cpp&nbsp;</th><th> </th><th>&nbsp;StarMgr.cpp&nbsp;</th><th></th></tr> 
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l1" /><small>skipping to change at</small><em> line 70</em></th><th> </th><th><a name="part-r1" /><small>skipping to change at</small><em> line 70</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#include &lt;list&gt;</td><td> </td><td class="right">#include &lt;list&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#include &lt;errno.h&gt;</td><td> </td><td class="right">#include &lt;errno.h&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">#include &lt;unistd.h&gt;</td><td> </td><td class="right">#include &lt;unistd.h&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">using namespace BigStarCatalogExtension;</td><td> </td><td class="right">using namespace BigStarCatalogExtension;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">static QStringList spectral_array;</td><td> </td><td class="right">static QStringList spectral_array;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">static QStringList component_array;</td><td> </td><td class="right">static QStringList component_array;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0001" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">// Initialise statics</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">bool StarMgr::flagSciNames = true;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">std::map&lt;int,QString&gt; StarMgr::commonNamesMap;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">std::map&lt;int,QString&gt; StarMgr::commonNamesMapI18n;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">std::map&lt;QString,int&gt; StarMgr::commonNamesIndex;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">std::map&lt;QString,int&gt; StarMgr::commonNamesIndexI18n;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">std::map&lt;int,QString&gt; StarMgr::sciNamesMapI18n;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">std::map&lt;QString,int&gt; StarMgr::sciNamesIndexI18n;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                           </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">QStringList initStringListFromFile(const QString&amp; file_name)</td><td> </td><td class="right">QStringList initStringListFromFile(const QString&amp; file_name)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       QStringList list;</td><td> </td><td class="right">       QStringList list;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       QFile f(file_name);</td><td> </td><td class="right">       QFile f(file_name);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (f.open(QIODevice::ReadOnly | QIODevice::Text))</td><td> </td><td class="right">       if (f.open(QIODevice::ReadOnly | QIODevice::Text))</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               while (!f.atEnd())</td><td> </td><td class="right">               while (!f.atEnd())</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       QString s = QString::fromUtf8(f.readLine());</td><td> </td><td class="right">                       QString s = QString::fromUtf8(f.readLine());</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       s.chop(1);</td><td> </td><td class="right">                       s.chop(1);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l2" /><small>skipping to change at</small><em> line 115</em></th><th> </th><th><a name="part-r2" /><small>skipping to change at</small><em> line 124</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void StarMgr::initTriangle(int lev,int index,</td><td> </td><td class="right">void StarMgr::initTriangle(int lev,int index,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                           const Vec3d &amp;c0,</td><td> </td><td class="right">                           const Vec3d &amp;c0,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                           const Vec3d &amp;c1,</td><td> </td><td class="right">                           const Vec3d &amp;c1,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                           const Vec3d &amp;c2) {</td><td> </td><td class="right">                           const Vec3d &amp;c2) {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">  ZoneArrayMap::const_iterator it(zoneArrays.find(lev));</td><td> </td><td class="right">  ZoneArrayMap::const_iterator it(zoneArrays.find(lev));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">  if (it!=zoneArrays.end()) it-&gt;second-&gt;initTriangle(index,c0,c1,c2);</td><td> </td><td class="right">  if (it!=zoneArrays.end()) it-&gt;second-&gt;initTriangle(index,c0,c1,c2);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0002" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">StarMgr::StarMgr(void) :</td><td> </td><td class="rblock">StarMgr::StarMgr(void) : hipIndex(new HipIndexStruct[NR_OF_HIP+1]), <span class="insert">fontSiz</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    hipIndex(new HipIndexStruct[NR_OF_HIP+1]),</td><td> </td><td class="rblock"><span class="insert">e(13.), starFont(NULL)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">fontSize(13.),</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">    starFont(0)</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       setObjectName("StarMgr");</td><td> </td><td class="right">       setObjectName("StarMgr");</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0003" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">  if (hipIndex == 0) {</td><td> </td><td class="rblock">       if (hipIndex == 0)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    <span class="delete">qWarning() &lt;&lt; "ERROR:</span> StarMgr::StarMgr: no <span class="delete">memory";</span></td><td> </td><td class="rblock">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">    exit(1);</span></td><td> </td><td class="rblock">               <span class="insert">qFatal("ERROR:</span> StarMgr::StarMgr: no <span class="insert">memory");</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">  }</td><td> </td><td class="rblock">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">  maxGeodesicGridLevel = -1;</td><td> </td><td class="rblock">       maxGeodesicGridLevel = -1;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">  lastMaxSearchLevel = -1;</td><td> </td><td class="rblock">       lastMaxSearchLevel = -1;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       <span class="insert">objectMgr = GETSTELMODULE(StelObjectMgr);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       Q_ASSERT(objectMgr);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">/*************************************************************************</td><td> </td><td class="right">/*************************************************************************</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"> Reimplementation of the getCallOrder method</td><td> </td><td class="right"> Reimplementation of the getCallOrder method</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">*************************************************************************/</td><td> </td><td class="right">*************************************************************************/</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">double StarMgr::getCallOrder(StelModuleActionName actionName) const</td><td> </td><td class="right">double StarMgr::getCallOrder(StelModuleActionName actionName) const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (actionName==StelModule::ActionDraw)</td><td> </td><td class="right">       if (actionName==StelModule::ActionDraw)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               return StelApp::getInstance().getModuleMgr().getModule("Cons
tellationMgr")-&gt;getCallOrder(actionName)+10;</td><td> </td><td class="right">               return StelApp::getInstance().getModuleMgr().getModule("Cons
tellationMgr")-&gt;getCallOrder(actionName)+10;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return 0;</td><td> </td><td class="right">       return 0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l3" /><small>skipping to change at</small><em> line 155</em></th><th> </th><th><a name="part-r3" /><small>skipping to change at</small><em> line 163</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               --it;</td><td> </td><td class="right">               --it;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               delete it-&gt;second;</td><td> </td><td class="right">               delete it-&gt;second;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               it-&gt;second = NULL;</td><td> </td><td class="right">               it-&gt;second = NULL;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       zoneArrays.clear();</td><td> </td><td class="right">       zoneArrays.clear();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (hipIndex)</td><td> </td><td class="right">       if (hipIndex)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               delete[] hipIndex;</td><td> </td><td class="right">               delete[] hipIndex;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0004" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">bool StarMgr::flagSciNames = true;</span></td><td> </td><td class="rblock">QString StarMgr::getCommonName(int hip)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">double StarMgr::currentJDay = 0;</span></td><td> </td><td class="rblock">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">std::map&lt;int,QString&gt; StarMgr::commonNamesMap;</span></td><td> </td><td class="rblock">       std::map&lt;int,QString&gt;::const_iterator <span class="insert">it(commonNamesMapI18n.find(hip</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">std::map&lt;int,QString&gt; StarMgr::commonNamesMapI18n;</span></td><td> </td><td class="rblock"><span class="insert">));</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">std::map&lt;QString,int&gt; StarMgr::commonNamesIndex;</span></td><td> </td><td class="rblock">       if (it!=commonNamesMapI18n.end())</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">std::map&lt;QString,int&gt; StarMgr::commonNamesIndexI18n;</span></td><td> </td><td class="rblock">               return it-&gt;second;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock">       return <span class="insert">QString();</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">std::map&lt;int,QString&gt; StarMgr::sciNamesMapI18n;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">std::map&lt;QString,int&gt; StarMgr::sciNamesIndexI18n;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                           </td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">QString StarMgr::getCommonName(int hip) {</td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">  std::map&lt;int,QString&gt;::const_iterator <span class="delete">it(commonNamesMapI18n.find(hip));</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">  if (it!=commonNamesMapI18n.end()) return it-&gt;second;</td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">  return <span class="delete">"";</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0005" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">QString StarMgr::getSciName(int hip) {</td><td> </td><td class="rblock">QString StarMgr::getSciName(int hip)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">  std::map&lt;int,QString&gt;::const_iterator it(sciNamesMapI18n.find(hip));</td><td> </td><td class="rblock">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">  if (it!=sciNamesMapI18n.end()) return it-&gt;second;</td><td> </td><td class="rblock">       std::map&lt;int,QString&gt;::const_iterator it(sciNamesMapI18n.find(hip));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">  return <span class="delete">"";</span></td><td> </td><td class="rblock">       if (it!=sciNamesMapI18n.end())</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">               return it-&gt;second;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       return <span class="insert">QString();</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void StarMgr::init()</td><td> </td><td class="right">void StarMgr::init()</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       QSettings* conf = StelApp::getInstance().getSettings();</td><td> </td><td class="right">       QSettings* conf = StelApp::getInstance().getSettings();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       Q_ASSERT(conf);</td><td> </td><td class="right">       Q_ASSERT(conf);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       loadStarSettings();</td><td> </td><td class="right">       loadStarSettings();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       loadData();</td><td> </td><td class="right">       loadData();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       double fontSize = 12;</td><td> </td><td class="right">       double fontSize = 12;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       starFont = &amp;StelApp::getInstance().getFontManager().getStandardFont(
StelApp::getInstance().getLocaleMgr().getSkyLanguage(), fontSize);</td><td> </td><td class="right">       starFont = &amp;StelApp::getInstance().getFontManager().getStandardFont(
StelApp::getInstance().getLocaleMgr().getSkyLanguage(), fontSize);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       setFlagStars(conf-&gt;value("astro/flag_stars", true).toBool());</td><td> </td><td class="right">       setFlagStars(conf-&gt;value("astro/flag_stars", true).toBool());</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       setFlagLabels(conf-&gt;value("astro/flag_star_name",true).toBool());</td><td> </td><td class="right">       setFlagLabels(conf-&gt;value("astro/flag_star_name",true).toBool());</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       setLabelsAmount(conf-&gt;value("stars/labels_amount",3).toDouble());</td><td> </td><td class="right">       setLabelsAmount(conf-&gt;value("stars/labels_amount",3).toDouble());</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0006" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">StelApp::getInstance().getStelObjectMgr().registerStelObjectMgr(this
</span>);</td><td> </td><td class="rblock">       <span class="insert">objectMgr-&gt;registerStelObjectMgr(this</span>);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       StelApp::getInstance().getTextureManager().setDefaultParams();</td><td> </td><td class="right">       StelApp::getInstance().getTextureManager().setDefaultParams();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       StelApp::getInstance().getTextureManager().setMinFilter(GL_LINEAR);</td><td> </td><td class="right">       StelApp::getInstance().getTextureManager().setMinFilter(GL_LINEAR);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       texPointer = StelApp::getInstance().getTextureManager().createTextur
e("pointeur2.png");   // Load pointer texture</td><td> </td><td class="right">       texPointer = StelApp::getInstance().getTextureManager().createTextur
e("pointeur2.png");   // Load pointer texture</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       StelApp::getInstance().getCore()-&gt;getGeodesicGrid(maxGeodesicGridLev
el)-&gt;visitTriangles(maxGeodesicGridLevel,initTriangleFunc,this);</td><td> </td><td class="right">       StelApp::getInstance().getCore()-&gt;getGeodesicGrid(maxGeodesicGridLev
el)-&gt;visitTriangles(maxGeodesicGridLevel,initTriangleFunc,this);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       for (ZoneArrayMap::const_iterator it(zoneArrays.begin()); it!=zoneAr
rays.end();it++)</td><td> </td><td class="right">       for (ZoneArrayMap::const_iterator it(zoneArrays.begin()); it!=zoneAr
rays.end();it++)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               it-&gt;second-&gt;scaleAxis();</td><td> </td><td class="right">               it-&gt;second-&gt;scaleAxis();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void StarMgr::drawPointer(const StelProjectorP&amp; prj, const StelNavigator * 
nav)</td><td> </td><td class="right">void StarMgr::drawPointer(const StelProjectorP&amp; prj, const StelNavigator * 
nav)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0007" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       const QList&lt;StelObjectP&gt; newSelected = <span class="delete">StelApp::getInstance().getSte
lObjectMgr().getSelectedObject(</span>"Star");</td><td> </td><td class="rblock">       const QList&lt;StelObjectP&gt; newSelected = <span class="insert">objectMgr-&gt;getSelectedObject(
</span>"Star");</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (!newSelected.empty())</td><td> </td><td class="right">       if (!newSelected.empty())</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               const StelObjectP obj = newSelected[0];</td><td> </td><td class="right">               const StelObjectP obj = newSelected[0];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               Vec3d pos=obj-&gt;getJ2000EquatorialPos(nav);</td><td> </td><td class="right">               Vec3d pos=obj-&gt;getJ2000EquatorialPos(nav);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               Vec3d screenpos;</td><td> </td><td class="right">               Vec3d screenpos;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               // Compute 2D pos and return if outside screen</td><td> </td><td class="right">               // Compute 2D pos and return if outside screen</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               if (!prj-&gt;project(pos, screenpos))</td><td> </td><td class="right">               if (!prj-&gt;project(pos, screenpos))</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       return;</td><td> </td><td class="right">                       return;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               StelPainter sPainter(prj);</td><td> </td><td class="right">               StelPainter sPainter(prj);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l4" /><small>skipping to change at</small><em> line 361</em></th><th> </th><th><a name="part-r4" /><small>skipping to change at</small><em> line 363</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                  &lt;&lt; ("stars/default/" + cat_hip_cids_file_
name)</td><td> </td><td class="right">                                  &lt;&lt; ("stars/default/" + cat_hip_cids_file_
name)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                  &lt;&lt; ": " &lt;&lt; e.what();</td><td> </td><td class="right">                                  &lt;&lt; ": " &lt;&lt; e.what();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       lastMaxSearchLevel = maxGeodesicGridLevel;</td><td> </td><td class="right">       lastMaxSearchLevel = maxGeodesicGridLevel;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       qDebug() &lt;&lt; "Finished loading star catalogue data, max_geodesic_leve
l: " &lt;&lt; maxGeodesicGridLevel;</td><td> </td><td class="right">       qDebug() &lt;&lt; "Finished loading star catalogue data, max_geodesic_leve
l: " &lt;&lt; maxGeodesicGridLevel;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Load common names from file</td><td> </td><td class="right">// Load common names from file</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0008" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">int StarMgr::loadCommonNames(const QString&amp; commonNameFile) {</td><td> </td><td class="rblock">int StarMgr::loadCommonNames(const QString&amp; commonNameFile)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       commonNamesMap.clear();</td><td> </td><td class="right">       commonNamesMap.clear();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       commonNamesMapI18n.clear();</td><td> </td><td class="right">       commonNamesMapI18n.clear();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       commonNamesIndex.clear();</td><td> </td><td class="right">       commonNamesIndex.clear();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       commonNamesIndexI18n.clear();</td><td> </td><td class="right">       commonNamesIndexI18n.clear();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       qDebug() &lt;&lt; "Loading star names from" &lt;&lt; commonNameFile;</td><td> </td><td class="right">       qDebug() &lt;&lt; "Loading star names from" &lt;&lt; commonNameFile;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       QFile cnFile(commonNameFile);</td><td> </td><td class="right">       QFile cnFile(commonNameFile);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (!cnFile.open(QIODevice::ReadOnly | QIODevice::Text))</td><td> </td><td class="right">       if (!cnFile.open(QIODevice::ReadOnly | QIODevice::Text))</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               qWarning() &lt;&lt; "WARNING - could not open" &lt;&lt; commonNameFile;</td><td> </td><td class="right">               qWarning() &lt;&lt; "WARNING - could not open" &lt;&lt; commonNameFile;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l5" /><small>skipping to change at</small><em> line 518</em></th><th> </th><th><a name="part-r5" /><small>skipping to change at</small><em> line 521</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       sciNamesIndexI18n[sci_name_i18n_cap] = hip;</td><td> </td><td class="right">                       sciNamesIndexI18n[sci_name_i18n_cap] = hip;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       readOk++;</td><td> </td><td class="right">                       readOk++;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       snFile.close();</td><td> </td><td class="right">       snFile.close();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       qDebug() &lt;&lt; "Loaded" &lt;&lt; readOk &lt;&lt; "/" &lt;&lt; totalRecords &lt;&lt; "scientific
 star names";</td><td> </td><td class="right">       qDebug() &lt;&lt; "Loaded" &lt;&lt; readOk &lt;&lt; "/" &lt;&lt; totalRecords &lt;&lt; "scientific
 star names";</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">int StarMgr::getMaxSearchLevel() const</td><td> </td><td class="right">int StarMgr::getMaxSearchLevel() const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0009" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">  int rval = -1;</td><td> </td><td class="rblock">       int rval = -1;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">  for (ZoneArrayMap::const_iterator <span class="delete">it(zoneArrays.begin());</span></td><td> </td><td class="rblock">       for (ZoneArrayMap::const_iterator <span class="insert">it(zoneArrays.begin());it!=zoneArr</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       it!=zoneArrays.end();it++)</span> {</td><td> </td><td class="rblock"><span class="insert">ays.end();++it)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    const float mag_min = 0.001f*it-&gt;second-&gt;mag_min;</td><td> </td><td class="rblock">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    float rcmag[2];</td><td> </td><td class="rblock">               const float mag_min = 0.001f*it-&gt;second-&gt;mag_min;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    if <span class="delete">(StelApp::getInstance().getCore()-&gt;getSkyDrawer()-&gt;computeRCMag(mag_</span></td><td> </td><td class="rblock">               float rcmag[2];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">min,rcmag)==false)</span></td><td> </td><td class="rblock">               if <span class="insert">(StelApp::getInstance().getCore()-&gt;getSkyDrawer()-&gt;comput</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               break;</td><td> </td><td class="rblock"><span class="insert">eRCMag(mag_min,rcmag)==false)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    rval = it-&gt;first;</td><td> </td><td class="rblock">                       break;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">  }</td><td> </td><td class="rblock">               rval = it-&gt;first;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">  return rval;</td><td> </td><td class="rblock">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       return rval;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Draw all the stars</td><td> </td><td class="right">// Draw all the stars</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void StarMgr::draw(StelCore* core)</td><td> </td><td class="right">void StarMgr::draw(StelCore* core)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       StelNavigator* nav = core-&gt;getNavigator();</td><td> </td><td class="right">       StelNavigator* nav = core-&gt;getNavigator();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       const StelProjectorP prj = core-&gt;getProjection(StelCore::FrameJ2000)
;</td><td> </td><td class="right">       const StelProjectorP prj = core-&gt;getProjection(StelCore::FrameJ2000)
;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       StelSkyDrawer* skyDrawer = core-&gt;getSkyDrawer();</td><td> </td><td class="right">       StelSkyDrawer* skyDrawer = core-&gt;getSkyDrawer();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0010" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    <span class="delete">currentJDay = nav-&gt;getJDay();</span></td><td> </td><td class="rblock">       // If stars are turned off don't waste time below</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                           </td><td> </td><td class="rblock">       // projecting all stars just to draw disembodied labels</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    // If stars are turned off don't waste time below</td><td> </td><td class="rblock">       if (!starsFader.getInterstate())</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    // projecting all stars just to draw disembodied labels</td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    if (!starsFader.getInterstate())</td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               return;</td><td> </td><td class="right">               return;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       int maxSearchLevel = getMaxSearchLevel();</td><td> </td><td class="right">       int maxSearchLevel = getMaxSearchLevel();</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0011" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       const GeodesicSearchResult* geodesic_search_result = core-&gt;getGeodes
icGrid(maxSearchLevel)-&gt;search(prj-&gt;<span class="delete">unprojectViewport(),maxSearchLev</span>el);</td><td> </td><td class="rblock">       const GeodesicSearchResult* geodesic_search_result = core-&gt;getGeodes
icGrid(maxSearchLevel)-&gt;search(prj-&gt;<span class="insert">getViewportConvexPolygon(),maxSearchLev
</span>el);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0012" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    // Set temporary static variable for optimization</td><td> </td><td class="rblock">       // Set temporary static variable for optimization</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    const float names_brightness = labelsFader.getInterstate() * <span class="delete">starsFader</span></td><td> </td><td class="rblock">       const float names_brightness = labelsFader.getInterstate() * <span class="insert">starsFa</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">.getInterstate();</span></td><td> </td><td class="rblock"><span class="insert">der.getInterstate();</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // Prepare openGL for drawing many stars</td><td> </td><td class="right">       // Prepare openGL for drawing many stars</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       StelPainter* sPainter = new StelPainter(prj);</td><td> </td><td class="right">       StelPainter* sPainter = new StelPainter(prj);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       skyDrawer-&gt;preDrawPointSource(sPainter);</td><td> </td><td class="right">       skyDrawer-&gt;preDrawPointSource(sPainter);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       Q_ASSERT(sPainter);</td><td> </td><td class="right">       Q_ASSERT(sPainter);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0013" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    // draw all the stars of all the selected zones</td><td> </td><td class="rblock">       // draw all the stars of all the selected zones</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    float rcmag_table[2*256];</td><td> </td><td class="rblock">       float rcmag_table[2*256];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0014" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    <span class="delete">for (ZoneArrayMap::const_iterator it(zoneArrays.begin()); it!=zoneArray
</span>s.end();++it)</td><td> </td><td class="rblock">    <span class="insert">   for (ZoneArrayMap::const_iterator it(zoneArrays.begin()); it!=zoneAr
ray</span>s.end();++it)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               const float mag_min = 0.001f*it-&gt;second-&gt;mag_min;</td><td> </td><td class="right">               const float mag_min = 0.001f*it-&gt;second-&gt;mag_min;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               const float k = (0.001f*it-&gt;second-&gt;mag_range)/it-&gt;second-&gt;m
ag_steps;</td><td> </td><td class="right">               const float k = (0.001f*it-&gt;second-&gt;mag_range)/it-&gt;second-&gt;m
ag_steps;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               for (int i=it-&gt;second-&gt;mag_steps-1;i&gt;=0;--i)</td><td> </td><td class="right">               for (int i=it-&gt;second-&gt;mag_steps-1;i&gt;=0;--i)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       const float mag = mag_min+k*i;</td><td> </td><td class="right">                       const float mag = mag_min+k*i;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       if (skyDrawer-&gt;computeRCMag(mag,rcmag_table + 2*i)==
false)</td><td> </td><td class="right">                       if (skyDrawer-&gt;computeRCMag(mag,rcmag_table + 2*i)==
false)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       {</td><td> </td><td class="right">                       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               if (i==0) goto exit_loop;</td><td> </td><td class="right">                               if (i==0) goto exit_loop;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       }</td><td> </td><td class="right">                       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l6" /><small>skipping to change at</small><em> line 591</em></th><th> </th><th><a name="part-r6" /><small>skipping to change at</small><em> line 592</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               if (labelsFader.getInterstate()&gt;0.f)</td><td> </td><td class="right">               if (labelsFader.getInterstate()&gt;0.f)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       // Adapt magnitude limit of the stars labels accordi
ng to FOV and labelsAmount</td><td> </td><td class="right">                       // Adapt magnitude limit of the stars labels accordi
ng to FOV and labelsAmount</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       float maxMag = (skyDrawer-&gt;getLimitMagnitude()-6.5)*
0.7+(labelsAmount*1.2f)-2.f;</td><td> </td><td class="right">                       float maxMag = (skyDrawer-&gt;getLimitMagnitude()-6.5)*
0.7+(labelsAmount*1.2f)-2.f;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       int x = (int)((maxMag-mag_min)/k);</td><td> </td><td class="right">                       int x = (int)((maxMag-mag_min)/k);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       if (x &gt; 0)</td><td> </td><td class="right">                       if (x &gt; 0)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               maxMagStarName = x;</td><td> </td><td class="right">                               maxMagStarName = x;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               int zone;</td><td> </td><td class="right">               int zone;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               for (GeodesicSearchInsideIterator it1(*geodesic_search_resul
t,it-&gt;first);(zone = it1.next()) &gt;= 0;)</td><td> </td><td class="right">               for (GeodesicSearchInsideIterator it1(*geodesic_search_resul
t,it-&gt;first);(zone = it1.next()) &gt;= 0;)</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0015" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       it-&gt;second-&gt;draw(zone, true, rcmag_table, <span class="delete">prj, maxMa
</span>gStarName, names_brightness, starFont);</td><td> </td><td class="rblock">                       it-&gt;second-&gt;draw(zone, true, rcmag_table, <span class="insert">core, maxM
a</span>gStarName, names_brightness, starFont);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               for (GeodesicSearchBorderIterator it1(*geodesic_search_resul
t,it-&gt;first);(zone = it1.next()) &gt;= 0;)</td><td> </td><td class="right">               for (GeodesicSearchBorderIterator it1(*geodesic_search_resul
t,it-&gt;first);(zone = it1.next()) &gt;= 0;)</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0016" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       it-&gt;second-&gt;draw(zone, false, rcmag_table, <span class="delete">prj, maxM</span></td><td> </td><td class="rblock">                       it-&gt;second-&gt;draw(zone, false, rcmag_table, <span class="insert">core, max</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">agStarName,names_brightness,</span> starFont);</td><td> </td><td class="rblock"><span class="insert">MagStarName,names_brightness,</span> starFont);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    }</td><td> </td><td class="rblock">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    exit_loop:</td><td> </td><td class="rblock">       exit_loop:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // Finish drawing many stars</td><td> </td><td class="right">       // Finish drawing many stars</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       skyDrawer-&gt;postDrawPointSource();</td><td> </td><td class="right">       skyDrawer-&gt;postDrawPointSource();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       delete sPainter;</td><td> </td><td class="right">       delete sPainter;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       sPainter = NULL;</td><td> </td><td class="right">       sPainter = NULL;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0017" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       drawPointer(prj, nav);</td><td> </td><td class="rblock">       <span class="insert">if (objectMgr-&gt;getFlagSelectedObjectPointer())</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">}</span></td><td> </td><td class="rblock">               drawPointer(prj, nav);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">// Look for a star by XYZ coords</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">StelObjectP StarMgr::search(Vec3d pos) const {</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">Q_ASSERT(0);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">  pos.normalize();</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">  QList&lt;StelObjectP &gt; v = searchAround(pos,</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                                        0.8, // just an arbitrary number</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                                        NULL);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">  StelObjectP nearest;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">  double cos_angle_nearest = -10.0;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">  for (QList&lt;StelObjectP &gt;::const_iterator it(v.begin());it!=v.end();it++) </span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">{</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">    const double c = (*it)-&gt;getJ2000EquatorialPos(0)*pos;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">    if (c &gt; cos_angle_nearest) {</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      cos_angle_nearest = c;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      nearest = *it;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">    }</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">  }</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">  return nearest;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Return a stl vector containing the stars located</td><td> </td><td class="right">// Return a stl vector containing the stars located</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// inside the limFov circle around position v</td><td> </td><td class="right">// inside the limFov circle around position v</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0018" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">QList&lt;StelObjectP &gt; StarMgr::searchAround(const Vec3d&amp; vv,</td><td> </td><td class="rblock">QList&lt;StelObjectP &gt; StarMgr::searchAround(const Vec3d&amp; vv, double limFov, <span class="insert">c</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                           double limFov, <span class="delete">// degrees</span></td><td> </td><td class="rblock"><span class="insert">onst</span> StelCore* core) const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                                                                           </span></td><td> </td><td class="rblock">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       const</span> StelCore* core) const {</td><td> </td><td class="rblock">       QList&lt;StelObjectP &gt; result;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">  QList&lt;StelObjectP &gt; result;</td><td> </td><td class="rblock">       if (!getFlagStars())</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">  if (!getFlagStars())</td><td> </td><td class="rblock">               return result;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       return result;</td><td> </td><td class="rblock">                                                                           </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                           </td><td> </td><td class="rblock">       Vec3d v(vv);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">  Vec3d v(vv);</td><td> </td><td class="rblock">       v.normalize();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">  v.normalize();</td><td> </td><td class="rblock">                                                                           </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    // find any vectors h0 and h1 (length 1), so that h0*v=h1*v=h0*h1=0</td><td> </td><td class="rblock">       // find any vectors h0 and h1 (length 1), so that h0*v=h1*v=h0*h1=0</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">  int i;</td><td> </td><td class="rblock">       int i;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">  {</td><td> </td><td class="rblock">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    const double a0 = fabs(v[0]);</td><td> </td><td class="rblock">               const double a0 = fabs(v[0]);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    const double a1 = fabs(v[1]);</td><td> </td><td class="rblock">               const double a1 = fabs(v[1]);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    const double a2 = fabs(v[2]);</td><td> </td><td class="rblock">               const double a2 = fabs(v[2]);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    if (a0 &lt;= a1) {</td><td> </td><td class="rblock">               if (a0 &lt;= a1)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      if (a0 &lt;= a2) i = 0;</td><td> </td><td class="rblock">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      else i = 2;</td><td> </td><td class="rblock">                       if (a0 &lt;= a2) i = 0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    } else {</td><td> </td><td class="rblock">                       else i = 2;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      if (a1 &lt;= a2) i = 1;</td><td> </td><td class="rblock">               } else</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      else i = 2;</td><td> </td><td class="rblock">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    }</td><td> </td><td class="rblock">                       if (a1 &lt;= a2) i = 1;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">  }</td><td> </td><td class="rblock">                       else i = 2;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">  Vec3d h0(0.0,0.0,0.0);</td><td> </td><td class="rblock">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">  h0[i] = 1.0;</td><td> </td><td class="rblock">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">  Vec3d h1 = h0 ^ v;</td><td> </td><td class="rblock">       Vec3d h0(0.0,0.0,0.0);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">  h1.normalize();</td><td> </td><td class="rblock">       h0[i] = 1.0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">  h0 = h1 ^ v;</td><td> </td><td class="rblock">       Vec3d h1 = h0 ^ v;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">  h0.normalize();</td><td> </td><td class="rblock">       h1.normalize();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    // <span class="delete">now</span> we have h0*v=h1*v=h0*h1=0.</td><td> </td><td class="rblock">       h0 = h1 ^ v;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    // <span class="delete">construct</span> a region with 4 corners e0,e1,e2,e3 inside which</td><td> </td><td class="rblock">       h0.normalize();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    <span class="delete">//</span> all <span class="delete">desired</span> stars must be:</td><td> </td><td class="rblock">                                                                           </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">  double f = 1.4142136 * tan(limFov * M_PI/180.0);</td><td> </td><td class="rblock">       // <span class="insert">Now</span> we have h0*v=h1*v=h0*h1=0.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">  h0 *= f;</td><td> </td><td class="rblock">       // <span class="insert">Construct</span> a region with 4 corners e0,e1,e2,e3 inside which all <span class="insert">de</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">  h1 *= f;</td><td> </td><td class="rblock"><span class="insert">sired</span> stars must be:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">  Vec3d e0 = v + h0;</td><td> </td><td class="rblock">       double f = 1.4142136 * tan(limFov * M_PI/180.0);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">  Vec3d e1 = v + h1;</td><td> </td><td class="rblock">       h0 *= f;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">  Vec3d e2 = v - h0;</td><td> </td><td class="rblock">       h1 *= f;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">  Vec3d e3 = v - h1;</td><td> </td><td class="rblock">       Vec3d e0 = v + h0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">  f = 1.0/e0.length();</td><td> </td><td class="rblock">       Vec3d e1 = v + h1;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">  e0 *= f;</td><td> </td><td class="rblock">       Vec3d e2 = v - h0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">  e1 *= f;</td><td> </td><td class="rblock">       Vec3d e3 = v - h1;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">  e2 *= f;</td><td> </td><td class="rblock">       f = 1.0/e0.length();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">  e3 *= f;</td><td> </td><td class="rblock">       e0 *= f;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    // <span class="delete">search</span> the triangles</td><td> </td><td class="rblock">       e1 *= f;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">  const GeodesicSearchResult* geodesic_search_result = <span class="delete">core-&gt;getGeodesicGri</span></td><td> </td><td class="rblock">       e2 *= f;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">d(lastMaxSearchLevel)-&gt;search(e3,e2,e1,e0,lastMaxSearchLevel);</span></td><td> </td><td class="rblock">       e3 *= f;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    // <span class="delete">iterate</span> over the stars inside the <span class="delete">triangles:</span></td><td> </td><td class="rblock">       // <span class="insert">Search</span> the triangles</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">  f = cos(limFov * M_PI/180.);</td><td> </td><td class="rblock">       const GeodesicSearchResult* geodesic_search_result = <span class="insert">core-&gt;getGeodes</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">  for (ZoneArrayMap::const_iterator <span class="delete">it(zoneArrays.begin());</span></td><td> </td><td class="rblock"><span class="insert">icGrid(lastMaxSearchLevel)-&gt;search(e3,e2,e1,e0,lastMaxSearchLevel);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       it!=zoneArrays.end();it++)</span> {</td><td> </td><td class="rblock">                                                                           </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">//qDebug() &lt;&lt; "search inside(" &lt;&lt; it-&gt;first &lt;&lt; "):";</td><td> </td><td class="rblock">       // <span class="insert">Iterate</span> over the stars inside the <span class="insert">triangles</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    int zone;</td><td> </td><td class="rblock">       f = cos(limFov * M_PI/180.);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    for (GeodesicSearchInsideIterator <span class="delete">it1(*geodesic_search_result,it-&gt;first</span></td><td> </td><td class="rblock">       for (ZoneArrayMap::const_iterator <span class="insert">it(zoneArrays.begin());it!=zoneArr</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">);</span></td><td> </td><td class="rblock"><span class="insert">ays.end();it++)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">         (zone</span> = it1.next()) &gt;= 0;) {</td><td> </td><td class="rblock">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      <span class="delete">it-&gt;second-&gt;searchAround(zone,v,f,result);</span></td><td> </td><td class="rblock">               //qDebug() &lt;&lt; "search inside(" &lt;&lt; it-&gt;first &lt;&lt; "):";</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">//qDebug() &lt;&lt; " " &lt;&lt; zone;</td><td> </td><td class="rblock">               int zone;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    }</td><td> </td><td class="rblock">               for (GeodesicSearchInsideIterator <span class="insert">it1(*geodesic_search_resul</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">//qDebug() &lt;&lt; endl &lt;&lt; "search border(" &lt;&lt; it-&gt;first &lt;&lt; "):";</td><td> </td><td class="rblock"><span class="insert">t,it-&gt;first);(zone</span> = it1.next()) &gt;= 0;)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    for (GeodesicSearchBorderIterator <span class="delete">it1(*geodesic_search_result,it-&gt;first</span></td><td> </td><td class="rblock">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">);</span></td><td> </td><td class="rblock">                       <span class="insert">it-&gt;second-&gt;searchAround(core-&gt;getNavigator(), zone,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">         (zone = it1.next()) &gt;= 0;) {</td><td> </td><td class="rblock"><span class="insert">v,f,result);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      <span class="delete">it-&gt;second-&gt;searchAround(zone,v,f,result);</span></td><td> </td><td class="rblock">                       //qDebug() &lt;&lt; " " &lt;&lt; zone;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">//qDebug() &lt;&lt; " " &lt;&lt; zone;</td><td> </td><td class="rblock">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    }</td><td> </td><td class="rblock">               //qDebug() &lt;&lt; endl &lt;&lt; "search border(" &lt;&lt; it-&gt;first &lt;&lt; "):";</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">  }</td><td> </td><td class="rblock">               for (GeodesicSearchBorderIterator <span class="insert">it1(*geodesic_search_resul</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">  return result;</td><td> </td><td class="rblock"><span class="insert">t,it-&gt;first);</span> (zone = it1.next()) &gt;= 0;)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                       <span class="insert">it-&gt;second-&gt;searchAround(core-&gt;getNavigator(), zone,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">v,f,result);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                       //qDebug() &lt;&lt; " " &lt;&lt; zone;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       return result;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//! Update i18 names from english names according to passed translator.</td><td> </td><td class="right">//! Update i18 names from english names according to passed translator.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//! The translation is done using gettext with translated strings defined i
n translations.h</td><td> </td><td class="right">//! The translation is done using gettext with translated strings defined i
n translations.h</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0019" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">void StarMgr::updateI18n() {</td><td> </td><td class="rblock">void StarMgr::updateI18n()</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">  StelTranslator trans = <span class="delete">StelApp::getInstance().getLocaleMgr().getSkyTransl</span></td><td> </td><td class="rblock">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">ator();</span></td><td> </td><td class="rblock">       StelTranslator trans = <span class="insert">StelApp::getInstance().getLocaleMgr().getSkyT</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">  commonNamesMapI18n.clear();</td><td> </td><td class="rblock"><span class="insert">ranslator();</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">  commonNamesIndexI18n.clear();</td><td> </td><td class="rblock">       commonNamesMapI18n.clear();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">  for (std::map&lt;int,QString&gt;::iterator <span class="delete">it(commonNamesMap.begin());</span></td><td> </td><td class="rblock">       commonNamesIndexI18n.clear();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       it!=commonNamesMap.end();it++) {</span></td><td> </td><td class="rblock">       for (std::map&lt;int,QString&gt;::iterator <span class="insert">it(commonNamesMap.begin());it!=</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">    const int i = it-&gt;first;</span></td><td> </td><td class="rblock"><span class="insert">commonNamesMap.end();it++)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">    const QString t(trans.qtranslate(it-&gt;second));</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">    commonNamesMapI18n[i] = t;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">    commonNamesIndexI18n[t.toUpper()] = i;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">  }</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">  starFont = &amp;StelApp::getInstance().getFontManager().getStandardFont(trans</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">.getTrueLocaleName(), fontSize);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">}</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">StelObjectP StarMgr::search(const QString&amp; name) const</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">{</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       // Use this QRegExp to extract the catalogue number and prefix</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       QRegExp catRx("^(HP|HD|SAO)\\s*(\\d+)$");</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       QString n = name.toUpper();</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       n.replace('_', ' ');</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       if (catRx.exactMatch(n))</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       {</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               QString cat = catRx.capturedTexts().at(1);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               if (cat=="HP")</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                       return searchHP(catRx.capturedTexts().at(2).toInt())</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               else // currently we only support searching by string for HP</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"> catalogue</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                       return NULL;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       }</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       else</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0020" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               <span class="delete">// Maybe the HP prefix is missing and we just have a number.</span></td><td> </td><td class="rblock">               <span class="insert">const</span> int <span class="insert">i</span> = <span class="insert">it-&gt;first;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">..</span></td><td> </td><td class="rblock"><span class="insert">               const QString t(trans.qtranslate(it-&gt;second));</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               bool ok;</span></td><td> </td><td class="rblock"><span class="insert">               commonNamesMapI18n[i] = t;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               int <span class="delete">num</span> = <span class="delete">n.toInt(&amp;ok);</span></td><td> </td><td class="rblock"><span class="insert">               commonNamesIndexI18n[t.toUpper()] = i;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               if (!ok)</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                       return NULL;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               else</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                       return searchHP(num);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0021" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       starFont = &amp;StelApp::getInstance().getFontManager().getStandardFont(
trans.getTrueLocaleName(), fontSize);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">// Search the star by HP number</td><td> </td><td class="right">// Search the star by HP number</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0022" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">StelObjectP StarMgr::searchHP(int <span class="delete">_HP)</span> const {</td><td> </td><td class="rblock">StelObjectP StarMgr::searchHP(int <span class="insert">hp)</span> const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">  if (0 &lt; <span class="delete">_HP</span> &amp;&amp; <span class="delete">_HP</span> &lt;= NR_OF_HIP) {</td><td> </td><td class="rblock">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    const Star1 *const s = <span class="delete">hipIndex[_HP].s;</span></td><td> </td><td class="rblock">       if (0 &lt; <span class="insert">hp</span> &amp;&amp; <span class="insert">hp</span> &lt;= NR_OF_HIP)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    if (s) {</td><td> </td><td class="rblock">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      const SpecialZoneArray&lt;Star1&gt; *const a = <span class="delete">hipIndex[_HP].a;</span></td><td> </td><td class="rblock">               const Star1 *const s = <span class="insert">hipIndex[hp].s;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      const SpecialZoneData&lt;Star1&gt; *const z = <span class="delete">hipIndex[_HP].z;</span></td><td> </td><td class="rblock">               if (s)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      return s-&gt;createStelObject(a,z);</td><td> </td><td class="rblock">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    }</td><td> </td><td class="rblock">                       const SpecialZoneArray&lt;Star1&gt; *const a = <span class="insert">hipIndex[hp</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">  }</td><td> </td><td class="rblock"><span class="insert">].a;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">  return StelObjectP();</td><td> </td><td class="rblock">                       const SpecialZoneData&lt;Star1&gt; *const z = <span class="insert">hipIndex[hp]</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">.z;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                       return s-&gt;createStelObject(a,z);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       return StelObjectP();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">StelObjectP StarMgr::searchByNameI18n(const QString&amp; nameI18n) const</td><td> </td><td class="right">StelObjectP StarMgr::searchByNameI18n(const QString&amp; nameI18n) const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       QString objw = nameI18n.toUpper();</td><td> </td><td class="right">       QString objw = nameI18n.toUpper();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // Search by HP number if it's an HP formated number</td><td> </td><td class="right">       // Search by HP number if it's an HP formated number</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0023" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       QRegExp rx("^\\s*<span class="delete">HP</span>\\s*(\\d+)\\s*$", Qt::CaseInsensitive);</td><td> </td><td class="rblock">       QRegExp rx("^\\s*<span class="insert">(HIP|HP)</span>\\s*(\\d+)\\s*$", Qt::CaseInsensitive);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (rx.exactMatch(objw))</td><td> </td><td class="right">       if (rx.exactMatch(objw))</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0024" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               return searchHP(rx.capturedTexts().at(<span class="delete">1</span>).toInt());</td><td> </td><td class="rblock">               return searchHP(rx.capturedTexts().at(<span class="insert">2</span>).toInt());</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // Search by I18n common name</td><td> </td><td class="right">       // Search by I18n common name</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       std::map&lt;QString,int&gt;::const_iterator it(commonNamesIndexI18n.find(o
bjw));</td><td> </td><td class="right">       std::map&lt;QString,int&gt;::const_iterator it(commonNamesIndexI18n.find(o
bjw));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (it!=commonNamesIndexI18n.end())</td><td> </td><td class="right">       if (it!=commonNamesIndexI18n.end())</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               return searchHP(it-&gt;second);</td><td> </td><td class="right">               return searchHP(it-&gt;second);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // Search by sci name</td><td> </td><td class="right">       // Search by sci name</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l7" /><small>skipping to change at</small><em> line 782</em></th><th> </th><th><a name="part-r7" /><small>skipping to change at</small><em> line 745</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return StelObjectP();</td><td> </td><td class="right">       return StelObjectP();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">StelObjectP StarMgr::searchByName(const QString&amp; name) const</td><td> </td><td class="right">StelObjectP StarMgr::searchByName(const QString&amp; name) const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       QString objw = name.toUpper();</td><td> </td><td class="right">       QString objw = name.toUpper();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // Search by HP number if it's an HP formated number</td><td> </td><td class="right">       // Search by HP number if it's an HP formated number</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0025" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       QRegExp rx("^\\s*<span class="delete">HP</span>\\s*(\\d+)\\s*$", Qt::CaseInsensitive);</td><td> </td><td class="rblock">       QRegExp rx("^\\s*<span class="insert">(HP|HIP)</span>\\s*(\\d+)\\s*$", Qt::CaseInsensitive);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (rx.exactMatch(objw))</td><td> </td><td class="right">       if (rx.exactMatch(objw))</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0026" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               return searchHP(rx.capturedTexts().at(<span class="delete">1</span>).toInt());</td><td> </td><td class="rblock">               return searchHP(rx.capturedTexts().at(<span class="insert">2</span>).toInt());</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0027" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">/* Should we try this anyway?</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       // Search by common name</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       std::map&lt;QString,int&gt;::const_iterator it(commonNamesIndexI18n.find(o</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">bjw));</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       if (it!=commonNamesIndexI18n.end()) {</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">               return searchHP(it-&gt;second);</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       } */</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                           </td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // Search by sci name</td><td> </td><td class="right">       // Search by sci name</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       std::map&lt;QString,int&gt;::const_iterator it = sciNamesIndexI18n.find(ob
jw);</td><td> </td><td class="right">       std::map&lt;QString,int&gt;::const_iterator it = sciNamesIndexI18n.find(ob
jw);</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0028" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       if (it!=sciNamesIndexI18n.end()) {</td><td> </td><td class="rblock">       if (it!=sciNamesIndexI18n.end())</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               return searchHP(it-&gt;second);</td><td> </td><td class="right">               return searchHP(it-&gt;second);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return StelObjectP();</td><td> </td><td class="right">       return StelObjectP();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//! Find and return the list of at most maxNbItem objects auto-completing</td><td> </td><td class="right">//! Find and return the list of at most maxNbItem objects auto-completing</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0029" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">//! the passed object I18n name</td><td> </td><td class="rblock">//! the passed object I18n name<span class="insert">.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">QStringList StarMgr::listMatchingObjectsI18n(const QString&amp; objPrefix, int 
maxNbItem) const</td><td> </td><td class="right">QStringList StarMgr::listMatchingObjectsI18n(const QString&amp; objPrefix, int 
maxNbItem) const</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       QStringList result;</td><td> </td><td class="right">       QStringList result;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (maxNbItem==0) return result;</td><td> </td><td class="right">       if (maxNbItem==0) return result;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       QString objw = objPrefix.toUpper();</td><td> </td><td class="right">       QString objw = objPrefix.toUpper();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // Search for common names</td><td> </td><td class="right">       // Search for common names</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0030" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       for (std::map&lt;QString,int&gt;::const_iterator it(commonNamesIndexI18n.l</td><td> </td><td class="rblock">       for (std::map&lt;QString,int&gt;::const_iterator it(commonNamesIndexI18n.l</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">ower_bound(objw));</td><td> </td><td class="rblock">ower_bound(objw)); it!=commonNamesIndexI18n.end(); <span class="insert">++it)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">            it!=commonNamesIndexI18n.end();</td><td> </td><td class="rblock">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">            <span class="delete">it++)</span></td><td> </td><td class="rblock">               if <span class="insert">(it-&gt;first.startsWith(objw))</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       {</td><td> </td><td class="rblock">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               <span class="delete">const QString constw(it-&gt;first.mid(0,objw.size()));</span></td><td> </td><td class="rblock">                       if (maxNbItem==0)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               if <span class="delete">(constw==objw)</span> {</td><td> </td><td class="rblock">                               break;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       if (maxNbItem==0) break;</td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       result &lt;&lt; getCommonName(it-&gt;second);</td><td> </td><td class="right">                       result &lt;&lt; getCommonName(it-&gt;second);</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0031" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       <span class="delete">maxNbItem--</span>;</td><td> </td><td class="rblock">                       <span class="insert">--maxNbItem</span>;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               else</td><td> </td><td class="right">               else</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       break;</td><td> </td><td class="right">                       break;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // Search for sci names</td><td> </td><td class="right">       // Search for sci names</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0032" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       for (std::map&lt;QString,int&gt;::const_iterator it(sciNamesIndexI18n.lowe</td><td> </td><td class="rblock">       <span class="insert">QString bayerPattern = objw;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">r_bound(objw));</td><td> </td><td class="rblock"><span class="insert">       QRegExp bayerRegEx(bayerPattern);</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">            it!=sciNamesIndexI18n.end();</td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">            <span class="delete">it++)</span></td><td> </td><td class="rblock"><span class="insert">       // if the first character is a Greek letter, check if there's an ind</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       {</td><td> </td><td class="rblock"><span class="insert">ex</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               <span class="delete">const QString constw(it-&gt;first.mid(0,objw.size()));</span></td><td> </td><td class="rblock"><span class="insert">       // after it, such as "alpha1 Cen".</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               if <span class="delete">(constw==objw)</span> {</td><td> </td><td class="rblock"><span class="insert">       if (objw.at(0).unicode() &gt;= 0x0391 &amp;&amp; objw.at(0).unicode() &lt;= 0x03A9</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       if (maxNbItem==0) break;</td><td> </td><td class="rblock"><span class="insert">)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               bayerRegEx.setPattern(bayerPattern.insert(1,"\\d?"));</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                           </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       for (std::map&lt;QString,int&gt;::const_iterator it(sciNamesIndexI18n.lowe</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">r_bound(objw)); it!=sciNamesIndexI18n.end(); <span class="insert">++it)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">               if <span class="insert">(it-&gt;first.indexOf(bayerRegEx)==0)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                       if (maxNbItem==0)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                               break;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       result &lt;&lt; getSciName(it-&gt;second);</td><td> </td><td class="right">                       result &lt;&lt; getSciName(it-&gt;second);</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0033" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       <span class="delete">maxNbItem--</span>;</td><td> </td><td class="rblock">                       <span class="insert">--maxNbItem</span>;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0034" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               else</td><td> </td><td class="rblock">               else<span class="insert"> if (it-&gt;first.at(0) != objw.at(0))</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       break;</td><td> </td><td class="right">                       break;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // Add exact Hp catalogue numbers</td><td> </td><td class="right">       // Add exact Hp catalogue numbers</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0035" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       QRegExp hpRx("^<span class="delete">HP</span>\\s*(\\d+)\\s*$");</td><td> </td><td class="rblock">       QRegExp hpRx("^<span class="insert">(HIP|HP)</span>\\s*(\\d+)\\s*$");</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       hpRx.setCaseSensitivity(Qt::CaseInsensitive);</td><td> </td><td class="right">       hpRx.setCaseSensitivity(Qt::CaseInsensitive);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       if (hpRx.exactMatch(objw))</td><td> </td><td class="right">       if (hpRx.exactMatch(objw))</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               bool ok;</td><td> </td><td class="right">               bool ok;</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0036" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               int hpNum = hpRx.capturedTexts().at(<span class="delete">1</span>).toInt(&amp;ok);</td><td> </td><td class="rblock">               int hpNum = hpRx.capturedTexts().at(<span class="insert">2</span>).toInt(&amp;ok);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               if (ok)</td><td> </td><td class="right">               if (ok)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {</td><td> </td><td class="right">               {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       StelObjectP s = searchHP(hpNum);</td><td> </td><td class="right">                       StelObjectP s = searchHP(hpNum);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       if (s &amp;&amp; maxNbItem&gt;0)</td><td> </td><td class="right">                       if (s &amp;&amp; maxNbItem&gt;0)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       {</td><td> </td><td class="right">                       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0037" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                               result &lt;&lt; QString("HP%1").arg(hpNum);</td><td> </td><td class="rblock">                               result &lt;&lt; QString("H<span class="insert">I</span>P%1").arg(hpNum);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                               maxNbItem--;</td><td> </td><td class="right">                               maxNbItem--;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       }</td><td> </td><td class="right">                       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               }</td><td> </td><td class="right">               }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       result.sort();</td><td> </td><td class="right">       result.sort();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       return result;</td><td> </td><td class="right">       return result;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">//! Define font file name and size to use for star names display</td><td> </td><td class="right">//! Define font file name and size to use for star names display</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">void StarMgr::setFontSize(double newFontSize)</td><td> </td><td class="right">void StarMgr::setFontSize(double newFontSize)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       fontSize = newFontSize;</td><td> </td><td class="right">       fontSize = newFontSize;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       starFont = &amp;StelApp::getInstance().getFontManager().getStandardFont(</td><td> </td><td class="right">       starFont = &amp;StelApp::getInstance().getFontManager().getStandardFont(</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               StelApp::getInstance().getLocaleMgr().getSkyLanguage(),fontS
ize);</td><td> </td><td class="right">               StelApp::getInstance().getLocaleMgr().getSkyLanguage(),fontS
ize);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">}</td><td> </td><td class="right">}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0038" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">void StarMgr::updateSkyCulture()</td><td> </td><td class="rblock">void StarMgr::updateSkyCulture(<span class="insert">const QString&amp; skyCultureDir</span>)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">{</td><td> </td><td class="right">{</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0039" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">QString skyCultureDir = StelApp::getInstance().getSkyCultureMgr().ge</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">tCurrentSkyCultureID();</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                           </td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       // Load culture star names in english</td><td> </td><td class="right">       // Load culture star names in english</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       try</td><td> </td><td class="right">       try</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               loadCommonNames(StelApp::getInstance().getFileMgr().findFile
("skycultures/" + skyCultureDir + "/star_names.fab"));</td><td> </td><td class="right">               loadCommonNames(StelApp::getInstance().getFileMgr().findFile
("skycultures/" + skyCultureDir + "/star_names.fab"));</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       catch(std::runtime_error&amp; e)</td><td> </td><td class="right">       catch(std::runtime_error&amp; e)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       {</td><td> </td><td class="right">       {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               qWarning() &lt;&lt; "WARNING: could not load star_names.fab for sk
y culture "</td><td> </td><td class="right">               qWarning() &lt;&lt; "WARNING: could not load star_names.fab for sk
y culture "</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                          &lt;&lt; skyCultureDir &lt;&lt; ": " &lt;&lt; e.what();</td><td> </td><td class="right">                          &lt;&lt; skyCultureDir &lt;&lt; ": " &lt;&lt; e.what();</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       }</td><td> </td><td class="right">       }</td><td class="lineno" valign="top"></td></tr>

     <tr><td></td><td class="left"></td><td> </td><td class="right"></td><td></td></tr>
     <tr bgcolor="gray"><th colspan="5" align="center"><a name="end">&nbsp;End of changes. 39 change blocks.&nbsp;</a></th></tr>
     <tr class="stats"><td></td><th><i>242 lines changed or deleted</i></th><th><i> </i></th><th><i>207 lines changed or added</i></th><td></td></tr>
     <tr><td colspan="5" align="center" class="small"><br/>This html diff was produced by rfcdiff 1.41. The latest version is available from <a href="http://www.tools.ietf.org/tools/rfcdiff/" >http://tools.ietf.org/tools/rfcdiff/</a> </td></tr>
   </table>
   </body>
   </html>
