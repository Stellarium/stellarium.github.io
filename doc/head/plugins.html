<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Stellarium: Plugins</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="stellarium-logo.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Stellarium 0.12.2</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- Generated by Doxygen 1.8.3.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="codingStyle.html"><span>Coding&#160;Style</span></a></li>
      <li><a href="scripting.html"><span>Scripting</span></a></li>
      <li><a href="plugins.html"><span>Plugins</span></a></li>
      <li><a href="renderer.html"><span>Renderer</span></a></li>
      <li><a href="fileStructure.html"><span>File&#160;Structure</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Plugins </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#introduction">Introduction</a></li>
<li class="level1"><a href="#staticAndDynamicPlugins">Static and Dynamic Plugins</a></li>
<li class="level1"><a href="#code">Coding</a></li>
<li class="level1"><a href="#examplePlugins">Example Plugins</a></li>
<li class="level1"><a href="#buildingPlugins">Building Plugins</a></li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="introduction"></a>
Introduction</h1>
<p>Plugins are extensions to Stellarium. They are potentially more powerful than <a class="el" href="scripting.html">scripts</a>, but are more difficult to write and maintain. Unlike scripts, plugins must be compiled for a specific platform, and will typically only be compatible with a particular version of Stellarium.</p>
<p>We hope that the plugin system will allow third party developers to write extensions to Stellarium which might not otherwise be included in the core program, and that the system will allow for prototyping of new features before inclusion into the core.</p>
<h1><a class="anchor" id="staticAndDynamicPlugins"></a>
Static and Dynamic Plugins</h1>
<p>Plugins can be built and used in two different ways:</p>
<ul>
<li><b>dynamic plugins</b> are stand-alone dynamic libraries (separate files with <code>.so</code> extension on Linux, <code>.dll</code> in Windows or <code>.dylib</code> on Mac OS X) that are loaded at run-time (on start-up) by Stellarium. This allows dynamic plugins to be distributed separately from Stellarium.</li>
<li><b>static plugins</b> are linked statically at build-time. They become "built-in", a part of Stellarium's binary files. This is used to release fixed versions of some "official" plugins together with Stellarium's releases.</li>
</ul>
<p>As Stellarium's plugin interface has changed over time, plugins for different versions so far are not interchangeable. This is the reason why the official plugins have been linked statically to the official release.</p>
<p>Static plugins require changes in the core code of Stellarium (the addition of Qt macros in several classes). This is why adding a new static plugin requires either asking the developers to add it to the main distribution, or creating and distributing a custom build.</p>
<p>Dynamic plugin libriaries need to be installed in a proper place in Stellarium's <a class="el" href="fileStructure.html">file tree</a> to function. Stellarium is looking for plugins in the <code>/modules</code> subdirectory of the user data directory or the installation data directory. Each plugin library must be in its own subdiretory of the <code>/modules</code> directory. If the plugin is called "MyPlugin", then its subdirectory should be also called <code>/MyPlugin</code> and the main name (without the extension) of the plugin binary file should be <code>libMyPlugin</code>. So, for example, the file tree should look like this on Windows XP:</p>
<ul>
<li><code>C:/Documents and Settings/User/Application Data/Stellarium/</code> (user data directory)<ul>
<li><code>modules/</code><ul>
<li><code>MyPlugin/</code><ul>
<li><code>libMyPlugin.dll</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>See the implementation of <a class="el" href="classStelModuleMgr.html#aa5031a821f0b81ee3f991e19d660900c" title="Return the list of all the external module found in the modules directories.">StelModuleMgr::getPluginsList()</a> for more details.</p>
<h1><a class="anchor" id="code"></a>
Coding</h1>
<p>A plugin should contain a main class deriving from the <a class="el" href="classStelModule.html" title="This is the common base class for all the main components of stellarium.">StelModule</a> class as well as an instance of the <a class="el" href="classStelPluginInterface.html" title="Define the interface to implement when creating a plugin.">StelPluginInterface</a> which allows Stellarium to load it. At startup, the <a class="el" href="classStelModuleMgr.html" title="Manage a collection of StelModules including both core and plugin modules.">StelModuleMgr</a> will load the library, and an instance of the <a class="el" href="classStelModule.html" title="This is the common base class for all the main components of stellarium.">StelModule</a> it contains will be instantiated and added to the list of other "normal" StelModules.</p>
<p>A plugin can interact with the users in many ways, not limited to:</p>
<ul>
<li>painting directly on the viewport like other StelModules (see the examples below);</li>
<li>defining <a href="http://doc.qt.nokia.com/stable/qaction.html">QActions</a> triggered with keyboard shortcut combinations with StelGui::addGuiActions();</li>
<li>buttons (<a class="el" href="classStelButton.html" title="A Button Graphicsitem for use in Stellarium&#39;s graphic widgets.">StelButton</a>) added to the bottom button bar (<a class="el" href="classBottomStelBar.html">BottomStelBar</a>; see the examples below);</li>
<li>windows (subclasses of <a class="el" href="classStelDialog.html" title="Base class for all the GUI windows in Stellarium.">StelDialog</a>) that can be designed with Qt's UI editor (see the examples and the configuration windows of the official plugins);</li>
<li>custom controls displayed anywhere on the screen based on any of the classes that inherit <a href="http://doc.qt.nokia.com/stable/qgraphicsitem.html">QGraphicsItem</a> (see <a href="http://doc.qt.nokia.com/stable/graphicsview.html">the documentation of Qt's Graphics View Framework</a>). To get a base widget to work on, use <a class="el" href="classStelGui.html#af8eb8aea49101eaeb83c79fc1e301f61" title="Get the SkyGui instance (useful for adding other interface elements).">StelGui::getSkyGui()</a>.</li>
</ul>
<p><em>Plugin developers - please note that classes used in plugins must inherit code from the core which is published under the GNU GPL. <b>If you distribute a binary plugin, you must do so under the terms of the same GNU General Public License that Stellarium uses</b> (as of August 2011, this is GNU GPL "version 2 or any later version"). No sneaky closed-source shenanigans now.</em></p>
<h1><a class="anchor" id="examplePlugins"></a>
Example Plugins</h1>
<p>There are a few simple <b>static</b> plugins written and maintained by the Stellarium developer team that can serve as examples.</p>
<ul>
<li><a href="http://bazaar.launchpad.net/~stellarium/stellarium/trunk/files/head%3A/plugins/HelloStelModule/">HelloStelModule plugin</a>: minimal plugin, intended as an example.</li>
<li><a href="http://bazaar.launchpad.net/~stellarium/stellarium/trunk/files/head%3A/plugins/SimpleDrawLine/">SimpleDrawLine</a>: minimal plugin for drawing lines.</li>
<li><a href="http://bazaar.launchpad.net/%7Estellarium/stellarium/trunk/files/head%3A/plugins/AngleMeasure/">AngleMeasure plugin</a>: simple plugin, intended as a guide to new developers.</li>
<li><a href="http://bazaar.launchpad.net/%7Estellarium/stellarium/trunk/files/head%3A/plugins/CompassMarks/">CompassMarks plugin</a>: another simple plugin intended as a guide to new developers.</li>
</ul>
<p>All static plugins incorporated in Stellarium's main code can be found in the <a href="http://bazaar.launchpad.net/~stellarium/stellarium/trunk/files/head%3A/plugins/">/plugins</a> subdirectory of Stellarium's code tree. Note that some of these plugins are under construction and have not been distributed yet with an official release.</p>
<p>There are also a few simple <b>dynamic</b> plugins. Their code is hosted in Stellarium's old Subversion repository at SourceForge.net:</p>
<ul>
<li><a href="http://sourceforge.net/p/stellarium/code/HEAD/tree/trunk/extmodules/ExampleDialog/">ExampleDialog</a> provides an example on how a plugin can create a Stellarium-style window and add a button to the bottom tool bar.</li>
<li><a href="http://sourceforge.net/p/stellarium/code/HEAD/tree/trunk/extmodules/ExamplePainter/">ExamplePainter</a> provides an example on how a plugin can draw on the viewport.</li>
</ul>
<p><a href="http://archive.eso.org/cms/virgo/">VirGO</a> is a fully featured extension to Stellarium sponsored by ESO. VirGO is used by professional astronomers to display and analyse data from the ESO archive. Follow the link for more information.</p>
<h1><a class="anchor" id="buildingPlugins"></a>
Building Plugins</h1>
<p><b>Note:</b> The following section is mostly out of date. It applies to <b>dynamic</b> plugins.</p>
<p>The following instructions can be used to build the Angle Measure plugin and the Compass Marks plugin.</p>
<ul>
<li>
<p class="startli">First, you will need to download the Stellarium source code from SVN, according to the instructions in the Stellarium build pages (see <a href="http://www.stellarium.org/wiki/index.php/Compilation_on_Linux">this page</a> for *nix systems, and <a href="http://www.stellarium.org/wiki/index.php/Windows_Build_Instructions">this page</a> for Windows builds). For the rest of this discussion, I will assume you downloaded the source code in the directory <code>/home/me/builds/stellarium</code>. If you put the source code somewhere else, you will need to modify the following instructions accordingly.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">After downloading the stellarium source such that it is in <code>/home/me/builds/stellarium</code>, change into the <code>/home/me/builds</code> directory and fetch the <code>extmodules</code> files from SVN. On Linux, you can use these commands to accomplish this: </p>
<pre class="fragment">cd /home/me/builds
svn co https://stellarium.svn.sourceforge.net/svnroot/stellarium/trunk/extmodules
</pre><p class="endli"></p>
</li>
<li>
<p class="startli">Build the main Stellarium program according to the instructions for your platform. Please note that you must build with the <code>Release</code> settings, not the <code>Debug</code> settings. You can do this by adding a step after doing <code>cmake</code>. On Windows, use the <code>cmakegui</code> tool, or on *nix use the <code>ccmake</code> tool (or just edit the <code>CMakeCache.txt</code> file) to set the value of <code>CMAKE_BUILD_TYPE</code> to <code>Release</code>. Then continue with the <code>make</code> stage.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Set an environment variable called <code>STELROOT</code> which contains the path to the Stellarium source code. </p>
<pre class="fragment">export STELROOT=/home/me/builds/stellarium
</pre><p class="endli"></p>
</li>
<li>
<p class="startli">Change into the directory containing the plugin you want to build, then create a build directory. On *nix systems this should be called <code>builds/unix</code>, on Windows it should be called <code>builds/msys</code>. Once made, change into it. e.g. on Linux: </p>
<pre class="fragment">cd /home/me/builds/plugins/AngleMeasure
mkdir -p builds/unix
cd builds/unix
</pre><p class="endli"></p>
</li>
<li>
The rest of the build procedure should be simple <ul>
<li>
On *nix systems: <pre class="fragment"> cmake ../..
 make
 make install
</pre>  </li>
<li>
On Windows: <pre class="fragment"> cmake -G "MSYS Makefiles" ../..
 make
</pre> </li>
</ul>
</li>
</ul>
<p>To install the plugin on Linux systems, simple add a <code>make install</code> command after the <code>make</code>. This will copy the necessary files to <code> $HOME/.stellarium/modules/AngleMeasure</code>.</p>
<p>To install a plugin on Windows or OSX, you should locate the User Data Directory, and then create a sub-directory called <code>modules</code> in it. Inside this, create a subdirectory named for the plugin, e.g. <code>AngleMeasure</code>. Into this directory, you should copy the following files: </p>
<ul>
<li>
<code>module.ini</code> file from the plugin source directory. </li>
<li>
<code>lib&lt;plugin-name&gt;</code>.so or <code>lib&lt;plugin-name&gt;</code>.dll from the <code>src</code> sub-directory of the <code>builds/unix</code> or <code>builds/msys</code> directory in the plugin source directory. </li>
<li>
Any other files which are needed for the plugin (there are no others for the example plugins at time of writing). </li>
</ul>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Jun 21 2013 19:17:17 for Stellarium by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.3.1
</small></address>
</body>
</html>
